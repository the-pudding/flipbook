function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["../chunks/browser.iMDD0cow.js","../chunks/validateLine.NbEnA8Ii.js","../chunks/scheduler.BIFECd0c.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{s as Ma,R as qp,e as M,S as zt,j as Z,c as D,a as j,T as Kt,d as I,l as Q,m as F,v as zp,U as Ln,i as ge,f as A,V as Ot,W as Kp,X as Vp,Y as Gp,C as yh,Z as Wp,o as Da,t as he,b as fe,g as Ke,E as Jp,n as Ur,k as Qe,r as Tn,w as Xp,a0 as Yp}from"../chunks/scheduler.BIFECd0c.js";import{S as Fa,i as $a,a as rt,t as Vt,f as Zp,c as wh,g as bh,b as _h,d as vh,m as Eh,e as Sh,h as Qp}from"../chunks/index.C3gPqRKU.js";import{e as jt}from"../chunks/each.D6YF6ztN.js";import{_ as Gr}from"../chunks/preload-helper.BQ24v_F8.js";import"../chunks/transform.W7TN51b0.js";import{a as La,l as eg,f as tg,v as rg}from"../chunks/validateLine.NbEnA8Ii.js";import{v as sg}from"../chunks/version.8vTIxrph.js";class ng extends Map{constructor(e,r=ag){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[s,n]of e)this.set(s,n)}get(e){return super.get(cl(this,e))}has(e){return super.has(cl(this,e))}set(e,r){return super.set(ig(this,e),r)}delete(e){return super.delete(og(this,e))}}function cl({_intern:t,_key:e},r){const s=e(r);return t.has(s)?t.get(s):r}function ig({_intern:t,_key:e},r){const s=e(r);return t.has(s)?t.get(s):(t.set(s,r),r)}function og({_intern:t,_key:e},r){const s=e(r);return t.has(s)&&(r=t.get(s),t.delete(s)),r}function ag(t){return t!==null&&typeof t=="object"?t.valueOf():t}function cg(t){return t}function lg(t,...e){return ug(t,Array.from,cg,e)}function ug(t,e,r,s){return function n(i,o){if(o>=s.length)return r(i);const a=new ng,c=s[o++];let l=-1;for(const u of i){const d=c(u,++l,i),h=a.get(d);h?h.push(u):a.set(d,[u])}for(const[u,d]of a)a.set(u,n(d,o));return e(a)}(t,0)}var ll={},Vi={},Gi=34,ls=10,Wi=13;function xh(t){return new Function("d","return {"+t.map(function(e,r){return JSON.stringify(e)+": d["+r+'] || ""'}).join(",")+"}")}function dg(t,e){var r=xh(t);return function(s,n){return e(r(s),n,t)}}function ul(t){var e=Object.create(null),r=[];return t.forEach(function(s){for(var n in s)n in e||r.push(e[n]=n)}),r}function ze(t,e){var r=t+"",s=r.length;return s<e?new Array(e-s+1).join(0)+r:r}function hg(t){return t<0?"-"+ze(-t,6):t>9999?"+"+ze(t,6):ze(t,4)}function fg(t){var e=t.getUTCHours(),r=t.getUTCMinutes(),s=t.getUTCSeconds(),n=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":hg(t.getUTCFullYear())+"-"+ze(t.getUTCMonth()+1,2)+"-"+ze(t.getUTCDate(),2)+(n?"T"+ze(e,2)+":"+ze(r,2)+":"+ze(s,2)+"."+ze(n,3)+"Z":s?"T"+ze(e,2)+":"+ze(r,2)+":"+ze(s,2)+"Z":r||e?"T"+ze(e,2)+":"+ze(r,2)+"Z":"")}function Ah(t){var e=new RegExp('["'+t+`
\r]`),r=t.charCodeAt(0);function s(d,h){var m,g,p=n(d,function(w,E){if(m)return m(w,E-1);g=w,m=h?dg(w,h):xh(w)});return p.columns=g||[],p}function n(d,h){var m=[],g=d.length,p=0,w=0,E,C=g<=0,R=!1;d.charCodeAt(g-1)===ls&&--g,d.charCodeAt(g-1)===Wi&&--g;function L(){if(C)return Vi;if(R)return R=!1,ll;var ce,q=p,X;if(d.charCodeAt(q)===Gi){for(;p++<g&&d.charCodeAt(p)!==Gi||d.charCodeAt(++p)===Gi;);return(ce=p)>=g?C=!0:(X=d.charCodeAt(p++))===ls?R=!0:X===Wi&&(R=!0,d.charCodeAt(p)===ls&&++p),d.slice(q+1,ce-1).replace(/""/g,'"')}for(;p<g;){if((X=d.charCodeAt(ce=p++))===ls)R=!0;else if(X===Wi)R=!0,d.charCodeAt(p)===ls&&++p;else if(X!==r)continue;return d.slice(q,ce)}return C=!0,d.slice(q,g)}for(;(E=L())!==Vi;){for(var re=[];E!==ll&&E!==Vi;)re.push(E),E=L();h&&(re=h(re,w++))==null||m.push(re)}return m}function i(d,h){return d.map(function(m){return h.map(function(g){return u(m[g])}).join(t)})}function o(d,h){return h==null&&(h=ul(d)),[h.map(u).join(t)].concat(i(d,h)).join(`
`)}function a(d,h){return h==null&&(h=ul(d)),i(d,h).join(`
`)}function c(d){return d.map(l).join(`
`)}function l(d){return d.map(u).join(t)}function u(d){return d==null?"":d instanceof Date?fg(d):e.test(d+="")?'"'+d.replace(/"/g,'""')+'"':d}return{parse:s,parseRows:n,format:o,formatBody:a,formatRows:c,formatRow:l,formatValue:u}}var Ch=Ah(","),pg=Ch.parse,gg=Ch.format,kh=Ah("	"),mg=kh.parse,yg=kh.format;const wg=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Gr(()=>Promise.resolve().then(()=>Ys),void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)};class Ua extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class bg extends Ua{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class _g extends Ua{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class vg extends Ua{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Eg=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(s.next(u))}catch(d){o(d)}}function c(u){try{l(s.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):n(u.value).then(a,c)}l((s=s.apply(t,e||[])).next())})};class Sg{constructor(e,{headers:r={},customFetch:s}={}){this.url=e,this.headers=r,this.fetch=wg(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var s;return Eg(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=r;let a={},c;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));const l=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:c}).catch(m=>{throw new bg(m)}),u=l.headers.get("x-relay-error");if(u&&u==="true")throw new _g(l);if(!l.ok)throw new vg(l);let d=((s=l.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),h;return d==="application/json"?h=yield l.json():d==="application/octet-stream"?h=yield l.blob():d==="multipart/form-data"?h=yield l.formData():h=yield l.text(),{data:h,error:null}}catch(n){return{data:null,error:n}}})}}var xg=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Wr=xg();const Ag=Wr.fetch,ja=Wr.fetch.bind(Wr),Rh=Wr.Headers,Cg=Wr.Request,kg=Wr.Response,Ys=Object.freeze(Object.defineProperty({__proto__:null,Headers:Rh,Request:Cg,Response:kg,default:ja,fetch:Ag},Symbol.toStringTag,{value:"Module"}));class Rg extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class Tg{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=ja:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,a,c;let l=null,u=null,d=null,h=i.status,m=i.statusText;if(i.ok){if(this.method!=="HEAD"){const E=await i.text();E===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=E:u=JSON.parse(E))}const p=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),w=(a=i.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");p&&w&&w.length>1&&(d=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(l={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,h=406,m="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const p=await i.text();try{l=JSON.parse(p),Array.isArray(l)&&i.status===404&&(u=[],l=null,h=200,m="OK")}catch{i.status===404&&p===""?(h=204,m="No Content"):l={message:p}}if(l&&this.isMaybeSingle&&(!((c=l==null?void 0:l.details)===null||c===void 0)&&c.includes("0 rows"))&&(l=null,h=200,m="OK"),l&&this.shouldThrowOnError)throw new Rg(l)}return{error:l,data:u,count:d,status:h,statusText:m}});return this.shouldThrowOnError||(n=n.catch(i=>{var o,a,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(a=i==null?void 0:i.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),n.then(e,r)}}class Og extends Tg{select(e){let r=!1;const s=(e??"*").split("").map(n=>/\s/.test(n)&&!r?"":(n==='"'&&(r=!r),n)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:r=!0,nullsFirst:s,foreignTable:n,referencedTable:i=n}={}){const o=i?`${i}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${r?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:r,referencedTable:s=r}={}){const n=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,r,{foreignTable:s,referencedTable:n=s}={}){const i=typeof n>"u"?"offset":`${n}.offset`,o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${r-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:r=!1,settings:s=!1,buffers:n=!1,wal:i=!1,format:o="text"}={}){var a;const c=[e?"analyze":null,r?"verbose":null,s?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${l}"; options=${c};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class $r extends Og{eq(e,r){return this.url.searchParams.append(e,`eq.${r}`),this}neq(e,r){return this.url.searchParams.append(e,`neq.${r}`),this}gt(e,r){return this.url.searchParams.append(e,`gt.${r}`),this}gte(e,r){return this.url.searchParams.append(e,`gte.${r}`),this}lt(e,r){return this.url.searchParams.append(e,`lt.${r}`),this}lte(e,r){return this.url.searchParams.append(e,`lte.${r}`),this}like(e,r){return this.url.searchParams.append(e,`like.${r}`),this}likeAllOf(e,r){return this.url.searchParams.append(e,`like(all).{${r.join(",")}}`),this}likeAnyOf(e,r){return this.url.searchParams.append(e,`like(any).{${r.join(",")}}`),this}ilike(e,r){return this.url.searchParams.append(e,`ilike.${r}`),this}ilikeAllOf(e,r){return this.url.searchParams.append(e,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(e,r){return this.url.searchParams.append(e,`ilike(any).{${r.join(",")}}`),this}is(e,r){return this.url.searchParams.append(e,`is.${r}`),this}in(e,r){const s=r.map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cs.{${r.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(r)}`),this}containedBy(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cd.{${r.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(r)}`),this}rangeGt(e,r){return this.url.searchParams.append(e,`sr.${r}`),this}rangeGte(e,r){return this.url.searchParams.append(e,`nxl.${r}`),this}rangeLt(e,r){return this.url.searchParams.append(e,`sl.${r}`),this}rangeLte(e,r){return this.url.searchParams.append(e,`nxr.${r}`),this}rangeAdjacent(e,r){return this.url.searchParams.append(e,`adj.${r}`),this}overlaps(e,r){return typeof r=="string"?this.url.searchParams.append(e,`ov.${r}`):this.url.searchParams.append(e,`ov.{${r.join(",")}}`),this}textSearch(e,r,{config:s,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${o}.${r}`),this}match(e){return Object.entries(e).forEach(([r,s])=>{this.url.searchParams.append(r,`eq.${s}`)}),this}not(e,r,s){return this.url.searchParams.append(e,`not.${r}.${s}`),this}or(e,{foreignTable:r,referencedTable:s=r}={}){const n=s?`${s}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,r,s){return this.url.searchParams.append(e,`${r}.${s}`),this}}class Pg{constructor(e,{headers:r={},schema:s,fetch:n}){this.url=e,this.headers=r,this.schema=s,this.fetch=n}select(e,{head:r=!1,count:s}={}){const n=r?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),s&&(this.headers.Prefer=`count=${s}`),new $r({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:r,defaultToNull:s=!0}={}){const n="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((a,c)=>a.concat(Object.keys(c)),[]);if(o.length>0){const a=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",a.join(","))}}return new $r({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:r,ignoreDuplicates:s=!1,count:n,defaultToNull:i=!0}={}){const o="POST",a=[`resolution=${s?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),i||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const c=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(c.length>0){const l=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new $r({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:r}={}){const s="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),r&&n.push(`count=${r}`),this.headers.Prefer=n.join(","),new $r({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const r="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new $r({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const Ig="1.9.2",Bg={"X-Client-Info":`postgrest-js/${Ig}`};class Ha{constructor(e,{headers:r={},schema:s,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},Bg),r),this.schemaName=s,this.fetch=n}from(e){const r=new URL(`${this.url}/${e}`);return new Pg(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Ha(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:s=!1,count:n}={}){let i;const o=new URL(`${this.url}/rpc/${e}`);let a;s?(i="HEAD",Object.entries(r).forEach(([l,u])=>{o.searchParams.append(l,`${u}`)})):(i="POST",a=r);const c=Object.assign({},this.headers);return n&&(c.Prefer=`count=${n}`),new $r({method:i,url:o,headers:c,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}}const Ng="2.9.3",Mg={"X-Client-Info":`realtime-js/${Ng}`},Dg="1.0.0",Th=1e4,Fg=1e3;var jr;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(jr||(jr={}));var et;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(et||(et={}));var gt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(gt||(gt={}));var ha;(function(t){t.websocket="websocket"})(ha||(ha={}));var gr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(gr||(gr={}));class Oh{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class $g{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,r,s)}_decodeBroadcast(e,r,s){const n=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const a=s.decode(e.slice(o,o+n));o=o+n;const c=s.decode(e.slice(o,o+i));o=o+i;const l=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:c,payload:l}}}class Ji{constructor(e,r,s={},n=Th){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var dl;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(dl||(dl={}));class Ms{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ms.syncState(this.state,n,i,o),this.pendingDiffs.forEach(c=>{this.state=Ms.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Ms.syncDiff(this.state,n,i,o),a())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const i=this.cloneDeep(e),o=this.transformState(r),a={},c={};return this.map(i,(l,u)=>{o[l]||(c[l]=u)}),this.map(o,(l,u)=>{const d=i[l];if(d){const h=u.map(w=>w.presence_ref),m=d.map(w=>w.presence_ref),g=u.filter(w=>m.indexOf(w.presence_ref)<0),p=d.filter(w=>h.indexOf(w.presence_ref)<0);g.length>0&&(a[l]=g),p.length>0&&(c[l]=p)}else a[l]=u}),this.syncDiff(i,{joins:a,leaves:c},s,n)}static syncDiff(e,r,s,n){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(a,c)=>{var l;const u=(l=e[a])!==null&&l!==void 0?l:[];if(e[a]=this.cloneDeep(c),u.length>0){const d=e[a].map(m=>m.presence_ref),h=u.filter(m=>d.indexOf(m.presence_ref)<0);e[a].unshift(...h)}s(a,u,c)}),this.map(o,(a,c)=>{let l=e[a];if(!l)return;const u=c.map(d=>d.presence_ref);l=l.filter(d=>u.indexOf(d.presence_ref)<0),e[a]=l,n(a,l,c),l.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ie;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(ie||(ie={}));const hl=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,o)=>(i[o]=Lg(o,t,e,n),i),{})},Lg=(t,e,r,s)=>{const n=e.find(a=>a.name===t),i=n==null?void 0:n.type,o=r[t];return i&&!s.includes(i)?Ph(i,o):fa(o)},Ph=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return qg(e,r)}switch(t){case ie.bool:return Ug(e);case ie.float4:case ie.float8:case ie.int2:case ie.int4:case ie.int8:case ie.numeric:case ie.oid:return jg(e);case ie.json:case ie.jsonb:return Hg(e);case ie.timestamp:return zg(e);case ie.abstime:case ie.date:case ie.daterange:case ie.int4range:case ie.int8range:case ie.money:case ie.reltime:case ie.text:case ie.time:case ie.timestamptz:case ie.timetz:case ie.tsrange:case ie.tstzrange:return fa(e);default:return fa(e)}},fa=t=>t,Ug=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},jg=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Hg=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},qg=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>Ph(e,a))}return t},zg=t=>typeof t=="string"?t.replace(" ","T"):t;var fl;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(fl||(fl={}));var pl;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes"})(pl||(pl={}));var gl;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(gl||(gl={}));class qa{constructor(e,r={config:{}},s){this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=et.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},r.config),this.timeout=this.socket.timeout,this.joinPush=new Ji(this,gt.join,this.params,this.timeout),this.rejoinTimer=new Oh(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=et.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=et.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=et.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=et.errored,this.rejoinTimer.scheduleTimeout())}),this._on(gt.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new Ms(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,r=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o}}=this.params;this._onError(l=>e&&e("CHANNEL_ERROR",l)),this._onClose(()=>e&&e("CLOSED"));const a={},c={broadcast:i,presence:o,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(l=>l.filter))!==null&&n!==void 0?n:[]};this.socket.accessToken&&(a.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:c},a)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",({postgres_changes:l})=>{var u;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),l===void 0){e&&e("SUBSCRIBED");return}else{const d=this.bindings.postgres_changes,h=(u=d==null?void 0:d.length)!==null&&u!==void 0?u:0,m=[];for(let g=0;g<h;g++){const p=d[g],{filter:{event:w,schema:E,table:C,filter:R}}=p,L=l&&l[g];if(L&&L.event===w&&L.schema===E&&L.table===C&&L.filter===R)m.push(Object.assign(Object.assign({},p),{id:L.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e("SUBSCRIBED");return}}).receive("error",l=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(l).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this._on(e,r,s)}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,a={method:"POST",headers:{apikey:(s=this.socket.apiKey)!==null&&s!==void 0?s:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,a,(n=r.timeout)!==null&&n!==void 0?n:this.timeout)).ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,c;const l=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),l.receive("ok",()=>i("ok")),l.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=et.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(gt.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(s=>{const n=new Ji(this,gt.leave,{},e);n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,r,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),o}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Ji(this,e,r,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,i;const o=e.toLocaleLowerCase(),{close:a,error:c,leave:l,join:u}=gt;if(s&&[a,c,l,u].indexOf(o)>=0&&s!==this._joinRef())return;let h=this._onMessage(o,r,s);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(m=>{var g,p,w;return((g=m.filter)===null||g===void 0?void 0:g.event)==="*"||((w=(p=m.filter)===null||p===void 0?void 0:p.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===o}).map(m=>m.callback(h,s)):(i=this.bindings[o])===null||i===void 0||i.filter(m=>{var g,p,w,E,C,R;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const L=m.id,re=(g=m.filter)===null||g===void 0?void 0:g.event;return L&&((p=r.ids)===null||p===void 0?void 0:p.includes(L))&&(re==="*"||(re==null?void 0:re.toLocaleLowerCase())===((w=r.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const L=(C=(E=m==null?void 0:m.filter)===null||E===void 0?void 0:E.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return L==="*"||L===((R=r==null?void 0:r.event)===null||R===void 0?void 0:R.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:p,table:w,commit_timestamp:E,type:C,errors:R}=g;h=Object.assign(Object.assign({},{schema:p,table:w,commit_timestamp:E,eventType:C,new:{},old:{},errors:R}),this._getPayloadRecords(g))}m.callback(h,s)})}_isClosed(){return this.state===et.closed}_isJoined(){return this.state===et.joined}_isJoining(){return this.state===et.joining}_isLeaving(){return this.state===et.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),i={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&qa.isEqual(n.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(gt.close,{},e)}_onError(e){this._on(gt.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=et.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=hl(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=hl(e.columns,e.old_record)),r}}const Kg=()=>{},Vg=typeof WebSocket<"u";class Gg{constructor(e,r){var s;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=Mg,this.params={},this.timeout=Th,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Kg,this.conn=null,this.sendBuffer=[],this.serializer=new $g,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>Gr(()=>Promise.resolve().then(()=>Ys),void 0,import.meta.url).then(({default:c})=>c(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${ha.websocket}`,r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const n=(s=r==null?void 0:r.params)===null||s===void 0?void 0:s.apikey;n&&(this.accessToken=n,this.apiKey=n),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,o)=>o(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Oh(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(Vg){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new Wg(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Gr(()=>import("../chunks/browser.iMDD0cow.js").then(e=>e.b),__vite__mapDeps([0,1,2]),import.meta.url).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case jr.connecting:return gr.Connecting;case jr.open:return gr.Open;case jr.closing:return gr.Closing;default:return gr.Closed}}isConnected(){return this.connectionState()===gr.Open}channel(e,r={config:{}}){const s=new qa(`realtime:${e}`,r,this);return this.channels.push(s),s}push(e){const{topic:r,event:s,payload:n,ref:i}=e,o=()=>{this.encode(e,a=>{var c;(c=this.conn)===null||c===void 0||c.send(a)})};this.log("push",`${r} ${s} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(r=>{e&&r.updateJoinPayload({access_token:e}),r.joinedOnce&&r._isJoined()&&r._push(gt.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Dg}))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:s,event:n,payload:i,ref:o}=r;(o&&o===this.pendingHeartbeatRef||n===(i==null?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${n} ${o&&"("+o+")"||""}`,i),this.channels.filter(a=>a._isMember(s)).forEach(a=>a._trigger(n,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(gt.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Fg,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class Wg{constructor(e,r,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=jr.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class za extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Le(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Jg extends za{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class ml extends za{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var Xg=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(s.next(u))}catch(d){o(d)}}function c(u){try{l(s.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):n(u.value).then(a,c)}l((s=s.apply(t,e||[])).next())})};const Ih=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Gr(()=>Promise.resolve().then(()=>Ys),void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},Yg=()=>Xg(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Gr(()=>Promise.resolve().then(()=>Ys),void 0,import.meta.url)).Response:Response});var Yr=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(s.next(u))}catch(d){o(d)}}function c(u){try{l(s.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):n(u.value).then(a,c)}l((s=s.apply(t,e||[])).next())})};const Xi=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Zg=(t,e)=>Yr(void 0,void 0,void 0,function*(){const r=yield Yg();t instanceof r?t.json().then(s=>{e(new Jg(Xi(s),t.status||500))}).catch(s=>{e(new ml(Xi(s),s))}):e(new ml(Xi(t),t))}),Qg=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};function ni(t,e,r,s,n,i){return Yr(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(r,Qg(e,s,n,i)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Zg(c,a))})})}function pa(t,e,r,s){return Yr(this,void 0,void 0,function*(){return ni(t,"GET",e,r,s)})}function Ht(t,e,r,s,n){return Yr(this,void 0,void 0,function*(){return ni(t,"POST",e,s,n,r)})}function em(t,e,r,s,n){return Yr(this,void 0,void 0,function*(){return ni(t,"PUT",e,s,n,r)})}function Bh(t,e,r,s,n){return Yr(this,void 0,void 0,function*(){return ni(t,"DELETE",e,s,n,r)})}var nt=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(s.next(u))}catch(d){o(d)}}function c(u){try{l(s.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):n(u.value).then(a,c)}l((s=s.apply(t,e||[])).next())})};const tm={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},yl={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class rm{constructor(e,r={},s,n){this.url=e,this.headers=r,this.bucketId=s,this.fetch=Ih(n)}uploadOrUpdate(e,r,s,n){return nt(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},yl),n),a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl)):(i=s,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType);const c=this._removeEmptyFolders(r),l=this._getFinalPath(c),u=yield this.fetch(`${this.url}/object/${l}`,Object.assign({method:e,body:i,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),d=yield u.json();return u.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(Le(i))return{data:null,error:i};throw i}})}upload(e,r,s){return nt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,s)})}uploadToSignedUrl(e,r,s,n){return nt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",r);try{let c;const l=Object.assign({upsert:yl.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(l.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",l.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",l.cacheControl)):(c=s,u["cache-control"]=`max-age=${l.cacheControl}`,u["content-type"]=l.contentType);const d=yield this.fetch(a.toString(),{method:"PUT",body:c,headers:u}),h=yield d.json();return d.ok?{data:{path:i,fullPath:h.Key},error:null}:{data:null,error:h}}catch(c){if(Le(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e){return nt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=yield Ht(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:this.headers}),n=new URL(this.url+s.url),i=n.searchParams.get("token");if(!i)throw new za("No token returned by API");return{data:{signedUrl:n.toString(),path:e,token:i},error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}})}update(e,r,s){return nt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,s)})}move(e,r){return nt(this,void 0,void 0,function*(){try{return{data:yield Ht(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r},{headers:this.headers}),error:null}}catch(s){if(Le(s))return{data:null,error:s};throw s}})}copy(e,r){return nt(this,void 0,void 0,function*(){try{return{data:{path:(yield Ht(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r},{headers:this.headers})).Key},error:null}}catch(s){if(Le(s))return{data:null,error:s};throw s}})}createSignedUrl(e,r,s){return nt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield Ht(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(Le(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,s){return nt(this,void 0,void 0,function*(){try{const n=yield Ht(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(Le(n))return{data:null,error:n};throw n}})}download(e,r){return nt(this,void 0,void 0,function*(){const n=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield pa(this.fetch,`${this.url}/${n}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(Le(a))return{data:null,error:a};throw a}})}getPublicUrl(e,r){const s=this._getFinalPath(e),n=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&n.push(i);const a=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&n.push(c);let l=n.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${s}${l}`)}}}remove(e){return nt(this,void 0,void 0,function*(){try{return{data:yield Bh(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}})}list(e,r,s){return nt(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},tm),r),{prefix:e||""});return{data:yield Ht(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(Le(n))return{data:null,error:n};throw n}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const sm="2.5.5",nm={"X-Client-Info":`storage-js/${sm}`};var Pr=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(s.next(u))}catch(d){o(d)}}function c(u){try{l(s.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):n(u.value).then(a,c)}l((s=s.apply(t,e||[])).next())})};class im{constructor(e,r={},s){this.url=e,this.headers=Object.assign(Object.assign({},nm),r),this.fetch=Ih(s)}listBuckets(){return Pr(this,void 0,void 0,function*(){try{return{data:yield pa(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Le(e))return{data:null,error:e};throw e}})}getBucket(e){return Pr(this,void 0,void 0,function*(){try{return{data:yield pa(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Pr(this,void 0,void 0,function*(){try{return{data:yield Ht(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Le(s))return{data:null,error:s};throw s}})}updateBucket(e,r){return Pr(this,void 0,void 0,function*(){try{return{data:yield em(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Le(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Pr(this,void 0,void 0,function*(){try{return{data:yield Ht(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Pr(this,void 0,void 0,function*(){try{return{data:yield Bh(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(Le(r))return{data:null,error:r};throw r}})}}class om extends im{constructor(e,r={},s){super(e,r,s)}from(e){return new rm(this.url,this.headers,e,this.fetch)}}const am="2.39.8";let Bs="";typeof Deno<"u"?Bs="deno":typeof document<"u"?Bs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Bs="react-native":Bs="node";const cm={"X-Client-Info":`supabase-js-${Bs}/${am}`},lm={headers:cm},um={schema:"public"},dm={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},hm={};var fm=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(s.next(u))}catch(d){o(d)}}function c(u){try{l(s.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):n(u.value).then(a,c)}l((s=s.apply(t,e||[])).next())})};const pm=t=>{let e;return t?e=t:typeof fetch>"u"?e=ja:e=fetch,(...r)=>e(...r)},gm=()=>typeof Headers>"u"?Rh:Headers,mm=(t,e,r)=>{const s=pm(r),n=gm();return(i,o)=>fm(void 0,void 0,void 0,function*(){var a;const c=(a=yield e())!==null&&a!==void 0?a:t;let l=new n(o==null?void 0:o.headers);return l.has("apikey")||l.set("apikey",t),l.has("Authorization")||l.set("Authorization",`Bearer ${c}`),s(i,Object.assign(Object.assign({},o),{headers:l}))})};function ym(t){return t.replace(/\/$/,"")}function wm(t,e){const{db:r,auth:s,realtime:n,global:i}=t,{db:o,auth:a,realtime:c,global:l}=e;return{db:Object.assign(Object.assign({},o),r),auth:Object.assign(Object.assign({},a),s),realtime:Object.assign(Object.assign({},c),n),global:Object.assign(Object.assign({},l),i)}}function bm(t){return Math.round(Date.now()/1e3)+t}function _m(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const ft=()=>typeof document<"u",lr={tested:!1,writable:!1},Ds=()=>{if(!ft())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(lr.tested)return lr.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),lr.tested=!0,lr.writable=!0}catch{lr.tested=!0,lr.writable=!1}return lr.writable};function Yi(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const Nh=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Gr(()=>Promise.resolve().then(()=>Ys),void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},vm=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",ur=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},wn=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Zi=async(t,e)=>{await t.removeItem(e)};function Em(t){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let r="",s,n,i,o,a,c,l,u=0;for(t=t.replace("-","+").replace("_","/");u<t.length;)o=e.indexOf(t.charAt(u++)),a=e.indexOf(t.charAt(u++)),c=e.indexOf(t.charAt(u++)),l=e.indexOf(t.charAt(u++)),s=o<<2|a>>4,n=(a&15)<<4|c>>2,i=(c&3)<<6|l,r=r+String.fromCharCode(s),c!=64&&n!=0&&(r=r+String.fromCharCode(n)),l!=64&&i!=0&&(r=r+String.fromCharCode(i));return r}class ii{constructor(){this.promise=new ii.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}ii.promiseConstructor=Promise;function wl(t){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,r=t.split(".");if(r.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(r[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=r[1];return JSON.parse(Em(s))}async function Sm(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function xm(t,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function Am(t){return("0"+t.toString(16)).substr(-2)}function Ir(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,Am).join("")}async function Cm(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}function km(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Br(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await Cm(t);return km(r)}class Ka extends Error{constructor(e,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r}}function W(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Rm extends Ka{constructor(e,r){super(e,r),this.name="AuthApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}function Tm(t){return W(t)&&t.name==="AuthApiError"}class Mh extends Ka{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Sr extends Ka{constructor(e,r,s){super(e),this.name=r,this.status=s}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Nr extends Sr{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class Qi extends Sr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class bn extends Sr{constructor(e){super(e,"AuthInvalidCredentialsError",400)}}class _n extends Sr{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class bl extends Sr{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ga extends Sr{constructor(e,r){super(e,"AuthRetryableFetchError",r)}}function eo(t){return W(t)&&t.name==="AuthRetryableFetchError"}class Om extends Sr{constructor(e,r,s){super(e,"AuthWeakPasswordError",r),this.reasons=s}}var Pm=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};const Lr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Im=[502,503,504];async function _l(t){if(!vm(t))throw new ga(Lr(t),0);if(Im.includes(t.status))throw new ga(Lr(t),t.status);let e;try{e=await t.json()}catch(r){throw new Mh(Lr(r),r)}throw typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)?new Om(Lr(e),t.status,e.weak_password.reasons):new Rm(Lr(e),t.status||500)}const Bm=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function J(t,e,r,s){var n;const i=Object.assign({},s==null?void 0:s.headers);s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Nm(t,e,r+a,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function Nm(t,e,r,s,n,i){const o=Bm(e,s,n,i);let a;try{a=await t(r,o)}catch(c){throw console.error(c),new ga(Lr(c),0)}if(a.ok||await _l(a),s!=null&&s.noResolveJson)return a;try{return await a.json()}catch(c){await _l(c)}}function fr(t){var e;let r=null;$m(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=bm(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function vl(t){const e=fr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function qt(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Mm(t){return{data:t,error:null}}function Dm(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=t,o=Pm(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},c=Object.assign({},o);return{data:{properties:a,user:c},error:null}}function Fm(t){return t}function $m(t){return t.access_token&&t.refresh_token&&t.expires_in}var Lm=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};class Um{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=Nh(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r="global"){try{return await J(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(W(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await J(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:qt})}catch(s){if(W(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=Lm(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await J(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Dm,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(W(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await J(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:qt})}catch(r){if(W(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,i,o,a,c;try{const l={nextPage:null,lastPage:0,total:0},u=await J(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Fm});if(u.error)throw u.error;const d=await u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(c=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(g.split(";")[1].split("=")[1]);l[`${w}Page`]=p}),l.total=parseInt(h)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(W(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await J(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:qt})}catch(r){if(W(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){try{return await J(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:qt})}catch(s){if(W(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){try{return await J(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:qt})}catch(s){if(W(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:r,error:s}=await J(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(W(r))return{data:null,error:r};throw r}}async _deleteFactor(e){try{return{data:await J(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(W(r))return{data:null,error:r};throw r}}}const Dh="0.0.0",jm="http://localhost:9999",Hm="supabase.auth.token",qm={"X-Client-Info":`gotrue-js/${Dh}`},El=10,zm={getItem:t=>Ds()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{Ds()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{Ds()&&globalThis.localStorage.removeItem(t)}};function Sl(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function Km(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Mr={debug:!!(globalThis&&Ds()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Fh extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Vm extends Fh{}async function Gm(t,e,r){Mr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Mr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){Mr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{Mr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw Mr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Vm(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Mr.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}})}Km();const Wm={url:jm,storageKey:Hm,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:qm,flowType:"implicit",debug:!1},us=30*1e3,xl=3;async function Al(t,e,r){return await r()}class Us{constructor(e){var r,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Us.nextInstanceID,Us.nextInstanceID+=1,this.instanceID>0&&ft()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Wm),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Um({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Nh(n.fetch),this.lock=n.lock||Al,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,n.lock?this.lock=n.lock:ft()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Gm:this.lock=Al,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:Ds()?this.storage=zm:(this.memoryStorage={},this.storage=Sl(this.memoryStorage)):(this.memoryStorage={},this.storage=Sl(this.memoryStorage)),ft()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Dh}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=ft()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:r,error:s}=await this._getSessionFromURL(e);if(s)return this._debug("#_initialize()","error detecting session from URL",s),(s==null?void 0:s.message)==="Identity is already linked"||(s==null?void 0:s.message)==="Identity is already linked to another user"?{error:s}:(await this._removeSession(),{error:s});const{session:n,redirectType:i}=r;return this._debug("#_initialize()","detected session in URL",n,"redirect type",i),await this._saveSession(n),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return W(e)?{error:e}:{error:new Mh("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signUp(e){var r,s,n;try{await this._removeSession();let i;if("email"in e){const{email:u,password:d,options:h}=e;let m=null,g=null;if(this.flowType==="pkce"){const p=Ir();await ur(this.storage,`${this.storageKey}-code-verifier`,p),m=await Br(p),g=p===m?"plain":"s256"}i=await J(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:m,code_challenge_method:g},xform:fr})}else if("phone"in e){const{phone:u,password:d,options:h}=e;i=await J(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(s=h==null?void 0:h.data)!==null&&s!==void 0?s:{},channel:(n=h==null?void 0:h.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:fr})}else throw new bn("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const c=o.session,l=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:l,session:c},error:null}}catch(i){if(W(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{await this._removeSession();let r;if("email"in e){const{email:i,password:o,options:a}=e;r=await J(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:vl})}else if("phone"in e){const{phone:i,password:o,options:a}=e;r=await J(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:vl})}else throw new bn("You must provide either an email or phone number and a password");const{data:s,error:n}=r;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Qi}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(W(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,s,n,i;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const r=await wn(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/"),{data:i,error:o}=await J(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:fr});return await Zi(this.storage,`${this.storageKey}-code-verifier`),o?{data:{user:null,session:null,redirectType:null},error:o}:!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Qi}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}async signInWithIdToken(e){await this._removeSession();try{const{options:r,provider:s,token:n,access_token:i,nonce:o}=e,a=await J(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:fr}),{data:c,error:l}=a;return l?{data:{user:null,session:null},error:l}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Qi}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:l})}catch(r){if(W(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,s,n,i,o;try{if(await this._removeSession(),"email"in e){const{email:a,options:c}=e;let l=null,u=null;if(this.flowType==="pkce"){const h=Ir();await ur(this.storage,`${this.storageKey}-code-verifier`,h),l=await Br(h),u=h===l?"plain":"s256"}const{error:d}=await J(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:l,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:a,options:c}=e,{data:l,error:u}=await J(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:u}}throw new bn("You must provide either an email or phone number.")}catch(a){if(W(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,s;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let n,i;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await J(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:fr});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,l=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:l,session:c},error:null}}catch(n){if(W(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var r,s,n;try{await this._removeSession();let i=null,o=null;if(this.flowType==="pkce"){const a=Ir();await ur(this.storage,`${this.storageKey}-code-verifier`,a),i=await Br(a),o=a===i?"plain":"s256"}return await J(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Mm})}catch(i){if(W(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new Nr;const{error:n}=await J(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(W(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:o}=await J(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:o,error:a}=await J(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new bn("You must provide either an email or phone number and a type")}catch(r){if(W(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await wn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s)return{data:{session:e},error:null};const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await J(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:qt}):await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)throw o;return await J(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0,xform:qt})})}catch(r){if(W(r))return{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new Nr;const o=n.session;let a=null,c=null;if(this.flowType==="pkce"&&e.email!=null){const d=Ir();await ur(this.storage,`${this.storageKey}-code-verifier`,d),a=await Br(d),c=d===a?"plain":"s256"}const{data:l,error:u}=await J(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:c}),jwt:o.access_token,xform:qt});if(u)throw u;return o.user=l.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(W(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return wl(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Nr;const r=Date.now()/1e3;let s=r,n=!0,i=null;const o=wl(e.access_token);if(o.exp&&(s=o.exp,n=s<=r),n){const{session:a,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(W(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:o,error:a}=r;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Nr;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(W(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e){try{if(!ft())throw new _n("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new _n("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new bl("Not a valid PKCE flow url.");const r=Yi(window.location.href);if(e){if(!r.code)throw new bl("No code detected.");const{data:C,error:R}=await this._exchangeCodeForSession(r.code);if(R)throw R;const L=new URL(window.location.href);return L.searchParams.delete("code"),window.history.replaceState(window.history.state,"",L.toString()),{data:{session:C.session,redirectType:null},error:null}}if(r.error||r.error_description||r.error_code)throw new _n(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:a,expires_at:c,token_type:l}=r;if(!i||!a||!o||!l)throw new _n("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(a);let h=u+d;c&&(h=parseInt(c));const m=h-u;m*1e3<=us&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${d}s`);const g=h-d;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",g,h,u);const{data:p,error:w}=await this._getUser(i);if(w)throw w;const E={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:d,expires_at:h,refresh_token:o,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:E,redirectType:r.type},error:null}}catch(r){if(W(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantFlow(){const e=Yi(window.location.href);return!!(ft()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=Yi(window.location.href),r=await wn(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{error:i};const o=(s=n.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(Tm(a)&&(a.status===404||a.status===401)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Zi(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const r=_m(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:i},error:o}=r;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;if(this.flowType==="pkce"){const i=Ir();await ur(this.storage,`${this.storageKey}-code-verifier`,`${i}/PASSWORD_RECOVERY`),s=await Br(i),n=i===s?"plain":"s256"}try{return await J(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(W(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(W(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:s,error:n}=await this._useSession(async i=>{var o,a,c,l,u;const{data:d,error:h}=i;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await J(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return ft()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(W(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)throw o;return await J(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(W(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await xm(async n=>(await Sm(n*200),this._debug(r,"refreshing attempt",n),await J(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:fr})),(n,i,o)=>o&&o.error&&eo(o.error)&&Date.now()+(n+1)*200-s<us)}catch(s){if(this._debug(r,"error",s),W(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),ft()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await wn(this.storage,this.storageKey);if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const n=Math.round(Date.now()/1e3),i=((e=s.expires_at)!==null&&e!==void 0?e:1/0)<n+El;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${El}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),eo(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new Nr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new ii;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Nr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(n,"error",i),W(i)){const o={session:null,error:i};return eo(i)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),await ur(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Zi(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ft()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),us);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/us);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${us}ms, refresh threshold is ${xl} ticks`),n<=xl&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Fh)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ft()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const i=Ir();await ur(this.storage,`${this.storageKey}-code-verifier`,i);const o=await Br(i),a=i===o?"plain":"s256";this._debug("PKCE","code verifier",`${i.substring(0,5)}...`,"code challenge",o,"method",a);const c=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(c.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await J(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(W(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)return{data:null,error:o};const{data:a,error:c}=await J(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(!((n=a==null?void 0:a.totp)===null||n===void 0)&&n.qr_code&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(r){if(W(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:a}=await J(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(r){if(W(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await J(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(W(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const s=(e==null?void 0:e.factors)||[],n=s.filter(i=>i.factor_type==="totp"&&i.status==="verified");return{data:{all:s,totp:n},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,s;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(n.access_token);let a=null;o.aal&&(a=o.aal);let c=a;((s=(r=n.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}}Us.nextInstanceID=0;class Jm extends Us{constructor(e){super(e)}}var Xm=function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(s.next(u))}catch(d){o(d)}}function c(u){try{l(s.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):n(u.value).then(a,c)}l((s=s.apply(t,e||[])).next())})};class Ym{constructor(e,r,s){var n,i,o,a,c,l,u,d;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const h=ym(e);this.realtimeUrl=`${h}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${h}/auth/v1`,this.storageUrl=`${h}/storage/v1`,this.functionsUrl=`${h}/functions/v1`;const m=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,g={db:um,realtime:hm,auth:Object.assign(Object.assign({},dm),{storageKey:m}),global:lm},p=wm(s??{},g);this.storageKey=(i=(n=p.auth)===null||n===void 0?void 0:n.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=(o=p.global)===null||o===void 0?void 0:o.headers)!==null&&a!==void 0?a:{},this.auth=this._initSupabaseAuthClient((c=p.auth)!==null&&c!==void 0?c:{},this.headers,(l=p.global)===null||l===void 0?void 0:l.fetch),this.fetch=mm(r,this._getAccessToken.bind(this),(u=p.global)===null||u===void 0?void 0:u.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},p.realtime)),this.rest=new Ha(`${h}/rest/v1`,{headers:this.headers,schema:(d=p.db)===null||d===void 0?void 0:d.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new Sg(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new om(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},s={}){return this.rest.rpc(e,r,s)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return Xm(this,void 0,void 0,function*(){const{data:s}=yield this.auth.getSession();return(r=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,storageKey:i,flowType:o,debug:a},c,l){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Jm({url:this.authUrl,headers:Object.assign(Object.assign({},u),c),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,flowType:o,debug:a,fetch:l})}_initRealtimeClient(e){return new Gg(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,r,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.realtime.setAuth(s??null),this.changedAccessToken=s):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Zm=(t,e,r)=>new Ym(t,e,r),Qm=t=>{let e=t.httpHandler;return{setHttpHandler(r){e=r},httpHandler(){return e},updateHttpClientConfig(r,s){e.updateHttpClientConfig(r,s)},httpHandlerConfigs(){return e.httpHandlerConfigs()}}},e0=t=>({httpHandler:t.httpHandler()});var Cl;(function(t){t.HEADER="header",t.QUERY="query"})(Cl||(Cl={}));var kl;(function(t){t.HEADER="header",t.QUERY="query"})(kl||(kl={}));var js;(function(t){t.HTTP="http",t.HTTPS="https"})(js||(js={}));var Un;(function(t){t.MD5="md5",t.CRC32="crc32",t.CRC32C="crc32c",t.SHA1="sha1",t.SHA256="sha256"})(Un||(Un={}));var Rl;(function(t){t[t.HEADER=0]="HEADER",t[t.TRAILER=1]="TRAILER"})(Rl||(Rl={}));const ma="__smithy_context";var Tl;(function(t){t.PROFILE="profile",t.SSO_SESSION="sso-session",t.SERVICES="services"})(Tl||(Tl={}));var Ol;(function(t){t.HTTP_0_9="http/0.9",t.HTTP_1_0="http/1.0",t.TDS_8_0="tds/8.0"})(Ol||(Ol={}));class We{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static isInstance(e){if(!e)return!1;const r=e;return"method"in r&&"protocol"in r&&"hostname"in r&&"path"in r&&typeof r.query=="object"&&typeof r.headers=="object"}clone(){const e=new We({...this,headers:{...this.headers}});return e.query&&(e.query=t0(e.query)),e}}function t0(t){return Object.keys(t).reduce((e,r)=>{const s=t[r];return{...e,[r]:Array.isArray(s)?[...s]:s}},{})}class Hs{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const r=e;return typeof r.statusCode=="number"&&typeof r.headers=="object"}}function r0(t){return e=>async r=>{const{request:s}=r;return We.isInstance(s)&&s.body&&t.runtime==="node"&&(s.headers={...s.headers,Expect:"100-continue"}),e({...r,request:s})}}const s0={step:"build",tags:["SET_EXPECT_HEADER","EXPECT_HEADER"],name:"addExpectContinueMiddleware",override:!0},n0=t=>({applyToStack:e=>{e.add(r0(t),s0)}});const i0=t=>e=>async r=>{if(!We.isInstance(r.request))return e(r);const{request:s}=r,{handlerProtocol:n=""}=t.requestHandler.metadata||{};if(n.indexOf("h2")>=0&&!s.headers[":authority"])delete s.headers.host,s.headers[":authority"]=s.hostname+(s.port?":"+s.port:"");else if(!s.headers.host){let i=s.hostname;s.port!=null&&(i+=`:${s.port}`),s.headers.host=i}return e(r)},o0={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},a0=t=>({applyToStack:e=>{e.add(i0(t),o0)}}),c0=()=>(t,e)=>async r=>{var s,n;try{const i=await t(r),{clientName:o,commandName:a,logger:c,dynamoDbDocumentClientOptions:l={}}=e,{overrideInputFilterSensitiveLog:u,overrideOutputFilterSensitiveLog:d}=l,h=u??e.inputFilterSensitiveLog,m=d??e.outputFilterSensitiveLog,{$metadata:g,...p}=i.output;return(s=c==null?void 0:c.info)==null||s.call(c,{clientName:o,commandName:a,input:h(r.input),output:m(p),metadata:g}),i}catch(i){const{clientName:o,commandName:a,logger:c,dynamoDbDocumentClientOptions:l={}}=e,{overrideInputFilterSensitiveLog:u}=l,d=u??e.inputFilterSensitiveLog;throw(n=c==null?void 0:c.error)==null||n.call(c,{clientName:o,commandName:a,input:d(r.input),error:i,metadata:i.$metadata}),i}},l0={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},u0=t=>({applyToStack:e=>{e.add(c0(),l0)}});var Pl={};const Il="X-Amzn-Trace-Id",d0="AWS_LAMBDA_FUNCTION_NAME",h0="_X_AMZN_TRACE_ID",f0=t=>e=>async r=>{const{request:s}=r;if(!We.isInstance(s)||t.runtime!=="node"||s.headers.hasOwnProperty(Il))return e(r);const n=Pl[d0],i=Pl[h0],o=a=>typeof a=="string"&&a.length>0;return o(n)&&o(i)&&(s.headers[Il]=i),e({...r,request:s})},p0={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},g0=t=>({applyToStack:e=>{e.add(f0(t),p0)}});class Va{trace(){}debug(){}info(){}warn(){}error(){}}const dr=(t,e)=>{const r=[];if(t&&r.push(t),e)for(const s of e)r.push(s);return r},Mt=(t,e)=>`${t||"anonymous"}${e&&e.length>0?` (a.k.a. ${e.join(",")})`:""}`,jn=()=>{let t=[],e=[],r=!1;const s=new Set,n=d=>d.sort((h,m)=>Bl[m.step]-Bl[h.step]||Nl[m.priority||"normal"]-Nl[h.priority||"normal"]),i=d=>{let h=!1;const m=g=>{const p=dr(g.name,g.aliases);if(p.includes(d)){h=!0;for(const w of p)s.delete(w);return!1}return!0};return t=t.filter(m),e=e.filter(m),h},o=d=>{let h=!1;const m=g=>{if(g.middleware===d){h=!0;for(const p of dr(g.name,g.aliases))s.delete(p);return!1}return!0};return t=t.filter(m),e=e.filter(m),h},a=d=>{var h;return t.forEach(m=>{d.add(m.middleware,{...m})}),e.forEach(m=>{d.addRelativeTo(m.middleware,{...m})}),(h=d.identifyOnResolve)==null||h.call(d,u.identifyOnResolve()),d},c=d=>{const h=[];return d.before.forEach(m=>{m.before.length===0&&m.after.length===0?h.push(m):h.push(...c(m))}),h.push(d),d.after.reverse().forEach(m=>{m.before.length===0&&m.after.length===0?h.push(m):h.push(...c(m))}),h},l=(d=!1)=>{const h=[],m=[],g={};return t.forEach(w=>{const E={...w,before:[],after:[]};for(const C of dr(E.name,E.aliases))g[C]=E;h.push(E)}),e.forEach(w=>{const E={...w,before:[],after:[]};for(const C of dr(E.name,E.aliases))g[C]=E;m.push(E)}),m.forEach(w=>{if(w.toMiddleware){const E=g[w.toMiddleware];if(E===void 0){if(d)return;throw new Error(`${w.toMiddleware} is not found when adding ${Mt(w.name,w.aliases)} middleware ${w.relation} ${w.toMiddleware}`)}w.relation==="after"&&E.after.push(w),w.relation==="before"&&E.before.push(w)}}),n(h).map(c).reduce((w,E)=>(w.push(...E),w),[])},u={add:(d,h={})=>{const{name:m,override:g,aliases:p}=h,w={step:"initialize",priority:"normal",middleware:d,...h},E=dr(m,p);if(E.length>0){if(E.some(C=>s.has(C))){if(!g)throw new Error(`Duplicate middleware name '${Mt(m,p)}'`);for(const C of E){const R=t.findIndex(re=>{var ce;return re.name===C||((ce=re.aliases)==null?void 0:ce.some(q=>q===C))});if(R===-1)continue;const L=t[R];if(L.step!==w.step||w.priority!==L.priority)throw new Error(`"${Mt(L.name,L.aliases)}" middleware with ${L.priority} priority in ${L.step} step cannot be overridden by "${Mt(m,p)}" middleware with ${w.priority} priority in ${w.step} step.`);t.splice(R,1)}}for(const C of E)s.add(C)}t.push(w)},addRelativeTo:(d,h)=>{const{name:m,override:g,aliases:p}=h,w={middleware:d,...h},E=dr(m,p);if(E.length>0){if(E.some(C=>s.has(C))){if(!g)throw new Error(`Duplicate middleware name '${Mt(m,p)}'`);for(const C of E){const R=e.findIndex(re=>{var ce;return re.name===C||((ce=re.aliases)==null?void 0:ce.some(q=>q===C))});if(R===-1)continue;const L=e[R];if(L.toMiddleware!==w.toMiddleware||L.relation!==w.relation)throw new Error(`"${Mt(L.name,L.aliases)}" middleware ${L.relation} "${L.toMiddleware}" middleware cannot be overridden by "${Mt(m,p)}" middleware ${w.relation} "${w.toMiddleware}" middleware.`);e.splice(R,1)}}for(const C of E)s.add(C)}e.push(w)},clone:()=>a(jn()),use:d=>{d.applyToStack(u)},remove:d=>typeof d=="string"?i(d):o(d),removeByTag:d=>{let h=!1;const m=g=>{const{tags:p,name:w,aliases:E}=g;if(p&&p.includes(d)){const C=dr(w,E);for(const R of C)s.delete(R);return h=!0,!1}return!0};return t=t.filter(m),e=e.filter(m),h},concat:d=>{var m;const h=a(jn());return h.use(d),h.identifyOnResolve(r||h.identifyOnResolve()||(((m=d.identifyOnResolve)==null?void 0:m.call(d))??!1)),h},applyToStack:a,identify:()=>l(!0).map(d=>{const h=d.step??d.relation+" "+d.toMiddleware;return Mt(d.name,d.aliases)+" - "+h}),identifyOnResolve(d){return typeof d=="boolean"&&(r=d),r},resolve:(d,h)=>{for(const m of l().map(g=>g.middleware).reverse())d=m(d,h);return r&&console.log(u.identify()),d}};return u},Bl={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},Nl={high:3,normal:2,low:1};class m0{constructor(e){this.middlewareStack=jn(),this.config=e}send(e,r,s){const n=typeof r!="function"?r:void 0,i=typeof r=="function"?r:s,o=e.resolveMiddleware(this.middlewareStack,this.config,n);if(i)o(e).then(a=>i(null,a.output),a=>i(a)).catch(()=>{});else return o(e).then(a=>a.output)}destroy(){this.config.requestHandler.destroy&&this.config.requestHandler.destroy()}}const Wt={},Zr=new Array(64);for(let t=0,e=65,r=90;t+e<=r;t++){const s=String.fromCharCode(t+e);Wt[s]=t,Zr[t]=s}for(let t=0,e=97,r=122;t+e<=r;t++){const s=String.fromCharCode(t+e),n=t+26;Wt[s]=n,Zr[n]=s}for(let t=0;t<10;t++){Wt[t.toString(10)]=t+52;const e=t.toString(10),r=t+52;Wt[e]=r,Zr[r]=e}Wt["+"]=62;Zr[62]="+";Wt["/"]=63;Zr[63]="/";const Hr=6,Fs=8,y0=63,Ga=t=>{let e=t.length/4*3;t.slice(-2)==="=="?e-=2:t.slice(-1)==="="&&e--;const r=new ArrayBuffer(e),s=new DataView(r);for(let n=0;n<t.length;n+=4){let i=0,o=0;for(let l=n,u=n+3;l<=u;l++)if(t[l]!=="="){if(!(t[l]in Wt))throw new TypeError(`Invalid character ${t[l]} in base64 string.`);i|=Wt[t[l]]<<(u-l)*Hr,o+=Hr}else i>>=Hr;const a=n/4*3;i>>=o%Fs;const c=Math.floor(o/Fs);for(let l=0;l<c;l++){const u=(c-l-1)*Fs;s.setUint8(a+l,(i&255<<u)>>u)}}return new Uint8Array(r)},Qr=t=>new TextEncoder().encode(t),qr=t=>typeof t=="string"?Qr(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t),oi=t=>{if(typeof t=="string")return t;if(typeof t!="object"||typeof t.byteOffset!="number"||typeof t.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(t)};function Wa(t){let e;typeof t=="string"?e=Qr(t):e=t;const r=typeof e=="object"&&typeof e.length=="number",s=typeof e=="object"&&typeof e.byteOffset=="number"&&typeof e.byteLength=="number";if(!r&&!s)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let n="";for(let i=0;i<e.length;i+=3){let o=0,a=0;for(let l=i,u=Math.min(i+3,e.length);l<u;l++)o|=e[l]<<(u-l-1)*Fs,a+=Fs;const c=Math.ceil(a/Hr);o<<=c*Hr-a;for(let l=1;l<=c;l++){const u=(c-l)*Hr;n+=Zr[(o&y0<<u)>>u]}n+="==".slice(0,4-c)}return n}function w0(t,e="utf-8"){return e==="base64"?Wa(t):oi(t)}function b0(t,e){return e==="base64"?wr.mutate(Ga(t)):wr.mutate(Qr(t))}class wr extends Uint8Array{static fromString(e,r="utf-8"){switch(typeof e){case"string":return b0(e,r);default:throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}}static mutate(e){return Object.setPrototypeOf(e,wr.prototype),e}transformToString(e="utf-8"){return w0(this,e)}}const _0=(t,e)=>{const{base64Encoder:r,bodyLengthChecker:s,checksumAlgorithmFn:n,checksumLocationName:i,streamHasher:o}=e,a=r!==void 0&&s!==void 0&&n!==void 0&&i!==void 0&&o!==void 0,c=a?o(n,t):void 0,l=t.getReader();return new ReadableStream({async pull(u){const{value:d,done:h}=await l.read();if(h){if(u.enqueue(`0\r
`),a){const m=r(await c);u.enqueue(`${i}:${m}\r
`),u.enqueue(`\r
`)}u.close()}else u.enqueue(`${(s(d)||0).toString(16)}\r
${d}\r
`)}})},mr=t=>encodeURIComponent(t).replace(/[!'()*]/g,v0),v0=t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`;function E0(t){const e=[];for(let r of Object.keys(t).sort()){const s=t[r];if(r=mr(r),Array.isArray(s))for(let n=0,i=s.length;n<i;n++)e.push(`${r}=${mr(s[n])}`);else{let n=r;(s||typeof s=="string")&&(n+=`=${mr(s)}`),e.push(n)}}return e.join("&")}function S0(t=0){return new Promise((e,r)=>{t&&setTimeout(()=>{const s=new Error(`Request did not complete within ${t} ms`);s.name="TimeoutError",r(s)},t)})}const x0={supported:typeof Request<"u"&&"keepalive"in new Request("https://[::1]")};class Ja{static create(e){return typeof(e==null?void 0:e.handle)=="function"?e:new Ja(e)}constructor(e){typeof e=="function"?this.configProvider=e().then(r=>r||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config))}destroy(){}async handle(e,{abortSignal:r}={}){this.config||(this.config=await this.configProvider);const s=this.config.requestTimeout,n=this.config.keepAlive===!0;if(r!=null&&r.aborted){const p=new Error("Request aborted");return p.name="AbortError",Promise.reject(p)}let i=e.path;const o=E0(e.query||{});o&&(i+=`?${o}`),e.fragment&&(i+=`#${e.fragment}`);let a="";if(e.username!=null||e.password!=null){const p=e.username??"",w=e.password??"";a=`${p}:${w}@`}const{port:c,method:l}=e,u=`${e.protocol}//${a}${e.hostname}${c?`:${c}`:""}${i}`,h={body:l==="GET"||l==="HEAD"?void 0:e.body,headers:new Headers(e.headers),method:l};typeof AbortController<"u"&&(h.signal=r),x0.supported&&(h.keepalive=n);const m=new Request(u,h),g=[fetch(m).then(p=>{const w=p.headers,E={};for(const R of w.entries())E[R[0]]=R[1];return p.body!=null?{response:new Hs({headers:E,reason:p.statusText,statusCode:p.status,body:p.body})}:p.blob().then(R=>({response:new Hs({headers:E,reason:p.statusText,statusCode:p.status,body:R})}))}),S0(s)];return r&&g.push(new Promise((p,w)=>{r.onabort=()=>{const E=new Error("Request aborted");E.name="AbortError",w(E)}})),Promise.race(g)}updateHttpClientConfig(e,r){this.config=void 0,this.configProvider=this.configProvider.then(s=>(s[e]=r,s))}httpHandlerConfigs(){return this.config??{}}}const $h=t=>typeof Blob=="function"&&t instanceof Blob?A0(t):C0(t);async function A0(t){const e=await k0(t),r=Ga(e);return new Uint8Array(r)}async function C0(t){let e=new Uint8Array(0);const r=t.getReader();let s=!1;for(;!s;){const{done:n,value:i}=await r.read();if(i){const o=e;e=new Uint8Array(o.length+i.length),e.set(o),e.set(i,o.length)}s=n}return e}function k0(t){return new Promise((e,r)=>{const s=new FileReader;s.onloadend=()=>{if(s.readyState!==2)return r(new Error("Reader aborted too early"));const n=s.result??"",i=n.indexOf(","),o=i>-1?i+1:n.length;e(n.substring(o))},s.onabort=()=>r(new Error("Read aborted")),s.onerror=()=>r(s.error),s.readAsDataURL(t)})}const Lh={},ya={};for(let t=0;t<256;t++){let e=t.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),Lh[t]=e,ya[e]=t}function R0(t){if(t.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2){const s=t.slice(r,r+2).toLowerCase();if(s in ya)e[r/2]=ya[s];else throw new Error(`Cannot decode unrecognized sequence ${s} as hexadecimal`)}return e}function tt(t){let e="";for(let r=0;r<t.byteLength;r++)e+=Lh[t[r]];return e}const Ml="The stream has already been transformed.",T0=t=>{var n,i;if(!Dl(t)&&!Fl(t)){const o=((i=(n=t==null?void 0:t.__proto__)==null?void 0:n.constructor)==null?void 0:i.name)||t;throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${o}`)}let e=!1;const r=async()=>{if(e)throw new Error(Ml);return e=!0,await $h(t)},s=o=>{if(typeof o.stream!="function")throw new Error(`Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.
If you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body`);return o.stream()};return Object.assign(t,{transformToByteArray:r,transformToString:async o=>{const a=await r();if(o==="base64")return Wa(a);if(o==="hex")return tt(a);if(o===void 0||o==="utf8"||o==="utf-8")return oi(a);if(typeof TextDecoder=="function")return new TextDecoder(o).decode(a);throw new Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(e)throw new Error(Ml);if(e=!0,Dl(t))return s(t);if(Fl(t))return t;throw new Error(`Cannot transform payload to web stream, got ${t}`)}})},Dl=t=>typeof Blob=="function"&&t instanceof Blob,Fl=t=>typeof ReadableStream=="function"&&t instanceof ReadableStream,Xa=async(t=new Uint8Array,e)=>{if(t instanceof Uint8Array)return wr.mutate(t);if(!t)return wr.mutate(new Uint8Array);const r=e.streamCollector(t);return wr.mutate(await r)};class es{constructor(){this.middlewareStack=jn()}static classBuilder(){return new O0}resolveMiddlewareWithContext(e,r,s,{middlewareFn:n,clientName:i,commandName:o,inputFilterSensitiveLog:a,outputFilterSensitiveLog:c,smithyContext:l,additionalContext:u,CommandCtor:d}){for(const w of n.bind(this)(d,e,r,s))this.middlewareStack.use(w);const h=e.concat(this.middlewareStack),{logger:m}=r,g={logger:m,clientName:i,commandName:o,inputFilterSensitiveLog:a,outputFilterSensitiveLog:c,[ma]:{...l},...u},{requestHandler:p}=r;return h.resolve(w=>p.handle(w.request,s||{}),g)}}class O0{constructor(){this._init=()=>{},this._ep={},this._middlewareFn=()=>[],this._commandName="",this._clientName="",this._additionalContext={},this._smithyContext={},this._inputFilterSensitiveLog=e=>e,this._outputFilterSensitiveLog=e=>e,this._serializer=null,this._deserializer=null}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,r,s={}){return this._smithyContext={service:e,operation:r,...s},this}c(e={}){return this._additionalContext=e,this}n(e,r){return this._clientName=e,this._commandName=r,this}f(e=s=>s,r=s=>s){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=r,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}build(){const e=this;let r;return r=class extends es{static getEndpointParameterInstructions(){return e._ep}constructor(s){super(),this.input=s,this.serialize=e._serializer,this.deserialize=e._deserializer,e._init(this)}resolveMiddleware(s,n,i){return this.resolveMiddlewareWithContext(s,n,i,{CommandCtor:r,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog,outputFilterSensitiveLog:e._outputFilterSensitiveLog,smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}const mt="***SensitiveInformation***",vr=t=>{switch(t){case"true":return!0;case"false":return!1;default:throw new Error(`Unable to parse boolean value "${t}"`)}},P0=t=>{if(t!=null){if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return String(e)!==String(t)&&Hh.warn(jh(`Expected number but observed string: ${t}`)),e}if(typeof t=="number")return t;throw new TypeError(`Expected number, got ${typeof t}: ${t}`)}},I0=Math.ceil(2**127*(2-2**-23)),$l=t=>{const e=P0(t);if(e!==void 0&&!Number.isNaN(e)&&e!==1/0&&e!==-1/0&&Math.abs(e)>I0)throw new TypeError(`Expected 32-bit float, got ${t}`);return e},wa=t=>{if(t!=null){if(Number.isInteger(t)&&!Number.isNaN(t))return t;throw new TypeError(`Expected integer, got ${typeof t}: ${t}`)}},Ll=t=>Ya(t,32),Ul=t=>Ya(t,16),jl=t=>Ya(t,8),Ya=(t,e)=>{const r=wa(t);if(r!==void 0&&B0(r,e)!==r)throw new TypeError(`Expected ${e}-bit integer, got ${t}`);return r},B0=(t,e)=>{switch(e){case 32:return Int32Array.of(t)[0];case 16:return Int16Array.of(t)[0];case 8:return Int8Array.of(t)[0]}},yt=(t,e)=>{if(t==null)throw e?new TypeError(`Expected a non-null value for ${e}`):new TypeError("Expected a non-null value");return t},Uh=t=>{if(t==null)return;if(typeof t=="object"&&!Array.isArray(t))return t;const e=Array.isArray(t)?"array":typeof t;throw new TypeError(`Expected object, got ${e}: ${t}`)},xe=t=>{if(t!=null){if(typeof t=="string")return t;if(["boolean","number","bigint"].includes(typeof t))return Hh.warn(jh(`Expected string, got ${typeof t}: ${t}`)),String(t);throw new TypeError(`Expected string, got ${typeof t}: ${t}`)}},N0=t=>$l(typeof t=="string"?Zs(t):t),M0=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,Zs=t=>{const e=t.match(M0);if(e===null||e[0].length!==t.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(t)},Za=t=>wa(typeof t=="string"?Zs(t):t),br=t=>Ll(typeof t=="string"?Zs(t):t),Hn=t=>Ul(typeof t=="string"?Zs(t):t),D0=t=>jl(typeof t=="string"?Zs(t):t),jh=t=>String(new TypeError(t).stack||t).split(`
`).slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join(`
`),Hh={warn:console.warn},F0=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Qa=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function zr(t){const e=t.getUTCFullYear(),r=t.getUTCMonth(),s=t.getUTCDay(),n=t.getUTCDate(),i=t.getUTCHours(),o=t.getUTCMinutes(),a=t.getUTCSeconds(),c=n<10?`0${n}`:`${n}`,l=i<10?`0${i}`:`${i}`,u=o<10?`0${o}`:`${o}`,d=a<10?`0${a}`:`${a}`;return`${F0[s]}, ${c} ${Qa[r]} ${e} ${l}:${u}:${d} GMT`}const $0=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),Qs=t=>{if(t==null)return;if(typeof t!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const e=$0.exec(t);if(!e)throw new TypeError("Invalid RFC-3339 date-time value");const[r,s,n,i,o,a,c,l,u]=e,d=Hn(zs(s)),h=Gt(n,"month",1,12),m=Gt(i,"day",1,31),g=On(d,h,m,{hours:o,minutes:a,seconds:c,fractionalMilliseconds:l});return u.toUpperCase()!="Z"&&g.setTime(g.getTime()-J0(u)),g},L0=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d{2}) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),U0=new RegExp(/^(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d{2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),j0=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( [1-9]|\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? (\d{4})$/),qs=t=>{if(t==null)return;if(typeof t!="string")throw new TypeError("RFC-7231 date-times must be expressed as strings");let e=L0.exec(t);if(e){const[r,s,n,i,o,a,c,l]=e;return On(Hn(zs(i)),to(n),Gt(s,"day",1,31),{hours:o,minutes:a,seconds:c,fractionalMilliseconds:l})}if(e=U0.exec(t),e){const[r,s,n,i,o,a,c,l]=e;return z0(On(H0(i),to(n),Gt(s,"day",1,31),{hours:o,minutes:a,seconds:c,fractionalMilliseconds:l}))}if(e=j0.exec(t),e){const[r,s,n,i,o,a,c,l]=e;return On(Hn(zs(l)),to(s),Gt(n.trimLeft(),"day",1,31),{hours:i,minutes:o,seconds:a,fractionalMilliseconds:c})}throw new TypeError("Invalid RFC-7231 date-time value")},On=(t,e,r,s)=>{const n=e-1;return V0(t,n,r),new Date(Date.UTC(t,n,r,Gt(s.hours,"hour",0,23),Gt(s.minutes,"minute",0,59),Gt(s.seconds,"seconds",0,60),W0(s.fractionalMilliseconds)))},H0=t=>{const e=new Date().getUTCFullYear(),r=Math.floor(e/100)*100+Hn(zs(t));return r<e?r+100:r},q0=50*365*24*60*60*1e3,z0=t=>t.getTime()-new Date().getTime()>q0?new Date(Date.UTC(t.getUTCFullYear()-100,t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())):t,to=t=>{const e=Qa.indexOf(t);if(e<0)throw new TypeError(`Invalid month: ${t}`);return e+1},K0=[31,28,31,30,31,30,31,31,30,31,30,31],V0=(t,e,r)=>{let s=K0[e];if(e===1&&G0(t)&&(s=29),r>s)throw new TypeError(`Invalid day for ${Qa[e]} in ${t}: ${r}`)},G0=t=>t%4===0&&(t%100!==0||t%400===0),Gt=(t,e,r,s)=>{const n=D0(zs(t));if(n<r||n>s)throw new TypeError(`${e} must be between ${r} and ${s}, inclusive`);return n},W0=t=>t==null?0:N0("0."+t)*1e3,J0=t=>{const e=t[0];let r=1;if(e=="+")r=1;else if(e=="-")r=-1;else throw new TypeError(`Offset direction, ${e}, must be "+" or "-"`);const s=Number(t.substring(1,3)),n=Number(t.substring(4,6));return r*(s*60+n)*60*1e3},zs=t=>{let e=0;for(;e<t.length-1&&t.charAt(e)==="0";)e++;return e===0?t:t.slice(e)};class ec extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,ec.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}}const At=(t,e={})=>{Object.entries(e).filter(([,s])=>s!==void 0).forEach(([s,n])=>{(t[s]==null||t[s]==="")&&(t[s]=n)});const r=t.message||t.Message||"UnknownError";return t.message=r,delete t.Message,t},X0=({output:t,parsedBody:e,exceptionCtor:r,errorCode:s})=>{const n=Z0(t),i=n.httpStatusCode?n.httpStatusCode+"":void 0,o=new r({name:(e==null?void 0:e.code)||(e==null?void 0:e.Code)||s||i||"UnknownError",$fault:"client",$metadata:n});throw At(o,e)},Y0=t=>({output:e,parsedBody:r,errorCode:s})=>{X0({output:e,parsedBody:r,exceptionCtor:t,errorCode:s})},Z0=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),Q0=t=>{switch(t){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},ey=t=>{const e=[];for(const r in Un){const s=Un[r];t[s]!==void 0&&e.push({algorithmId:()=>s,checksumConstructor:()=>t[s]})}return{_checksumAlgorithms:e,addChecksumAlgorithm(r){this._checksumAlgorithms.push(r)},checksumAlgorithms(){return this._checksumAlgorithms}}},ty=t=>{const e={};return t.checksumAlgorithms().forEach(r=>{e[r.algorithmId()]=r.checksumConstructor()}),e},ry=t=>{let e=t.retryStrategy;return{setRetryStrategy(r){e=r},retryStrategy(){return e}}},sy=t=>{const e={};return e.retryStrategy=t.retryStrategy(),e},ny=t=>({...ey(t),...ry(t)}),iy=t=>({...ty(t),...sy(t)});function Hl(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}const ba=t=>Array.isArray(t)?t:[t],qh=t=>{const e="#text";for(const r in t)t.hasOwnProperty(r)&&t[r][e]!==void 0?t[r]=t[r][e]:typeof t[r]=="object"&&t[r]!==null&&(t[r]=qh(t[r]));return t},_a=function(){const t=Object.getPrototypeOf(this).constructor,e=Function.bind.apply(String,[null,...arguments]),r=new e;return Object.setPrototypeOf(r,t.prototype),r};_a.prototype=Object.create(String.prototype,{constructor:{value:_a,enumerable:!1,writable:!0,configurable:!0}});Object.setPrototypeOf(_a,String);function ue(t,e,r){let s,n,i;if(typeof e>"u"&&typeof r>"u")s={},i=t;else{if(s=t,typeof e=="function")return n=e,i=r,oy(s,n,i);i=e}for(const o of Object.keys(i)){if(!Array.isArray(i[o])){s[o]=i[o];continue}ay(s,null,i,o)}return s}const oy=(t,e,r)=>ue(t,Object.entries(r).reduce((s,[n,i])=>(Array.isArray(i)?s[n]=i:typeof i=="function"?s[n]=[e,i()]:s[n]=[e,i],s),{})),ay=(t,e,r,s)=>{if(e!==null){let o=r[s];typeof o=="function"&&(o=[,o]);const[a=cy,c=ly,l=s]=o;(typeof a=="function"&&a(e[l])||typeof a!="function"&&a)&&(t[s]=c(e[l]));return}let[n,i]=r[s];if(typeof i=="function"){let o;const a=n===void 0&&(o=i())!=null,c=typeof n=="function"&&!!n(void 0)||typeof n!="function"&&!!n;a?t[s]=o:c&&(t[s]=i())}else{const o=n===void 0&&i!=null,a=typeof n=="function"&&!!n(i)||typeof n!="function"&&!!n;(o||a)&&(t[s]=i)}},cy=t=>t!=null,ly=t=>t,uy=(t,e,r,s,n,i)=>{if(e!=null&&e[r]!==void 0){const o=s();if(o.length<=0)throw new Error("Empty value provided for input HTTP label: "+r+".");t=t.replace(n,i?o.split("/").map(a=>Hl(a)).join("/"):Hl(o))}else throw new Error("No value provided for input HTTP label: "+r+".");return t},dy="content-length";function hy(){return(t,e)=>async r=>{var n;const{request:s}=r;if(We.isInstance(s)&&!(dy in s.headers)){const i="Are you using a Stream of unknown length as the Body of a PutObject request? Consider using Upload instead from @aws-sdk/lib-storage.";typeof((n=e==null?void 0:e.logger)==null?void 0:n.warn)=="function"&&!(e.logger instanceof Va)?e.logger.warn(i):console.warn(i)}return t({...r})}}const fy={step:"finalizeRequest",tags:["CHECK_CONTENT_LENGTH_HEADER"],name:"getCheckContentLengthHeaderPlugin",override:!0},py=t=>({applyToStack:e=>{e.add(hy(),fy)}}),gy=t=>(e,r)=>async s=>{const n=await t.region(),i=t.region;r.__s3RegionRedirect&&(t.region=async()=>(t.region=i,r.__s3RegionRedirect));const o=await e(s);if(r.__s3RegionRedirect){const a=await t.region();if(n!==a)throw new Error("Region was not restored following S3 region redirect.")}return o},my={tags:["REGION_REDIRECT","S3"],name:"regionRedirectEndpointMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"};function yy(t){return(e,r)=>async s=>{var n,i;try{return await e(s)}catch(o){if(t.followRegionRedirects&&((n=o==null?void 0:o.$metadata)==null?void 0:n.httpStatusCode)===301){try{const a=o.$response.headers["x-amz-bucket-region"];(i=r.logger)==null||i.debug(`Redirecting from ${await t.region()} to ${a}`),r.__s3RegionRedirect=a}catch(a){throw new Error("Region redirect failed: "+a)}return e(s)}else throw o}}}const wy={step:"initialize",tags:["REGION_REDIRECT","S3"],name:"regionRedirectMiddleware",override:!0},by=t=>({applyToStack:e=>{e.add(yy(t),wy),e.addRelativeTo(gy(t),my)}}),_y=t=>(e,r)=>async s=>{var o;const n=await e(s),{response:i}=n;if(Hs.isInstance(i)&&i.headers.expires){i.headers.expiresstring=i.headers.expires;try{qs(i.headers.expires)}catch(a){(o=r.logger)==null||o.warn(`AWS SDK Warning for ${r.clientName}::${r.commandName} response parsing (${i.headers.expires}): ${a}`),delete i.headers.expires}}return n},vy={tags:["S3"],name:"s3ExpiresMiddleware",override:!0,relation:"after",toMiddleware:"deserializerMiddleware"},zh=t=>({applyToStack:e=>{e.addRelativeTo(_y(),vy)}});class ai{constructor(e={}){this.data=e,this.lastPurgeTime=Date.now()}get(e){const r=this.data[e];if(r)return r}set(e,r){return this.data[e]=r,r}delete(e){delete this.data[e]}async purgeExpired(){const e=Date.now();if(!(this.lastPurgeTime+ai.EXPIRED_CREDENTIAL_PURGE_INTERVAL_MS>e))for(const r in this.data){const s=this.data[r];if(!s.isRefreshing){const n=await s.identity;n.expiration&&n.expiration.getTime()<e&&delete this.data[r]}}}}ai.EXPIRED_CREDENTIAL_PURGE_INTERVAL_MS=3e4;class ro{constructor(e,r=!1,s=Date.now()){this._identity=e,this.isRefreshing=r,this.accessed=s}get identity(){return this.accessed=Date.now(),this._identity}}class ci{constructor(e,r=new ai){this.createSessionFn=e,this.cache=r}async getS3ExpressIdentity(e,r){const s=r.Bucket,{cache:n}=this,i=n.get(s);return i?i.identity.then(o=>{var l,u;return(((l=o.expiration)==null?void 0:l.getTime())??0)<Date.now()?n.set(s,new ro(this.getIdentity(s))).identity:((((u=o.expiration)==null?void 0:u.getTime())??0)<Date.now()+ci.REFRESH_WINDOW_MS&&!i.isRefreshing&&(i.isRefreshing=!0,this.getIdentity(s).then(d=>{n.set(s,new ro(Promise.resolve(d)))})),o)}):n.set(s,new ro(this.getIdentity(s))).identity}async getIdentity(e){var n,i;await this.cache.purgeExpired().catch(o=>{console.warn(`Error while clearing expired entries in S3ExpressIdentityCache: 
`+o)});const r=await this.createSessionFn(e);if(!((n=r.Credentials)!=null&&n.AccessKeyId)||!((i=r.Credentials)!=null&&i.SecretAccessKey))throw new Error("s3#createSession response credential missing AccessKeyId or SecretAccessKey.");return{accessKeyId:r.Credentials.AccessKeyId,secretAccessKey:r.Credentials.SecretAccessKey,sessionToken:r.Credentials.SessionToken,expiration:r.Credentials.Expiration?new Date(r.Credentials.Expiration):void 0}}}ci.REFRESH_WINDOW_MS=6e4;var so={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var va=function(t,e){return va=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var n in s)s.hasOwnProperty(n)&&(r[n]=s[n])},va(t,e)};function Ey(t,e){va(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Ea=function(){return Ea=Object.assign||function(e){for(var r,s=1,n=arguments.length;s<n;s++){r=arguments[s];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Ea.apply(this,arguments)};function Sy(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r}function xy(t,e,r,s){var n=arguments.length,i=n<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,r):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,s);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(n<3?o(i):n>3?o(e,r,i):o(e,r))||i);return n>3&&i&&Object.defineProperty(e,r,i),i}function Ay(t,e){return function(r,s){e(r,s,t)}}function Cy(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function ky(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(s.next(u))}catch(d){o(d)}}function c(u){try{l(s.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):n(u.value).then(a,c)}l((s=s.apply(t,e||[])).next())})}function Ry(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,n,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(s)throw new TypeError("Generator is already executing.");for(;r;)try{if(s=1,n&&(i=l[0]&2?n.return:l[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,l[1])).done)return i;switch(n=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(u){l=[6,u],n=0}finally{s=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Ty(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]}function Oy(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Sa(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],s=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Kh(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var s=r.call(t),n,i=[],o;try{for(;(e===void 0||e-- >0)&&!(n=s.next()).done;)i.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(o)throw o.error}}return i}function Py(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Kh(arguments[e]));return t}function Iy(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var s=Array(t),n=0,e=0;e<r;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,n++)s[n]=i[o];return s}function Ks(t){return this instanceof Ks?(this.v=t,this):new Ks(t)}function By(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(t,e||[]),n,i=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(h){s[h]&&(n[h]=function(m){return new Promise(function(g,p){i.push([h,m,g,p])>1||a(h,m)})})}function a(h,m){try{c(s[h](m))}catch(g){d(i[0][3],g)}}function c(h){h.value instanceof Ks?Promise.resolve(h.value.v).then(l,u):d(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,m){h(m),i.shift(),i.length&&a(i[0][0],i[0][1])}}function Ny(t){var e,r;return e={},s("next"),s("throw",function(n){throw n}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(n,i){e[n]=t[n]?function(o){return(r=!r)?{value:Ks(t[n](o)),done:n==="return"}:i?i(o):o}:i}}function My(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Sa=="function"?Sa(t):t[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),n(a,c,o.done,o.value)})}}function n(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function Dy(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Fy(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function $y(t){return t&&t.__esModule?t:{default:t}}function Ly(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Uy(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const jy=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Ea},__asyncDelegator:Ny,__asyncGenerator:By,__asyncValues:My,__await:Ks,__awaiter:ky,__classPrivateFieldGet:Ly,__classPrivateFieldSet:Uy,__createBinding:Ty,__decorate:xy,__exportStar:Oy,__extends:Ey,__generator:Ry,__importDefault:$y,__importStar:Fy,__makeTemplateObject:Dy,__metadata:Cy,__param:Ay,__read:Kh,__rest:Sy,__spread:Py,__spreadArrays:Iy,__values:Sa},Symbol.toStringTag,{value:"Module"})),bt=La(jy);var no={},ds={};const Hy=t=>{const e=[];for(let r=0,s=t.length;r<s;r++){const n=t.charCodeAt(r);if(n<128)e.push(n);else if(n<2048)e.push(n>>6|192,n&63|128);else if(r+1<t.length&&(n&64512)===55296&&(t.charCodeAt(r+1)&64512)===56320){const i=65536+((n&1023)<<10)+(t.charCodeAt(++r)&1023);e.push(i>>18|240,i>>12&63|128,i>>6&63|128,i&63|128)}else e.push(n>>12|224,n>>6&63|128,n&63|128)}return Uint8Array.from(e)},qy=t=>{let e="";for(let r=0,s=t.length;r<s;r++){const n=t[r];if(n<128)e+=String.fromCharCode(n);else if(192<=n&&n<224){const i=t[++r];e+=String.fromCharCode((n&31)<<6|i&63)}else if(240<=n&&n<365){const o="%"+[n,t[++r],t[++r],t[++r]].map(a=>a.toString(16)).join("%");e+=decodeURIComponent(o)}else e+=String.fromCharCode((n&15)<<12|(t[++r]&63)<<6|t[++r]&63)}return e};function zy(t){return new TextEncoder().encode(t)}function Ky(t){return new TextDecoder("utf-8").decode(t)}const Vy=t=>typeof TextEncoder=="function"?zy(t):Hy(t),Gy=t=>typeof TextDecoder=="function"?Ky(t):qy(t),Wy=Object.freeze(Object.defineProperty({__proto__:null,fromUtf8:Vy,toUtf8:Gy},Symbol.toStringTag,{value:"Module"})),li=La(Wy);var ql;function Jy(){if(ql)return ds;ql=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.convertToBuffer=void 0;var t=li,e=typeof Buffer<"u"&&Buffer.from?function(s){return Buffer.from(s,"utf8")}:t.fromUtf8;function r(s){return s instanceof Uint8Array?s:typeof s=="string"?e(s):ArrayBuffer.isView(s)?new Uint8Array(s.buffer,s.byteOffset,s.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(s)}return ds.convertToBuffer=r,ds}var hs={},zl;function Xy(){if(zl)return hs;zl=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.isEmptyData=void 0;function t(e){return typeof e=="string"?e.length===0:e.byteLength===0}return hs.isEmptyData=t,hs}var fs={},Kl;function Yy(){if(Kl)return fs;Kl=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.numToUint8=void 0;function t(e){return new Uint8Array([(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255])}return fs.numToUint8=t,fs}var ps={},Vl;function Zy(){if(Vl)return ps;Vl=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.uint32ArrayFrom=void 0;function t(e){if(!Uint32Array.from){for(var r=new Uint32Array(e.length),s=0;s<e.length;)r[s]=e[s],s+=1;return r}return Uint32Array.from(e)}return ps.uint32ArrayFrom=t,ps}var Gl;function Xt(){return Gl||(Gl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=t.numToUint8=t.isEmptyData=t.convertToBuffer=void 0;var e=Jy();Object.defineProperty(t,"convertToBuffer",{enumerable:!0,get:function(){return e.convertToBuffer}});var r=Xy();Object.defineProperty(t,"isEmptyData",{enumerable:!0,get:function(){return r.isEmptyData}});var s=Yy();Object.defineProperty(t,"numToUint8",{enumerable:!0,get:function(){return s.numToUint8}});var n=Zy();Object.defineProperty(t,"uint32ArrayFrom",{enumerable:!0,get:function(){return n.uint32ArrayFrom}})}(no)),no}var gs={},Wl;function Qy(){if(Wl)return gs;Wl=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.AwsCrc32=void 0;var t=bt,e=Xt(),r=Vh(),s=function(){function n(){this.crc32=new r.Crc32}return n.prototype.update=function(i){(0,e.isEmptyData)(i)||this.crc32.update((0,e.convertToBuffer)(i))},n.prototype.digest=function(){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(i){return[2,(0,e.numToUint8)(this.crc32.digest())]})})},n.prototype.reset=function(){this.crc32=new r.Crc32},n}();return gs.AwsCrc32=s,gs}var Jl;function Vh(){return Jl||(Jl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.AwsCrc32=t.Crc32=t.crc32=void 0;var e=bt,r=Xt();function s(c){return new n().update(c).digest()}t.crc32=s;var n=function(){function c(){this.checksum=4294967295}return c.prototype.update=function(l){var u,d;try{for(var h=e.__values(l),m=h.next();!m.done;m=h.next()){var g=m.value;this.checksum=this.checksum>>>8^o[(this.checksum^g)&255]}}catch(p){u={error:p}}finally{try{m&&!m.done&&(d=h.return)&&d.call(h)}finally{if(u)throw u.error}}return this},c.prototype.digest=function(){return(this.checksum^4294967295)>>>0},c}();t.Crc32=n;var i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=(0,r.uint32ArrayFrom)(i),a=Qy();Object.defineProperty(t,"AwsCrc32",{enumerable:!0,get:function(){return a.AwsCrc32}})}(so)),so}var tc=Vh();class $s{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const r=new Uint8Array(8);for(let s=7,n=Math.abs(Math.round(e));s>-1&&n>0;s--,n/=256)r[s]=n;return e<0&&Xl(r),new $s(r)}valueOf(){const e=this.bytes.slice(0),r=e[0]&128;return r&&Xl(e),parseInt(tt(e),16)*(r?-1:1)}toString(){return String(this.valueOf())}}function Xl(t){for(let e=0;e<8;e++)t[e]^=255;for(let e=7;e>-1&&(t[e]++,t[e]===0);e--);}class Gh{constructor(e,r){this.toUtf8=e,this.fromUtf8=r}format(e){const r=[];for(const i of Object.keys(e)){const o=this.fromUtf8(i);r.push(Uint8Array.from([o.byteLength]),o,this.formatHeaderValue(e[i]))}const s=new Uint8Array(r.reduce((i,o)=>i+o.byteLength,0));let n=0;for(const i of r)s.set(i,n),n+=i.byteLength;return s}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const r=new DataView(new ArrayBuffer(3));return r.setUint8(0,3),r.setInt16(1,e.value,!1),new Uint8Array(r.buffer);case"integer":const s=new DataView(new ArrayBuffer(5));return s.setUint8(0,4),s.setInt32(1,e.value,!1),new Uint8Array(s.buffer);case"long":const n=new Uint8Array(9);return n[0]=5,n.set(e.value.bytes,1),n;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const o=new Uint8Array(i.buffer);return o.set(e.value,3),o;case"string":const a=this.fromUtf8(e.value),c=new DataView(new ArrayBuffer(3+a.byteLength));c.setUint8(0,7),c.setUint16(1,a.byteLength,!1);const l=new Uint8Array(c.buffer);return l.set(a,3),l;case"timestamp":const u=new Uint8Array(9);return u[0]=8,u.set($s.fromNumber(e.value.valueOf()).bytes,1),u;case"uuid":if(!cw.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const d=new Uint8Array(17);return d[0]=9,d.set(R0(e.value.replace(/\-/g,"")),1),d}}parse(e){const r={};let s=0;for(;s<e.byteLength;){const n=e.getUint8(s++),i=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+s,n));switch(s+=n,e.getUint8(s++)){case 0:r[i]={type:Zl,value:!0};break;case 1:r[i]={type:Zl,value:!1};break;case 2:r[i]={type:ew,value:e.getInt8(s++)};break;case 3:r[i]={type:tw,value:e.getInt16(s,!1)},s+=2;break;case 4:r[i]={type:rw,value:e.getInt32(s,!1)},s+=4;break;case 5:r[i]={type:sw,value:new $s(new Uint8Array(e.buffer,e.byteOffset+s,8))},s+=8;break;case 6:const o=e.getUint16(s,!1);s+=2,r[i]={type:nw,value:new Uint8Array(e.buffer,e.byteOffset+s,o)},s+=o;break;case 7:const a=e.getUint16(s,!1);s+=2,r[i]={type:iw,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+s,a))},s+=a;break;case 8:r[i]={type:ow,value:new Date(new $s(new Uint8Array(e.buffer,e.byteOffset+s,8)).valueOf())},s+=8;break;case 9:const c=new Uint8Array(e.buffer,e.byteOffset+s,16);s+=16,r[i]={type:aw,value:`${tt(c.subarray(0,4))}-${tt(c.subarray(4,6))}-${tt(c.subarray(6,8))}-${tt(c.subarray(8,10))}-${tt(c.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return r}}var Yl;(function(t){t[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid"})(Yl||(Yl={}));const Zl="boolean",ew="byte",tw="short",rw="integer",sw="long",nw="binary",iw="string",ow="timestamp",aw="uuid",cw=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,Wh=4,Lt=Wh*2,pr=4,lw=Lt+pr*2;function uw({byteLength:t,byteOffset:e,buffer:r}){if(t<lw)throw new Error("Provided message too short to accommodate event stream message overhead");const s=new DataView(r,e,t),n=s.getUint32(0,!1);if(t!==n)throw new Error("Reported message length does not match received message length");const i=s.getUint32(Wh,!1),o=s.getUint32(Lt,!1),a=s.getUint32(t-pr,!1),c=new tc.Crc32().update(new Uint8Array(r,e,Lt));if(o!==c.digest())throw new Error(`The prelude checksum specified in the message (${o}) does not match the calculated CRC32 checksum (${c.digest()})`);if(c.update(new Uint8Array(r,e+Lt,t-(Lt+pr))),a!==c.digest())throw new Error(`The message checksum (${c.digest()}) did not match the expected value of ${a}`);return{headers:new DataView(r,e+Lt+pr,i),body:new Uint8Array(r,e+Lt+pr+i,n-i-(Lt+pr+pr))}}class dw{constructor(e,r){this.headerMarshaller=new Gh(e,r),this.messageBuffer=[],this.isEndOfStream=!1}feed(e){this.messageBuffer.push(this.decode(e))}endOfStream(){this.isEndOfStream=!0}getMessage(){const e=this.messageBuffer.pop(),r=this.isEndOfStream;return{getMessage(){return e},isEndOfStream(){return r}}}getAvailableMessages(){const e=this.messageBuffer;this.messageBuffer=[];const r=this.isEndOfStream;return{getMessages(){return e},isEndOfStream(){return r}}}encode({headers:e,body:r}){const s=this.headerMarshaller.format(e),n=s.byteLength+r.byteLength+16,i=new Uint8Array(n),o=new DataView(i.buffer,i.byteOffset,i.byteLength),a=new tc.Crc32;return o.setUint32(0,n,!1),o.setUint32(4,s.byteLength,!1),o.setUint32(8,a.update(i.subarray(0,8)).digest(),!1),i.set(s,12),i.set(r,s.byteLength+12),o.setUint32(n-4,a.update(i.subarray(8,n-4)).digest(),!1),i}decode(e){const{headers:r,body:s}=uw(e);return{headers:this.headerMarshaller.parse(r),body:s}}formatHeaders(e){return this.headerMarshaller.format(e)}}class hw{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.decoder.decode(e)}}class fw{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream)yield this.options.encoder.encode(e);this.options.includeEndFrame&&(yield new Uint8Array(0))}}class pw{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream){const r=await this.options.deserializer(e);r!==void 0&&(yield r)}}}class gw{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.serializer(e)}}const mw=t=>t[ma]||(t[ma]={}),wt=t=>{if(typeof t=="function")return t;const e=Promise.resolve(t);return()=>e},yw="X-Amz-Algorithm",ww="X-Amz-Credential",Jh="X-Amz-Date",bw="X-Amz-SignedHeaders",_w="X-Amz-Expires",Xh="X-Amz-Signature",Yh="X-Amz-Security-Token",Zh="authorization",Qh=Jh.toLowerCase(),vw="date",Ew=[Zh,Qh,vw],Sw=Xh.toLowerCase(),xa="x-amz-content-sha256",xw=Yh.toLowerCase(),Aw={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},Cw=/^proxy-/,kw=/^sec-/,io="AWS4-HMAC-SHA256",Rw="AWS4-HMAC-SHA256-PAYLOAD",Tw="UNSIGNED-PAYLOAD",Ow=50,ef="aws4_request",Pw=60*60*24*7,vn={},oo=[],ao=(t,e,r)=>`${t}/${e}/${r}/${ef}`,Iw=async(t,e,r,s,n)=>{const i=await Ql(t,e.secretAccessKey,e.accessKeyId),o=`${r}:${s}:${n}:${tt(i)}:${e.sessionToken}`;if(o in vn)return vn[o];for(oo.push(o);oo.length>Ow;)delete vn[oo.shift()];let a=`AWS4${e.secretAccessKey}`;for(const c of[r,s,n,ef])a=await Ql(t,a,c);return vn[o]=a},Ql=(t,e,r)=>{const s=new t(e);return s.update(qr(r)),s.digest()},eu=({headers:t},e,r)=>{const s={};for(const n of Object.keys(t).sort()){if(t[n]==null)continue;const i=n.toLowerCase();(i in Aw||e!=null&&e.has(i)||Cw.test(i)||kw.test(i))&&(!r||r&&!r.has(i))||(s[i]=t[n].trim().replace(/\s+/g," "))}return s},Bw=({query:t={}})=>{const e=[],r={};for(const s of Object.keys(t).sort()){if(s.toLowerCase()===Sw)continue;e.push(s);const n=t[s];typeof n=="string"?r[s]=`${mr(s)}=${mr(n)}`:Array.isArray(n)&&(r[s]=n.slice(0).reduce((i,o)=>i.concat([`${mr(s)}=${mr(o)}`]),[]).sort().join("&"))}return e.map(s=>r[s]).filter(s=>s).join("&")},tf=t=>typeof ArrayBuffer=="function"&&t instanceof ArrayBuffer||Object.prototype.toString.call(t)==="[object ArrayBuffer]",co=async({headers:t,body:e},r)=>{for(const s of Object.keys(t))if(s.toLowerCase()===xa)return t[s];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||tf(e)){const s=new r;return s.update(qr(e)),tt(await s.digest())}return Tw},Nw=(t,e)=>{t=t.toLowerCase();for(const r of Object.keys(e))if(t===r.toLowerCase())return!0;return!1},rf=({headers:t,query:e,...r})=>({...r,headers:{...t},query:e?Mw(e):void 0}),Mw=t=>Object.keys(t).reduce((e,r)=>{const s=t[r];return{...e,[r]:Array.isArray(s)?[...s]:s}},{}),Dw=(t,e={})=>{var n;const{headers:r,query:s={}}=typeof t.clone=="function"?t.clone():rf(t);for(const i of Object.keys(r)){const o=i.toLowerCase();o.slice(0,6)==="x-amz-"&&!((n=e.unhoistableHeaders)!=null&&n.has(o))&&(s[i]=r[i],delete r[i])}return{...t,headers:r,query:s}},tu=t=>{t=typeof t.clone=="function"?t.clone():rf(t);for(const e of Object.keys(t.headers))Ew.indexOf(e.toLowerCase())>-1&&delete t.headers[e];return t},Fw=t=>$w(t).toISOString().replace(/\.\d{3}Z$/,"Z"),$w=t=>typeof t=="number"?new Date(t*1e3):typeof t=="string"?Number(t)?new Date(Number(t)*1e3):new Date(t):t;class Aa{constructor({applyChecksum:e,credentials:r,region:s,service:n,sha256:i,uriEscapePath:o=!0}){this.headerMarshaller=new Gh(oi,Qr),this.service=n,this.sha256=i,this.uriEscapePath=o,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=wt(s),this.credentialProvider=wt(r)}async presign(e,r={}){const{signingDate:s=new Date,expiresIn:n=3600,unsignableHeaders:i,unhoistableHeaders:o,signableHeaders:a,signingRegion:c,signingService:l}=r,u=await this.credentialProvider();this.validateResolvedCredentials(u);const d=c??await this.regionProvider(),{longDate:h,shortDate:m}=En(s);if(n>Pw)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const g=ao(m,d,l??this.service),p=Dw(tu(e),{unhoistableHeaders:o});u.sessionToken&&(p.query[Yh]=u.sessionToken),p.query[yw]=io,p.query[ww]=`${u.accessKeyId}/${g}`,p.query[Jh]=h,p.query[_w]=n.toString(10);const w=eu(p,i,a);return p.query[bw]=ru(w),p.query[Xh]=await this.getSignature(h,g,this.getSigningKey(u,d,m,l),this.createCanonicalRequest(p,w,await co(e,this.sha256))),p}async sign(e,r){return typeof e=="string"?this.signString(e,r):e.headers&&e.payload?this.signEvent(e,r):e.message?this.signMessage(e,r):this.signRequest(e,r)}async signEvent({headers:e,payload:r},{signingDate:s=new Date,priorSignature:n,signingRegion:i,signingService:o}){const a=i??await this.regionProvider(),{shortDate:c,longDate:l}=En(s),u=ao(c,a,o??this.service),d=await co({headers:{},body:r},this.sha256),h=new this.sha256;h.update(e);const m=tt(await h.digest()),g=[Rw,l,u,n,m,d].join(`
`);return this.signString(g,{signingDate:s,signingRegion:a,signingService:o})}async signMessage(e,{signingDate:r=new Date,signingRegion:s,signingService:n}){return this.signEvent({headers:this.headerMarshaller.format(e.message.headers),payload:e.message.body},{signingDate:r,signingRegion:s,signingService:n,priorSignature:e.priorSignature}).then(o=>({message:e.message,signature:o}))}async signString(e,{signingDate:r=new Date,signingRegion:s,signingService:n}={}){const i=await this.credentialProvider();this.validateResolvedCredentials(i);const o=s??await this.regionProvider(),{shortDate:a}=En(r),c=new this.sha256(await this.getSigningKey(i,o,a,n));return c.update(qr(e)),tt(await c.digest())}async signRequest(e,{signingDate:r=new Date,signableHeaders:s,unsignableHeaders:n,signingRegion:i,signingService:o}={}){const a=await this.credentialProvider();this.validateResolvedCredentials(a);const c=i??await this.regionProvider(),l=tu(e),{longDate:u,shortDate:d}=En(r),h=ao(d,c,o??this.service);l.headers[Qh]=u,a.sessionToken&&(l.headers[xw]=a.sessionToken);const m=await co(l,this.sha256);!Nw(xa,l.headers)&&this.applyChecksum&&(l.headers[xa]=m);const g=eu(l,n,s),p=await this.getSignature(u,h,this.getSigningKey(a,c,d,o),this.createCanonicalRequest(l,g,m));return l.headers[Zh]=`${io} Credential=${a.accessKeyId}/${h}, SignedHeaders=${ru(g)}, Signature=${p}`,l}createCanonicalRequest(e,r,s){const n=Object.keys(r).sort();return`${e.method}
${this.getCanonicalPath(e)}
${Bw(e)}
${n.map(i=>`${i}:${r[i]}`).join(`
`)}

${n.join(";")}
${s}`}async createStringToSign(e,r,s){const n=new this.sha256;n.update(qr(s));const i=await n.digest();return`${io}
${e}
${r}
${tt(i)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const r=[];for(const i of e.split("/"))(i==null?void 0:i.length)!==0&&i!=="."&&(i===".."?r.pop():r.push(i));const s=`${e!=null&&e.startsWith("/")?"/":""}${r.join("/")}${r.length>0&&(e!=null&&e.endsWith("/"))?"/":""}`;return encodeURIComponent(s).replace(/%2F/g,"/")}return e}async getSignature(e,r,s,n){const i=await this.createStringToSign(e,r,n),o=new this.sha256(await s);return o.update(qr(i)),tt(await o.digest())}getSigningKey(e,r,s,n){return Iw(this.sha256,e,s,r,n||this.service)}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}}const En=t=>{const e=Fw(t).replace(/[\-:]/g,"");return{longDate:e,shortDate:e.slice(0,8)}},ru=t=>Object.keys(t).sort().join(";");var su;(function(t){t.ENV="env",t.CONFIG="shared config entry"})(su||(su={}));const Lw="Directory",Uw="S3Express",jw="sigv4-s3express",Ca="X-Amz-S3session-Token",ka=Ca.toLowerCase();class Hw extends Aa{async signWithCredentials(e,r,s){const n=nu(r);e.headers[ka]=r.sessionToken;const i=this;return iu(i,n),i.signRequest(e,s??{})}async presignWithCredentials(e,r,s){const n=nu(r);return delete e.headers[ka],e.headers[Ca]=r.sessionToken,e.query=e.query??{},e.query[Ca]=r.sessionToken,iu(this,n),this.presign(e,s)}}function nu(t){return{accessKeyId:t.accessKeyId,secretAccessKey:t.secretAccessKey,expiration:t.expiration}}function iu(t,e){const r=setTimeout(()=>{throw new Error("SignatureV4S3Express credential override was created but not called.")},10),s=t.credentialProvider,n=()=>(clearTimeout(r),t.credentialProvider=s,Promise.resolve(e));t.credentialProvider=n}const qw=t=>(e,r)=>async s=>{var n,i,o,a,c;if(r.endpointV2){const l=r.endpointV2,u=((o=(i=(n=l.properties)==null?void 0:n.authSchemes)==null?void 0:i[0])==null?void 0:o.name)===jw;if((((a=l.properties)==null?void 0:a.backend)===Uw||((c=l.properties)==null?void 0:c.bucketType)===Lw)&&(r.isS3ExpressBucket=!0),u){const h=s.input.Bucket;if(h){const m=await t.s3ExpressIdentityProvider.getS3ExpressIdentity(await t.credentials(),{Bucket:h});r.s3ExpressIdentity=m,We.isInstance(s.request)&&m.sessionToken&&(s.request.headers[ka]=m.sessionToken)}}}return e(s)},zw={name:"s3ExpressMiddleware",step:"build",tags:["S3","S3_EXPRESS"],override:!0},Kw=t=>({applyToStack:e=>{e.add(qw(t),zw)}}),Vw=(t,{session:e})=>{const[r,s]=e;return{...t,forcePathStyle:t.forcePathStyle??!1,useAccelerateEndpoint:t.useAccelerateEndpoint??!1,disableMultiregionAccessPoints:t.disableMultiregionAccessPoints??!1,followRegionRedirects:t.followRegionRedirects??!1,s3ExpressIdentityProvider:t.s3ExpressIdentityProvider??new ci(async n=>r().send(new s({Bucket:n,SessionMode:"ReadWrite"}))),bucketEndpoint:t.bucketEndpoint??!1}},Gw=t=>typeof t=="string"&&t.indexOf("arn:")===0&&t.split(":").length>=6;function Ww(t){return(e,r)=>async s=>{var n,i,o,a;if(t.bucketEndpoint){const c=r.endpointV2;if(c){const l=s.input.Bucket;if(typeof l=="string")try{const u=new URL(l);c.url=u}catch(u){const d=`@aws-sdk/middleware-sdk-s3: bucketEndpoint=true was set but Bucket=${l} could not be parsed as URL.`;throw((i=(n=r.logger)==null?void 0:n.constructor)==null?void 0:i.name)==="NoOpLogger"?console.warn(d):(a=(o=r.logger)==null?void 0:o.warn)==null||a.call(o,d),u}}}return e(s)}}const Jw={name:"bucketEndpointMiddleware",override:!0,relation:"after",toMiddleware:"endpointV2Middleware"};function Xw({bucketEndpoint:t}){return e=>async r=>{const{input:{Bucket:s}}=r;if(!t&&typeof s=="string"&&!Gw(s)&&s.indexOf("/")>=0){const n=new Error(`Bucket name shouldn't contain '/', received '${s}'`);throw n.name="InvalidBucketName",n}return e({...r})}}const Yw={step:"initialize",tags:["VALIDATE_BUCKET_NAME"],name:"validateBucketNameMiddleware",override:!0},Zw=t=>({applyToStack:e=>{e.add(Xw(t),Yw),e.addRelativeTo(Ww(t),Jw)}}),sf=(t,e,r)=>{let s,n,i,o=!1;const a=async()=>{n||(n=t());try{s=await n,i=!0,o=!1}finally{n=void 0}return s};return e===void 0?async c=>((!i||c!=null&&c.forceRefresh)&&(s=await a()),s):async c=>((!i||c!=null&&c.forceRefresh)&&(s=await a()),o?s:r&&!r(s)?(o=!0,s):(e(s)&&await a(),s))},Qw=3e5,eb=t=>{const e=t.credentials?tb(t.credentials):t.credentialDefaultProvider(Object.assign({},t,{parentClientConfig:t})),{signingEscapePath:r=!0,systemClockOffset:s=t.systemClockOffset||0,sha256:n}=t;let i;return t.signer?i=wt(t.signer):t.regionInfoProvider?i=()=>wt(t.region)().then(async o=>[await t.regionInfoProvider(o,{useFipsEndpoint:await t.useFipsEndpoint(),useDualstackEndpoint:await t.useDualstackEndpoint()})||{},o]).then(([o,a])=>{const{signingRegion:c,signingService:l}=o;t.signingRegion=t.signingRegion||c||a,t.signingName=t.signingName||l||t.serviceId;const u={...t,credentials:e,region:t.signingRegion,service:t.signingName,sha256:n,uriEscapePath:r},d=t.signerConstructor||Aa;return new d(u)}):i=async o=>{o=Object.assign({},{name:"sigv4",signingName:t.signingName||t.defaultSigningName,signingRegion:await wt(t.region)(),properties:{}},o);const a=o.signingRegion,c=o.signingName;t.signingRegion=t.signingRegion||a,t.signingName=t.signingName||c||t.serviceId;const l={...t,credentials:e,region:t.signingRegion,service:t.signingName,sha256:n,uriEscapePath:r},u=t.signerConstructor||Aa;return new u(l)},{...t,systemClockOffset:s,signingEscapePath:r,credentials:e,signer:i}},tb=t=>typeof t=="function"?sf(t,e=>e.expiration!==void 0&&e.expiration.getTime()-Date.now()<Qw,e=>e.expiration!==void 0):wt(t),nf=t=>new Date(Date.now()+t),rb=(t,e)=>Math.abs(nf(e).getTime()-t)>=3e5,ou=(t,e)=>{const r=Date.parse(t);return rb(r,e)?r-Date.now():e},sb=t=>(e,r)=>async function(s){var d,h,m,g;if(!We.isInstance(s.request))return e(s);const n=(m=(h=(d=r.endpointV2)==null?void 0:d.properties)==null?void 0:h.authSchemes)==null?void 0:m[0],i=(n==null?void 0:n.name)==="sigv4a"?(g=n==null?void 0:n.signingRegionSet)==null?void 0:g.join(","):void 0,o=await t.signer(n);let a;const c={signingDate:nf(t.systemClockOffset),signingRegion:i||r.signing_region,signingService:r.signing_service};if(r.s3ExpressIdentity){if(a=await o.signWithCredentials(s.request,r.s3ExpressIdentity,c),a.headers["X-Amz-Security-Token"]||a.headers["x-amz-security-token"])throw new Error("X-Amz-Security-Token must not be set for s3-express requests.")}else a=await o.sign(s.request,c);const l=await e({...s,request:a}).catch(p=>{const w=p.ServerTime??au(p.$response);throw w&&(t.systemClockOffset=ou(w,t.systemClockOffset)),p}),u=au(l.response);return u&&(t.systemClockOffset=ou(u,t.systemClockOffset)),l},au=t=>{var e,r;return Hs.isInstance(t)?((e=t.headers)==null?void 0:e.date)??((r=t.headers)==null?void 0:r.Date):void 0},nb={name:"awsAuthMiddleware",tags:["SIGNATURE","AWSAUTH"],relation:"after",toMiddleware:"retryMiddleware",override:!0},ib=t=>({applyToStack:e=>{e.addRelativeTo(sb(t),nb)}});function ob(t){return{...t,customUserAgent:typeof t.customUserAgent=="string"?[[t.customUserAgent]]:t.customUserAgent}}const ab=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),of=t=>ab.test(t)||t.startsWith("[")&&t.endsWith("]"),cb=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),rc=(t,e=!1)=>{if(!e)return cb.test(t);const r=t.split(".");for(const s of r)if(!rc(s))return!1;return!0},Ra={},Vs="endpoints";function Jt(t){return typeof t!="object"||t==null?t:"ref"in t?`$${Jt(t.ref)}`:"fn"in t?`${t.fn}(${(t.argv||[]).map(Jt).join(", ")})`:JSON.stringify(t,null,2)}class st extends Error{constructor(e){super(e),this.name="EndpointError"}}const lb=(t,e)=>t===e,ub=t=>{const e=t.split("."),r=[];for(const s of e){const n=s.indexOf("[");if(n!==-1){if(s.indexOf("]")!==s.length-1)throw new st(`Path: '${t}' does not end with ']'`);const i=s.slice(n+1,-1);if(Number.isNaN(parseInt(i)))throw new st(`Invalid array index: '${i}' in path: '${t}'`);n!==0&&r.push(s.slice(0,n)),r.push(i)}else r.push(s)}return r},af=(t,e)=>ub(e).reduce((r,s)=>{if(typeof r!="object")throw new st(`Index '${s}' in '${e}' not found in '${JSON.stringify(t)}'`);return Array.isArray(r)?r[parseInt(s)]:r[s]},t),db=t=>t!=null,hb=t=>!t,lo={[js.HTTP]:80,[js.HTTPS]:443},fb=t=>{const e=(()=>{try{if(t instanceof URL)return t;if(typeof t=="object"&&"hostname"in t){const{hostname:h,port:m,protocol:g="",path:p="",query:w={}}=t,E=new URL(`${g}//${h}${m?`:${m}`:""}${p}`);return E.search=Object.entries(w).map(([C,R])=>`${C}=${R}`).join("&"),E}return new URL(t)}catch{return null}})();if(!e)return console.error(`Unable to parse ${JSON.stringify(t)} as a whatwg URL.`),null;const r=e.href,{host:s,hostname:n,pathname:i,protocol:o,search:a}=e;if(a)return null;const c=o.slice(0,-1);if(!Object.values(js).includes(c))return null;const l=of(n),u=r.includes(`${s}:${lo[c]}`)||typeof t=="string"&&t.includes(`${s}:${lo[c]}`),d=`${s}${u?`:${lo[c]}`:""}`;return{scheme:c,authority:d,path:i,normalizedPath:i.endsWith("/")?i:`${i}/`,isIp:l}},pb=(t,e)=>t===e,gb=(t,e,r,s)=>e>=r||t.length<r?null:s?t.substring(t.length-r,t.length-e):t.substring(e,r),mb=t=>encodeURIComponent(t).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),yb={booleanEquals:lb,getAttr:af,isSet:db,isValidHostLabel:rc,not:hb,parseURL:fb,stringEquals:pb,substring:gb,uriEncode:mb},cf=(t,e)=>{const r=[],s={...e.endpointParams,...e.referenceRecord};let n=0;for(;n<t.length;){const i=t.indexOf("{",n);if(i===-1){r.push(t.slice(n));break}r.push(t.slice(n,i));const o=t.indexOf("}",i);if(o===-1){r.push(t.slice(i));break}t[i+1]==="{"&&t[o+1]==="}"&&(r.push(t.slice(i+1,o)),n=o+2);const a=t.substring(i+1,o);if(a.includes("#")){const[c,l]=a.split("#");r.push(af(s[c],l))}else r.push(s[a]);n=o+1}return r.join("")},wb=({ref:t},e)=>({...e.endpointParams,...e.referenceRecord})[t],ui=(t,e,r)=>{if(typeof t=="string")return cf(t,r);if(t.fn)return lf(t,r);if(t.ref)return wb(t,r);throw new st(`'${e}': ${String(t)} is not a string, function or reference.`)},lf=({fn:t,argv:e},r)=>{const s=e.map(i=>["boolean","number"].includes(typeof i)?i:ui(i,"arg",r)),n=t.split(".");return n[0]in Ra&&n[1]!=null?Ra[n[0]][n[1]](...s):yb[t](...s)},bb=({assign:t,...e},r)=>{var n,i;if(t&&t in r.referenceRecord)throw new st(`'${t}' is already defined in Reference Record.`);const s=lf(e,r);return(i=(n=r.logger)==null?void 0:n.debug)==null||i.call(n,Vs,`evaluateCondition: ${Jt(e)} = ${Jt(s)}`),{result:s===""?!0:!!s,...t!=null&&{toAssign:{name:t,value:s}}}},sc=(t=[],e)=>{var s,n;const r={};for(const i of t){const{result:o,toAssign:a}=bb(i,{...e,referenceRecord:{...e.referenceRecord,...r}});if(!o)return{result:o};a&&(r[a.name]=a.value,(n=(s=e.logger)==null?void 0:s.debug)==null||n.call(s,Vs,`assign: ${a.name} := ${Jt(a.value)}`))}return{result:!0,referenceRecord:r}},_b=(t,e)=>Object.entries(t).reduce((r,[s,n])=>({...r,[s]:n.map(i=>{const o=ui(i,"Header value entry",e);if(typeof o!="string")throw new st(`Header '${s}' value '${o}' is not a string`);return o})}),{}),uf=(t,e)=>{if(Array.isArray(t))return t.map(r=>uf(r,e));switch(typeof t){case"string":return cf(t,e);case"object":if(t===null)throw new st(`Unexpected endpoint property: ${t}`);return df(t,e);case"boolean":return t;default:throw new st(`Unexpected endpoint property type: ${typeof t}`)}},df=(t,e)=>Object.entries(t).reduce((r,[s,n])=>({...r,[s]:uf(n,e)}),{}),vb=(t,e)=>{const r=ui(t,"Endpoint URL",e);if(typeof r=="string")try{return new URL(r)}catch(s){throw console.error(`Failed to construct URL with ${r}`,s),s}throw new st(`Endpoint URL must be a string, got ${typeof r}`)},Eb=(t,e)=>{var u,d;const{conditions:r,endpoint:s}=t,{result:n,referenceRecord:i}=sc(r,e);if(!n)return;const o={...e,referenceRecord:{...e.referenceRecord,...i}},{url:a,properties:c,headers:l}=s;return(d=(u=e.logger)==null?void 0:u.debug)==null||d.call(u,Vs,`Resolving endpoint from template: ${Jt(s)}`),{...l!=null&&{headers:_b(l,o)},...c!=null&&{properties:df(c,o)},url:vb(a,o)}},Sb=(t,e)=>{const{conditions:r,error:s}=t,{result:n,referenceRecord:i}=sc(r,e);if(n)throw new st(ui(s,"Error",{...e,referenceRecord:{...e.referenceRecord,...i}}))},xb=(t,e)=>{const{conditions:r,rules:s}=t,{result:n,referenceRecord:i}=sc(r,e);if(n)return hf(s,{...e,referenceRecord:{...e.referenceRecord,...i}})},hf=(t,e)=>{for(const r of t)if(r.type==="endpoint"){const s=Eb(r,e);if(s)return s}else if(r.type==="error")Sb(r,e);else if(r.type==="tree"){const s=xb(r,e);if(s)return s}else throw new st(`Unknown endpoint rule: ${r}`);throw new st("Rules evaluation failed")},Ab=(t,e)=>{var l,u,d,h,m;const{endpointParams:r,logger:s}=e,{parameters:n,rules:i}=t;(u=(l=e.logger)==null?void 0:l.debug)==null||u.call(l,`${Vs} Initial EndpointParams: ${Jt(r)}`);const o=Object.entries(n).filter(([,g])=>g.default!=null).map(([g,p])=>[g,p.default]);if(o.length>0)for(const[g,p]of o)r[g]=r[g]??p;const a=Object.entries(n).filter(([,g])=>g.required).map(([g])=>g);for(const g of a)if(r[g]==null)throw new st(`Missing required parameter: '${g}'`);const c=hf(i,{endpointParams:r,logger:s,referenceRecord:{}});if((d=e.endpointParams)!=null&&d.Endpoint)try{const g=new URL(e.endpointParams.Endpoint),{protocol:p,port:w}=g;c.url.protocol=p,c.url.port=w}catch{}return(m=(h=e.logger)==null?void 0:h.debug)==null||m.call(h,`${Vs} Resolved endpoint: ${Jt(c)}`),c},ff=(t,e=!1)=>{if(e){for(const r of t.split("."))if(!ff(r))return!1;return!0}return!(!rc(t)||t.length<3||t.length>63||t!==t.toLowerCase()||of(t))},Cb=t=>{const e=t.split(":");if(e.length<6)return null;const[r,s,n,i,o,...a]=e;return r!=="arn"||s===""||n===""||a[0]===""?null:{partition:s,service:n,region:i,accountId:o,resourceId:a[0].includes("/")?a[0].split("/"):a}},kb=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"aws-global":{description:"AWS Standard global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"AWS China global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"AWS GovCloud (US) global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"c2s.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"AWS ISO (US) global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"sc2s.sgov.gov",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"AWS ISOB (US) global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"cloud.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"csp.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{}}],Rb="1.1",Tb={partitions:kb,version:Rb};let Ob=Tb;const Pb=t=>{const{partitions:e}=Ob;for(const s of e){const{regions:n,outputs:i}=s;for(const[o,a]of Object.entries(n))if(o===t)return{...i,...a}}for(const s of e){const{regionRegex:n,outputs:i}=s;if(new RegExp(n).test(t))return{...i}}const r=e.find(s=>s.id==="aws");if(!r)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...r.outputs}},Ib={isVirtualHostableS3Bucket:ff,parseArn:Cb,partition:Pb};Ra.aws=Ib;const cu="user-agent",uo="x-amz-user-agent",lu=" ",ho="/",Bb=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,Nb=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g,uu="-",Mb=t=>(e,r)=>async s=>{var d,h;const{request:n}=s;if(!We.isInstance(n))return e(s);const{headers:i}=n,o=((d=r==null?void 0:r.userAgent)==null?void 0:d.map(fo))||[],a=(await t.defaultUserAgentProvider()).map(fo),c=((h=t==null?void 0:t.customUserAgent)==null?void 0:h.map(fo))||[],l=[].concat([...a,...o,...c]).join(lu),u=[...a.filter(m=>m.startsWith("aws-sdk-")),...c].join(lu);return t.runtime!=="browser"?(u&&(i[uo]=i[uo]?`${i[cu]} ${u}`:u),i[cu]=l):i[uo]=l,e({...s,request:n})},fo=t=>{var o;const e=t[0].split(ho).map(a=>a.replace(Bb,uu)).join(ho),r=(o=t[1])==null?void 0:o.replace(Nb,uu),s=e.indexOf(ho),n=e.substring(0,s);let i=e.substring(s+1);return n==="api"&&(i=i.toLowerCase()),[n,i,r].filter(a=>a&&a.length>0).reduce((a,c,l)=>{switch(l){case 0:return c;case 1:return`${a}/${c}`;default:return`${a}#${c}`}},"")},Db={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},Fb=t=>({applyToStack:e=>{e.add(Mb(t),Db)}}),$b=!1,Lb=!1,pf=t=>typeof t=="string"&&(t.startsWith("fips-")||t.endsWith("-fips")),du=t=>pf(t)?["fips-aws-global","aws-fips"].includes(t)?"us-east-1":t.replace(/fips-(dkr-|prod-)?|-fips/,""):t,Ub=t=>{const{region:e,useFipsEndpoint:r}=t;if(!e)throw new Error("Region is missing");return{...t,region:async()=>{if(typeof e=="string")return du(e);const s=await e();return du(s)},useFipsEndpoint:async()=>{const s=typeof e=="string"?e:await e();return pf(s)?!0:typeof r!="function"?Promise.resolve(!!r):r()}}},jb=t=>({...t,eventStreamMarshaller:t.eventStreamSerdeProvider(t)}),hu="content-length";function Hb(t){return e=>async r=>{const s=r.request;if(We.isInstance(s)){const{body:n,headers:i}=s;if(n&&Object.keys(i).map(o=>o.toLowerCase()).indexOf(hu)===-1)try{const o=t(n);s.headers={...s.headers,[hu]:String(o)}}catch{}}return e({...r,request:s})}}const qb={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},zb=t=>({applyToStack:e=>{e.add(Hb(t.bodyLengthChecker),qb)}}),Kb=async t=>{const e=(t==null?void 0:t.Bucket)||"";if(typeof t.Bucket=="string"&&(t.Bucket=e.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),Xb(e)){if(t.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!Jb(e)||e.indexOf(".")!==-1&&!String(t.Endpoint).startsWith("http:")||e.toLowerCase()!==e||e.length<3)&&(t.ForcePathStyle=!0);return t.DisableMultiRegionAccessPoints&&(t.disableMultiRegionAccessPoints=!0,t.DisableMRAP=!0),t},Vb=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,Gb=/(\d+\.){3}\d+/,Wb=/\.\./,Jb=t=>Vb.test(t)&&!Gb.test(t)&&!Wb.test(t),Xb=t=>{const[e,r,s,n,i,o]=t.split(":"),a=e==="arn"&&t.split(":").length>=6,c=[e,r,s,i,o].filter(Boolean).length===5;if(a&&!c)throw new Error(`Invalid ARN: ${t} was an invalid ARN.`);return e==="arn"&&!!r&&!!s&&!!i&&!!o},Yb=(t,e,r)=>{const s=async()=>{const n=r[t]??r[e];return typeof n=="function"?n():n};return t==="credentialScope"||e==="CredentialScope"?async()=>{const n=typeof r.credentials=="function"?await r.credentials():r.credentials;return(n==null?void 0:n.credentialScope)??(n==null?void 0:n.CredentialScope)}:t==="endpoint"||e==="endpoint"?async()=>{const n=await s();if(n&&typeof n=="object"){if("url"in n)return n.url.href;if("hostname"in n){const{protocol:i,hostname:o,port:a,path:c}=n;return`${i}//${o}${a?":"+a:""}${c}`}}return n}:s},Zb=async t=>{};function Qb(t){const e={};if(t=t.replace(/^\?/,""),t)for(const r of t.split("&")){let[s,n=null]=r.split("=");s=decodeURIComponent(s),n&&(n=decodeURIComponent(n)),s in e?Array.isArray(e[s])?e[s].push(n):e[s]=[e[s],n]:e[s]=n}return e}const qn=t=>{if(typeof t=="string")return qn(new URL(t));const{hostname:e,pathname:r,port:s,protocol:n,search:i}=t;let o;return i&&(o=Qb(i)),{hostname:e,port:s?parseInt(s):void 0,protocol:n,path:r,query:o}},gf=t=>typeof t=="object"?"url"in t?qn(t.url):t:qn(t),e_=async(t,e,r,s)=>{if(!r.endpoint){const o=await Zb(r.serviceId||"");o&&(r.endpoint=()=>Promise.resolve(gf(o)))}const n=await t_(t,e,r);if(typeof r.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return r.endpointProvider(n,s)},t_=async(t,e,r)=>{var i;const s={},n=((i=e==null?void 0:e.getEndpointParameterInstructions)==null?void 0:i.call(e))||{};for(const[o,a]of Object.entries(n))switch(a.type){case"staticContextParams":s[o]=a.value;break;case"contextParams":s[o]=t[a.name];break;case"clientContextParams":case"builtInParams":s[o]=await Yb(a.name,o,r)();break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(a))}return Object.keys(n).length===0&&Object.assign(s,r),String(r.serviceId).toLowerCase()==="s3"&&await Kb(s),s},r_=({config:t,instructions:e})=>(r,s)=>async n=>{var a,c,l;const i=await e_(n.input,{getEndpointParameterInstructions(){return e}},{...t},s);s.endpointV2=i,s.authSchemes=(a=i.properties)==null?void 0:a.authSchemes;const o=(c=s.authSchemes)==null?void 0:c[0];if(o){s.signing_region=o.signingRegion,s.signing_service=o.signingName;const u=mw(s),d=(l=u==null?void 0:u.selectedHttpAuthScheme)==null?void 0:l.httpAuthOption;d&&(d.signingProperties=Object.assign(d.signingProperties||{},{signing_region:o.signingRegion,signingRegion:o.signingRegion,signing_service:o.signingName,signingName:o.signingName,signingRegionSet:o.signingRegionSet},o.properties))}return r({...n})},s_=(t,e)=>(r,s)=>async n=>{const{response:i}=await r(n);try{const o=await e(i,t);return{response:i,output:o}}catch(o){if(Object.defineProperty(o,"$response",{value:i}),!("$metadata"in o)){const a="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";o.message+=`
  `+a,typeof o.$responseBodyText<"u"&&o.$response&&(o.$response.body=o.$responseBodyText)}throw o}},n_=(t,e)=>(r,s)=>async n=>{var a;const i=(a=s.endpointV2)!=null&&a.url&&t.urlParser?async()=>t.urlParser(s.endpointV2.url):t.endpoint;if(!i)throw new Error("No valid endpoint provider available.");const o=await e(n.input,{...t,endpoint:i});return r({...n,request:o})},i_={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},nc={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function en(t,e,r){return{applyToStack:s=>{s.add(s_(t,r),i_),s.add(n_(t,e),nc)}}}const mf={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:nc.name},tn=(t,e)=>({applyToStack:r=>{r.addRelativeTo(r_({config:t,instructions:e}),mf)}}),o_=t=>{const e=t.tls??!0,{endpoint:r}=t,s=r!=null?async()=>gf(await wt(r)()):void 0;return{...t,endpoint:s,tls:e,isCustomEndpoint:!!r,useDualstackEndpoint:wt(t.useDualstackEndpoint??!1),useFipsEndpoint:wt(t.useFipsEndpoint??!1)}};var Jr;(function(t){t.STANDARD="standard",t.ADAPTIVE="adaptive"})(Jr||(Jr={}));const zn=3,a_=Jr.STANDARD,c_=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],l_=["TimeoutError","RequestTimeout","RequestTimeoutException"],u_=[500,502,503,504],d_=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],h_=t=>{var e;return(e=t.$metadata)==null?void 0:e.clockSkewCorrected},yf=t=>{var e,r;return((e=t.$metadata)==null?void 0:e.httpStatusCode)===429||c_.includes(t.name)||((r=t.$retryable)==null?void 0:r.throttling)==!0},wf=t=>{var e;return h_(t)||l_.includes(t.name)||d_.includes((t==null?void 0:t.code)||"")||u_.includes(((e=t.$metadata)==null?void 0:e.httpStatusCode)||0)},f_=t=>{var e;if(((e=t.$metadata)==null?void 0:e.httpStatusCode)!==void 0){const r=t.$metadata.httpStatusCode;return 500<=r&&r<=599&&!wf(t)}return!1};class p_{constructor(e){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=(e==null?void 0:e.beta)??.7,this.minCapacity=(e==null?void 0:e.minCapacity)??1,this.minFillRate=(e==null?void 0:e.minFillRate)??.5,this.scaleConstant=(e==null?void 0:e.scaleConstant)??.4,this.smooth=(e==null?void 0:e.smooth)??.8;const r=this.getCurrentTimeInSeconds();this.lastThrottleTime=r,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const r=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(s=>setTimeout(s,r))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}const r=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+r),this.lastTimestamp=e}updateClientSendingRate(e){let r;if(this.updateMeasuredRate(),yf(e)){const n=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=n,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),r=this.cubicThrottle(n),this.enableTokenBucket()}else this.calculateTimeWindow(),r=this.cubicSuccess(this.getCurrentTimeInSeconds());const s=Math.min(r,2*this.measuredTxRate);this.updateTokenBucketRate(s)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),r=Math.floor(e*2)/2;if(this.requestCount++,r>this.lastTxRateBucket){const s=this.requestCount/(r-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(s*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=r}}getPrecise(e){return parseFloat(e.toFixed(8))}}const Ta=100,bf=20*1e3,g_=500,fu=500,m_=5,y_=10,w_=1,b_="amz-sdk-invocation-id",__="amz-sdk-request",v_=()=>{let t=Ta;return{computeNextBackoffDelay:s=>Math.floor(Math.min(bf,Math.random()*2**s*t)),setDelayBase:s=>{t=s}}},pu=({retryDelay:t,retryCount:e,retryCost:r})=>({getRetryCount:()=>e,getRetryDelay:()=>Math.min(bf,t),getRetryCost:()=>r});class _f{constructor(e){this.maxAttempts=e,this.mode=Jr.STANDARD,this.capacity=fu,this.retryBackoffStrategy=v_(),this.maxAttemptsProvider=typeof e=="function"?e:async()=>e}async acquireInitialRetryToken(e){return pu({retryDelay:Ta,retryCount:0})}async refreshRetryTokenForRetry(e,r){const s=await this.getMaxAttempts();if(this.shouldRetry(e,r,s)){const n=r.errorType;this.retryBackoffStrategy.setDelayBase(n==="THROTTLING"?g_:Ta);const i=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),o=r.retryAfterHint?Math.max(r.retryAfterHint.getTime()-Date.now()||0,i):i,a=this.getCapacityCost(n);return this.capacity-=a,pu({retryDelay:o,retryCount:e.getRetryCount()+1,retryCost:a})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(fu,this.capacity+(e.getRetryCost()??w_))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${zn}`),zn}}shouldRetry(e,r,s){return e.getRetryCount()+1<s&&this.capacity>=this.getCapacityCost(r.errorType)&&this.isRetryableError(r.errorType)}getCapacityCost(e){return e==="TRANSIENT"?y_:m_}isRetryableError(e){return e==="THROTTLING"||e==="TRANSIENT"}}class E_{constructor(e,r){this.maxAttemptsProvider=e,this.mode=Jr.ADAPTIVE;const{rateLimiter:s}=r??{};this.rateLimiter=s??new p_,this.standardRetryStrategy=new _f(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,r){return this.rateLimiter.updateClientSendingRate(r),this.standardRetryStrategy.refreshRetryTokenForRetry(e,r)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}var Sn,S_=new Uint8Array(16);function x_(){if(!Sn&&(Sn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Sn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Sn(S_)}const A_=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function C_(t){return typeof t=="string"&&A_.test(t)}var Ie=[];for(var po=0;po<256;++po)Ie.push((po+256).toString(16).substr(1));function k_(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(Ie[t[e+0]]+Ie[t[e+1]]+Ie[t[e+2]]+Ie[t[e+3]]+"-"+Ie[t[e+4]]+Ie[t[e+5]]+"-"+Ie[t[e+6]]+Ie[t[e+7]]+"-"+Ie[t[e+8]]+Ie[t[e+9]]+"-"+Ie[t[e+10]]+Ie[t[e+11]]+Ie[t[e+12]]+Ie[t[e+13]]+Ie[t[e+14]]+Ie[t[e+15]]).toLowerCase();if(!C_(r))throw TypeError("Stringified UUID is invalid");return r}function R_(t,e,r){t=t||{};var s=t.random||(t.rng||x_)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,e){r=r||0;for(var n=0;n<16;++n)e[r+n]=s[n];return e}return k_(s)}const T_=t=>t instanceof Error?t:t instanceof Object?Object.assign(new Error,t):typeof t=="string"?new Error(t):new Error(`AWS SDK error wrapper for ${t}`),O_=t=>{const{retryStrategy:e}=t,r=wt(t.maxAttempts??zn);return{...t,maxAttempts:r,retryStrategy:async()=>e||(await wt(t.retryMode)()===Jr.ADAPTIVE?new E_(r):new _f(r))}},P_=t=>(t==null?void 0:t.body)instanceof ReadableStream,I_=t=>(e,r)=>async s=>{var o;let n=await t.retryStrategy();const i=await t.maxAttempts();if(B_(n)){n=n;let a=await n.acquireInitialRetryToken(r.partition_id),c=new Error,l=0,u=0;const{request:d}=s,h=We.isInstance(d);for(h&&(d.headers[b_]=R_());;)try{h&&(d.headers[__]=`attempt=${l+1}; max=${i}`);const{response:m,output:g}=await e(s);return n.recordSuccess(a),g.$metadata.attempts=l+1,g.$metadata.totalRetryDelay=u,{response:m,output:g}}catch(m){const g=N_(m);if(c=T_(m),h&&P_(d))throw(o=r.logger instanceof Va?console:r.logger)==null||o.warn("An error was encountered in a non-retryable streaming request."),c;try{a=await n.refreshRetryTokenForRetry(a,g)}catch{throw c.$metadata||(c.$metadata={}),c.$metadata.attempts=l+1,c.$metadata.totalRetryDelay=u,c}l=a.getRetryCount();const p=a.getRetryDelay();u+=p,await new Promise(w=>setTimeout(w,p))}}else return n=n,n!=null&&n.mode&&(r.userAgent=[...r.userAgent||[],["cfg/retry-mode",n.mode]]),n.retry(e,s)},B_=t=>typeof t.acquireInitialRetryToken<"u"&&typeof t.refreshRetryTokenForRetry<"u"&&typeof t.recordSuccess<"u",N_=t=>{const e={error:t,errorType:M_(t)},r=F_(t.$response);return r&&(e.retryAfterHint=r),e},M_=t=>yf(t)?"THROTTLING":wf(t)?"TRANSIENT":f_(t)?"SERVER_ERROR":"CLIENT_ERROR",vf={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},D_=t=>({applyToStack:e=>{e.add(I_(t),vf)}}),F_=t=>{if(!Hs.isInstance(t))return;const e=Object.keys(t.headers).find(i=>i.toLowerCase()==="retry-after");if(!e)return;const r=t.headers[e],s=Number(r);return Number.isNaN(s)?new Date(r):new Date(s*1e3)},$_=t=>({...t,useFipsEndpoint:t.useFipsEndpoint??!1,useDualstackEndpoint:t.useDualstackEndpoint??!1,forcePathStyle:t.forcePathStyle??!1,useAccelerateEndpoint:t.useAccelerateEndpoint??!1,useGlobalEndpoint:t.useGlobalEndpoint??!1,disableMultiregionAccessPoints:t.disableMultiregionAccessPoints??!1,defaultSigningName:"s3"}),rn={ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},DisableS3ExpressSessionAuth:{type:"clientContextParams",name:"disableS3ExpressSessionAuth"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};class ot extends ec{constructor(e){super(e),Object.setPrototypeOf(this,ot.prototype)}}class ic extends ot{constructor(e){super({name:"NoSuchUpload",$fault:"client",...e}),this.name="NoSuchUpload",this.$fault="client",Object.setPrototypeOf(this,ic.prototype)}}class oc extends ot{constructor(e){super({name:"ObjectNotInActiveTierError",$fault:"client",...e}),this.name="ObjectNotInActiveTierError",this.$fault="client",Object.setPrototypeOf(this,oc.prototype)}}class ac extends ot{constructor(e){super({name:"BucketAlreadyExists",$fault:"client",...e}),this.name="BucketAlreadyExists",this.$fault="client",Object.setPrototypeOf(this,ac.prototype)}}class cc extends ot{constructor(e){super({name:"BucketAlreadyOwnedByYou",$fault:"client",...e}),this.name="BucketAlreadyOwnedByYou",this.$fault="client",Object.setPrototypeOf(this,cc.prototype)}}class lc extends ot{constructor(e){super({name:"NoSuchBucket",$fault:"client",...e}),this.name="NoSuchBucket",this.$fault="client",Object.setPrototypeOf(this,lc.prototype)}}var gu;(function(t){t.visit=(e,r)=>e.Prefix!==void 0?r.Prefix(e.Prefix):e.Tag!==void 0?r.Tag(e.Tag):e.And!==void 0?r.And(e.And):r._(e.$unknown[0],e.$unknown[1])})(gu||(gu={}));var mu;(function(t){t.visit=(e,r)=>e.Prefix!==void 0?r.Prefix(e.Prefix):e.Tag!==void 0?r.Tag(e.Tag):e.ObjectSizeGreaterThan!==void 0?r.ObjectSizeGreaterThan(e.ObjectSizeGreaterThan):e.ObjectSizeLessThan!==void 0?r.ObjectSizeLessThan(e.ObjectSizeLessThan):e.And!==void 0?r.And(e.And):r._(e.$unknown[0],e.$unknown[1])})(mu||(mu={}));var yu;(function(t){t.visit=(e,r)=>e.Prefix!==void 0?r.Prefix(e.Prefix):e.Tag!==void 0?r.Tag(e.Tag):e.AccessPointArn!==void 0?r.AccessPointArn(e.AccessPointArn):e.And!==void 0?r.And(e.And):r._(e.$unknown[0],e.$unknown[1])})(yu||(yu={}));var wu;(function(t){t.visit=(e,r)=>e.Prefix!==void 0?r.Prefix(e.Prefix):e.Tag!==void 0?r.Tag(e.Tag):e.And!==void 0?r.And(e.And):r._(e.$unknown[0],e.$unknown[1])})(wu||(wu={}));class uc extends ot{constructor(e){super({name:"InvalidObjectState",$fault:"client",...e}),this.name="InvalidObjectState",this.$fault="client",Object.setPrototypeOf(this,uc.prototype),this.StorageClass=e.StorageClass,this.AccessTier=e.AccessTier}}class dc extends ot{constructor(e){super({name:"NoSuchKey",$fault:"client",...e}),this.name="NoSuchKey",this.$fault="client",Object.setPrototypeOf(this,dc.prototype)}}class hc extends ot{constructor(e){super({name:"NotFound",$fault:"client",...e}),this.name="NotFound",this.$fault="client",Object.setPrototypeOf(this,hc.prototype)}}const L_=t=>({...t,...t.SecretAccessKey&&{SecretAccessKey:mt},...t.SessionToken&&{SessionToken:mt}}),U_=t=>({...t,...t.Credentials&&{Credentials:L_(t.Credentials)}}),j_=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:mt}}),H_=t=>({...t,...t.SSECustomerKey&&{SSECustomerKey:mt}}),q_=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:mt}}),z_=t=>({...t,...t.SSECustomerKey&&{SSECustomerKey:mt}});mf.name;nc.name;vf.name;function sn(t,e){return new K_(t,e)}class K_{constructor(e,r){this.input=e,this.context=r,this.query={},this.method="",this.headers={},this.path="",this.body=null,this.hostname="",this.resolvePathStack=[]}async build(){const{hostname:e,protocol:r="https",port:s,path:n}=await this.context.endpoint();this.path=n;for(const i of this.resolvePathStack)i(this.path);return new We({protocol:r,hostname:this.hostname||e,port:s,method:this.method,path:this.path,query:this.query,body:this.body,headers:this.headers})}hn(e){return this.hostname=e,this}bp(e){return this.resolvePathStack.push(r=>{this.path=`${r!=null&&r.endsWith("/")?r.slice(0,-1):r||""}`+e}),this}p(e,r,s,n){return this.resolvePathStack.push(i=>{this.path=uy(i,this.input,e,r,s,n)}),this}h(e){return this.headers=e,this}q(e){return this.query=e,this}b(e){return this.body=e,this}m(e){return this.method=e,this}}const V_=(t,e)=>Xa(t,e).then(r=>e.utf8Encoder(r));var fc={},di={};(function(t){const e=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r=e+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",s="["+e+"]["+r+"]*",n=new RegExp("^"+s+"$"),i=function(a,c){const l=[];let u=c.exec(a);for(;u;){const d=[];d.startIndex=c.lastIndex-u[0].length;const h=u.length;for(let m=0;m<h;m++)d.push(u[m]);l.push(d),u=c.exec(a)}return l},o=function(a){const c=n.exec(a);return!(c===null||typeof c>"u")};t.isExist=function(a){return typeof a<"u"},t.isEmptyObject=function(a){return Object.keys(a).length===0},t.merge=function(a,c,l){if(c){const u=Object.keys(c),d=u.length;for(let h=0;h<d;h++)l==="strict"?a[u[h]]=[c[u[h]]]:a[u[h]]=c[u[h]]}},t.getValue=function(a){return t.isExist(a)?a:""},t.isName=o,t.getAllMatches=i,t.nameRegexp=s})(di);const pc=di,G_={allowBooleanAttributes:!1,unpairedTags:[]};fc.validate=function(t,e){e=Object.assign({},G_,e);const r=[];let s=!1,n=!1;t[0]==="\uFEFF"&&(t=t.substr(1));for(let i=0;i<t.length;i++)if(t[i]==="<"&&t[i+1]==="?"){if(i+=2,i=_u(t,i),i.err)return i}else if(t[i]==="<"){let o=i;if(i++,t[i]==="!"){i=vu(t,i);continue}else{let a=!1;t[i]==="/"&&(a=!0,i++);let c="";for(;i<t.length&&t[i]!==">"&&t[i]!==" "&&t[i]!=="	"&&t[i]!==`
`&&t[i]!=="\r";i++)c+=t[i];if(c=c.trim(),c[c.length-1]==="/"&&(c=c.substring(0,c.length-1),i--),!tv(c)){let d;return c.trim().length===0?d="Invalid space after '<'.":d="Tag '"+c+"' is an invalid name.",_e("InvalidTag",d,qe(t,i))}const l=X_(t,i);if(l===!1)return _e("InvalidAttr","Attributes for '"+c+"' have open quote.",qe(t,i));let u=l.value;if(i=l.index,u[u.length-1]==="/"){const d=i-u.length;u=u.substring(0,u.length-1);const h=Eu(u,e);if(h===!0)s=!0;else return _e(h.err.code,h.err.msg,qe(t,d+h.err.line))}else if(a)if(l.tagClosed){if(u.trim().length>0)return _e("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",qe(t,o));{const d=r.pop();if(c!==d.tagName){let h=qe(t,d.tagStartPos);return _e("InvalidTag","Expected closing tag '"+d.tagName+"' (opened in line "+h.line+", col "+h.col+") instead of closing tag '"+c+"'.",qe(t,o))}r.length==0&&(n=!0)}}else return _e("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",qe(t,i));else{const d=Eu(u,e);if(d!==!0)return _e(d.err.code,d.err.msg,qe(t,i-u.length+d.err.line));if(n===!0)return _e("InvalidXml","Multiple possible root nodes found.",qe(t,i));e.unpairedTags.indexOf(c)!==-1||r.push({tagName:c,tagStartPos:o}),s=!0}for(i++;i<t.length;i++)if(t[i]==="<")if(t[i+1]==="!"){i++,i=vu(t,i);continue}else if(t[i+1]==="?"){if(i=_u(t,++i),i.err)return i}else break;else if(t[i]==="&"){const d=Q_(t,i);if(d==-1)return _e("InvalidChar","char '&' is not expected.",qe(t,i));i=d}else if(n===!0&&!bu(t[i]))return _e("InvalidXml","Extra text at the end",qe(t,i));t[i]==="<"&&i--}}else{if(bu(t[i]))continue;return _e("InvalidChar","char '"+t[i]+"' is not expected.",qe(t,i))}if(s){if(r.length==1)return _e("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",qe(t,r[0].tagStartPos));if(r.length>0)return _e("InvalidXml","Invalid '"+JSON.stringify(r.map(i=>i.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return _e("InvalidXml","Start tag expected.",1);return!0};function bu(t){return t===" "||t==="	"||t===`
`||t==="\r"}function _u(t,e){const r=e;for(;e<t.length;e++)if(t[e]=="?"||t[e]==" "){const s=t.substr(r,e-r);if(e>5&&s==="xml")return _e("InvalidXml","XML declaration allowed only at the start of the document.",qe(t,e));if(t[e]=="?"&&t[e+1]==">"){e++;break}else continue}return e}function vu(t,e){if(t.length>e+5&&t[e+1]==="-"&&t[e+2]==="-"){for(e+=3;e<t.length;e++)if(t[e]==="-"&&t[e+1]==="-"&&t[e+2]===">"){e+=2;break}}else if(t.length>e+8&&t[e+1]==="D"&&t[e+2]==="O"&&t[e+3]==="C"&&t[e+4]==="T"&&t[e+5]==="Y"&&t[e+6]==="P"&&t[e+7]==="E"){let r=1;for(e+=8;e<t.length;e++)if(t[e]==="<")r++;else if(t[e]===">"&&(r--,r===0))break}else if(t.length>e+9&&t[e+1]==="["&&t[e+2]==="C"&&t[e+3]==="D"&&t[e+4]==="A"&&t[e+5]==="T"&&t[e+6]==="A"&&t[e+7]==="["){for(e+=8;e<t.length;e++)if(t[e]==="]"&&t[e+1]==="]"&&t[e+2]===">"){e+=2;break}}return e}const W_='"',J_="'";function X_(t,e){let r="",s="",n=!1;for(;e<t.length;e++){if(t[e]===W_||t[e]===J_)s===""?s=t[e]:s!==t[e]||(s="");else if(t[e]===">"&&s===""){n=!0;break}r+=t[e]}return s!==""?!1:{value:r,index:e,tagClosed:n}}const Y_=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function Eu(t,e){const r=pc.getAllMatches(t,Y_),s={};for(let n=0;n<r.length;n++){if(r[n][1].length===0)return _e("InvalidAttr","Attribute '"+r[n][2]+"' has no space in starting.",ms(r[n]));if(r[n][3]!==void 0&&r[n][4]===void 0)return _e("InvalidAttr","Attribute '"+r[n][2]+"' is without value.",ms(r[n]));if(r[n][3]===void 0&&!e.allowBooleanAttributes)return _e("InvalidAttr","boolean attribute '"+r[n][2]+"' is not allowed.",ms(r[n]));const i=r[n][2];if(!ev(i))return _e("InvalidAttr","Attribute '"+i+"' is an invalid name.",ms(r[n]));if(!s.hasOwnProperty(i))s[i]=1;else return _e("InvalidAttr","Attribute '"+i+"' is repeated.",ms(r[n]))}return!0}function Z_(t,e){let r=/\d/;for(t[e]==="x"&&(e++,r=/[\da-fA-F]/);e<t.length;e++){if(t[e]===";")return e;if(!t[e].match(r))break}return-1}function Q_(t,e){if(e++,t[e]===";")return-1;if(t[e]==="#")return e++,Z_(t,e);let r=0;for(;e<t.length;e++,r++)if(!(t[e].match(/\w/)&&r<20)){if(t[e]===";")break;return-1}return e}function _e(t,e,r){return{err:{code:t,msg:e,line:r.line||r,col:r.col}}}function ev(t){return pc.isName(t)}function tv(t){return pc.isName(t)}function qe(t,e){const r=t.substring(0,e).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function ms(t){return t.startIndex+t[1].length}var gc={};const Ef={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(t,e,r){return t}},rv=function(t){return Object.assign({},Ef,t)};gc.buildOptions=rv;gc.defaultOptions=Ef;class sv{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,r){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:r})}addChild(e){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}}var nv=sv;const iv=di;function ov(t,e){const r={};if(t[e+3]==="O"&&t[e+4]==="C"&&t[e+5]==="T"&&t[e+6]==="Y"&&t[e+7]==="P"&&t[e+8]==="E"){e=e+9;let s=1,n=!1,i=!1,o="";for(;e<t.length;e++)if(t[e]==="<"&&!i){if(n&&lv(t,e))e+=7,[entityName,val,e]=av(t,e+1),val.indexOf("&")===-1&&(r[fv(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(n&&uv(t,e))e+=8;else if(n&&dv(t,e))e+=8;else if(n&&hv(t,e))e+=9;else if(cv)i=!0;else throw new Error("Invalid DOCTYPE");s++,o=""}else if(t[e]===">"){if(i?t[e-1]==="-"&&t[e-2]==="-"&&(i=!1,s--):s--,s===0)break}else t[e]==="["?n=!0:o+=t[e];if(s!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:r,i:e}}function av(t,e){let r="";for(;e<t.length&&t[e]!=="'"&&t[e]!=='"';e++)r+=t[e];if(r=r.trim(),r.indexOf(" ")!==-1)throw new Error("External entites are not supported");const s=t[e++];let n="";for(;e<t.length&&t[e]!==s;e++)n+=t[e];return[r,n,e]}function cv(t,e){return t[e+1]==="!"&&t[e+2]==="-"&&t[e+3]==="-"}function lv(t,e){return t[e+1]==="!"&&t[e+2]==="E"&&t[e+3]==="N"&&t[e+4]==="T"&&t[e+5]==="I"&&t[e+6]==="T"&&t[e+7]==="Y"}function uv(t,e){return t[e+1]==="!"&&t[e+2]==="E"&&t[e+3]==="L"&&t[e+4]==="E"&&t[e+5]==="M"&&t[e+6]==="E"&&t[e+7]==="N"&&t[e+8]==="T"}function dv(t,e){return t[e+1]==="!"&&t[e+2]==="A"&&t[e+3]==="T"&&t[e+4]==="T"&&t[e+5]==="L"&&t[e+6]==="I"&&t[e+7]==="S"&&t[e+8]==="T"}function hv(t,e){return t[e+1]==="!"&&t[e+2]==="N"&&t[e+3]==="O"&&t[e+4]==="T"&&t[e+5]==="A"&&t[e+6]==="T"&&t[e+7]==="I"&&t[e+8]==="O"&&t[e+9]==="N"}function fv(t){if(iv.isName(t))return t;throw new Error(`Invalid entity name ${t}`)}var pv=ov;const gv=/^[-+]?0x[a-fA-F0-9]+$/,mv=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const yv={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function wv(t,e={}){if(e=Object.assign({},yv,e),!t||typeof t!="string")return t;let r=t.trim();if(e.skipLike!==void 0&&e.skipLike.test(r))return t;if(e.hex&&gv.test(r))return Number.parseInt(r,16);{const s=mv.exec(r);if(s){const n=s[1],i=s[2];let o=bv(s[3]);const a=s[4]||s[6];if(!e.leadingZeros&&i.length>0&&n&&r[2]!==".")return t;if(!e.leadingZeros&&i.length>0&&!n&&r[1]!==".")return t;{const c=Number(r),l=""+c;return l.search(/[eE]/)!==-1||a?e.eNotation?c:t:r.indexOf(".")!==-1?l==="0"&&o===""||l===o||n&&l==="-"+o?c:t:i?o===l||n+o===l?c:t:r===l||r===n+l?c:t}}else return t}}function bv(t){return t&&t.indexOf(".")!==-1&&(t=t.replace(/0+$/,""),t==="."?t="0":t[0]==="."?t="0"+t:t[t.length-1]==="."&&(t=t.substr(0,t.length-1))),t}var _v=wv;const mc=di,ys=nv,vv=pv,Ev=_v;"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,mc.nameRegexp);let Sv=class{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""}},this.addExternalEntities=xv,this.parseXml=Tv,this.parseTextData=Av,this.resolveNameSpace=Cv,this.buildAttributesMap=Rv,this.isItStopNode=Bv,this.replaceEntitiesValue=Pv,this.readStopNodeData=Mv,this.saveTextToParentTag=Iv,this.addChild=Ov}};function xv(t){const e=Object.keys(t);for(let r=0;r<e.length;r++){const s=e[r];this.lastEntities[s]={regex:new RegExp("&"+s+";","g"),val:t[s]}}}function Av(t,e,r,s,n,i,o){if(t!==void 0&&(this.options.trimValues&&!s&&(t=t.trim()),t.length>0)){o||(t=this.replaceEntitiesValue(t));const a=this.options.tagValueProcessor(e,t,r,n,i);return a==null?t:typeof a!=typeof t||a!==t?a:this.options.trimValues?Pa(t,this.options.parseTagValue,this.options.numberParseOptions):t.trim()===t?Pa(t,this.options.parseTagValue,this.options.numberParseOptions):t}}function Cv(t){if(this.options.removeNSPrefix){const e=t.split(":"),r=t.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(t=r+e[1])}return t}const kv=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function Rv(t,e,r){if(!this.options.ignoreAttributes&&typeof t=="string"){const s=mc.getAllMatches(t,kv),n=s.length,i={};for(let o=0;o<n;o++){const a=this.resolveNameSpace(s[o][1]);let c=s[o][4],l=this.options.attributeNamePrefix+a;if(a.length)if(this.options.transformAttributeName&&(l=this.options.transformAttributeName(l)),l==="__proto__"&&(l="#__proto__"),c!==void 0){this.options.trimValues&&(c=c.trim()),c=this.replaceEntitiesValue(c);const u=this.options.attributeValueProcessor(a,c,e);u==null?i[l]=c:typeof u!=typeof c||u!==c?i[l]=u:i[l]=Pa(c,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(i[l]=!0)}if(!Object.keys(i).length)return;if(this.options.attributesGroupName){const o={};return o[this.options.attributesGroupName]=i,o}return i}}const Tv=function(t){t=t.replace(/\r\n?/g,`
`);const e=new ys("!xml");let r=e,s="",n="";for(let i=0;i<t.length;i++)if(t[i]==="<")if(t[i+1]==="/"){const a=yr(t,">",i,"Closing Tag is not closed.");let c=t.substring(i+2,a).trim();if(this.options.removeNSPrefix){const d=c.indexOf(":");d!==-1&&(c=c.substr(d+1))}this.options.transformTagName&&(c=this.options.transformTagName(c)),r&&(s=this.saveTextToParentTag(s,r,n));const l=n.substring(n.lastIndexOf(".")+1);if(c&&this.options.unpairedTags.indexOf(c)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${c}>`);let u=0;l&&this.options.unpairedTags.indexOf(l)!==-1?(u=n.lastIndexOf(".",n.lastIndexOf(".")-1),this.tagsNodeStack.pop()):u=n.lastIndexOf("."),n=n.substring(0,u),r=this.tagsNodeStack.pop(),s="",i=a}else if(t[i+1]==="?"){let a=Oa(t,i,!1,"?>");if(!a)throw new Error("Pi Tag is not closed.");if(s=this.saveTextToParentTag(s,r,n),!(this.options.ignoreDeclaration&&a.tagName==="?xml"||this.options.ignorePiTags)){const c=new ys(a.tagName);c.add(this.options.textNodeName,""),a.tagName!==a.tagExp&&a.attrExpPresent&&(c[":@"]=this.buildAttributesMap(a.tagExp,n,a.tagName)),this.addChild(r,c,n)}i=a.closeIndex+1}else if(t.substr(i+1,3)==="!--"){const a=yr(t,"-->",i+4,"Comment is not closed.");if(this.options.commentPropName){const c=t.substring(i+4,a-2);s=this.saveTextToParentTag(s,r,n),r.add(this.options.commentPropName,[{[this.options.textNodeName]:c}])}i=a}else if(t.substr(i+1,2)==="!D"){const a=vv(t,i);this.docTypeEntities=a.entities,i=a.i}else if(t.substr(i+1,2)==="!["){const a=yr(t,"]]>",i,"CDATA is not closed.")-2,c=t.substring(i+9,a);if(s=this.saveTextToParentTag(s,r,n),this.options.cdataPropName)r.add(this.options.cdataPropName,[{[this.options.textNodeName]:c}]);else{let l=this.parseTextData(c,r.tagname,n,!0,!1,!0);l==null&&(l=""),r.add(this.options.textNodeName,l)}i=a+2}else{let a=Oa(t,i,this.options.removeNSPrefix),c=a.tagName,l=a.tagExp,u=a.attrExpPresent,d=a.closeIndex;this.options.transformTagName&&(c=this.options.transformTagName(c)),r&&s&&r.tagname!=="!xml"&&(s=this.saveTextToParentTag(s,r,n,!1));const h=r;if(h&&this.options.unpairedTags.indexOf(h.tagname)!==-1&&(r=this.tagsNodeStack.pop(),n=n.substring(0,n.lastIndexOf("."))),c!==e.tagname&&(n+=n?"."+c:c),this.isItStopNode(this.options.stopNodes,n,c)){let m="";if(l.length>0&&l.lastIndexOf("/")===l.length-1)i=a.closeIndex;else if(this.options.unpairedTags.indexOf(c)!==-1)i=a.closeIndex;else{const p=this.readStopNodeData(t,c,d+1);if(!p)throw new Error(`Unexpected end of ${c}`);i=p.i,m=p.tagContent}const g=new ys(c);c!==l&&u&&(g[":@"]=this.buildAttributesMap(l,n,c)),m&&(m=this.parseTextData(m,c,n,!0,u,!0,!0)),n=n.substr(0,n.lastIndexOf(".")),g.add(this.options.textNodeName,m),this.addChild(r,g,n)}else{if(l.length>0&&l.lastIndexOf("/")===l.length-1){c[c.length-1]==="/"?(c=c.substr(0,c.length-1),l=c):l=l.substr(0,l.length-1),this.options.transformTagName&&(c=this.options.transformTagName(c));const m=new ys(c);c!==l&&u&&(m[":@"]=this.buildAttributesMap(l,n,c)),this.addChild(r,m,n),n=n.substr(0,n.lastIndexOf("."))}else{const m=new ys(c);this.tagsNodeStack.push(r),c!==l&&u&&(m[":@"]=this.buildAttributesMap(l,n,c)),this.addChild(r,m,n),r=m}s="",i=d}}else s+=t[i];return e.child};function Ov(t,e,r){const s=this.options.updateTag(e.tagname,r,e[":@"]);s===!1||(typeof s=="string"&&(e.tagname=s),t.addChild(e))}const Pv=function(t){if(this.options.processEntities){for(let e in this.docTypeEntities){const r=this.docTypeEntities[e];t=t.replace(r.regx,r.val)}for(let e in this.lastEntities){const r=this.lastEntities[e];t=t.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){const r=this.htmlEntities[e];t=t.replace(r.regex,r.val)}t=t.replace(this.ampEntity.regex,this.ampEntity.val)}return t};function Iv(t,e,r,s){return t&&(s===void 0&&(s=Object.keys(e.child).length===0),t=this.parseTextData(t,e.tagname,r,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,s),t!==void 0&&t!==""&&e.add(this.options.textNodeName,t),t=""),t}function Bv(t,e,r){const s="*."+r;for(const n in t){const i=t[n];if(s===i||e===i)return!0}return!1}function Nv(t,e,r=">"){let s,n="";for(let i=e;i<t.length;i++){let o=t[i];if(s)o===s&&(s="");else if(o==='"'||o==="'")s=o;else if(o===r[0])if(r[1]){if(t[i+1]===r[1])return{data:n,index:i}}else return{data:n,index:i};else o==="	"&&(o=" ");n+=o}}function yr(t,e,r,s){const n=t.indexOf(e,r);if(n===-1)throw new Error(s);return n+e.length-1}function Oa(t,e,r,s=">"){const n=Nv(t,e+1,s);if(!n)return;let i=n.data;const o=n.index,a=i.search(/\s/);let c=i,l=!0;if(a!==-1&&(c=i.substr(0,a).replace(/\s\s*$/,""),i=i.substr(a+1)),r){const u=c.indexOf(":");u!==-1&&(c=c.substr(u+1),l=c!==n.data.substr(u+1))}return{tagName:c,tagExp:i,closeIndex:o,attrExpPresent:l}}function Mv(t,e,r){const s=r;let n=1;for(;r<t.length;r++)if(t[r]==="<")if(t[r+1]==="/"){const i=yr(t,">",r,`${e} is not closed`);if(t.substring(r+2,i).trim()===e&&(n--,n===0))return{tagContent:t.substring(s,r),i};r=i}else if(t[r+1]==="?")r=yr(t,"?>",r+1,"StopNode is not closed.");else if(t.substr(r+1,3)==="!--")r=yr(t,"-->",r+3,"StopNode is not closed.");else if(t.substr(r+1,2)==="![")r=yr(t,"]]>",r,"StopNode is not closed.")-2;else{const i=Oa(t,r,">");i&&((i&&i.tagName)===e&&i.tagExp[i.tagExp.length-1]!=="/"&&n++,r=i.closeIndex)}}function Pa(t,e,r){if(e&&typeof t=="string"){const s=t.trim();return s==="true"?!0:s==="false"?!1:Ev(t,r)}else return mc.isExist(t)?t:""}var Dv=Sv,Sf={};function Fv(t,e){return xf(t,e)}function xf(t,e,r){let s;const n={};for(let i=0;i<t.length;i++){const o=t[i],a=$v(o);let c="";if(r===void 0?c=a:c=r+"."+a,a===e.textNodeName)s===void 0?s=o[a]:s+=""+o[a];else{if(a===void 0)continue;if(o[a]){let l=xf(o[a],e,c);const u=Uv(l,e);o[":@"]?Lv(l,o[":@"],c,e):Object.keys(l).length===1&&l[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?l=l[e.textNodeName]:Object.keys(l).length===0&&(e.alwaysCreateTextNode?l[e.textNodeName]="":l=""),n[a]!==void 0&&n.hasOwnProperty(a)?(Array.isArray(n[a])||(n[a]=[n[a]]),n[a].push(l)):e.isArray(a,c,u)?n[a]=[l]:n[a]=l}}}return typeof s=="string"?s.length>0&&(n[e.textNodeName]=s):s!==void 0&&(n[e.textNodeName]=s),n}function $v(t){const e=Object.keys(t);for(let r=0;r<e.length;r++){const s=e[r];if(s!==":@")return s}}function Lv(t,e,r,s){if(e){const n=Object.keys(e),i=n.length;for(let o=0;o<i;o++){const a=n[o];s.isArray(a,r+"."+a,!0,!0)?t[a]=[e[a]]:t[a]=e[a]}}}function Uv(t,e){const{textNodeName:r}=e,s=Object.keys(t).length;return!!(s===0||s===1&&(t[r]||typeof t[r]=="boolean"||t[r]===0))}Sf.prettify=Fv;const{buildOptions:jv}=gc,Hv=Dv,{prettify:qv}=Sf,zv=fc;let Kv=class{constructor(e){this.externalEntities={},this.options=jv(e)}parse(e,r){if(typeof e!="string")if(e.toString)e=e.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(r){r===!0&&(r={});const i=zv.validate(e,r);if(i!==!0)throw Error(`${i.err.msg}:${i.err.line}:${i.err.col}`)}const s=new Hv(this.options);s.addExternalEntities(this.externalEntities);const n=s.parseXml(e);return this.options.preserveOrder||n===void 0?n:qv(n,this.options)}addEntity(e,r){if(r.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(e.indexOf("&")!==-1||e.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(r==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=r}};var Vv=Kv;const Gv=`
`;function Wv(t,e){let r="";return e.format&&e.indentBy.length>0&&(r=Gv),Af(t,e,"",r)}function Af(t,e,r,s){let n="",i=!1;for(let o=0;o<t.length;o++){const a=t[o],c=Jv(a);let l="";if(r.length===0?l=c:l=`${r}.${c}`,c===e.textNodeName){let g=a[c];Xv(l,e)||(g=e.tagValueProcessor(c,g),g=Cf(g,e)),i&&(n+=s),n+=g,i=!1;continue}else if(c===e.cdataPropName){i&&(n+=s),n+=`<![CDATA[${a[c][0][e.textNodeName]}]]>`,i=!1;continue}else if(c===e.commentPropName){n+=s+`<!--${a[c][0][e.textNodeName]}-->`,i=!0;continue}else if(c[0]==="?"){const g=Su(a[":@"],e),p=c==="?xml"?"":s;let w=a[c][0][e.textNodeName];w=w.length!==0?" "+w:"",n+=p+`<${c}${w}${g}?>`,i=!0;continue}let u=s;u!==""&&(u+=e.indentBy);const d=Su(a[":@"],e),h=s+`<${c}${d}`,m=Af(a[c],e,l,u);e.unpairedTags.indexOf(c)!==-1?e.suppressUnpairedNode?n+=h+">":n+=h+"/>":(!m||m.length===0)&&e.suppressEmptyNode?n+=h+"/>":m&&m.endsWith(">")?n+=h+`>${m}${s}</${c}>`:(n+=h+">",m&&s!==""&&(m.includes("/>")||m.includes("</"))?n+=s+e.indentBy+m+s:n+=m,n+=`</${c}>`),i=!0}return n}function Jv(t){const e=Object.keys(t);for(let r=0;r<e.length;r++){const s=e[r];if(s!==":@")return s}}function Su(t,e){let r="";if(t&&!e.ignoreAttributes)for(let s in t){let n=e.attributeValueProcessor(s,t[s]);n=Cf(n,e),n===!0&&e.suppressBooleanAttributes?r+=` ${s.substr(e.attributeNamePrefix.length)}`:r+=` ${s.substr(e.attributeNamePrefix.length)}="${n}"`}return r}function Xv(t,e){t=t.substr(0,t.length-e.textNodeName.length-1);let r=t.substr(t.lastIndexOf(".")+1);for(let s in e.stopNodes)if(e.stopNodes[s]===t||e.stopNodes[s]==="*."+r)return!0;return!1}function Cf(t,e){if(t&&t.length>0&&e.processEntities)for(let r=0;r<e.entities.length;r++){const s=e.entities[r];t=t.replace(s.regex,s.val)}return t}var Yv=Wv;const Zv=Yv,Qv={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function Yt(t){this.options=Object.assign({},Qv,t),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=rE),this.processTextOrObjNode=eE,this.options.format?(this.indentate=tE,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}Yt.prototype.build=function(t){return this.options.preserveOrder?Zv(t,this.options):(Array.isArray(t)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(t={[this.options.arrayNodeName]:t}),this.j2x(t,0).val)};Yt.prototype.j2x=function(t,e){let r="",s="";for(let n in t)if(!(typeof t[n]>"u"))if(t[n]===null)n[0]==="?"?s+=this.indentate(e)+"<"+n+"?"+this.tagEndChar:s+=this.indentate(e)+"<"+n+"/"+this.tagEndChar;else if(t[n]instanceof Date)s+=this.buildTextValNode(t[n],n,"",e);else if(typeof t[n]!="object"){const i=this.isAttribute(n);if(i)r+=this.buildAttrPairStr(i,""+t[n]);else if(n===this.options.textNodeName){let o=this.options.tagValueProcessor(n,""+t[n]);s+=this.replaceEntitiesValue(o)}else s+=this.buildTextValNode(t[n],n,"",e)}else if(Array.isArray(t[n])){const i=t[n].length;let o="";for(let a=0;a<i;a++){const c=t[n][a];typeof c>"u"||(c===null?n[0]==="?"?s+=this.indentate(e)+"<"+n+"?"+this.tagEndChar:s+=this.indentate(e)+"<"+n+"/"+this.tagEndChar:typeof c=="object"?this.options.oneListGroup?o+=this.j2x(c,e+1).val:o+=this.processTextOrObjNode(c,n,e):o+=this.buildTextValNode(c,n,"",e))}this.options.oneListGroup&&(o=this.buildObjectNode(o,n,"",e)),s+=o}else if(this.options.attributesGroupName&&n===this.options.attributesGroupName){const i=Object.keys(t[n]),o=i.length;for(let a=0;a<o;a++)r+=this.buildAttrPairStr(i[a],""+t[n][i[a]])}else s+=this.processTextOrObjNode(t[n],n,e);return{attrStr:r,val:s}};Yt.prototype.buildAttrPairStr=function(t,e){return e=this.options.attributeValueProcessor(t,""+e),e=this.replaceEntitiesValue(e),this.options.suppressBooleanAttributes&&e==="true"?" "+t:" "+t+'="'+e+'"'};function eE(t,e,r){const s=this.j2x(t,r+1);return t[this.options.textNodeName]!==void 0&&Object.keys(t).length===1?this.buildTextValNode(t[this.options.textNodeName],e,s.attrStr,r):this.buildObjectNode(s.val,e,s.attrStr,r)}Yt.prototype.buildObjectNode=function(t,e,r,s){if(t==="")return e[0]==="?"?this.indentate(s)+"<"+e+r+"?"+this.tagEndChar:this.indentate(s)+"<"+e+r+this.closeTag(e)+this.tagEndChar;{let n="</"+e+this.tagEndChar,i="";return e[0]==="?"&&(i="?",n=""),r&&t.indexOf("<")===-1?this.indentate(s)+"<"+e+r+i+">"+t+n:this.options.commentPropName!==!1&&e===this.options.commentPropName&&i.length===0?this.indentate(s)+`<!--${t}-->`+this.newLine:this.indentate(s)+"<"+e+r+i+this.tagEndChar+t+this.indentate(s)+n}};Yt.prototype.closeTag=function(t){let e="";return this.options.unpairedTags.indexOf(t)!==-1?this.options.suppressUnpairedNode||(e="/"):this.options.suppressEmptyNode?e="/":e=`></${t}`,e};Yt.prototype.buildTextValNode=function(t,e,r,s){if(this.options.cdataPropName!==!1&&e===this.options.cdataPropName)return this.indentate(s)+`<![CDATA[${t}]]>`+this.newLine;if(this.options.commentPropName!==!1&&e===this.options.commentPropName)return this.indentate(s)+`<!--${t}-->`+this.newLine;if(e[0]==="?")return this.indentate(s)+"<"+e+r+"?"+this.tagEndChar;{let n=this.options.tagValueProcessor(e,t);return n=this.replaceEntitiesValue(n),n===""?this.indentate(s)+"<"+e+r+this.closeTag(e)+this.tagEndChar:this.indentate(s)+"<"+e+r+">"+n+"</"+e+this.tagEndChar}};Yt.prototype.replaceEntitiesValue=function(t){if(t&&t.length>0&&this.options.processEntities)for(let e=0;e<this.options.entities.length;e++){const r=this.options.entities[e];t=t.replace(r.regex,r.val)}return t};function tE(t){return this.options.indentBy.repeat(t)}function rE(t){return t.startsWith(this.options.attributeNamePrefix)?t.substr(this.attrPrefixLen):!1}var sE=Yt;const nE=fc,iE=Vv,oE=sE;var aE={XMLParser:iE,XMLValidator:nE,XMLBuilder:oE};const yc=(t,e)=>V_(t,e).then(r=>{if(r.length){const s=new aE.XMLParser({attributeNamePrefix:"",htmlEntities:!0,ignoreAttributes:!1,ignoreDeclaration:!0,parseTagValue:!1,trimValues:!1,tagValueProcessor:(c,l)=>l.trim()===""&&l.includes(`
`)?"":void 0});s.addEntity("#xD","\r"),s.addEntity("#10",`
`);let n;try{n=s.parse(r)}catch(c){throw c&&typeof c=="object"&&Object.defineProperty(c,"$responseBodyText",{value:r}),c}const i="#text",o=Object.keys(n)[0],a=n[o];return a[i]&&(a[o]=a[i],delete a[i]),qh(a)}return{}}),cE=async(t,e)=>{const r=await yc(t,e);return r.Error&&(r.Error.message=r.Error.message??r.Error.Message),r},lE=(t,e)=>{var r;if(((r=e==null?void 0:e.Error)==null?void 0:r.Code)!==void 0)return e.Error.Code;if((e==null?void 0:e.Code)!==void 0)return e.Code;if(t.statusCode==404)return"NotFound"};class wc extends ot{constructor(e){super({name:"ObjectAlreadyInActiveTierError",$fault:"client",...e}),this.name="ObjectAlreadyInActiveTierError",this.$fault="client",Object.setPrototypeOf(this,wc.prototype)}}var xu;(function(t){t.visit=(e,r)=>e.Records!==void 0?r.Records(e.Records):e.Stats!==void 0?r.Stats(e.Stats):e.Progress!==void 0?r.Progress(e.Progress):e.Cont!==void 0?r.Cont(e.Cont):e.End!==void 0?r.End(e.End):r._(e.$unknown[0],e.$unknown[1])})(xu||(xu={}));const uE=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:mt},...t.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:mt}}),dE=t=>({...t,...t.SSECustomerKey&&{SSECustomerKey:mt},...t.SSEKMSKeyId&&{SSEKMSKeyId:mt},...t.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:mt}}),hE=async(t,e)=>{const r=sn(t,e),s=ue({},Ve,{[SS]:t[tS]});r.bp("/"),r.p("Bucket",()=>t.Bucket,"{Bucket}",!1);const n=ue({[bS]:[,""]});return r.m("GET").h(s).q(n).b(void 0),r.build()},fE=async(t,e)=>{const r=sn(t,e),s=ue({},Ve,{[Hf]:t[Pf],[qf]:[()=>Ve(t[Gn]),()=>zr(t[Gn]).toString()],[zf]:t[If],[Kf]:[()=>Ve(t[Wn]),()=>zr(t[Wn]).toString()],[Gf]:t[Df],[ss]:t[ts],[$c]:t[Cc],[ns]:t[rs],[ki]:t[wi],[Ai]:t[mi],[Jf]:t[Rf]});r.bp("/{Key+}"),r.p("Bucket",()=>t.Bucket,"{Bucket}",!1),r.p("Key",()=>t.Key,"{Key+}",!0);const n=ue({[Qf]:[,"GetObject"],[fS]:[,t[JE]],[pS]:[,t[XE]],[gS]:[,t[YE]],[mS]:[,t[ZE]],[yS]:[,t[QE]],[wS]:[()=>t.ResponseExpires!==void 0,()=>zr(t[eS]).toString()],[Wf]:[,t[on]],[Vf]:[()=>t.PartNumber!==void 0,()=>t[Mf].toString()]});return r.m("GET").h(s).q(n).b(void 0),r.build()},pE=async(t,e)=>{const r=sn(t,e),s=ue({},Ve,{[Hf]:t[Pf],[qf]:[()=>Ve(t[Gn]),()=>zr(t[Gn]).toString()],[zf]:t[If],[Kf]:[()=>Ve(t[Wn]),()=>zr(t[Wn]).toString()],[Gf]:t[Df],[ss]:t[ts],[$c]:t[Cc],[ns]:t[rs],[ki]:t[wi],[Ai]:t[mi],[Jf]:t[Rf]});r.bp("/{Key+}"),r.p("Bucket",()=>t.Bucket,"{Bucket}",!1),r.p("Key",()=>t.Key,"{Key+}",!0);const n=ue({[Wf]:[,t[on]],[Vf]:[()=>t.PartNumber!==void 0,()=>t[Mf].toString()]});return r.m("HEAD").h(s).q(n).b(void 0),r.build()},gE=async(t,e)=>{const r=sn(t,e),s=ue({},Ve,{[ki]:t[wi],[Ai]:t[mi],[RS]:[()=>Ve(t[Au]),()=>(t[Au]||[]).map(o=>o).join(", ")]});r.bp("/"),r.p("Bucket",()=>t.Bucket,"{Bucket}",!1);const n=ue({[uS]:[,"2"],[aS]:[,t[In]],[cS]:[,t[Bn]],[dS]:[()=>t.MaxKeys!==void 0,()=>t[Nn].toString()],[hS]:[,t[_r]],[oS]:[,t[Pn]],[lS]:[()=>t.FetchOwner!==void 0,()=>t[zE].toString()],[_S]:[,t[Mn]]});return r.m("GET").h(s).q(n).b(void 0),r.build()},mE=async(t,e)=>{const r=sn(t,e),s=ue({},Ve,{[Ic]:t[Sc]||"application/octet-stream",[vS]:t[UE],[Rc]:t[bc],[Tc]:t[_c],[Oc]:t[vc],[Pc]:t[Ec],[Ws]:[()=>Ve(t[Kn]),()=>t[Kn].toString()],[nS]:t[HE],[TS]:t[Ns],[vi]:t[hi],[Ei]:t[fi],[Si]:t[pi],[xi]:t[gi],[Js]:[()=>Ve(t[Vn]),()=>zr(t[Vn]).toString()],[xS]:t[KE],[AS]:t[VE],[CS]:t[GE],[kS]:t[WE],[Ri]:t[bi],[Fc]:t[Pt],[Uc]:t[kc],[ss]:t[ts],[$c]:t[Cc],[ns]:t[rs],[Ti]:t[_i],[Zf]:t[Lf],[Er]:[()=>Ve(t[Gs]),()=>t[Gs].toString()],[ki]:t[wi],[OS]:t[rS],[Dc]:t[Ac],[Xs]:[()=>Ve(t[Jn]),()=>(t[Jn].toISOString().split(".")[0]+"Z").toString()],[Mc]:t[xc],[Ai]:t[mi],...t.Metadata!==void 0&&Object.keys(t.Metadata).reduce((a,c)=>(a[`x-amz-meta-${c.toLowerCase()}`]=t.Metadata[c],a),{})});r.bp("/{Key+}"),r.p("Bucket",()=>t.Bucket,"{Bucket}",!1),r.p("Key",()=>t.Key,"{Key+}",!0);const n=ue({[Qf]:[,"PutObject"]});let i,o;return t.Body!==void 0&&(o=t.Body,i=o),r.m("PUT").h(s).q(n).b(i),r.build()},yE=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return nn(t,e);const r=ue({$metadata:Je(t)}),s=yt(Uh(await yc(t.body,e)),"body");return s[yo]!=null&&(r[yo]=LE(s[yo])),r},wE=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return nn(t,e);const r=ue({$metadata:Je(t),[Tf]:[()=>t.headers[Yn]!==void 0,()=>vr(t.headers[Yn])],[kf]:[,t.headers[Uf]],[Vr]:[,t.headers[Nc]],[$f]:[,t.headers[Xf]],[Ls]:[()=>t.headers[Xn]!==void 0,()=>yt(qs(t.headers[Xn]))],[Kn]:[()=>t.headers[Ws]!==void 0,()=>Za(t.headers[Ws])],[Kr]:[,t.headers[Bc]],[hi]:[,t.headers[vi]],[fi]:[,t.headers[Ei]],[pi]:[,t.headers[Si]],[gi]:[,t.headers[xi]],[Bf]:[()=>t.headers[Zn]!==void 0,()=>br(t.headers[Zn])],[on]:[,t.headers[Lc]],[bc]:[,t.headers[Rc]],[_c]:[,t.headers[Tc]],[vc]:[,t.headers[Oc]],[Ec]:[,t.headers[Pc]],[qE]:[,t.headers[iS]],[Sc]:[,t.headers[Ic]],[Vn]:[()=>t.headers[Js]!==void 0,()=>yt(qs(t.headers[Js]))],[Of]:[,t.headers[jf]],[kc]:[,t.headers[Uc]],[bi]:[,t.headers[Ri]],[ts]:[,t.headers[ss]],[rs]:[,t.headers[ns]],[_i]:[,t.headers[Ti]],[Gs]:[()=>t.headers[Er]!==void 0,()=>vr(t.headers[Er])],[Pt]:[,t.headers[Fc]],[yi]:[,t.headers[Ci]],[Ff]:[,t.headers[Yf]],[Nf]:[()=>t.headers[Qn]!==void 0,()=>br(t.headers[Qn])],[sS]:[()=>t.headers[Cu]!==void 0,()=>br(t.headers[Cu])],[Ac]:[,t.headers[Dc]],[Jn]:[()=>t.headers[Xs]!==void 0,()=>yt(Qs(t.headers[Xs]))],[xc]:[,t.headers[Mc]],Metadata:[,Object.keys(t.headers).filter(n=>n.startsWith("x-amz-meta-")).reduce((n,i)=>(n[i.substring(11)]=t.headers[i],n),{})]}),s=t.body;return e.sdkStreamMixin(s),r.Body=s,r},bE=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return nn(t,e);const r=ue({$metadata:Je(t),[Tf]:[()=>t.headers[Yn]!==void 0,()=>vr(t.headers[Yn])],[kf]:[,t.headers[Uf]],[Vr]:[,t.headers[Nc]],[$f]:[,t.headers[Xf]],[jE]:[,t.headers[ES]],[Ls]:[()=>t.headers[Xn]!==void 0,()=>yt(qs(t.headers[Xn]))],[Kn]:[()=>t.headers[Ws]!==void 0,()=>Za(t.headers[Ws])],[hi]:[,t.headers[vi]],[fi]:[,t.headers[Ei]],[pi]:[,t.headers[Si]],[gi]:[,t.headers[xi]],[Kr]:[,t.headers[Bc]],[Bf]:[()=>t.headers[Zn]!==void 0,()=>br(t.headers[Zn])],[on]:[,t.headers[Lc]],[bc]:[,t.headers[Rc]],[_c]:[,t.headers[Tc]],[vc]:[,t.headers[Oc]],[Ec]:[,t.headers[Pc]],[Sc]:[,t.headers[Ic]],[Vn]:[()=>t.headers[Js]!==void 0,()=>yt(qs(t.headers[Js]))],[Of]:[,t.headers[jf]],[kc]:[,t.headers[Uc]],[bi]:[,t.headers[Ri]],[ts]:[,t.headers[ss]],[rs]:[,t.headers[ns]],[_i]:[,t.headers[Ti]],[Gs]:[()=>t.headers[Er]!==void 0,()=>vr(t.headers[Er])],[Pt]:[,t.headers[Fc]],[yi]:[,t.headers[Ci]],[Ff]:[,t.headers[Yf]],[Nf]:[()=>t.headers[Qn]!==void 0,()=>br(t.headers[Qn])],[Ac]:[,t.headers[Dc]],[Jn]:[()=>t.headers[Xs]!==void 0,()=>yt(Qs(t.headers[Xs]))],[xc]:[,t.headers[Mc]],Metadata:[,Object.keys(t.headers).filter(s=>s.startsWith("x-amz-meta-")).reduce((s,n)=>(s[n.substring(11)]=t.headers[n],s),{})]});return await Xa(t.body,e),r},_E=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return nn(t,e);const r=ue({$metadata:Je(t),[yi]:[,t.headers[Ci]]}),s=yt(Uh(await yc(t.body,e)),"body");return s.CommonPrefixes===""?r[xn]=[]:s[xn]!=null&&(r[xn]=NE(ba(s[xn]))),s.Contents===""?r[An]=[]:s[An]!=null&&(r[An]=DE(ba(s[An]))),s[Pn]!=null&&(r[Pn]=xe(s[Pn])),s[In]!=null&&(r[In]=xe(s[In])),s[Bn]!=null&&(r[Bn]=xe(s[Bn])),s[vo]!=null&&(r[vo]=vr(s[vo])),s[So]!=null&&(r[So]=br(s[So])),s[Nn]!=null&&(r[Nn]=br(s[Nn])),s[xo]!=null&&(r[xo]=xe(s[xo])),s[Ao]!=null&&(r[Ao]=xe(s[Ao])),s[_r]!=null&&(r[_r]=xe(s[_r])),s[Mn]!=null&&(r[Mn]=xe(s[Mn])),r},vE=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return nn(t,e);const r=ue({$metadata:Je(t),[Vr]:[,t.headers[Nc]],[Kr]:[,t.headers[Bc]],[hi]:[,t.headers[vi]],[fi]:[,t.headers[Ei]],[pi]:[,t.headers[Si]],[gi]:[,t.headers[xi]],[bi]:[,t.headers[Ri]],[on]:[,t.headers[Lc]],[ts]:[,t.headers[ss]],[rs]:[,t.headers[ns]],[_i]:[,t.headers[Ti]],[Lf]:[,t.headers[Zf]],[Gs]:[()=>t.headers[Er]!==void 0,()=>vr(t.headers[Er])],[yi]:[,t.headers[Ci]]});return await Xa(t.body,e),r},nn=async(t,e)=>{const r={...t,body:await cE(t.body,e)},s=lE(t,r.body);switch(s){case"NoSuchUpload":case"com.amazonaws.s3#NoSuchUpload":throw await RE(r);case"ObjectNotInActiveTierError":case"com.amazonaws.s3#ObjectNotInActiveTierError":throw await PE(r);case"BucketAlreadyExists":case"com.amazonaws.s3#BucketAlreadyExists":throw await SE(r);case"BucketAlreadyOwnedByYou":case"com.amazonaws.s3#BucketAlreadyOwnedByYou":throw await xE(r);case"NoSuchBucket":case"com.amazonaws.s3#NoSuchBucket":throw await CE(r);case"InvalidObjectState":case"com.amazonaws.s3#InvalidObjectState":throw await AE(r);case"NoSuchKey":case"com.amazonaws.s3#NoSuchKey":throw await kE(r);case"NotFound":case"com.amazonaws.s3#NotFound":throw await TE(r);case"ObjectAlreadyInActiveTierError":case"com.amazonaws.s3#ObjectAlreadyInActiveTierError":throw await OE(r);default:const n=r.body;return EE({output:t,parsedBody:n,errorCode:s})}},EE=Y0(ot),SE=async(t,e)=>{const r=ue({});t.body;const s=new ac({$metadata:Je(t),...r});return At(s,t.body)},xE=async(t,e)=>{const r=ue({});t.body;const s=new cc({$metadata:Je(t),...r});return At(s,t.body)},AE=async(t,e)=>{const r=ue({}),s=t.body;s[mo]!=null&&(r[mo]=xe(s[mo])),s[Pt]!=null&&(r[Pt]=xe(s[Pt]));const n=new uc({$metadata:Je(t),...r});return At(n,t.body)},CE=async(t,e)=>{const r=ue({});t.body;const s=new lc({$metadata:Je(t),...r});return At(s,t.body)},kE=async(t,e)=>{const r=ue({});t.body;const s=new dc({$metadata:Je(t),...r});return At(s,t.body)},RE=async(t,e)=>{const r=ue({});t.body;const s=new ic({$metadata:Je(t),...r});return At(s,t.body)},TE=async(t,e)=>{const r=ue({});t.body;const s=new hc({$metadata:Je(t),...r});return At(s,t.body)},OE=async(t,e)=>{const r=ue({});t.body;const s=new wc({$metadata:Je(t),...r});return At(s,t.body)},PE=async(t,e)=>{const r=ue({});t.body;const s=new oc({$metadata:Je(t),...r});return At(s,t.body)},IE=(t,e)=>(t||[]).filter(r=>r!=null).map(r=>xe(r)),BE=(t,e)=>{const r={};return t[_r]!=null&&(r[_r]=xe(t[_r])),r},NE=(t,e)=>(t||[]).filter(r=>r!=null).map(r=>BE(r)),ME=(t,e)=>{const r={};return t[Eo]!=null&&(r[Eo]=xe(t[Eo])),t[Ls]!=null&&(r[Ls]=yt(Qs(t[Ls]))),t[Kr]!=null&&(r[Kr]=xe(t[Kr])),t.ChecksumAlgorithm===""?r[Ns]=[]:t[Ns]!=null&&(r[Ns]=IE(ba(t[Ns]))),t[Po]!=null&&(r[Po]=Za(t[Po])),t[Pt]!=null&&(r[Pt]=xe(t[Pt])),t[Co]!=null&&(r[Co]=FE(t[Co])),t[Ro]!=null&&(r[Ro]=$E(t[Ro])),r},DE=(t,e)=>(t||[]).filter(r=>r!=null).map(r=>ME(r)),FE=(t,e)=>{const r={};return t[wo]!=null&&(r[wo]=xe(t[wo])),t[bo]!=null&&(r[bo]=xe(t[bo])),r},$E=(t,e)=>{const r={};return t[_o]!=null&&(r[_o]=vr(t[_o])),t[ko]!=null&&(r[ko]=yt(Qs(t[ko]))),r},LE=(t,e)=>{const r={};return t[go]!=null&&(r[go]=xe(t[go])),t[To]!=null&&(r[To]=xe(t[To])),t[Oo]!=null&&(r[Oo]=xe(t[Oo])),t[Vr]!=null&&(r[Vr]=yt(Qs(t[Vr]))),r},Je=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),Ve=t=>t!=null&&t!==""&&(!Object.getOwnPropertyNames(t).includes("length")||t.length!=0)&&(!Object.getOwnPropertyNames(t).includes("size")||t.size!=0),UE="ACL",go="AccessKeyId",kf="AcceptRanges",jE="ArchiveStatus",mo="AccessTier",Gs="BucketKeyEnabled",yo="Credentials",Ns="ChecksumAlgorithm",bc="CacheControl",hi="ChecksumCRC32",fi="ChecksumCRC32C",_c="ContentDisposition",vc="ContentEncoding",Ec="ContentLanguage",Kn="ContentLength",Rf="ChecksumMode",HE="ContentMD5",xn="CommonPrefixes",qE="ContentRange",pi="ChecksumSHA1",gi="ChecksumSHA256",Sc="ContentType",Pn="ContinuationToken",An="Contents",In="Delimiter",Tf="DeleteMarker",wo="DisplayName",Vn="Expires",mi="ExpectedBucketOwner",Of="ExpiresString",Bn="EncodingType",Kr="ETag",Vr="Expiration",zE="FetchOwner",KE="GrantFullControl",VE="GrantRead",GE="GrantReadACP",WE="GrantWriteACP",bo="ID",Pf="IfMatch",Gn="IfModifiedSince",If="IfNoneMatch",_o="IsRestoreInProgress",vo="IsTruncated",Wn="IfUnmodifiedSince",Eo="Key",So="KeyCount",Ls="LastModified",Nn="MaxKeys",Bf="MissingMeta",xo="Name",Ao="NextContinuationToken",Co="Owner",xc="ObjectLockLegalHoldStatus",Ac="ObjectLockMode",Jn="ObjectLockRetainUntilDate",Au="OptionalObjectAttributes",_r="Prefix",Nf="PartsCount",Mf="PartNumber",Df="Range",yi="RequestCharged",JE="ResponseCacheControl",XE="ResponseContentDisposition",YE="ResponseContentEncoding",ZE="ResponseContentLanguage",QE="ResponseContentType",eS="ResponseExpires",ko="RestoreExpiryDate",wi="RequestPayer",Ff="ReplicationStatus",Ro="RestoreStatus",$f="Restore",Mn="StartAfter",To="SecretAccessKey",Pt="StorageClass",tS="SessionMode",bi="ServerSideEncryption",ts="SSECustomerAlgorithm",Cc="SSECustomerKey",rs="SSECustomerKeyMD5",Lf="SSEKMSEncryptionContext",_i="SSEKMSKeyId",Oo="SessionToken",Po="Size",rS="Tagging",sS="TagCount",on="VersionId",kc="WebsiteRedirectLocation",Uf="accept-ranges",Rc="cache-control",Tc="content-disposition",Oc="content-encoding",Pc="content-language",Ws="content-length",nS="content-md5",iS="content-range",Ic="content-type",oS="continuation-token",aS="delimiter",Js="expires",cS="encoding-type",Bc="etag",jf="expiresstring",lS="fetch-owner",Hf="if-match",qf="if-modified-since",zf="if-none-match",Kf="if-unmodified-since",Xn="last-modified",uS="list-type",dS="max-keys",Vf="partNumber",hS="prefix",Gf="range",fS="response-cache-control",pS="response-content-disposition",gS="response-content-encoding",mS="response-content-language",yS="response-content-type",wS="response-expires",bS="session",_S="start-after",Wf="versionId",vS="x-amz-acl",ES="x-amz-archive-status",vi="x-amz-checksum-crc32",Ei="x-amz-checksum-crc32c",Jf="x-amz-checksum-mode",Si="x-amz-checksum-sha1",xi="x-amz-checksum-sha256",SS="x-amz-create-session-mode",Yn="x-amz-delete-marker",Nc="x-amz-expiration",Ai="x-amz-expected-bucket-owner",xS="x-amz-grant-full-control",AS="x-amz-grant-read",CS="x-amz-grant-read-acp",kS="x-amz-grant-write-acp",Zn="x-amz-missing-meta",Qn="x-amz-mp-parts-count",Mc="x-amz-object-lock-legal-hold",Dc="x-amz-object-lock-mode",Xs="x-amz-object-lock-retain-until-date",RS="x-amz-optional-object-attributes",Xf="x-amz-restore",Ci="x-amz-request-charged",ki="x-amz-request-payer",Yf="x-amz-replication-status",Fc="x-amz-storage-class",TS="x-amz-sdk-checksum-algorithm",Ri="x-amz-server-side-encryption",Ti="x-amz-server-side-encryption-aws-kms-key-id",Er="x-amz-server-side-encryption-bucket-key-enabled",Zf="x-amz-server-side-encryption-context",ss="x-amz-server-side-encryption-customer-algorithm",$c="x-amz-server-side-encryption-customer-key",ns="x-amz-server-side-encryption-customer-key-md5",OS="x-amz-tagging",Cu="x-amz-tagging-count",Lc="x-amz-version-id",Uc="x-amz-website-redirect-location",Qf="x-id";class PS extends es.classBuilder().ep({...rn,DisableS3ExpressSessionAuth:{type:"staticContextParams",value:!0},Bucket:{type:"contextParams",name:"Bucket"}}).m(function(e,r,s,n){return[en(s,this.serialize,this.deserialize),tn(s,e.getEndpointParameterInstructions())]}).s("AmazonS3","CreateSession",{}).n("S3Client","CreateSessionCommand").f(void 0,U_).ser(hE).de(yE).build(){}const IS="@aws-sdk/client-s3",BS="AWS SDK for JavaScript S3 Client for Node.js, Browser and React Native",NS="3.529.1",MS={build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"node ../../scripts/compilation/inline client-s3","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo s3",test:"yarn test:unit","test:e2e":"yarn test:e2e:node && yarn test:e2e:browser","test:e2e:browser":"ts-mocha test/**/*.browser.ispec.ts && karma start karma.conf.js","test:e2e:node":"jest --c jest.config.e2e.js","test:unit":"ts-mocha test/unit/**/*.spec.ts"},DS="./dist-cjs/index.js",FS="./dist-types/index.d.ts",$S="./dist-es/index.js",LS=!1,US={"@aws-crypto/sha1-browser":"3.0.0","@aws-crypto/sha256-browser":"3.0.0","@aws-crypto/sha256-js":"3.0.0","@aws-sdk/client-sts":"3.529.1","@aws-sdk/core":"3.529.1","@aws-sdk/credential-provider-node":"3.529.1","@aws-sdk/middleware-bucket-endpoint":"3.525.0","@aws-sdk/middleware-expect-continue":"3.523.0","@aws-sdk/middleware-flexible-checksums":"3.523.0","@aws-sdk/middleware-host-header":"3.523.0","@aws-sdk/middleware-location-constraint":"3.523.0","@aws-sdk/middleware-logger":"3.523.0","@aws-sdk/middleware-recursion-detection":"3.523.0","@aws-sdk/middleware-sdk-s3":"3.525.0","@aws-sdk/middleware-signing":"3.523.0","@aws-sdk/middleware-ssec":"3.523.0","@aws-sdk/middleware-user-agent":"3.525.0","@aws-sdk/region-config-resolver":"3.525.0","@aws-sdk/signature-v4-multi-region":"3.525.0","@aws-sdk/types":"3.523.0","@aws-sdk/util-endpoints":"3.525.0","@aws-sdk/util-user-agent-browser":"3.523.0","@aws-sdk/util-user-agent-node":"3.525.0","@aws-sdk/xml-builder":"3.523.0","@smithy/config-resolver":"^2.1.4","@smithy/core":"^1.3.5","@smithy/eventstream-serde-browser":"^2.1.3","@smithy/eventstream-serde-config-resolver":"^2.1.3","@smithy/eventstream-serde-node":"^2.1.3","@smithy/fetch-http-handler":"^2.4.3","@smithy/hash-blob-browser":"^2.1.3","@smithy/hash-node":"^2.1.3","@smithy/hash-stream-node":"^2.1.3","@smithy/invalid-dependency":"^2.1.3","@smithy/md5-js":"^2.1.3","@smithy/middleware-content-length":"^2.1.3","@smithy/middleware-endpoint":"^2.4.4","@smithy/middleware-retry":"^2.1.4","@smithy/middleware-serde":"^2.1.3","@smithy/middleware-stack":"^2.1.3","@smithy/node-config-provider":"^2.2.4","@smithy/node-http-handler":"^2.4.1","@smithy/protocol-http":"^3.2.1","@smithy/smithy-client":"^2.4.2","@smithy/types":"^2.10.1","@smithy/url-parser":"^2.1.3","@smithy/util-base64":"^2.1.1","@smithy/util-body-length-browser":"^2.1.1","@smithy/util-body-length-node":"^2.2.1","@smithy/util-defaults-mode-browser":"^2.1.4","@smithy/util-defaults-mode-node":"^2.2.3","@smithy/util-endpoints":"^1.1.4","@smithy/util-retry":"^2.1.3","@smithy/util-stream":"^2.1.3","@smithy/util-utf8":"^2.1.1","@smithy/util-waiter":"^2.1.3",tslib:"^2.5.0"},jS={"@aws-sdk/signature-v4-crt":"3.525.0","@smithy/service-client-documentation-generator":"^2.1.1","@tsconfig/node14":"1.0.3","@types/chai":"^4.2.11","@types/mocha":"^8.0.4","@types/node":"^14.14.31",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~4.9.5"},HS={node:">=14.0.0"},qS={"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},zS=["dist-*/**"],KS={name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},VS="Apache-2.0",GS={"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},WS="https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-s3",JS={type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-s3"},XS={name:IS,description:BS,version:NS,scripts:MS,main:DS,types:FS,module:$S,sideEffects:LS,dependencies:US,devDependencies:jS,engines:HS,typesVersions:qS,files:zS,author:KS,license:VS,browser:GS,"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:WS,repository:JS};var ep={},ws={},bs={},_s={},ku;function tp(){if(ku)return _s;ku=1,Object.defineProperty(_s,"__esModule",{value:!0}),_s.isEmptyData=void 0;function t(e){return typeof e=="string"?e.length===0:e.byteLength===0}return _s.isEmptyData=t,_s}var Io={},Ru;function rp(){return Ru||(Ru=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_DATA_SHA_1=t.SHA_1_HMAC_ALGO=t.SHA_1_HASH=void 0,t.SHA_1_HASH={name:"SHA-1"},t.SHA_1_HMAC_ALGO={name:"HMAC",hash:t.SHA_1_HASH},t.EMPTY_DATA_SHA_1=new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9])}(Io)),Io}const YS={};function ZS(){return typeof window<"u"?window:typeof self<"u"?self:YS}const QS=Object.freeze(Object.defineProperty({__proto__:null,locateWindow:ZS},Symbol.toStringTag,{value:"Module"})),is=La(QS);var Tu;function sp(){if(Tu)return bs;Tu=1,Object.defineProperty(bs,"__esModule",{value:!0}),bs.Sha1=void 0;var t=tp(),e=rp(),r=li,s=is,n=function(){function a(c){this.secret=c,this.reset()}return a.prototype.update=function(c){var l=this;(0,t.isEmptyData)(c)||(this.operation=this.operation.then(function(u){return u.onerror=function(){l.operation=Promise.reject(new Error("Error encountered updating hash"))},u.process(o(c)),u}),this.operation.catch(function(){}))},a.prototype.digest=function(){return this.operation.then(function(c){return new Promise(function(l,u){c.onerror=function(){u(new Error("Error encountered finalizing hash"))},c.oncomplete=function(){c.result&&l(new Uint8Array(c.result)),u(new Error("Error encountered finalizing hash"))},c.finish()})})},a.prototype.reset=function(){this.secret?(this.operation=i(this.secret).then(function(c){return(0,s.locateWindow)().msCrypto.subtle.sign(e.SHA_1_HMAC_ALGO,c)}),this.operation.catch(function(){})):this.operation=Promise.resolve((0,s.locateWindow)().msCrypto.subtle.digest("SHA-1"))},a}();bs.Sha1=n;function i(a){return new Promise(function(c,l){var u=(0,s.locateWindow)().msCrypto.subtle.importKey("raw",o(a),e.SHA_1_HMAC_ALGO,!1,["sign"]);u.oncomplete=function(){u.result&&c(u.result),l(new Error("ImportKey completed without importing key."))},u.onerror=function(){l(new Error("ImportKey failed to import key."))}})}function o(a){return typeof a=="string"?(0,r.fromUtf8)(a):ArrayBuffer.isView(a)?new Uint8Array(a.buffer,a.byteOffset,a.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(a)}return bs}var vs={},Ou;function np(){if(Ou)return vs;Ou=1,Object.defineProperty(vs,"__esModule",{value:!0}),vs.Sha1=void 0;var t=li,e=tp(),r=rp(),s=is,n=function(){function o(a){this.toHash=new Uint8Array(0),a!==void 0&&(this.key=new Promise(function(c,l){(0,s.locateWindow)().crypto.subtle.importKey("raw",i(a),r.SHA_1_HMAC_ALGO,!1,["sign"]).then(c,l)}),this.key.catch(function(){}))}return o.prototype.update=function(a){if(!(0,e.isEmptyData)(a)){var c=i(a),l=new Uint8Array(this.toHash.byteLength+c.byteLength);l.set(this.toHash,0),l.set(c,this.toHash.byteLength),this.toHash=l}},o.prototype.digest=function(){var a=this;return this.key?this.key.then(function(c){return(0,s.locateWindow)().crypto.subtle.sign(r.SHA_1_HMAC_ALGO,c,a.toHash).then(function(l){return new Uint8Array(l)})}):(0,e.isEmptyData)(this.toHash)?Promise.resolve(r.EMPTY_DATA_SHA_1):Promise.resolve().then(function(){return(0,s.locateWindow)().crypto.subtle.digest(r.SHA_1_HASH,a.toHash)}).then(function(c){return Promise.resolve(new Uint8Array(c))})},o.prototype.reset=function(){this.toHash=new Uint8Array(0)},o}();vs.Sha1=n;function i(o){return typeof o=="string"?(0,t.fromUtf8)(o):ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(o)}return vs}var Bo={},dt={},Pu;function e1(){if(Pu)return dt;Pu=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.supportsZeroByteGCM=dt.supportsSubtleCrypto=dt.supportsSecureRandom=dt.supportsWebCrypto=void 0;var t=bt,e=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function r(o){if(s(o)&&typeof o.crypto.subtle=="object"){var a=o.crypto.subtle;return n(a)}return!1}dt.supportsWebCrypto=r;function s(o){if(typeof o=="object"&&typeof o.crypto=="object"){var a=o.crypto.getRandomValues;return typeof a=="function"}return!1}dt.supportsSecureRandom=s;function n(o){return o&&e.every(function(a){return typeof o[a]=="function"})}dt.supportsSubtleCrypto=n;function i(o){return t.__awaiter(this,void 0,void 0,function(){var a,c;return t.__generator(this,function(l){switch(l.label){case 0:if(!n(o))return[2,!1];l.label=1;case 1:return l.trys.push([1,4,,5]),[4,o.generateKey({name:"AES-GCM",length:128},!1,["encrypt"])];case 2:return a=l.sent(),[4,o.encrypt({name:"AES-GCM",iv:new Uint8Array(Array(12)),additionalData:new Uint8Array(Array(16)),tagLength:128},a,new Uint8Array(0))];case 3:return c=l.sent(),[2,c.byteLength===16];case 4:return l.sent(),[2,!1];case 5:return[2]}})})}return dt.supportsZeroByteGCM=i,dt}var Iu;function ip(){return Iu||(Iu=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=bt;e.__exportStar(e1(),t)}(Bo)),Bo}var No={},Mo={},Bu;function t1(){return Bu||(Bu=1,Object.defineProperty(Mo,"__esModule",{value:!0})),Mo}var Do={},Nu;function r1(){return Nu||(Nu=1,Object.defineProperty(Do,"__esModule",{value:!0})),Do}var Fo={},Mu;function s1(){return Mu||(Mu=1,Object.defineProperty(Fo,"__esModule",{value:!0})),Fo}var $o={},Du;function n1(){return Du||(Du=1,Object.defineProperty($o,"__esModule",{value:!0})),$o}var Es={},Fu;function i1(){if(Fu)return Es;Fu=1,Object.defineProperty(Es,"__esModule",{value:!0}),Es.isMsWindow=void 0;var t=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function e(s){return"MSInputMethodContext"in s&&"msCrypto"in s}function r(s){if(e(s)&&s.msCrypto.subtle!==void 0){var n=s.msCrypto,i=n.getRandomValues,o=n.subtle;return t.map(function(a){return o[a]}).concat(i).every(function(a){return typeof a=="function"})}return!1}return Es.isMsWindow=r,Es}var $u;function op(){return $u||($u=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=bt;e.__exportStar(t1(),t),e.__exportStar(r1(),t),e.__exportStar(s1(),t),e.__exportStar(n1(),t),e.__exportStar(i1(),t)}(No)),No}var Lu;function o1(){if(Lu)return ws;Lu=1,Object.defineProperty(ws,"__esModule",{value:!0}),ws.Sha1=void 0;var t=sp(),e=np(),r=ip(),s=op(),n=is,i=Xt(),o=function(){function a(c){if((0,r.supportsWebCrypto)((0,n.locateWindow)()))this.hash=new e.Sha1(c);else if((0,s.isMsWindow)((0,n.locateWindow)()))this.hash=new t.Sha1(c);else throw new Error("SHA1 not supported")}return a.prototype.update=function(c,l){this.hash.update((0,i.convertToBuffer)(c))},a.prototype.digest=function(){return this.hash.digest()},a.prototype.reset=function(){this.hash.reset()},a}();return ws.Sha1=o,ws}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.WebCryptoSha1=t.Ie11Sha1=void 0;var e=bt;e.__exportStar(o1(),t);var r=sp();Object.defineProperty(t,"Ie11Sha1",{enumerable:!0,get:function(){return r.Sha1}});var s=np();Object.defineProperty(t,"WebCryptoSha1",{enumerable:!0,get:function(){return s.Sha1}})})(ep);var ap={},Ss={},xs={},As={},Uu;function a1(){if(Uu)return As;Uu=1,Object.defineProperty(As,"__esModule",{value:!0}),As.isEmptyData=void 0;function t(e){return typeof e=="string"?e.length===0:e.byteLength===0}return As.isEmptyData=t,As}var Lo={},ju;function cp(){return ju||(ju=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_DATA_SHA_256=t.SHA_256_HMAC_ALGO=t.SHA_256_HASH=void 0,t.SHA_256_HASH={name:"SHA-256"},t.SHA_256_HMAC_ALGO={name:"HMAC",hash:t.SHA_256_HASH},t.EMPTY_DATA_SHA_256=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85])}(Lo)),Lo}var Hu;function lp(){if(Hu)return xs;Hu=1,Object.defineProperty(xs,"__esModule",{value:!0}),xs.Sha256=void 0;var t=a1(),e=cp(),r=li,s=is,n=function(){function a(c){this.secret=c,this.reset()}return a.prototype.update=function(c){var l=this;(0,t.isEmptyData)(c)||(this.operation=this.operation.then(function(u){return u.onerror=function(){l.operation=Promise.reject(new Error("Error encountered updating hash"))},u.process(o(c)),u}),this.operation.catch(function(){}))},a.prototype.digest=function(){return this.operation.then(function(c){return new Promise(function(l,u){c.onerror=function(){u(new Error("Error encountered finalizing hash"))},c.oncomplete=function(){c.result&&l(new Uint8Array(c.result)),u(new Error("Error encountered finalizing hash"))},c.finish()})})},a.prototype.reset=function(){this.secret?(this.operation=i(this.secret).then(function(c){return(0,s.locateWindow)().msCrypto.subtle.sign(e.SHA_256_HMAC_ALGO,c)}),this.operation.catch(function(){})):this.operation=Promise.resolve((0,s.locateWindow)().msCrypto.subtle.digest("SHA-256"))},a}();xs.Sha256=n;function i(a){return new Promise(function(c,l){var u=(0,s.locateWindow)().msCrypto.subtle.importKey("raw",o(a),e.SHA_256_HMAC_ALGO,!1,["sign"]);u.oncomplete=function(){u.result&&c(u.result),l(new Error("ImportKey completed without importing key."))},u.onerror=function(){l(new Error("ImportKey failed to import key."))}})}function o(a){return typeof a=="string"?(0,r.fromUtf8)(a):ArrayBuffer.isView(a)?new Uint8Array(a.buffer,a.byteOffset,a.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(a)}return xs}var Cs={},qu;function up(){if(qu)return Cs;qu=1,Object.defineProperty(Cs,"__esModule",{value:!0}),Cs.Sha256=void 0;var t=Xt(),e=cp(),r=is,s=function(){function n(i){this.toHash=new Uint8Array(0),this.secret=i,this.reset()}return n.prototype.update=function(i){if(!(0,t.isEmptyData)(i)){var o=(0,t.convertToBuffer)(i),a=new Uint8Array(this.toHash.byteLength+o.byteLength);a.set(this.toHash,0),a.set(o,this.toHash.byteLength),this.toHash=a}},n.prototype.digest=function(){var i=this;return this.key?this.key.then(function(o){return(0,r.locateWindow)().crypto.subtle.sign(e.SHA_256_HMAC_ALGO,o,i.toHash).then(function(a){return new Uint8Array(a)})}):(0,t.isEmptyData)(this.toHash)?Promise.resolve(e.EMPTY_DATA_SHA_256):Promise.resolve().then(function(){return(0,r.locateWindow)().crypto.subtle.digest(e.SHA_256_HASH,i.toHash)}).then(function(o){return Promise.resolve(new Uint8Array(o))})},n.prototype.reset=function(){var i=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(o,a){(0,r.locateWindow)().crypto.subtle.importKey("raw",(0,t.convertToBuffer)(i.secret),e.SHA_256_HMAC_ALGO,!1,["sign"]).then(o,a)}),this.key.catch(function(){}))},n}();return Cs.Sha256=s,Cs}var Uo={},ks={},Ze={},zu;function dp(){return zu||(zu=1,Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.MAX_HASHABLE_LENGTH=Ze.INIT=Ze.KEY=Ze.DIGEST_LENGTH=Ze.BLOCK_SIZE=void 0,Ze.BLOCK_SIZE=64,Ze.DIGEST_LENGTH=32,Ze.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ze.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Ze.MAX_HASHABLE_LENGTH=Math.pow(2,53)-1),Ze}var Rs={},Ku;function c1(){if(Ku)return Rs;Ku=1,Object.defineProperty(Rs,"__esModule",{value:!0}),Rs.RawSha256=void 0;var t=dp(),e=function(){function r(){this.state=Int32Array.from(t.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return r.prototype.update=function(s){if(this.finished)throw new Error("Attempted to update an already finished hash.");var n=0,i=s.byteLength;if(this.bytesHashed+=i,this.bytesHashed*8>t.MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;i>0;)this.buffer[this.bufferLength++]=s[n++],i--,this.bufferLength===t.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},r.prototype.digest=function(){if(!this.finished){var s=this.bytesHashed*8,n=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),i=this.bufferLength;if(n.setUint8(this.bufferLength++,128),i%t.BLOCK_SIZE>=t.BLOCK_SIZE-8){for(var o=this.bufferLength;o<t.BLOCK_SIZE;o++)n.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(var o=this.bufferLength;o<t.BLOCK_SIZE-8;o++)n.setUint8(o,0);n.setUint32(t.BLOCK_SIZE-8,Math.floor(s/4294967296),!0),n.setUint32(t.BLOCK_SIZE-4,s),this.hashBuffer(),this.finished=!0}for(var a=new Uint8Array(t.DIGEST_LENGTH),o=0;o<8;o++)a[o*4]=this.state[o]>>>24&255,a[o*4+1]=this.state[o]>>>16&255,a[o*4+2]=this.state[o]>>>8&255,a[o*4+3]=this.state[o]>>>0&255;return a},r.prototype.hashBuffer=function(){for(var s=this,n=s.buffer,i=s.state,o=i[0],a=i[1],c=i[2],l=i[3],u=i[4],d=i[5],h=i[6],m=i[7],g=0;g<t.BLOCK_SIZE;g++){if(g<16)this.temp[g]=(n[g*4]&255)<<24|(n[g*4+1]&255)<<16|(n[g*4+2]&255)<<8|n[g*4+3]&255;else{var p=this.temp[g-2],w=(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10;p=this.temp[g-15];var E=(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3;this.temp[g]=(w+this.temp[g-7]|0)+(E+this.temp[g-16]|0)}var C=(((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&d^~u&h)|0)+(m+(t.KEY[g]+this.temp[g]|0)|0)|0,R=((o>>>2|o<<30)^(o>>>13|o<<19)^(o>>>22|o<<10))+(o&a^o&c^a&c)|0;m=h,h=d,d=u,u=l+C|0,l=c,c=a,a=o,o=C+R|0}i[0]+=o,i[1]+=a,i[2]+=c,i[3]+=l,i[4]+=u,i[5]+=d,i[6]+=h,i[7]+=m},r}();return Rs.RawSha256=e,Rs}var Vu;function l1(){if(Vu)return ks;Vu=1,Object.defineProperty(ks,"__esModule",{value:!0}),ks.Sha256=void 0;var t=bt,e=dp(),r=c1(),s=Xt(),n=function(){function o(a){this.secret=a,this.hash=new r.RawSha256,this.reset()}return o.prototype.update=function(a){if(!((0,s.isEmptyData)(a)||this.error))try{this.hash.update((0,s.convertToBuffer)(a))}catch(c){this.error=c}},o.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},o.prototype.digest=function(){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(a){return[2,this.digestSync()]})})},o.prototype.reset=function(){if(this.hash=new r.RawSha256,this.secret){this.outer=new r.RawSha256;var a=i(this.secret),c=new Uint8Array(e.BLOCK_SIZE);c.set(a);for(var l=0;l<e.BLOCK_SIZE;l++)a[l]^=54,c[l]^=92;this.hash.update(a),this.outer.update(c);for(var l=0;l<a.byteLength;l++)a[l]=0}},o}();ks.Sha256=n;function i(o){var a=(0,s.convertToBuffer)(o);if(a.byteLength>e.BLOCK_SIZE){var c=new r.RawSha256;c.update(a),a=c.digest()}var l=new Uint8Array(e.BLOCK_SIZE);return l.set(a),l}return ks}var Gu;function u1(){return Gu||(Gu=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=bt;e.__exportStar(l1(),t)}(Uo)),Uo}var Wu;function d1(){if(Wu)return Ss;Wu=1,Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.Sha256=void 0;var t=lp(),e=up(),r=u1(),s=ip(),n=op(),i=is,o=Xt(),a=function(){function c(l){(0,s.supportsWebCrypto)((0,i.locateWindow)())?this.hash=new e.Sha256(l):(0,n.isMsWindow)((0,i.locateWindow)())?this.hash=new t.Sha256(l):this.hash=new r.Sha256(l)}return c.prototype.update=function(l,u){this.hash.update((0,o.convertToBuffer)(l))},c.prototype.digest=function(){return this.hash.digest()},c.prototype.reset=function(){this.hash.reset()},c}();return Ss.Sha256=a,Ss}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.WebCryptoSha256=t.Ie11Sha256=void 0;var e=bt;e.__exportStar(d1(),t);var r=lp();Object.defineProperty(t,"Ie11Sha256",{enumerable:!0,get:function(){return r.Sha256}});var s=up();Object.defineProperty(t,"WebCryptoSha256",{enumerable:!0,get:function(){return s.Sha256}})})(ap);const h1={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},hp={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},me={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},Ue={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},Ut={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class v{static getFirstMatch(e,r){const s=r.match(e);return s&&s.length>0&&s[1]||""}static getSecondMatch(e,r){const s=r.match(e);return s&&s.length>1&&s[2]||""}static matchAndReturnConst(e,r,s){if(e.test(r))return s}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const r=e.split(".").splice(0,2).map(s=>parseInt(s,10)||0);if(r.push(0),r[0]===10)switch(r[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const r=e.split(".").splice(0,2).map(s=>parseInt(s,10)||0);if(r.push(0),!(r[0]===1&&r[1]<5)){if(r[0]===1&&r[1]<6)return"Cupcake";if(r[0]===1&&r[1]>=6)return"Donut";if(r[0]===2&&r[1]<2)return"Eclair";if(r[0]===2&&r[1]===2)return"Froyo";if(r[0]===2&&r[1]>2)return"Gingerbread";if(r[0]===3)return"Honeycomb";if(r[0]===4&&r[1]<1)return"Ice Cream Sandwich";if(r[0]===4&&r[1]<4)return"Jelly Bean";if(r[0]===4&&r[1]>=4)return"KitKat";if(r[0]===5)return"Lollipop";if(r[0]===6)return"Marshmallow";if(r[0]===7)return"Nougat";if(r[0]===8)return"Oreo";if(r[0]===9)return"Pie"}}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,r,s=!1){const n=v.getVersionPrecision(e),i=v.getVersionPrecision(r);let o=Math.max(n,i),a=0;const c=v.map([e,r],l=>{const u=o-v.getVersionPrecision(l),d=l+new Array(u+1).join(".0");return v.map(d.split("."),h=>new Array(20-h.length).join("0")+h).reverse()});for(s&&(a=o-Math.min(n,i)),o-=1;o>=a;){if(c[0][o]>c[1][o])return 1;if(c[0][o]===c[1][o]){if(o===a)return 0;o-=1}else if(c[0][o]<c[1][o])return-1}}static map(e,r){const s=[];let n;if(Array.prototype.map)return Array.prototype.map.call(e,r);for(n=0;n<e.length;n+=1)s.push(r(e[n]));return s}static find(e,r){let s,n;if(Array.prototype.find)return Array.prototype.find.call(e,r);for(s=0,n=e.length;s<n;s+=1){const i=e[s];if(r(i,s))return i}}static assign(e,...r){const s=e;let n,i;if(Object.assign)return Object.assign(e,...r);for(n=0,i=r.length;n<i;n+=1){const o=r[n];typeof o=="object"&&o!==null&&Object.keys(o).forEach(c=>{s[c]=o[c]})}return e}static getBrowserAlias(e){return h1[e]}static getBrowserTypeByAlias(e){return hp[e]||""}}const se=/version\/(\d+(\.?_?\d+)+)/i,f1=[{test:[/googlebot/i],describe(t){const e={name:"Googlebot"},r=v.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/opera/i],describe(t){const e={name:"Opera"},r=v.getFirstMatch(se,t)||v.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/opr\/|opios/i],describe(t){const e={name:"Opera"},r=v.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/SamsungBrowser/i],describe(t){const e={name:"Samsung Internet for Android"},r=v.getFirstMatch(se,t)||v.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/Whale/i],describe(t){const e={name:"NAVER Whale Browser"},r=v.getFirstMatch(se,t)||v.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/MZBrowser/i],describe(t){const e={name:"MZ Browser"},r=v.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/focus/i],describe(t){const e={name:"Focus"},r=v.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/swing/i],describe(t){const e={name:"Swing"},r=v.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/coast/i],describe(t){const e={name:"Opera Coast"},r=v.getFirstMatch(se,t)||v.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(t){const e={name:"Opera Touch"},r=v.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,t)||v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/yabrowser/i],describe(t){const e={name:"Yandex Browser"},r=v.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/ucbrowser/i],describe(t){const e={name:"UC Browser"},r=v.getFirstMatch(se,t)||v.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/Maxthon|mxios/i],describe(t){const e={name:"Maxthon"},r=v.getFirstMatch(se,t)||v.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/epiphany/i],describe(t){const e={name:"Epiphany"},r=v.getFirstMatch(se,t)||v.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/puffin/i],describe(t){const e={name:"Puffin"},r=v.getFirstMatch(se,t)||v.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/sleipnir/i],describe(t){const e={name:"Sleipnir"},r=v.getFirstMatch(se,t)||v.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/k-meleon/i],describe(t){const e={name:"K-Meleon"},r=v.getFirstMatch(se,t)||v.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/micromessenger/i],describe(t){const e={name:"WeChat"},r=v.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/qqbrowser/i],describe(t){const e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},r=v.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/msie|trident/i],describe(t){const e={name:"Internet Explorer"},r=v.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/\sedg\//i],describe(t){const e={name:"Microsoft Edge"},r=v.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/edg([ea]|ios)/i],describe(t){const e={name:"Microsoft Edge"},r=v.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/vivaldi/i],describe(t){const e={name:"Vivaldi"},r=v.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/seamonkey/i],describe(t){const e={name:"SeaMonkey"},r=v.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/sailfish/i],describe(t){const e={name:"Sailfish"},r=v.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return r&&(e.version=r),e}},{test:[/silk/i],describe(t){const e={name:"Amazon Silk"},r=v.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/phantom/i],describe(t){const e={name:"PhantomJS"},r=v.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/slimerjs/i],describe(t){const e={name:"SlimerJS"},r=v.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e={name:"BlackBerry"},r=v.getFirstMatch(se,t)||v.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/(web|hpw)[o0]s/i],describe(t){const e={name:"WebOS Browser"},r=v.getFirstMatch(se,t)||v.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/bada/i],describe(t){const e={name:"Bada"},r=v.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/tizen/i],describe(t){const e={name:"Tizen"},r=v.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/qupzilla/i],describe(t){const e={name:"QupZilla"},r=v.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/firefox|iceweasel|fxios/i],describe(t){const e={name:"Firefox"},r=v.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/electron/i],describe(t){const e={name:"Electron"},r=v.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/MiuiBrowser/i],describe(t){const e={name:"Miui"},r=v.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/chromium/i],describe(t){const e={name:"Chromium"},r=v.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/chrome|crios|crmo/i],describe(t){const e={name:"Chrome"},r=v.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/GSA/i],describe(t){const e={name:"Google Search"},r=v.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test(t){const e=!t.test(/like android/i),r=t.test(/android/i);return e&&r},describe(t){const e={name:"Android Browser"},r=v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/playstation 4/i],describe(t){const e={name:"PlayStation 4"},r=v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/safari|applewebkit/i],describe(t){const e={name:"Safari"},r=v.getFirstMatch(se,t);return r&&(e.version=r),e}},{test:[/.*/i],describe(t){const e=/^(.*)\/(.*) /,r=/^(.*)\/(.*)[ \t]\((.*)/,n=t.search("\\(")!==-1?r:e;return{name:v.getFirstMatch(n,t),version:v.getSecondMatch(n,t)}}}],p1=[{test:[/Roku\/DVP/],describe(t){const e=v.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:Ue.Roku,version:e}}},{test:[/windows phone/i],describe(t){const e=v.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:Ue.WindowsPhone,version:e}}},{test:[/windows /i],describe(t){const e=v.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),r=v.getWindowsVersionName(e);return{name:Ue.Windows,version:e,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(t){const e={name:Ue.iOS},r=v.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return r&&(e.version=r),e}},{test:[/macintosh/i],describe(t){const e=v.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),r=v.getMacOSVersionName(e),s={name:Ue.MacOS,version:e};return r&&(s.versionName=r),s}},{test:[/(ipod|iphone|ipad)/i],describe(t){const e=v.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:Ue.iOS,version:e}}},{test(t){const e=!t.test(/like android/i),r=t.test(/android/i);return e&&r},describe(t){const e=v.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),r=v.getAndroidVersionName(e),s={name:Ue.Android,version:e};return r&&(s.versionName=r),s}},{test:[/(web|hpw)[o0]s/i],describe(t){const e=v.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),r={name:Ue.WebOS};return e&&e.length&&(r.version=e),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e=v.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||v.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||v.getFirstMatch(/\bbb(\d+)/i,t);return{name:Ue.BlackBerry,version:e}}},{test:[/bada/i],describe(t){const e=v.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:Ue.Bada,version:e}}},{test:[/tizen/i],describe(t){const e=v.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:Ue.Tizen,version:e}}},{test:[/linux/i],describe(){return{name:Ue.Linux}}},{test:[/CrOS/],describe(){return{name:Ue.ChromeOS}}},{test:[/PlayStation 4/],describe(t){const e=v.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:Ue.PlayStation4,version:e}}}],g1=[{test:[/googlebot/i],describe(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe(t){const e=v.getFirstMatch(/(can-l01)/i,t)&&"Nova",r={type:me.mobile,vendor:"Huawei"};return e&&(r.model=e),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe(){return{type:me.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe(){return{type:me.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(){return{type:me.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe(){return{type:me.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe(){return{type:me.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe(){return{type:me.tablet}}},{test(t){const e=t.test(/ipod|iphone/i),r=t.test(/like (ipod|iphone)/i);return e&&!r},describe(t){const e=v.getFirstMatch(/(ipod|iphone)/i,t);return{type:me.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe(){return{type:me.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe(){return{type:me.mobile}}},{test(t){return t.getBrowserName(!0)==="blackberry"},describe(){return{type:me.mobile,vendor:"BlackBerry"}}},{test(t){return t.getBrowserName(!0)==="bada"},describe(){return{type:me.mobile}}},{test(t){return t.getBrowserName()==="windows phone"},describe(){return{type:me.mobile,vendor:"Microsoft"}}},{test(t){const e=Number(String(t.getOSVersion()).split(".")[0]);return t.getOSName(!0)==="android"&&e>=3},describe(){return{type:me.tablet}}},{test(t){return t.getOSName(!0)==="android"},describe(){return{type:me.mobile}}},{test(t){return t.getOSName(!0)==="macos"},describe(){return{type:me.desktop,vendor:"Apple"}}},{test(t){return t.getOSName(!0)==="windows"},describe(){return{type:me.desktop}}},{test(t){return t.getOSName(!0)==="linux"},describe(){return{type:me.desktop}}},{test(t){return t.getOSName(!0)==="playstation 4"},describe(){return{type:me.tv}}},{test(t){return t.getOSName(!0)==="roku"},describe(){return{type:me.tv}}}],m1=[{test(t){return t.getBrowserName(!0)==="microsoft edge"},describe(t){if(/\sedg\//i.test(t))return{name:Ut.Blink};const r=v.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:Ut.EdgeHTML,version:r}}},{test:[/trident/i],describe(t){const e={name:Ut.Trident},r=v.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test(t){return t.test(/presto/i)},describe(t){const e={name:Ut.Presto},r=v.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test(t){const e=t.test(/gecko/i),r=t.test(/like gecko/i);return e&&!r},describe(t){const e={name:Ut.Gecko},r=v.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/(apple)?webkit\/537\.36/i],describe(){return{name:Ut.Blink}}},{test:[/(apple)?webkit/i],describe(t){const e={name:Ut.WebKit},r=v.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}}];class Ju{constructor(e,r=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},r!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=v.find(f1,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(s=>this.test(s));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=v.find(p1,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(s=>this.test(s));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:r}=this.getOS();return e?String(r).toLowerCase()||"":r||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:r}=this.getPlatform();return e?String(r).toLowerCase()||"":r||""}parsePlatform(){this.parsedResult.platform={};const e=v.find(g1,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(s=>this.test(s));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=v.find(m1,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(s=>this.test(s));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return v.assign({},this.parsedResult)}satisfies(e){const r={};let s=0;const n={};let i=0;if(Object.keys(e).forEach(a=>{const c=e[a];typeof c=="string"?(n[a]=c,i+=1):typeof c=="object"&&(r[a]=c,s+=1)}),s>0){const a=Object.keys(r),c=v.find(a,u=>this.isOS(u));if(c){const u=this.satisfies(r[c]);if(u!==void 0)return u}const l=v.find(a,u=>this.isPlatform(u));if(l){const u=this.satisfies(r[l]);if(u!==void 0)return u}}if(i>0){const a=Object.keys(n),c=v.find(a,l=>this.isBrowser(l,!0));if(c!==void 0)return this.compareVersion(n[c])}}isBrowser(e,r=!1){const s=this.getBrowserName().toLowerCase();let n=e.toLowerCase();const i=v.getBrowserTypeByAlias(n);return r&&i&&(n=i.toLowerCase()),n===s}compareVersion(e){let r=[0],s=e,n=!1;const i=this.getBrowserVersion();if(typeof i=="string")return e[0]===">"||e[0]==="<"?(s=e.substr(1),e[1]==="="?(n=!0,s=e.substr(2)):r=[],e[0]===">"?r.push(1):r.push(-1)):e[0]==="="?s=e.substr(1):e[0]==="~"&&(n=!0,s=e.substr(1)),r.indexOf(v.compareVersions(i,s,n))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,r=!1){return this.isBrowser(e,r)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(r=>this.is(r))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class fp{static getParser(e,r=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new Ju(e,r)}static parse(e){return new Ju(e).getResult()}static get BROWSER_MAP(){return hp}static get ENGINE_MAP(){return Ut}static get OS_MAP(){return Ue}static get PLATFORMS_MAP(){return me}}const y1=({serviceId:t,clientVersion:e})=>async()=>{var n,i,o,a,c;const r=typeof window<"u"&&((n=window==null?void 0:window.navigator)!=null&&n.userAgent)?fp.parse(window.navigator.userAgent):void 0,s=[["aws-sdk-js",e],["ua","2.0"],[`os/${((i=r==null?void 0:r.os)==null?void 0:i.name)||"other"}`,(o=r==null?void 0:r.os)==null?void 0:o.version],["lang/js"],["md/browser",`${((a=r==null?void 0:r.browser)==null?void 0:a.name)??"unknown"}_${((c=r==null?void 0:r.browser)==null?void 0:c.version)??"unknown"}`]];return t&&s.push([`api/${t}`,e]),s};function w1(t){let e=0,r=0,s=null,n=null;const i=a=>{if(typeof a!="number")throw new Error("Attempted to allocate an event message where size was not a number: "+a);e=a,r=4,s=new Uint8Array(a),new DataView(s.buffer).setUint32(0,a,!1)},o=async function*(){const a=t[Symbol.asyncIterator]();for(;;){const{value:c,done:l}=await a.next();if(l){if(e)if(e===r)yield s;else throw new Error("Truncated event message received.");else return;return}const u=c.length;let d=0;for(;d<u;){if(!s){const m=u-d;n||(n=new Uint8Array(4));const g=Math.min(4-r,m);if(n.set(c.slice(d,d+g),r),r+=g,d+=g,r<4)break;i(new DataView(n.buffer).getUint32(0,!1)),n=null}const h=Math.min(e-r,u-d);s.set(c.slice(d,d+h),r),r+=h,d+=h,e&&e===r&&(yield s,s=null,e=0,r=0)}}};return{[Symbol.asyncIterator]:o}}function b1(t,e){return async function(r){const{value:s}=r.headers[":message-type"];if(s==="error"){const n=new Error(r.headers[":error-message"].value||"UnknownError");throw n.name=r.headers[":error-code"].value,n}else if(s==="exception"){const n=r.headers[":exception-type"].value,i={[n]:r},o=await t(i);if(o.$unknown){const a=new Error(e(r.body));throw a.name=n,a}throw o[n]}else if(s==="event"){const n={[r.headers[":event-type"].value]:r},i=await t(n);return i.$unknown?void 0:i}else throw Error(`Unrecognizable event type: ${r.headers[":event-type"].value}`)}}let _1=class{constructor({utf8Encoder:e,utf8Decoder:r}){this.eventStreamCodec=new dw(e,r),this.utfEncoder=e}deserialize(e,r){const s=w1(e);return new pw({messageStream:new hw({inputStream:s,decoder:this.eventStreamCodec}),deserializer:b1(r,this.utfEncoder)})}serialize(e,r){return new fw({messageStream:new gw({inputStream:e,serializer:r}),encoder:this.eventStreamCodec,includeEndFrame:!0})}};const v1=t=>({[Symbol.asyncIterator]:async function*(){const e=t.getReader();try{for(;;){const{done:r,value:s}=await e.read();if(r)return;yield s}}finally{e.releaseLock()}}}),E1=t=>{const e=t[Symbol.asyncIterator]();return new ReadableStream({async pull(r){const{done:s,value:n}=await e.next();if(s)return r.close();r.enqueue(n)}})};class S1{constructor({utf8Encoder:e,utf8Decoder:r}){this.universalMarshaller=new _1({utf8Decoder:r,utf8Encoder:e})}deserialize(e,r){const s=x1(e)?v1(e):e;return this.universalMarshaller.deserialize(s,r)}serialize(e,r){const s=this.universalMarshaller.serialize(e,r);return typeof ReadableStream=="function"?E1(s):s}}const x1=t=>typeof ReadableStream=="function"&&t instanceof ReadableStream,A1=t=>new S1(t);function C1(t,e,r=1024*1024){return new Promise((s,n)=>{const i=new FileReader;i.addEventListener("error",n),i.addEventListener("abort",n);const o=t.size;let a=0;function c(){if(a>=o){s();return}i.readAsArrayBuffer(t.slice(a,Math.min(o,a+r)))}i.addEventListener("load",l=>{const u=l.target.result;e(new Uint8Array(u)),a+=u.byteLength,c()}),c()})}const k1=async function(e,r){const s=new e;return await C1(r,n=>{s.update(n)}),s.digest()},R1=t=>()=>Promise.reject(t),Dt=64,T1=16,O1=[1732584193,4023233417,2562383102,271733878];class P1{constructor(){this.reset()}update(e){if(I1(e))return;if(this.finished)throw new Error("Attempted to update an already finished hash.");const r=B1(e);let s=0,{byteLength:n}=r;for(this.bytesHashed+=n;n>0;)this.buffer.setUint8(this.bufferLength++,r[s++]),n--,this.bufferLength===Dt&&(this.hashBuffer(),this.bufferLength=0)}async digest(){if(!this.finished){const{buffer:r,bufferLength:s,bytesHashed:n}=this,i=n*8;if(r.setUint8(this.bufferLength++,128),s%Dt>=Dt-8){for(let o=this.bufferLength;o<Dt;o++)r.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(let o=this.bufferLength;o<Dt-8;o++)r.setUint8(o,0);r.setUint32(Dt-8,i>>>0,!0),r.setUint32(Dt-4,Math.floor(i/4294967296),!0),this.hashBuffer(),this.finished=!0}const e=new DataView(new ArrayBuffer(T1));for(let r=0;r<4;r++)e.setUint32(r*4,this.state[r],!0);return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}hashBuffer(){const{buffer:e,state:r}=this;let s=r[0],n=r[1],i=r[2],o=r[3];s=Me(s,n,i,o,e.getUint32(0,!0),7,3614090360),o=Me(o,s,n,i,e.getUint32(4,!0),12,3905402710),i=Me(i,o,s,n,e.getUint32(8,!0),17,606105819),n=Me(n,i,o,s,e.getUint32(12,!0),22,3250441966),s=Me(s,n,i,o,e.getUint32(16,!0),7,4118548399),o=Me(o,s,n,i,e.getUint32(20,!0),12,1200080426),i=Me(i,o,s,n,e.getUint32(24,!0),17,2821735955),n=Me(n,i,o,s,e.getUint32(28,!0),22,4249261313),s=Me(s,n,i,o,e.getUint32(32,!0),7,1770035416),o=Me(o,s,n,i,e.getUint32(36,!0),12,2336552879),i=Me(i,o,s,n,e.getUint32(40,!0),17,4294925233),n=Me(n,i,o,s,e.getUint32(44,!0),22,2304563134),s=Me(s,n,i,o,e.getUint32(48,!0),7,1804603682),o=Me(o,s,n,i,e.getUint32(52,!0),12,4254626195),i=Me(i,o,s,n,e.getUint32(56,!0),17,2792965006),n=Me(n,i,o,s,e.getUint32(60,!0),22,1236535329),s=De(s,n,i,o,e.getUint32(4,!0),5,4129170786),o=De(o,s,n,i,e.getUint32(24,!0),9,3225465664),i=De(i,o,s,n,e.getUint32(44,!0),14,643717713),n=De(n,i,o,s,e.getUint32(0,!0),20,3921069994),s=De(s,n,i,o,e.getUint32(20,!0),5,3593408605),o=De(o,s,n,i,e.getUint32(40,!0),9,38016083),i=De(i,o,s,n,e.getUint32(60,!0),14,3634488961),n=De(n,i,o,s,e.getUint32(16,!0),20,3889429448),s=De(s,n,i,o,e.getUint32(36,!0),5,568446438),o=De(o,s,n,i,e.getUint32(56,!0),9,3275163606),i=De(i,o,s,n,e.getUint32(12,!0),14,4107603335),n=De(n,i,o,s,e.getUint32(32,!0),20,1163531501),s=De(s,n,i,o,e.getUint32(52,!0),5,2850285829),o=De(o,s,n,i,e.getUint32(8,!0),9,4243563512),i=De(i,o,s,n,e.getUint32(28,!0),14,1735328473),n=De(n,i,o,s,e.getUint32(48,!0),20,2368359562),s=Fe(s,n,i,o,e.getUint32(20,!0),4,4294588738),o=Fe(o,s,n,i,e.getUint32(32,!0),11,2272392833),i=Fe(i,o,s,n,e.getUint32(44,!0),16,1839030562),n=Fe(n,i,o,s,e.getUint32(56,!0),23,4259657740),s=Fe(s,n,i,o,e.getUint32(4,!0),4,2763975236),o=Fe(o,s,n,i,e.getUint32(16,!0),11,1272893353),i=Fe(i,o,s,n,e.getUint32(28,!0),16,4139469664),n=Fe(n,i,o,s,e.getUint32(40,!0),23,3200236656),s=Fe(s,n,i,o,e.getUint32(52,!0),4,681279174),o=Fe(o,s,n,i,e.getUint32(0,!0),11,3936430074),i=Fe(i,o,s,n,e.getUint32(12,!0),16,3572445317),n=Fe(n,i,o,s,e.getUint32(24,!0),23,76029189),s=Fe(s,n,i,o,e.getUint32(36,!0),4,3654602809),o=Fe(o,s,n,i,e.getUint32(48,!0),11,3873151461),i=Fe(i,o,s,n,e.getUint32(60,!0),16,530742520),n=Fe(n,i,o,s,e.getUint32(8,!0),23,3299628645),s=$e(s,n,i,o,e.getUint32(0,!0),6,4096336452),o=$e(o,s,n,i,e.getUint32(28,!0),10,1126891415),i=$e(i,o,s,n,e.getUint32(56,!0),15,2878612391),n=$e(n,i,o,s,e.getUint32(20,!0),21,4237533241),s=$e(s,n,i,o,e.getUint32(48,!0),6,1700485571),o=$e(o,s,n,i,e.getUint32(12,!0),10,2399980690),i=$e(i,o,s,n,e.getUint32(40,!0),15,4293915773),n=$e(n,i,o,s,e.getUint32(4,!0),21,2240044497),s=$e(s,n,i,o,e.getUint32(32,!0),6,1873313359),o=$e(o,s,n,i,e.getUint32(60,!0),10,4264355552),i=$e(i,o,s,n,e.getUint32(24,!0),15,2734768916),n=$e(n,i,o,s,e.getUint32(52,!0),21,1309151649),s=$e(s,n,i,o,e.getUint32(16,!0),6,4149444226),o=$e(o,s,n,i,e.getUint32(44,!0),10,3174756917),i=$e(i,o,s,n,e.getUint32(8,!0),15,718787259),n=$e(n,i,o,s,e.getUint32(36,!0),21,3951481745),r[0]=s+r[0]&4294967295,r[1]=n+r[1]&4294967295,r[2]=i+r[2]&4294967295,r[3]=o+r[3]&4294967295}reset(){this.state=Uint32Array.from(O1),this.buffer=new DataView(new ArrayBuffer(Dt)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}}function Oi(t,e,r,s,n,i){return e=(e+t&4294967295)+(s+i&4294967295)&4294967295,(e<<n|e>>>32-n)+r&4294967295}function Me(t,e,r,s,n,i,o){return Oi(e&r|~e&s,t,e,n,i,o)}function De(t,e,r,s,n,i,o){return Oi(e&s|r&~s,t,e,n,i,o)}function Fe(t,e,r,s,n,i,o){return Oi(e^r^s,t,e,n,i,o)}function $e(t,e,r,s,n,i,o){return Oi(r^(e|~s),t,e,n,i,o)}function I1(t){return typeof t=="string"?t.length===0:t.byteLength===0}function B1(t){return typeof t=="string"?Qr(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}const Xu=typeof TextEncoder=="function"?new TextEncoder:null,N1=t=>{if(typeof t=="string"){if(Xu)return Xu.encode(t).byteLength;let e=t.length;for(let r=e-1;r>=0;r--){const s=t.charCodeAt(r);s>127&&s<=2047?e++:s>2047&&s<=65535&&(e+=2),s>=56320&&s<=57343&&r--}return e}else{if(typeof t.byteLength=="number")return t.byteLength;if(typeof t.size=="number")return t.size}throw new Error(`Body Length computation failed for ${t}`)},M1={CrtSignerV4:null};class D1{constructor(e){this.sigv4Signer=new Hw(e),this.signerOptions=e}async sign(e,r={}){if(r.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().sign(e,r)}return this.sigv4Signer.sign(e,r)}async signWithCredentials(e,r,s={}){if(s.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().signWithCredentials(e,r,s)}return this.sigv4Signer.signWithCredentials(e,r,s)}async presign(e,r={}){if(r.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().presign(e,r)}return this.sigv4Signer.presign(e,r)}async presignWithCredentials(e,r,s={}){if(s.signingRegion==="*")throw new Error("Method presignWithCredentials is not supported for [signingRegion=*].");return this.sigv4Signer.presignWithCredentials(e,r,s)}getSigv4aSigner(){if(!this.sigv4aSigner){let e=null;try{if(e=M1.CrtSignerV4,typeof e!="function")throw new Error}catch(r){throw r.message=`${r.message}
Please check whether you have installed the "@aws-sdk/signature-v4-crt" package explicitly. 
You must also register the package by calling [require("@aws-sdk/signature-v4-crt");] or an ESM equivalent such as [import "@aws-sdk/signature-v4-crt";]. 
For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt`,r}this.sigv4aSigner=new e({...this.signerOptions,signingAlgorithm:1})}return this.sigv4aSigner}}const jc="required",f="type",y="conditions",b="fn",_="argv",$="ref",pe="assign",T="url",O="properties",pp="backend",_t="authSchemes",vt="disableDoubleEncoding",Et="signingName",Ct="signingRegion",P="headers",F1=!1,ht=!0,it="isSet",Te="booleanEquals",B="error",ei="aws.partition",le="stringEquals",ye="getAttr",Xe="name",St="substring",Yu="bucketSuffix",gp="parseURL",Zu="{url#scheme}://{url#authority}/{uri_encoded_bucket}{url#path}",x="endpoint",S="tree",mp="aws.isVirtualHostableS3Bucket",Dn="{url#scheme}://{Bucket}.{url#authority}{url#path}",xt="not",Fn="{url#scheme}://{url#authority}{url#path}",yp="hardwareType",wp="regionPrefix",Qu="bucketAliasSuffix",Ia="outpostId",xr="isValidHostLabel",Hc="s3-outposts",Xr="s3",bp="{url#scheme}://{url#authority}{url#normalizedPath}{Bucket}",_p="https://{Bucket}.s3-accelerate.{partitionResult#dnsSuffix}",ed="https://{Bucket}.s3.{partitionResult#dnsSuffix}",vp="aws.parseArn",Ep="bucketArn",Sp="arnType",ti="",qc="s3-object-lambda",xp="accesspoint",zc="accessPointName",td="{url#scheme}://{accessPointName}-{bucketArn#accountId}.{url#authority}{url#path}",rd="mrapPartition",sd="outpostType",nd="arnPrefix",Ap="{url#scheme}://{url#authority}{url#normalizedPath}{uri_encoded_bucket}",id="https://s3.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",od="https://s3.{partitionResult#dnsSuffix}",Ts={[jc]:!1,[f]:"String"},Dr={[jc]:!0,default:!1,[f]:"Boolean"},Os={[jc]:!1,[f]:"Boolean"},pt={[b]:Te,[_]:[{[$]:"Accelerate"},!0]},ae={[b]:Te,[_]:[{[$]:"UseFIPS"},!0]},oe={[b]:Te,[_]:[{[$]:"UseDualStack"},!0]},be={[b]:it,[_]:[{[$]:"Endpoint"}]},Cp={[b]:ei,[_]:[{[$]:"Region"}],[pe]:"partitionResult"},ad={[b]:le,[_]:[{[b]:ye,[_]:[{[$]:"partitionResult"},Xe]},"aws-cn"]},ri={[b]:it,[_]:[{[$]:"Bucket"}]},He={[$]:"Bucket"},je={[b]:gp,[_]:[{[$]:"Endpoint"}],[pe]:"url"},$n={[b]:Te,[_]:[{[b]:ye,[_]:[{[$]:"url"},"isIp"]},!0]},kp={[$]:"url"},Rp={[b]:"uriEncode",[_]:[He],[pe]:"uri_encoded_bucket"},Tt={[pp]:"S3Express",[_t]:[{[vt]:!0,[Xe]:"sigv4",[Et]:"s3express",[Ct]:"{Region}"}]},U={},Tp={[b]:mp,[_]:[He,!1]},jo={[B]:"S3Express bucket name is not a valid virtual hostable name.",[f]:B},si={[pp]:"S3Express",[_t]:[{[vt]:!0,[Xe]:"sigv4-s3express",[Et]:"s3express",[Ct]:"{Region}"}]},cd={[b]:it,[_]:[{[$]:"UseS3ExpressControlEndpoint"}]},ld={[b]:Te,[_]:[{[$]:"UseS3ExpressControlEndpoint"},!0]},H={[b]:xt,[_]:[be]},ud={[B]:"Unrecognized S3Express bucket name format.",[f]:B},dd={[b]:xt,[_]:[ri]},hd={[$]:yp},fd={[y]:[H],[B]:"Expected a endpoint to be specified but no endpoint was found",[f]:B},Cn={[_t]:[{[vt]:!0,[Xe]:"sigv4",[Et]:Hc,[Ct]:"{Region}"}]},Ho={[b]:Te,[_]:[{[$]:"ForcePathStyle"},!1]},$1={[$]:"ForcePathStyle"},we={[b]:Te,[_]:[{[$]:"Accelerate"},!1]},Se={[b]:le,[_]:[{[$]:"Region"},"aws-global"]},Ae={[_t]:[{[vt]:!0,[Xe]:"sigv4",[Et]:Xr,[Ct]:"us-east-1"}]},G={[b]:xt,[_]:[Se]},Ce={[b]:Te,[_]:[{[$]:"UseGlobalEndpoint"},!0]},pd={[T]:"https://{Bucket}.s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[O]:{[_t]:[{[vt]:!0,[Xe]:"sigv4",[Et]:Xr,[Ct]:"{Region}"}]},[P]:{}},ve={[_t]:[{[vt]:!0,[Xe]:"sigv4",[Et]:Xr,[Ct]:"{Region}"}]},ke={[b]:Te,[_]:[{[$]:"UseGlobalEndpoint"},!1]},V={[b]:Te,[_]:[{[$]:"UseDualStack"},!1]},gd={[T]:"https://{Bucket}.s3-fips.{Region}.{partitionResult#dnsSuffix}",[O]:ve,[P]:{}},z={[b]:Te,[_]:[{[$]:"UseFIPS"},!1]},md={[T]:"https://{Bucket}.s3-accelerate.dualstack.{partitionResult#dnsSuffix}",[O]:ve,[P]:{}},yd={[T]:"https://{Bucket}.s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[O]:ve,[P]:{}},qo={[b]:Te,[_]:[{[b]:ye,[_]:[kp,"isIp"]},!1]},zo={[T]:bp,[O]:ve,[P]:{}},Ba={[T]:Dn,[O]:ve,[P]:{}},wd={[x]:Ba,[f]:x},Ko={[T]:_p,[O]:ve,[P]:{}},bd={[T]:"https://{Bucket}.s3.{Region}.{partitionResult#dnsSuffix}",[O]:ve,[P]:{}},kn={[B]:"Invalid region: region was not a valid DNS name.",[f]:B},Ge={[$]:Ep},Op={[$]:Sp},Vo={[b]:ye,[_]:[Ge,"service"]},Kc={[$]:zc},_d={[y]:[oe],[B]:"S3 Object Lambda does not support Dual-stack",[f]:B},vd={[y]:[pt],[B]:"S3 Object Lambda does not support S3 Accelerate",[f]:B},Ed={[y]:[{[b]:it,[_]:[{[$]:"DisableAccessPoints"}]},{[b]:Te,[_]:[{[$]:"DisableAccessPoints"},!0]}],[B]:"Access points are not supported for this operation",[f]:B},Go={[y]:[{[b]:it,[_]:[{[$]:"UseArnRegion"}]},{[b]:Te,[_]:[{[$]:"UseArnRegion"},!1]},{[b]:xt,[_]:[{[b]:le,[_]:[{[b]:ye,[_]:[Ge,"region"]},"{Region}"]}]}],[B]:"Invalid configuration: region from ARN `{bucketArn#region}` does not match client region `{Region}` and UseArnRegion is `false`",[f]:B},Pp={[b]:ye,[_]:[{[$]:"bucketPartition"},Xe]},Ip={[b]:ye,[_]:[Ge,"accountId"]},Wo={[_t]:[{[vt]:!0,[Xe]:"sigv4",[Et]:qc,[Ct]:"{bucketArn#region}"}]},Sd={[B]:"Invalid ARN: The access point name may only contain a-z, A-Z, 0-9 and `-`. Found: `{accessPointName}`",[f]:B},Jo={[B]:"Invalid ARN: The account id may only contain a-z, A-Z, 0-9 and `-`. Found: `{bucketArn#accountId}`",[f]:B},Xo={[B]:"Invalid region in ARN: `{bucketArn#region}` (invalid DNS name)",[f]:B},Yo={[B]:"Client was configured for partition `{partitionResult#name}` but ARN (`{Bucket}`) has `{bucketPartition#name}`",[f]:B},xd={[B]:"Invalid ARN: The ARN may only contain a single resource component after `accesspoint`.",[f]:B},Ad={[B]:"Invalid ARN: Expected a resource of the format `accesspoint:<accesspoint name>` but no name was provided",[f]:B},Ps={[_t]:[{[vt]:!0,[Xe]:"sigv4",[Et]:Xr,[Ct]:"{bucketArn#region}"}]},Cd={[_t]:[{[vt]:!0,[Xe]:"sigv4",[Et]:Hc,[Ct]:"{bucketArn#region}"}]},kd={[b]:vp,[_]:[He]},Rd={[T]:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[O]:ve,[P]:{}},Td={[T]:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[O]:ve,[P]:{}},Od={[T]:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[O]:ve,[P]:{}},Zo={[T]:Ap,[O]:ve,[P]:{}},Pd={[T]:"https://s3.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[O]:ve,[P]:{}},Id={[$]:"UseObjectLambdaEndpoint"},Qo={[_t]:[{[vt]:!0,[Xe]:"sigv4",[Et]:qc,[Ct]:"{Region}"}]},Bd={[T]:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[O]:ve,[P]:{}},Nd={[T]:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}",[O]:ve,[P]:{}},Md={[T]:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[O]:ve,[P]:{}},ea={[T]:Fn,[O]:ve,[P]:{}},Dd={[T]:"https://s3.{Region}.{partitionResult#dnsSuffix}",[O]:ve,[P]:{}},ta=[{[$]:"Region"}],L1=[{[$]:"Endpoint"}],U1=[He],ra=[oe],Rn=[pt],hr=[be,je],Fd=[{[b]:it,[_]:[{[$]:"DisableS3ExpressSessionAuth"}]},{[b]:Te,[_]:[{[$]:"DisableS3ExpressSessionAuth"},!0]}],$d=[$n],sa=[Rp],na=[Tp],Fr=[ae],Ld=[{[b]:St,[_]:[He,6,14,!0],[pe]:"s3expressAvailabilityZoneId"},{[b]:St,[_]:[He,14,16,!0],[pe]:"s3expressAvailabilityZoneDelim"},{[b]:le,[_]:[{[$]:"s3expressAvailabilityZoneDelim"},"--"]}],Ud=[{[y]:[ae],[x]:{[T]:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.{Region}.amazonaws.com",[O]:Tt,[P]:{}},[f]:x},{[x]:{[T]:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.{Region}.amazonaws.com",[O]:Tt,[P]:{}},[f]:x}],jd=[{[b]:St,[_]:[He,6,15,!0],[pe]:"s3expressAvailabilityZoneId"},{[b]:St,[_]:[He,15,17,!0],[pe]:"s3expressAvailabilityZoneDelim"},{[b]:le,[_]:[{[$]:"s3expressAvailabilityZoneDelim"},"--"]}],Hd=[{[y]:[ae],[x]:{[T]:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.{Region}.amazonaws.com",[O]:si,[P]:{}},[f]:x},{[x]:{[T]:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.{Region}.amazonaws.com",[O]:si,[P]:{}},[f]:x}],j1=[ri],qd=[{[b]:xr,[_]:[{[$]:Ia},!1]}],zd=[{[b]:le,[_]:[{[$]:wp},"beta"]}],Ft=[Cp],Kd=[{[b]:xr,[_]:[{[$]:"Region"},!1]}],$t=[{[b]:le,[_]:[{[$]:"Region"},"us-east-1"]}],ia=[{[b]:le,[_]:[Op,xp]}],Vd=[{[b]:ye,[_]:[Ge,"resourceId[1]"],[pe]:zc},{[b]:xt,[_]:[{[b]:le,[_]:[Kc,ti]}]}],H1=[Ge,"resourceId[1]"],oa=[{[b]:xt,[_]:[{[b]:le,[_]:[{[b]:ye,[_]:[Ge,"region"]},ti]}]}],Gd=[{[b]:xt,[_]:[{[b]:it,[_]:[{[b]:ye,[_]:[Ge,"resourceId[2]"]}]}]}],q1=[Ge,"resourceId[2]"],aa=[{[b]:ei,[_]:[{[b]:ye,[_]:[Ge,"region"]}],[pe]:"bucketPartition"}],Wd=[{[b]:le,[_]:[Pp,{[b]:ye,[_]:[{[$]:"partitionResult"},Xe]}]}],ca=[{[b]:xr,[_]:[{[b]:ye,[_]:[Ge,"region"]},!0]}],la=[{[b]:xr,[_]:[Ip,!1]}],Jd=[{[b]:xr,[_]:[Kc,!1]}],Xd=[{[b]:xr,[_]:[{[$]:"Region"},!0]}],z1={version:"1.0",parameters:{Bucket:Ts,Region:Ts,UseFIPS:Dr,UseDualStack:Dr,Endpoint:Ts,ForcePathStyle:Dr,Accelerate:Dr,UseGlobalEndpoint:Dr,UseObjectLambdaEndpoint:Os,Key:Ts,Prefix:Ts,DisableAccessPoints:Os,DisableMultiRegionAccessPoints:Dr,UseArnRegion:Os,UseS3ExpressControlEndpoint:Os,DisableS3ExpressSessionAuth:Os},rules:[{[y]:[{[b]:it,[_]:ta}],rules:[{[y]:[pt,ae],error:"Accelerate cannot be used with FIPS",[f]:B},{[y]:[oe,be],error:"Cannot set dual-stack in combination with a custom endpoint.",[f]:B},{[y]:[be,ae],error:"A custom endpoint cannot be combined with FIPS",[f]:B},{[y]:[be,pt],error:"A custom endpoint cannot be combined with S3 Accelerate",[f]:B},{[y]:[ae,Cp,ad],error:"Partition does not support FIPS",[f]:B},{[y]:[ri,{[b]:St,[_]:[He,0,6,ht],[pe]:Yu},{[b]:le,[_]:[{[$]:Yu},"--x-s3"]}],rules:[{[y]:ra,error:"S3Express does not support Dual-stack.",[f]:B},{[y]:Rn,error:"S3Express does not support S3 Accelerate.",[f]:B},{[y]:hr,rules:[{[y]:Fd,rules:[{[y]:$d,rules:[{[y]:sa,rules:[{endpoint:{[T]:Zu,[O]:Tt,[P]:U},[f]:x}],[f]:S}],[f]:S},{[y]:na,rules:[{endpoint:{[T]:Dn,[O]:Tt,[P]:U},[f]:x}],[f]:S},jo],[f]:S},{[y]:$d,rules:[{[y]:sa,rules:[{endpoint:{[T]:Zu,[O]:si,[P]:U},[f]:x}],[f]:S}],[f]:S},{[y]:na,rules:[{endpoint:{[T]:Dn,[O]:si,[P]:U},[f]:x}],[f]:S},jo],[f]:S},{[y]:[cd,ld],rules:[{[y]:[Rp,H],rules:[{[y]:Fr,endpoint:{[T]:"https://s3express-control-fips.{Region}.amazonaws.com/{uri_encoded_bucket}",[O]:Tt,[P]:U},[f]:x},{endpoint:{[T]:"https://s3express-control.{Region}.amazonaws.com/{uri_encoded_bucket}",[O]:Tt,[P]:U},[f]:x}],[f]:S}],[f]:S},{[y]:na,rules:[{[y]:Fd,rules:[{[y]:Ld,rules:Ud,[f]:S},{[y]:jd,rules:Ud,[f]:S},ud],[f]:S},{[y]:Ld,rules:Hd,[f]:S},{[y]:jd,rules:Hd,[f]:S},ud],[f]:S},jo],[f]:S},{[y]:[dd,cd,ld],rules:[{[y]:hr,endpoint:{[T]:Fn,[O]:Tt,[P]:U},[f]:x},{[y]:Fr,endpoint:{[T]:"https://s3express-control-fips.{Region}.amazonaws.com",[O]:Tt,[P]:U},[f]:x},{endpoint:{[T]:"https://s3express-control.{Region}.amazonaws.com",[O]:Tt,[P]:U},[f]:x}],[f]:S},{[y]:[ri,{[b]:St,[_]:[He,49,50,ht],[pe]:yp},{[b]:St,[_]:[He,8,12,ht],[pe]:wp},{[b]:St,[_]:[He,0,7,ht],[pe]:Qu},{[b]:St,[_]:[He,32,49,ht],[pe]:Ia},{[b]:ei,[_]:ta,[pe]:"regionPartition"},{[b]:le,[_]:[{[$]:Qu},"--op-s3"]}],rules:[{[y]:qd,rules:[{[y]:[{[b]:le,[_]:[hd,"e"]}],rules:[{[y]:zd,rules:[fd,{[y]:hr,endpoint:{[T]:"https://{Bucket}.ec2.{url#authority}",[O]:Cn,[P]:U},[f]:x}],[f]:S},{endpoint:{[T]:"https://{Bucket}.ec2.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[O]:Cn,[P]:U},[f]:x}],[f]:S},{[y]:[{[b]:le,[_]:[hd,"o"]}],rules:[{[y]:zd,rules:[fd,{[y]:hr,endpoint:{[T]:"https://{Bucket}.op-{outpostId}.{url#authority}",[O]:Cn,[P]:U},[f]:x}],[f]:S},{endpoint:{[T]:"https://{Bucket}.op-{outpostId}.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[O]:Cn,[P]:U},[f]:x}],[f]:S},{error:'Unrecognized hardware type: "Expected hardware type o or e but got {hardwareType}"',[f]:B}],[f]:S},{error:"Invalid ARN: The outpost Id must only contain a-z, A-Z, 0-9 and `-`.",[f]:B}],[f]:S},{[y]:j1,rules:[{[y]:[be,{[b]:xt,[_]:[{[b]:it,[_]:[{[b]:gp,[_]:L1}]}]}],error:"Custom endpoint `{Endpoint}` was not a valid URI",[f]:B},{[y]:[Ho,Tp],rules:[{[y]:Ft,rules:[{[y]:Kd,rules:[{[y]:[pt,ad],error:"S3 Accelerate cannot be used in this region",[f]:B},{[y]:[oe,ae,we,H,Se],endpoint:{[T]:"https://{Bucket}.s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[O]:Ae,[P]:U},[f]:x},{[y]:[oe,ae,we,H,G,Ce],rules:[{endpoint:pd,[f]:x}],[f]:S},{[y]:[oe,ae,we,H,G,ke],endpoint:pd,[f]:x},{[y]:[V,ae,we,H,Se],endpoint:{[T]:"https://{Bucket}.s3-fips.us-east-1.{partitionResult#dnsSuffix}",[O]:Ae,[P]:U},[f]:x},{[y]:[V,ae,we,H,G,Ce],rules:[{endpoint:gd,[f]:x}],[f]:S},{[y]:[V,ae,we,H,G,ke],endpoint:gd,[f]:x},{[y]:[oe,z,pt,H,Se],endpoint:{[T]:"https://{Bucket}.s3-accelerate.dualstack.us-east-1.{partitionResult#dnsSuffix}",[O]:Ae,[P]:U},[f]:x},{[y]:[oe,z,pt,H,G,Ce],rules:[{endpoint:md,[f]:x}],[f]:S},{[y]:[oe,z,pt,H,G,ke],endpoint:md,[f]:x},{[y]:[oe,z,we,H,Se],endpoint:{[T]:"https://{Bucket}.s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[O]:Ae,[P]:U},[f]:x},{[y]:[oe,z,we,H,G,Ce],rules:[{endpoint:yd,[f]:x}],[f]:S},{[y]:[oe,z,we,H,G,ke],endpoint:yd,[f]:x},{[y]:[V,z,we,be,je,$n,Se],endpoint:{[T]:bp,[O]:Ae,[P]:U},[f]:x},{[y]:[V,z,we,be,je,qo,Se],endpoint:{[T]:Dn,[O]:Ae,[P]:U},[f]:x},{[y]:[V,z,we,be,je,$n,G,Ce],rules:[{[y]:$t,endpoint:zo,[f]:x},{endpoint:zo,[f]:x}],[f]:S},{[y]:[V,z,we,be,je,qo,G,Ce],rules:[{[y]:$t,endpoint:Ba,[f]:x},wd],[f]:S},{[y]:[V,z,we,be,je,$n,G,ke],endpoint:zo,[f]:x},{[y]:[V,z,we,be,je,qo,G,ke],endpoint:Ba,[f]:x},{[y]:[V,z,pt,H,Se],endpoint:{[T]:_p,[O]:Ae,[P]:U},[f]:x},{[y]:[V,z,pt,H,G,Ce],rules:[{[y]:$t,endpoint:Ko,[f]:x},{endpoint:Ko,[f]:x}],[f]:S},{[y]:[V,z,pt,H,G,ke],endpoint:Ko,[f]:x},{[y]:[V,z,we,H,Se],endpoint:{[T]:ed,[O]:Ae,[P]:U},[f]:x},{[y]:[V,z,we,H,G,Ce],rules:[{[y]:$t,endpoint:{[T]:ed,[O]:ve,[P]:U},[f]:x},{endpoint:bd,[f]:x}],[f]:S},{[y]:[V,z,we,H,G,ke],endpoint:bd,[f]:x}],[f]:S},kn],[f]:S}],[f]:S},{[y]:[be,je,{[b]:le,[_]:[{[b]:ye,[_]:[kp,"scheme"]},"http"]},{[b]:mp,[_]:[He,ht]},Ho,z,V,we],rules:[{[y]:Ft,rules:[{[y]:Kd,rules:[wd],[f]:S},kn],[f]:S}],[f]:S},{[y]:[Ho,{[b]:vp,[_]:U1,[pe]:Ep}],rules:[{[y]:[{[b]:ye,[_]:[Ge,"resourceId[0]"],[pe]:Sp},{[b]:xt,[_]:[{[b]:le,[_]:[Op,ti]}]}],rules:[{[y]:[{[b]:le,[_]:[Vo,qc]}],rules:[{[y]:ia,rules:[{[y]:Vd,rules:[_d,vd,{[y]:oa,rules:[Ed,{[y]:Gd,rules:[Go,{[y]:aa,rules:[{[y]:Ft,rules:[{[y]:Wd,rules:[{[y]:ca,rules:[{[y]:[{[b]:le,[_]:[Ip,ti]}],error:"Invalid ARN: Missing account id",[f]:B},{[y]:la,rules:[{[y]:Jd,rules:[{[y]:hr,endpoint:{[T]:td,[O]:Wo,[P]:U},[f]:x},{[y]:Fr,endpoint:{[T]:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[O]:Wo,[P]:U},[f]:x},{endpoint:{[T]:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda.{bucketArn#region}.{bucketPartition#dnsSuffix}",[O]:Wo,[P]:U},[f]:x}],[f]:S},Sd],[f]:S},Jo],[f]:S},Xo],[f]:S},Yo],[f]:S}],[f]:S}],[f]:S},xd],[f]:S},{error:"Invalid ARN: bucket ARN is missing a region",[f]:B}],[f]:S},Ad],[f]:S},{error:"Invalid ARN: Object Lambda ARNs only support `accesspoint` arn types, but found: `{arnType}`",[f]:B}],[f]:S},{[y]:ia,rules:[{[y]:Vd,rules:[{[y]:oa,rules:[{[y]:ia,rules:[{[y]:oa,rules:[Ed,{[y]:Gd,rules:[Go,{[y]:aa,rules:[{[y]:Ft,rules:[{[y]:[{[b]:le,[_]:[Pp,"{partitionResult#name}"]}],rules:[{[y]:ca,rules:[{[y]:[{[b]:le,[_]:[Vo,Xr]}],rules:[{[y]:la,rules:[{[y]:Jd,rules:[{[y]:Rn,error:"Access Points do not support S3 Accelerate",[f]:B},{[y]:[ae,oe],endpoint:{[T]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[O]:Ps,[P]:U},[f]:x},{[y]:[ae,V],endpoint:{[T]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[O]:Ps,[P]:U},[f]:x},{[y]:[z,oe],endpoint:{[T]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[O]:Ps,[P]:U},[f]:x},{[y]:[z,V,be,je],endpoint:{[T]:td,[O]:Ps,[P]:U},[f]:x},{[y]:[z,V],endpoint:{[T]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.{bucketArn#region}.{bucketPartition#dnsSuffix}",[O]:Ps,[P]:U},[f]:x}],[f]:S},Sd],[f]:S},Jo],[f]:S},{error:"Invalid ARN: The ARN was not for the S3 service, found: {bucketArn#service}",[f]:B}],[f]:S},Xo],[f]:S},Yo],[f]:S}],[f]:S}],[f]:S},xd],[f]:S}],[f]:S}],[f]:S},{[y]:[{[b]:xr,[_]:[Kc,ht]}],rules:[{[y]:ra,error:"S3 MRAP does not support dual-stack",[f]:B},{[y]:Fr,error:"S3 MRAP does not support FIPS",[f]:B},{[y]:Rn,error:"S3 MRAP does not support S3 Accelerate",[f]:B},{[y]:[{[b]:Te,[_]:[{[$]:"DisableMultiRegionAccessPoints"},ht]}],error:"Invalid configuration: Multi-Region Access Point ARNs are disabled.",[f]:B},{[y]:[{[b]:ei,[_]:ta,[pe]:rd}],rules:[{[y]:[{[b]:le,[_]:[{[b]:ye,[_]:[{[$]:rd},Xe]},{[b]:ye,[_]:[Ge,"partition"]}]}],rules:[{endpoint:{[T]:"https://{accessPointName}.accesspoint.s3-global.{mrapPartition#dnsSuffix}",[O]:{[_t]:[{[vt]:ht,name:"sigv4a",[Et]:Xr,signingRegionSet:["*"]}]},[P]:U},[f]:x}],[f]:S},{error:"Client was configured for partition `{mrapPartition#name}` but bucket referred to partition `{bucketArn#partition}`",[f]:B}],[f]:S}],[f]:S},{error:"Invalid Access Point Name",[f]:B}],[f]:S},Ad],[f]:S},{[y]:[{[b]:le,[_]:[Vo,Hc]}],rules:[{[y]:ra,error:"S3 Outposts does not support Dual-stack",[f]:B},{[y]:Fr,error:"S3 Outposts does not support FIPS",[f]:B},{[y]:Rn,error:"S3 Outposts does not support S3 Accelerate",[f]:B},{[y]:[{[b]:it,[_]:[{[b]:ye,[_]:[Ge,"resourceId[4]"]}]}],error:"Invalid Arn: Outpost Access Point ARN contains sub resources",[f]:B},{[y]:[{[b]:ye,[_]:H1,[pe]:Ia}],rules:[{[y]:qd,rules:[Go,{[y]:aa,rules:[{[y]:Ft,rules:[{[y]:Wd,rules:[{[y]:ca,rules:[{[y]:la,rules:[{[y]:[{[b]:ye,[_]:q1,[pe]:sd}],rules:[{[y]:[{[b]:ye,[_]:[Ge,"resourceId[3]"],[pe]:zc}],rules:[{[y]:[{[b]:le,[_]:[{[$]:sd},xp]}],rules:[{[y]:hr,endpoint:{[T]:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.{url#authority}",[O]:Cd,[P]:U},[f]:x},{endpoint:{[T]:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.s3-outposts.{bucketArn#region}.{bucketPartition#dnsSuffix}",[O]:Cd,[P]:U},[f]:x}],[f]:S},{error:"Expected an outpost type `accesspoint`, found {outpostType}",[f]:B}],[f]:S},{error:"Invalid ARN: expected an access point name",[f]:B}],[f]:S},{error:"Invalid ARN: Expected a 4-component resource",[f]:B}],[f]:S},Jo],[f]:S},Xo],[f]:S},Yo],[f]:S}],[f]:S}],[f]:S},{error:"Invalid ARN: The outpost Id may only contain a-z, A-Z, 0-9 and `-`. Found: `{outpostId}`",[f]:B}],[f]:S},{error:"Invalid ARN: The Outpost Id was not set",[f]:B}],[f]:S},{error:"Invalid ARN: Unrecognized format: {Bucket} (type: {arnType})",[f]:B}],[f]:S},{error:"Invalid ARN: No ARN type specified",[f]:B}],[f]:S},{[y]:[{[b]:St,[_]:[He,0,4,F1],[pe]:nd},{[b]:le,[_]:[{[$]:nd},"arn:"]},{[b]:xt,[_]:[{[b]:it,[_]:[kd]}]}],error:"Invalid ARN: `{Bucket}` was not a valid ARN",[f]:B},{[y]:[{[b]:Te,[_]:[$1,ht]},kd],error:"Path-style addressing cannot be used with ARN buckets",[f]:B},{[y]:sa,rules:[{[y]:Ft,rules:[{[y]:[we],rules:[{[y]:[oe,H,ae,Se],endpoint:{[T]:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[O]:Ae,[P]:U},[f]:x},{[y]:[oe,H,ae,G,Ce],rules:[{endpoint:Rd,[f]:x}],[f]:S},{[y]:[oe,H,ae,G,ke],endpoint:Rd,[f]:x},{[y]:[V,H,ae,Se],endpoint:{[T]:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[O]:Ae,[P]:U},[f]:x},{[y]:[V,H,ae,G,Ce],rules:[{endpoint:Td,[f]:x}],[f]:S},{[y]:[V,H,ae,G,ke],endpoint:Td,[f]:x},{[y]:[oe,H,z,Se],endpoint:{[T]:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[O]:Ae,[P]:U},[f]:x},{[y]:[oe,H,z,G,Ce],rules:[{endpoint:Od,[f]:x}],[f]:S},{[y]:[oe,H,z,G,ke],endpoint:Od,[f]:x},{[y]:[V,be,je,z,Se],endpoint:{[T]:Ap,[O]:Ae,[P]:U},[f]:x},{[y]:[V,be,je,z,G,Ce],rules:[{[y]:$t,endpoint:Zo,[f]:x},{endpoint:Zo,[f]:x}],[f]:S},{[y]:[V,be,je,z,G,ke],endpoint:Zo,[f]:x},{[y]:[V,H,z,Se],endpoint:{[T]:id,[O]:Ae,[P]:U},[f]:x},{[y]:[V,H,z,G,Ce],rules:[{[y]:$t,endpoint:{[T]:id,[O]:ve,[P]:U},[f]:x},{endpoint:Pd,[f]:x}],[f]:S},{[y]:[V,H,z,G,ke],endpoint:Pd,[f]:x}],[f]:S},{error:"Path-style addressing cannot be used with S3 Accelerate",[f]:B}],[f]:S}],[f]:S}],[f]:S},{[y]:[{[b]:it,[_]:[Id]},{[b]:Te,[_]:[Id,ht]}],rules:[{[y]:Ft,rules:[{[y]:Xd,rules:[_d,vd,{[y]:hr,endpoint:{[T]:Fn,[O]:Qo,[P]:U},[f]:x},{[y]:Fr,endpoint:{[T]:"https://s3-object-lambda-fips.{Region}.{partitionResult#dnsSuffix}",[O]:Qo,[P]:U},[f]:x},{endpoint:{[T]:"https://s3-object-lambda.{Region}.{partitionResult#dnsSuffix}",[O]:Qo,[P]:U},[f]:x}],[f]:S},kn],[f]:S}],[f]:S},{[y]:[dd],rules:[{[y]:Ft,rules:[{[y]:Xd,rules:[{[y]:[ae,oe,H,Se],endpoint:{[T]:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[O]:Ae,[P]:U},[f]:x},{[y]:[ae,oe,H,G,Ce],rules:[{endpoint:Bd,[f]:x}],[f]:S},{[y]:[ae,oe,H,G,ke],endpoint:Bd,[f]:x},{[y]:[ae,V,H,Se],endpoint:{[T]:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}",[O]:Ae,[P]:U},[f]:x},{[y]:[ae,V,H,G,Ce],rules:[{endpoint:Nd,[f]:x}],[f]:S},{[y]:[ae,V,H,G,ke],endpoint:Nd,[f]:x},{[y]:[z,oe,H,Se],endpoint:{[T]:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[O]:Ae,[P]:U},[f]:x},{[y]:[z,oe,H,G,Ce],rules:[{endpoint:Md,[f]:x}],[f]:S},{[y]:[z,oe,H,G,ke],endpoint:Md,[f]:x},{[y]:[z,V,be,je,Se],endpoint:{[T]:Fn,[O]:Ae,[P]:U},[f]:x},{[y]:[z,V,be,je,G,Ce],rules:[{[y]:$t,endpoint:ea,[f]:x},{endpoint:ea,[f]:x}],[f]:S},{[y]:[z,V,be,je,G,ke],endpoint:ea,[f]:x},{[y]:[z,V,H,Se],endpoint:{[T]:od,[O]:Ae,[P]:U},[f]:x},{[y]:[z,V,H,G,Ce],rules:[{[y]:$t,endpoint:{[T]:od,[O]:ve,[P]:U},[f]:x},{endpoint:Dd,[f]:x}],[f]:S},{[y]:[z,V,H,G,ke],endpoint:Dd,[f]:x}],[f]:S},kn],[f]:S}],[f]:S}],[f]:S},{error:"A region must be set when sending requests to S3.",[f]:B}]},K1=z1,V1=(t,e={})=>Ab(K1,{endpointParams:t,logger:e.logger}),G1=t=>({apiVersion:"2006-03-01",base64Decoder:(t==null?void 0:t.base64Decoder)??Ga,base64Encoder:(t==null?void 0:t.base64Encoder)??Wa,disableHostPrefix:(t==null?void 0:t.disableHostPrefix)??!1,endpointProvider:(t==null?void 0:t.endpointProvider)??V1,extensions:(t==null?void 0:t.extensions)??[],getAwsChunkedEncodingStream:(t==null?void 0:t.getAwsChunkedEncodingStream)??_0,logger:(t==null?void 0:t.logger)??new Va,sdkStreamMixin:(t==null?void 0:t.sdkStreamMixin)??T0,serviceId:(t==null?void 0:t.serviceId)??"S3",signerConstructor:(t==null?void 0:t.signerConstructor)??D1,signingEscapePath:(t==null?void 0:t.signingEscapePath)??!1,urlParser:(t==null?void 0:t.urlParser)??qn,useArnRegion:(t==null?void 0:t.useArnRegion)??!1,utf8Decoder:(t==null?void 0:t.utf8Decoder)??Qr,utf8Encoder:(t==null?void 0:t.utf8Encoder)??oi}),W1=["in-region","cross-region","mobile","standard","legacy"],J1=({defaultsMode:t}={})=>sf(async()=>{const e=typeof t=="function"?await t():t;switch(e==null?void 0:e.toLowerCase()){case"auto":return Promise.resolve(X1()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(e==null?void 0:e.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${W1.join(", ")}, got ${e}`)}}),X1=()=>{var r,s;const t=typeof window<"u"&&((r=window==null?void 0:window.navigator)!=null&&r.userAgent)?fp.parse(window.navigator.userAgent):void 0,e=(s=t==null?void 0:t.platform)==null?void 0:s.type;return e==="tablet"||e==="mobile"},Y1=t=>{const e=J1(t),r=()=>e().then(Q0),s=G1(t);return{...s,...t,runtime:"browser",defaultsMode:e,bodyLengthChecker:(t==null?void 0:t.bodyLengthChecker)??N1,credentialDefaultProvider:(t==null?void 0:t.credentialDefaultProvider)??(n=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(t==null?void 0:t.defaultUserAgentProvider)??y1({serviceId:s.serviceId,clientVersion:XS.version}),eventStreamSerdeProvider:(t==null?void 0:t.eventStreamSerdeProvider)??A1,maxAttempts:(t==null?void 0:t.maxAttempts)??zn,md5:(t==null?void 0:t.md5)??P1,region:(t==null?void 0:t.region)??R1("Region is missing"),requestHandler:Ja.create((t==null?void 0:t.requestHandler)??r),retryMode:(t==null?void 0:t.retryMode)??(async()=>(await r()).retryMode||a_),sha1:(t==null?void 0:t.sha1)??ep.Sha1,sha256:(t==null?void 0:t.sha256)??ap.Sha256,streamCollector:(t==null?void 0:t.streamCollector)??$h,streamHasher:(t==null?void 0:t.streamHasher)??k1,useDualstackEndpoint:(t==null?void 0:t.useDualstackEndpoint)??(()=>Promise.resolve($b)),useFipsEndpoint:(t==null?void 0:t.useFipsEndpoint)??(()=>Promise.resolve(Lb))}},Z1=t=>{let e=async()=>{if(t.region===void 0)throw new Error("Region is missing from runtimeConfig");const r=t.region;return typeof r=="string"?r:r()};return{setRegion(r){e=r},region(){return e}}},Q1=t=>({region:t.region()}),ua=t=>t,ex=(t,e)=>{const r={...ua(Z1(t)),...ua(ny(t)),...ua(Qm(t))};return e.forEach(s=>s.configure(r)),{...t,...Q1(r),...iy(r),...e0(r)}};class tx extends m0{constructor(...[e]){const r=Y1(e||{}),s=$_(r),n=Ub(s),i=o_(n),o=O_(i),a=o,c=eb(a),l=Vw(c,{session:[()=>this,PS]}),u=ob(l),d=jb(u),h=ex(d,(e==null?void 0:e.extensions)||[]);super(h),this.config=h,this.middlewareStack.use(D_(this.config)),this.middlewareStack.use(zb(this.config)),this.middlewareStack.use(a0(this.config)),this.middlewareStack.use(u0(this.config)),this.middlewareStack.use(g0(this.config)),this.middlewareStack.use(ib(this.config)),this.middlewareStack.use(Zw(this.config)),this.middlewareStack.use(n0(this.config)),this.middlewareStack.use(by(this.config)),this.middlewareStack.use(Kw(this.config)),this.middlewareStack.use(Fb(this.config))}destroy(){super.destroy()}}function rx(t){return e=>async r=>{const s={...r.input},n=[{target:"SSECustomerKey",hash:"SSECustomerKeyMD5"},{target:"CopySourceSSECustomerKey",hash:"CopySourceSSECustomerKeyMD5"}];for(const i of n){const o=s[i.target];if(o){let a;typeof o=="string"?/^(?:[A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(o)?a=t.base64Decoder(o):(a=t.utf8Decoder(o),s[i.target]=t.base64Encoder(a)):(a=ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o),s[i.target]=t.base64Encoder(a));const c=new t.md5;c.update(a),s[i.hash]=t.base64Encoder(await c.digest())}}return e({...r,input:s})}}const sx={name:"ssecMiddleware",step:"initialize",tags:["SSE"],override:!0},Vc=t=>({applyToStack:e=>{e.add(rx(t),sx)}});var Re;(function(t){t.MD5="MD5",t.CRC32="CRC32",t.CRC32C="CRC32C",t.SHA1="SHA1",t.SHA256="SHA256"})(Re||(Re={}));var Yd;(function(t){t.HEADER="header",t.TRAILER="trailer"})(Yd||(Yd={}));const nx=Re.MD5,ix=Re.CRC32,Na=[Re.CRC32,Re.CRC32C,Re.SHA1,Re.SHA256],ox=[Re.CRC32,Re.CRC32C,Re.SHA1,Re.SHA256],ax=(t,{requestChecksumRequired:e,requestAlgorithmMember:r},s)=>{const n=s?ix:nx;if(!r||!t[r])return e?n:void 0;const i=t[r];if(!Na.includes(i))throw new Error(`The checksum algorithm "${i}" is not supported by the client. Select one of ${Na}.`);return i},Gc=t=>t===Re.MD5?"content-md5":`x-amz-checksum-${t.toLowerCase()}`,cx=(t,e)=>{const r=t.toLowerCase();for(const s of Object.keys(e))if(r===s.toLowerCase())return!0;return!1},Wc=t=>t!==void 0&&typeof t!="string"&&!ArrayBuffer.isView(t)&&!tf(t);var da={},Is={},Zd;function lx(){if(Zd)return Is;Zd=1,Object.defineProperty(Is,"__esModule",{value:!0}),Is.AwsCrc32c=void 0;var t=bt,e=Xt(),r=Bp(),s=function(){function n(){this.crc32c=new r.Crc32c}return n.prototype.update=function(i){(0,e.isEmptyData)(i)||this.crc32c.update((0,e.convertToBuffer)(i))},n.prototype.digest=function(){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(i){return[2,(0,e.numToUint8)(this.crc32c.digest())]})})},n.prototype.reset=function(){this.crc32c=new r.Crc32c},n}();return Is.AwsCrc32c=s,Is}var Qd;function Bp(){return Qd||(Qd=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.AwsCrc32c=t.Crc32c=t.crc32c=void 0;var e=bt,r=Xt();function s(c){return new n().update(c).digest()}t.crc32c=s;var n=function(){function c(){this.checksum=4294967295}return c.prototype.update=function(l){var u,d;try{for(var h=e.__values(l),m=h.next();!m.done;m=h.next()){var g=m.value;this.checksum=this.checksum>>>8^o[(this.checksum^g)&255]}}catch(p){u={error:p}}finally{try{m&&!m.done&&(d=h.return)&&d.call(h)}finally{if(u)throw u.error}}return this},c.prototype.digest=function(){return(this.checksum^4294967295)>>>0},c}();t.Crc32c=n;var i=[0,4067132163,3778769143,324072436,3348797215,904991772,648144872,3570033899,2329499855,2024987596,1809983544,2575936315,1296289744,3207089363,2893594407,1578318884,274646895,3795141740,4049975192,51262619,3619967088,632279923,922689671,3298075524,2592579488,1760304291,2075979607,2312596564,1562183871,2943781820,3156637768,1313733451,549293790,3537243613,3246849577,871202090,3878099393,357341890,102525238,4101499445,2858735121,1477399826,1264559846,3107202533,1845379342,2677391885,2361733625,2125378298,820201905,3263744690,3520608582,598981189,4151959214,85089709,373468761,3827903834,3124367742,1213305469,1526817161,2842354314,2107672161,2412447074,2627466902,1861252501,1098587580,3004210879,2688576843,1378610760,2262928035,1955203488,1742404180,2511436119,3416409459,969524848,714683780,3639785095,205050476,4266873199,3976438427,526918040,1361435347,2739821008,2954799652,1114974503,2529119692,1691668175,2005155131,2247081528,3690758684,697762079,986182379,3366744552,476452099,3993867776,4250756596,255256311,1640403810,2477592673,2164122517,1922457750,2791048317,1412925310,1197962378,3037525897,3944729517,427051182,170179418,4165941337,746937522,3740196785,3451792453,1070968646,1905808397,2213795598,2426610938,1657317369,3053634322,1147748369,1463399397,2773627110,4215344322,153784257,444234805,3893493558,1021025245,3467647198,3722505002,797665321,2197175160,1889384571,1674398607,2443626636,1164749927,3070701412,2757221520,1446797203,137323447,4198817972,3910406976,461344835,3484808360,1037989803,781091935,3705997148,2460548119,1623424788,1939049696,2180517859,1429367560,2807687179,3020495871,1180866812,410100952,3927582683,4182430767,186734380,3756733383,763408580,1053836080,3434856499,2722870694,1344288421,1131464017,2971354706,1708204729,2545590714,2229949006,1988219213,680717673,3673779818,3383336350,1002577565,4010310262,493091189,238226049,4233660802,2987750089,1082061258,1395524158,2705686845,1972364758,2279892693,2494862625,1725896226,952904198,3399985413,3656866545,731699698,4283874585,222117402,510512622,3959836397,3280807620,837199303,582374963,3504198960,68661723,4135334616,3844915500,390545967,1230274059,3141532936,2825850620,1510247935,2395924756,2091215383,1878366691,2644384480,3553878443,565732008,854102364,3229815391,340358836,3861050807,4117890627,119113024,1493875044,2875275879,3090270611,1247431312,2660249211,1828433272,2141937292,2378227087,3811616794,291187481,34330861,4032846830,615137029,3603020806,3314634738,939183345,1776939221,2609017814,2295496738,2058945313,2926798794,1545135305,1330124605,3173225534,4084100981,17165430,307568514,3762199681,888469610,3332340585,3587147933,665062302,2042050490,2346497209,2559330125,1793573966,3190661285,1279665062,1595330642,2910671697],o=(0,r.uint32ArrayFrom)(i),a=lx();Object.defineProperty(t,"AwsCrc32c",{enumerable:!0,get:function(){return a.AwsCrc32c}})}(da)),da}var ux=Bp();const Np=(t,e)=>({[Re.MD5]:e.md5,[Re.CRC32]:tc.AwsCrc32,[Re.CRC32C]:ux.AwsCrc32c,[Re.SHA1]:e.sha1,[Re.SHA256]:e.sha256})[t],Mp=(t,e)=>{const r=new t;return r.update(qr(e||"")),r.digest()},dx={name:"flexibleChecksumsMiddleware",step:"build",tags:["BODY_CHECKSUM"],override:!0},hx=(t,e)=>(r,s)=>async n=>{if(!We.isInstance(n.request))return r(n);const{request:i}=n,{body:o,headers:a}=i,{base64Encoder:c,streamHasher:l}=t,{input:u,requestChecksumRequired:d,requestAlgorithmMember:h}=e,m=ax(u,{requestChecksumRequired:d,requestAlgorithmMember:h},!!s.isS3ExpressBucket);let g=o,p=a;if(m){const E=Gc(m),C=Np(m,t);if(Wc(o)){const{getAwsChunkedEncodingStream:R,bodyLengthChecker:L}=t;g=R(o,{base64Encoder:c,bodyLengthChecker:L,checksumLocationName:E,checksumAlgorithmFn:C,streamHasher:l}),p={...a,"content-encoding":a["content-encoding"]?`${a["content-encoding"]},aws-chunked`:"aws-chunked","transfer-encoding":"chunked","x-amz-decoded-content-length":a["content-length"],"x-amz-content-sha256":"STREAMING-UNSIGNED-PAYLOAD-TRAILER","x-amz-trailer":E},delete p["content-length"]}else if(!cx(E,a)){const R=await Mp(C,o);p={...a,[E]:c(R)}}}return await r({...n,request:{...i,headers:p,body:g}})},Dp=(t=[])=>{const e=[];for(const r of ox)!t.includes(r)||!Na.includes(r)||e.push(r);return e},fx=t=>{const e=t.lastIndexOf("-");if(e!==-1){const r=t.slice(e+1);if(!r.startsWith("0")){const s=parseInt(r,10);if(!isNaN(s)&&s>=1&&s<=1e4)return!0}}return!1};function eh(t){return new Blob([t]).stream()}const px=async(t,{streamHasher:e,checksumAlgorithmFn:r,base64Encoder:s})=>{const n=Wc(t)?e(r,t):Mp(r,t);return s(await n)},gx=async(t,{config:e,responseAlgorithms:r})=>{const s=Dp(r),{body:n,headers:i}=t;for(const o of s){const a=Gc(o),c=i[a];if(c){const l=Np(o,e),{streamHasher:u,base64Encoder:d}=e,h=await px(n,{streamHasher:u,checksumAlgorithmFn:l,base64Encoder:d});if(h===c)break;throw new Error(`Checksum mismatch: expected "${h}" but received "${c}" in response header "${a}".`)}}},mx={name:"flexibleChecksumsResponseMiddleware",toMiddleware:"deserializerMiddleware",relation:"after",tags:["BODY_CHECKSUM"],override:!0},yx=(t,e)=>(r,s)=>async n=>{if(!We.isInstance(n.request))return r(n);const i=n.input,o=await r(n),a=o.response;let c;const{requestValidationModeMember:l,responseAlgorithms:u}=e;if(l&&i[l]==="ENABLED"){const{clientName:d,commandName:h}=s;if(d==="S3Client"&&h==="GetObjectCommand"&&Dp(u).every(p=>{const w=Gc(p),E=a.headers[w];return!E||fx(E)}))return o;const g=Wc(a.body);g&&(c=await t.streamCollector(a.body),a.body=eh(c)),await gx(o.response,{config:t,responseAlgorithms:u}),g&&c&&(a.body=eh(c))}return o},Fp=(t,e)=>({applyToStack:r=>{r.add(hx(t,e),dx),r.addRelativeTo(yx(t,e),mx)}});class wx extends es.classBuilder().ep({...rn,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,r,s,n){return[en(s,this.serialize,this.deserialize),tn(s,e.getEndpointParameterInstructions()),Vc(s),zh(),Fp(s,{input:this.input,requestChecksumRequired:!1,requestValidationModeMember:"ChecksumMode",responseAlgorithms:["CRC32","CRC32C","SHA256","SHA1"]})]}).s("AmazonS3","GetObject",{}).n("S3Client","GetObjectCommand").f(H_,j_).ser(fE).de(wE).build(){}class bx extends es.classBuilder().ep({...rn,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,r,s,n){return[en(s,this.serialize,this.deserialize),tn(s,e.getEndpointParameterInstructions()),Vc(s),zh()]}).s("AmazonS3","HeadObject",{}).n("S3Client","HeadObjectCommand").f(z_,q_).ser(pE).de(bE).build(){}class _x extends es.classBuilder().ep({...rn,Bucket:{type:"contextParams",name:"Bucket"},Prefix:{type:"contextParams",name:"Prefix"}}).m(function(e,r,s,n){return[en(s,this.serialize,this.deserialize),tn(s,e.getEndpointParameterInstructions())]}).s("AmazonS3","ListObjectsV2",{}).n("S3Client","ListObjectsV2Command").f(void 0,void 0).ser(gE).de(_E).build(){}class vx extends es.classBuilder().ep({...rn,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,r,s,n){return[en(s,this.serialize,this.deserialize),tn(s,e.getEndpointParameterInstructions()),py(),Vc(s),Fp(s,{input:this.input,requestAlgorithmMember:"ChecksumAlgorithm",requestChecksumRequired:!1})]}).s("AmazonS3","PutObject",{}).n("S3Client","PutObjectCommand").f(dE,uE).ser(mE).de(vE).build(){}let It=null;function $p(t){const e=["csv","tsv","json","txt"];try{const r=t.split(".");if(r.length){const s=r.pop();if(e.includes(s))return s;throw new Error(`unsupported format: ${s}`)}throw new Error("no extension in filename")}catch(r){throw r}}async function Ex({data:t,format:e}){try{let r=null;return e==="csv"&&(r=gg(t)),e==="tsv"&&(r=yg(t)),e==="json"&&(r=JSON.stringify(t)),e==="txt"&&(r=t),r}catch{throw new Error(`issue stringifying data as a ${e}`)}}async function Sx(t){return new Promise((e,r)=>{const s=[];t.on("data",n=>s.push(n)),t.on("end",()=>e(Buffer.concat(s))),t.on("error",r)})}async function xx({stream:t,format:e}){try{const s=(await Sx(t)).toString("utf8");let n=null;return e==="csv"&&(n=pg(s)),e==="tsv"&&(n=mg(s)),e==="json"&&(n=JSON.parse(s)),e==="txt"&&(n=s),n}catch{throw new Error(`issue parsing data as a ${e}`)}}function Pi(t){const e=t.startsWith("/"),r=t.endsWith("/");return t.substring(e?1:0).slice(0,r?-1:t.length)}async function Ax({bucket:t,path:e="",file:r,data:s}){if(!It)throw new Error("data-s3 not intialized");if(!t||!r||!s)throw new Error("missing parameters");try{const n=await $p(r),i=await Ex({data:s,format:n}),o={Bucket:`${t}`,Body:i,Key:`${Pi(e)}/${r}`};return await It.send(new vx(o)),!0}catch(n){throw n}}async function Cx({bucket:t,path:e="",file:r}){if(!It)throw new Error("data-s3 not intialized");if(!t||!r)throw new Error("missing parameters");try{const s={Bucket:t,Key:`${Pi(e)}/${r}`},{Body:n}=await It.send(new wx(s)),i=n,o=await $p(s.Key);return await xx({stream:i,format:o})}catch(s){throw s}}async function kx({bucket:t,path:e="",file:r}){try{if(!It)throw new Error("data-s3 not intialized");if(!t||!r)throw new Error("missing parameters");const s={Bucket:`${t}`,Key:`${Pi(e)}/${r}`};return await It.send(new bx(s)),!0}catch(s){if(s.name==="NotFound")return!1;throw s}}async function Rx({bucket:t,path:e=""}){try{if(!It)throw new Error("data-s3 not intialized");if(!t)throw new Error("missing parameters");const r={Bucket:t,Prefix:Pi(e)};return(await It.send(new _x(r))).Contents.map(i=>i.Key.replace(`${r.Prefix}/`,"")).filter(i=>i)}catch(r){throw r}}async function Tx({accessKeyId:t,secretAccessKey:e,region:r}){if(!r)throw new Error("data-s3 init: missing region");if(!t||!e)throw new Error("data-s3 init: missing credentials");{const s={accessKeyId:t,secretAccessKey:e};It=new tx({region:r,credentials:s})}}const Ox={init:Tx,upload:Ax,download:Cx,exists:kx,list:Rx},Px=t=>({}),th=t=>({});function rh(t){let e;return{c(){e=zt("path"),this.h()},l(r){e=Kt(r,"path",{class:!0,d:!0}),j(e).forEach(I),this.h()},h(){F(e,"class","prev svelte-75c590"),F(e,"d",t[2])},m(r,s){ge(r,e,s)},p(r,s){s&4&&F(e,"d",r[2])},d(r){r&&I(e)}}}function sh(t){let e,r,s,n;return{c(){e=M("p"),r=M("small"),s=he(t[3]),this.h()},l(i){e=D(i,"P",{class:!0});var o=j(e);r=D(o,"SMALL",{});var a=j(r);s=fe(a,t[3]),a.forEach(I),o.forEach(I),this.h()},h(){F(e,"class","message svelte-75c590")},m(i,o){ge(i,e,o),A(e,r),A(r,s)},p(i,o){o&8&&Ke(s,i[3])},i(i){i&&(n||Jp(()=>{n=Zp(e,tg,{}),n.start()}))},o:Ur,d(i){i&&I(e)}}}function Ix(t){let e,r,s,n,i,o,a,c,l,u,d=t[2]&&rh(t),h=t[3]&&sh(t);const m=t[18].ui,g=qp(m,t,t[17],th);return{c(){e=M("div"),r=M("div"),s=zt("svg"),n=zt("g"),d&&d.c(),i=zt("path"),o=Z(),h&&h.c(),a=Z(),g&&g.c(),this.h()},l(p){e=D(p,"DIV",{class:!0});var w=j(e);r=D(w,"DIV",{class:!0,style:!0});var E=j(r);s=Kt(E,"svg",{class:!0,"aria-label":!0});var C=j(s);n=Kt(C,"g",{});var R=j(n);d&&d.l(R),i=Kt(R,"path",{d:!0,class:!0}),j(i).forEach(I),R.forEach(I),C.forEach(I),o=Q(E),h&&h.l(E),E.forEach(I),w.forEach(I),a=Q(p),g&&g.l(p),this.h()},h(){F(i,"d",t[0]),F(i,"class","svelte-75c590"),F(s,"class","draw shadow svelte-75c590"),F(s,"aria-label","a drawing canvas to trace an image drawn by a previous user"),F(r,"class","canvas svelte-75c590"),zp(r,"--stroke-width",Lp),F(e,"class","c svelte-75c590"),Ln(e,"disabled",t[1])},m(p,w){ge(p,e,w),A(e,r),A(r,s),A(s,n),d&&d.m(n,null),A(n,i),A(r,o),h&&h.m(r,null),ge(p,a,w),g&&g.m(p,w),c=!0,l||(u=[Ot(e,"pointerdown",t[4]),Ot(e,"pointermove",t[5]),Ot(e,"pointerup",t[6]),Ot(e,"pointerleave",t[6])],l=!0)},p(p,[w]){p[2]?d?d.p(p,w):(d=rh(p),d.c(),d.m(n,i)):d&&(d.d(1),d=null),(!c||w&1)&&F(i,"d",p[0]),p[3]?h?(h.p(p,w),w&8&&rt(h,1)):(h=sh(p),h.c(),rt(h,1),h.m(r,null)):h&&(h.d(1),h=null),(!c||w&2)&&Ln(e,"disabled",p[1]),g&&g.p&&(!c||w&131072)&&Kp(g,m,p,p[17],c?Gp(m,p[17],w,Px):Vp(p[17]),th)},i(p){c||(rt(h),rt(g,p),c=!0)},o(p){Vt(g,p),c=!1},d(p){p&&(I(e),I(a)),d&&d.d(),h&&h.d(),g&&g.d(p),l=!1,yh(u)}}}const Lp=4,nh=320;function ih(t){const e=+t.offsetX.toFixed(1),r=+t.offsetY.toFixed(1);return[e,r]}function Bx(t,e,r){let{$$slots:s={},$$scope:n}=e,{animationId:i}=e,{preset:o}=e,{path:a}=e,{disabled:c}=e,{inkRem:l=1}=e;const u=nh*(i===28?3:5),d=Wp(),h=!!o;let m=!1,g=!1,p=[],w="",E=!0,C=0;const R=kt,L=Be,re=Ye,ce=Ee;function q(ne){return ne.length?`M${p.map(Ne=>Ne.join(" ")).join("L")}`:""}function X(ne){r(3,Ee=null),r(14,m=!1),r(7,l=1),g=!0;const at=ih(ne);r(15,p=[at])}function ee(ne){if(!g||m)return;const at=ih(ne);r(15,p=[...p,at]);const Ne=eg(p);Ne>u&&r(14,m=!0),r(7,l=Math.max(0,(u-Ne)/u))}function te(){g=!1}function Y(){if(!p.length){r(3,Ee="Draw something first!"),d("validate",!1),setTimeout(()=>{r(3,Ee=null)},2e3);return}h?(C+=1,r(16,E=rg({cur:a,prev:w,canvasSize:nh,strokeWidth:Lp,attempts:C})),d("validate",E)):r(16,E=!0),E||setTimeout(()=>{r(16,E=void 0)},2e3),r(15,p=[]),r(7,l=1)}function Ye(){r(15,p=[]),r(7,l=1),r(3,Ee=null),r(14,m=!1),r(16,E=!0)}function kt(){Y()}function Be(){Ye()}function Ee(ne){r(3,Ee=ne)}return Da(()=>{r(2,w=o||"")}),t.$$set=ne=>{"animationId"in ne&&r(8,i=ne.animationId),"preset"in ne&&r(9,o=ne.preset),"path"in ne&&r(0,a=ne.path),"disabled"in ne&&r(1,c=ne.disabled),"inkRem"in ne&&r(7,l=ne.inkRem),"$$scope"in ne&&r(17,n=ne.$$scope)},t.$$.update=()=>{t.$$.dirty&32768&&r(0,a=q(p)),t.$$.dirty&81920&&r(3,Ee=E===!1?"I think you can do better!":m?"Out of ink":null)},[a,c,w,Ee,X,ee,te,l,i,o,R,L,re,ce,m,p,E,n,s]}class Nx extends Fa{constructor(e){super(),$a(this,e,Bx,Ix,Ma,{animationId:8,preset:9,path:0,disabled:1,inkRem:7,addFrame:10,clearFrame:11,resetFrame:12,addMessage:13})}get addFrame(){return this.$$.ctx[10]}get clearFrame(){return this.$$.ctx[11]}get resetFrame(){return this.$$.ctx[12]}get addMessage(){return this.$$.ctx[13]}}function oh(t){let e;return{c(){e=zt("path"),this.h()},l(r){e=Kt(r,"path",{d:!0,class:!0}),j(e).forEach(I),this.h()},h(){F(e,"d",t[1]),F(e,"class","svelte-10hml6n")},m(r,s){ge(r,e,s)},p(r,s){s&2&&F(e,"d",r[1])},d(r){r&&I(e)}}}function Mx(t){let e,r,s,n,i,o=t[1]&&oh(t);return{c(){e=M("div"),r=M("p"),s=he(t[0]),n=Z(),i=zt("svg"),o&&o.c(),this.h()},l(a){e=D(a,"DIV",{class:!0});var c=j(e);r=D(c,"P",{class:!0});var l=j(r);s=fe(l,t[0]),l.forEach(I),n=Q(c),i=Kt(c,"svg",{width:!0,height:!0,viewBox:!0,class:!0});var u=j(i);o&&o.l(u),u.forEach(I),c.forEach(I),this.h()},h(){F(r,"class","svelte-10hml6n"),F(i,"width","160"),F(i,"height","160"),F(i,"viewBox","0 0 320 320"),F(i,"class","svelte-10hml6n"),F(e,"class","svelte-10hml6n")},m(a,c){ge(a,e,c),A(e,r),A(r,s),A(e,n),A(e,i),o&&o.m(i,null)},p(a,[c]){c&1&&Ke(s,a[0]),a[1]?o?o.p(a,c):(o=oh(a),o.c(),o.m(i,null)):o&&(o.d(1),o=null)},i:Ur,o:Ur,d(a){a&&I(e),o&&o.d()}}}function Dx(t,e,r){let{shortcode:s}=e,{frame_index:n}=e,{animation_id:i}=e,o;return Da(async()=>{const c=`https://pudding.cool/projects/flipbook-data/drawings/${i}/${s}.txt?version=${Date.now()}`,l=await fetch(c);r(1,o=await l.text())}),t.$$set=a=>{"shortcode"in a&&r(2,s=a.shortcode),"frame_index"in a&&r(0,n=a.frame_index),"animation_id"in a&&r(3,i=a.animation_id)},[n,o,s,i]}class Fx extends Fa{constructor(e){super(),$a(this,e,Dx,Mx,Ma,{shortcode:2,frame_index:0,animation_id:3})}}function ah(t,e,r){const s=t.slice();return s[20]=e[r][0],s[21]=e[r][1],s}function ch(t,e,r){const s=t.slice();return s[24]=e[r].shortcode,s[25]=e[r].frame_index,s[26]=e[r].animation_id,s}function lh(t,e,r){const s=t.slice();return s[20]=e[r],s}function uh(t,e,r){const s=t.slice();s[31]=e[r];const n=s[31].updated;return s[5]=n,s}function dh(t){let e,r,s=t[31].id+"",n,i,o,a=t[31].frame_index+"",c,l,u,d=t[31].shortcode+"",h,m,g,p=t[31].user_id+"",w,E,C,R,L=t[31].paused?"Resume":"Pause",re,ce,q,X;function ee(){return t[10](t[31])}return{c(){e=M("tr"),r=M("td"),n=he(s),i=Z(),o=M("td"),c=he(a),l=Z(),u=M("td"),h=he(d),m=Z(),g=M("td"),w=he(p),E=Z(),C=M("td"),R=M("button"),re=he(L),ce=Z(),this.h()},l(te){e=D(te,"TR",{class:!0});var Y=j(e);r=D(Y,"TD",{class:!0});var Ye=j(r);n=fe(Ye,s),Ye.forEach(I),i=Q(Y),o=D(Y,"TD",{class:!0});var kt=j(o);c=fe(kt,a),kt.forEach(I),l=Q(Y),u=D(Y,"TD",{class:!0});var Be=j(u);h=fe(Be,d),Be.forEach(I),m=Q(Y),g=D(Y,"TD",{class:!0});var Ee=j(g);w=fe(Ee,p),Ee.forEach(I),E=Q(Y),C=D(Y,"TD",{class:!0});var ne=j(C);R=D(ne,"BUTTON",{class:!0});var at=j(R);re=fe(at,L),at.forEach(I),ne.forEach(I),ce=Q(Y),Y.forEach(I),this.h()},h(){F(r,"class","svelte-8frgn7"),F(o,"class","svelte-8frgn7"),F(u,"class","svelte-8frgn7"),F(g,"class","svelte-8frgn7"),F(R,"class","small"),F(C,"class","svelte-8frgn7"),F(e,"class","svelte-8frgn7"),Ln(e,"updated",t[5])},m(te,Y){ge(te,e,Y),A(e,r),A(r,n),A(e,i),A(e,o),A(o,c),A(e,l),A(e,u),A(u,h),A(e,m),A(e,g),A(g,w),A(e,E),A(e,C),A(C,R),A(R,re),A(e,ce),q||(X=Ot(R,"click",ee),q=!0)},p(te,Y){t=te,Y[0]&1&&s!==(s=t[31].id+"")&&Ke(n,s),Y[0]&1&&a!==(a=t[31].frame_index+"")&&Ke(c,a),Y[0]&1&&d!==(d=t[31].shortcode+"")&&Ke(h,d),Y[0]&1&&p!==(p=t[31].user_id+"")&&Ke(w,p),Y[0]&1&&L!==(L=t[31].paused?"Resume":"Pause")&&Ke(re,L),Y[0]&1&&Ln(e,"updated",t[5])},d(te){te&&I(e),q=!1,X()}}}function hh(t){let e,r,s,n,i=t[20].id+"",o,a,c=t[20].frame_index+"",l,u,d,h,m,g;return{c(){e=M("div"),r=M("p"),s=M("mark"),n=he("animation: "),o=he(i),a=he(" frame: "),l=he(c),u=Z(),d=zt("svg"),h=zt("path"),g=Z(),this.h()},l(p){e=D(p,"DIV",{class:!0});var w=j(e);r=D(w,"P",{});var E=j(r);s=D(E,"MARK",{});var C=j(s);n=fe(C,"animation: "),o=fe(C,i),a=fe(C," frame: "),l=fe(C,c),C.forEach(I),E.forEach(I),u=Q(w),d=Kt(w,"svg",{class:!0});var R=j(d);h=Kt(R,"path",{d:!0,class:!0}),j(h).forEach(I),R.forEach(I),g=Q(w),w.forEach(I),this.h()},h(){F(h,"d",m=t[20].drawing),F(h,"class","svelte-8frgn7"),F(d,"class","svelte-8frgn7"),F(e,"class","animation svelte-8frgn7")},m(p,w){ge(p,e,w),A(e,r),A(r,s),A(s,n),A(s,o),A(s,a),A(s,l),A(e,u),A(e,d),A(d,h),A(e,g)},p(p,w){w[0]&1&&i!==(i=p[20].id+"")&&Ke(o,i),w[0]&1&&c!==(c=p[20].frame_index+"")&&Ke(l,c),w[0]&1&&m!==(m=p[20].drawing)&&F(h,"d",m)},d(p){p&&I(e)}}}function fh(t){let e,r,s,n;return r=new Fx({props:{shortcode:t[24],animation_id:t[26],frame_index:t[25]}}),{c(){e=M("li"),_h(r.$$.fragment),s=Z(),this.h()},l(i){e=D(i,"LI",{class:!0});var o=j(e);vh(r.$$.fragment,o),s=Q(o),o.forEach(I),this.h()},h(){F(e,"class","svelte-8frgn7")},m(i,o){ge(i,e,o),Eh(r,e,null),A(e,s),n=!0},p(i,o){const a={};o[0]&2&&(a.shortcode=i[24]),o[0]&2&&(a.animation_id=i[26]),o[0]&2&&(a.frame_index=i[25]),r.$set(a)},i(i){n||(rt(r.$$.fragment,i),n=!0)},o(i){Vt(r.$$.fragment,i),n=!1},d(i){i&&I(e),Sh(r)}}}function ph(t){let e,r,s,n,i=t[20]+"",o,a,c,l,u,d=jt(t[21]),h=[];for(let g=0;g<d.length;g+=1)h[g]=fh(ch(t,d,g));const m=g=>Vt(h[g],1,1,()=>{h[g]=null});return{c(){e=M("div"),r=M("p"),s=M("mark"),n=he("animation: "),o=he(i),a=Z(),c=M("ul");for(let g=0;g<h.length;g+=1)h[g].c();l=Z(),this.h()},l(g){e=D(g,"DIV",{class:!0});var p=j(e);r=D(p,"P",{});var w=j(r);s=D(w,"MARK",{});var E=j(s);n=fe(E,"animation: "),o=fe(E,i),E.forEach(I),w.forEach(I),a=Q(p),c=D(p,"UL",{class:!0});var C=j(c);for(let R=0;R<h.length;R+=1)h[R].l(C);C.forEach(I),l=Q(p),p.forEach(I),this.h()},h(){F(c,"class","svelte-8frgn7"),F(e,"class","animation svelte-8frgn7")},m(g,p){ge(g,e,p),A(e,r),A(r,s),A(s,n),A(s,o),A(e,a),A(e,c);for(let w=0;w<h.length;w+=1)h[w]&&h[w].m(c,null);A(e,l),u=!0},p(g,p){if((!u||p[0]&2)&&i!==(i=g[20]+"")&&Ke(o,i),p[0]&2){d=jt(g[21]);let w;for(w=0;w<d.length;w+=1){const E=ch(g,d,w);h[w]?(h[w].p(E,p),rt(h[w],1)):(h[w]=fh(E),h[w].c(),rt(h[w],1),h[w].m(c,null))}for(bh(),w=d.length;w<h.length;w+=1)m(w);wh()}},i(g){if(!u){for(let p=0;p<d.length;p+=1)rt(h[p]);u=!0}},o(g){h=h.filter(Boolean);for(let p=0;p<h.length;p+=1)Vt(h[p]);u=!1},d(g){g&&I(e),Tn(h,g)}}}function $x(t){let e,r,s;function n(o){t[15](o)}let i={};return t[2]!==void 0&&(i.path=t[2]),e=new Nx({props:i}),Xp.push(()=>Qp(e,"path",n)),{c(){_h(e.$$.fragment)},l(o){vh(e.$$.fragment,o)},m(o,a){Eh(e,o,a),s=!0},p(o,a){const c={};!r&&a[0]&4&&(r=!0,c.path=o[2],Yp(()=>r=!1)),e.$set(c)},i(o){s||(rt(e.$$.fragment,o),s=!0)},o(o){Vt(e.$$.fragment,o),s=!1},d(o){Sh(e,o)}}}function Lx(t){let e,r="Animation Created!";return{c(){e=M("p"),e.textContent=r},l(s){e=D(s,"P",{"data-svelte-h":!0}),Qe(e)!=="svelte-vkhmzv"&&(e.textContent=r)},m(s,n){ge(s,e,n)},p:Ur,i:Ur,o:Ur,d(s){s&&I(e)}}}function Ux(t){let e,r,s="Admin Dashboard",n,i,o,a,c,l,u,d,h,m,g,p,w="Current",E,C,R,L='<tr class="svelte-8frgn7"><th class="svelte-8frgn7">ID</th> <th class="svelte-8frgn7">Frame Index</th> <th class="svelte-8frgn7">Shortcode</th> <th class="svelte-8frgn7">User ID</th> <th class="svelte-8frgn7">Pause</th></tr>',re,ce,q,X,ee,te="Previous",Y,Ye,kt,Be,Ee,ne="Recent Frames",at,Ne,Zt,Jc="10",Ii,Qt,Xc="20",Bi,er,Yc="30",Ni,tr,Zc="40",Mi,rr,an,Rt,sr,Qc="Public Data",Di,nr,Fi,ir,$i,os=JSON.stringify(t[3],null,2)+"",cn,Li,Ui,ln,ct,or,el="New Animation",ji,as,Ar,Hi,ar,Cr,tl="Path Code",qi,cs,un,Bt,zi,rl,kr=jt(t[0]),Oe=[];for(let k=0;k<kr.length;k+=1)Oe[k]=dh(uh(t,kr,k));let Rr=jt(t[0].filter(mh)),Pe=[];for(let k=0;k<Rr.length;k+=1)Pe[k]=hh(lh(t,Rr,k));let cr=jt(t[1]),de=[];for(let k=0;k<cr.length;k+=1)de[k]=ph(ah(t,cr,k));const Up=k=>Vt(de[k],1,1,()=>{de[k]=null}),jp=[Lx,$x],Ki=[];function Hp(k,K){return k[6]?0:1}return as=Hp(t),Ar=Ki[as]=jp[as](t),{c(){e=M("section"),r=M("h1"),r.textContent=s,n=Z(),i=M("p"),o=he("last public update: "),a=he(t[4]),c=he(" seconds ago"),l=Z(),u=M("p"),d=M("small"),h=he(t[5]),m=Z(),g=M("section"),p=M("h2"),p.textContent=w,E=Z(),C=M("table"),R=M("thead"),R.innerHTML=L,re=Z(),ce=M("tbody");for(let k=0;k<Oe.length;k+=1)Oe[k].c();q=Z(),X=M("section"),ee=M("h2"),ee.textContent=te,Y=Z(),Ye=M("div");for(let k=0;k<Pe.length;k+=1)Pe[k].c();kt=Z(),Be=M("section"),Ee=M("h2"),Ee.textContent=ne,at=Z(),Ne=M("p"),Zt=M("button"),Zt.textContent=Jc,Ii=Z(),Qt=M("button"),Qt.textContent=Xc,Bi=Z(),er=M("button"),er.textContent=Yc,Ni=Z(),tr=M("button"),tr.textContent=Zc,Mi=Z(),rr=M("div");for(let k=0;k<de.length;k+=1)de[k].c();an=Z(),Rt=M("section"),sr=M("h2"),sr.textContent=Qc,Di=Z(),nr=M("pre"),Fi=he("		"),ir=M("code"),$i=he(`
`),cn=he(os),Li=he(`
	`),Ui=he(`
	`),ln=Z(),ct=M("section"),or=M("h2"),or.textContent=el,ji=Z(),Ar.c(),Hi=Z(),ar=M("details"),Cr=M("summary"),Cr.textContent=tl,qi=Z(),cs=M("code"),un=he(t[2]),this.h()},l(k){e=D(k,"SECTION",{class:!0});var K=j(e);r=D(K,"H1",{class:!0,"data-svelte-h":!0}),Qe(r)!=="svelte-ijv2ub"&&(r.textContent=s),n=Q(K),i=D(K,"P",{});var N=j(i);o=fe(N,"last public update: "),a=fe(N,t[4]),c=fe(N," seconds ago"),N.forEach(I),l=Q(K),u=D(K,"P",{});var lt=j(u);d=D(lt,"SMALL",{});var sl=j(d);h=fe(sl,t[5]),sl.forEach(I),lt.forEach(I),K.forEach(I),m=Q(k),g=D(k,"SECTION",{class:!0});var dn=j(g);p=D(dn,"H2",{class:!0,"data-svelte-h":!0}),Qe(p)!=="svelte-1xgllxh"&&(p.textContent=w),E=Q(dn),C=D(dn,"TABLE",{id:!0,class:!0});var hn=j(C);R=D(hn,"THEAD",{"data-svelte-h":!0}),Qe(R)!=="svelte-13kjonr"&&(R.innerHTML=L),re=Q(hn),ce=D(hn,"TBODY",{});var nl=j(ce);for(let ut=0;ut<Oe.length;ut+=1)Oe[ut].l(nl);nl.forEach(I),hn.forEach(I),dn.forEach(I),q=Q(k),X=D(k,"SECTION",{class:!0});var fn=j(X);ee=D(fn,"H2",{class:!0,"data-svelte-h":!0}),Qe(ee)!=="svelte-10fc9cz"&&(ee.textContent=te),Y=Q(fn),Ye=D(fn,"DIV",{class:!0});var il=j(Ye);for(let ut=0;ut<Pe.length;ut+=1)Pe[ut].l(il);il.forEach(I),fn.forEach(I),kt=Q(k),Be=D(k,"SECTION",{class:!0});var Tr=j(Be);Ee=D(Tr,"H2",{class:!0,"data-svelte-h":!0}),Qe(Ee)!=="svelte-1ahqmvr"&&(Ee.textContent=ne),at=Q(Tr),Ne=D(Tr,"P",{});var Nt=j(Ne);Zt=D(Nt,"BUTTON",{"data-svelte-h":!0}),Qe(Zt)!=="svelte-1qqzxl0"&&(Zt.textContent=Jc),Ii=Q(Nt),Qt=D(Nt,"BUTTON",{"data-svelte-h":!0}),Qe(Qt)!=="svelte-1eq9ah2"&&(Qt.textContent=Xc),Bi=Q(Nt),er=D(Nt,"BUTTON",{"data-svelte-h":!0}),Qe(er)!=="svelte-1hxyrxk"&&(er.textContent=Yc),Ni=Q(Nt),tr=D(Nt,"BUTTON",{"data-svelte-h":!0}),Qe(tr)!=="svelte-19pgsa9"&&(tr.textContent=Zc),Nt.forEach(I),Mi=Q(Tr),rr=D(Tr,"DIV",{class:!0});var ol=j(rr);for(let ut=0;ut<de.length;ut+=1)de[ut].l(ol);ol.forEach(I),Tr.forEach(I),an=Q(k),Rt=D(k,"SECTION",{class:!0});var pn=j(Rt);sr=D(pn,"H2",{class:!0,"data-svelte-h":!0}),Qe(sr)!=="svelte-jl0w0v"&&(sr.textContent=Qc),Di=Q(pn),nr=D(pn,"PRE",{});var gn=j(nr);Fi=fe(gn,"		"),ir=D(gn,"CODE",{});var mn=j(ir);$i=fe(mn,`
`),cn=fe(mn,os),Li=fe(mn,`
	`),mn.forEach(I),Ui=fe(gn,`
	`),gn.forEach(I),pn.forEach(I),ln=Q(k),ct=D(k,"SECTION",{class:!0});var Or=j(ct);or=D(Or,"H2",{class:!0,"data-svelte-h":!0}),Qe(or)!=="svelte-14c2nra"&&(or.textContent=el),ji=Q(Or),Ar.l(Or),Hi=Q(Or),ar=D(Or,"DETAILS",{});var yn=j(ar);Cr=D(yn,"SUMMARY",{"data-svelte-h":!0}),Qe(Cr)!=="svelte-167df54"&&(Cr.textContent=tl),qi=Q(yn),cs=D(yn,"CODE",{});var al=j(cs);un=fe(al,t[2]),al.forEach(I),yn.forEach(I),Or.forEach(I),this.h()},h(){F(r,"class","svelte-8frgn7"),F(e,"class","svelte-8frgn7"),F(p,"class","svelte-8frgn7"),F(C,"id","animations"),F(C,"class","svelte-8frgn7"),F(g,"class","svelte-8frgn7"),F(ee,"class","svelte-8frgn7"),F(Ye,"class","previous svelte-8frgn7"),F(X,"class","svelte-8frgn7"),F(Ee,"class","svelte-8frgn7"),F(rr,"class","frames"),F(Be,"class","svelte-8frgn7"),F(sr,"class","svelte-8frgn7"),F(Rt,"class","svelte-8frgn7"),F(or,"class","svelte-8frgn7"),F(ct,"class","svelte-8frgn7")},m(k,K){ge(k,e,K),A(e,r),A(e,n),A(e,i),A(i,o),A(i,a),A(i,c),A(e,l),A(e,u),A(u,d),A(d,h),ge(k,m,K),ge(k,g,K),A(g,p),A(g,E),A(g,C),A(C,R),A(C,re),A(C,ce);for(let N=0;N<Oe.length;N+=1)Oe[N]&&Oe[N].m(ce,null);ge(k,q,K),ge(k,X,K),A(X,ee),A(X,Y),A(X,Ye);for(let N=0;N<Pe.length;N+=1)Pe[N]&&Pe[N].m(Ye,null);ge(k,kt,K),ge(k,Be,K),A(Be,Ee),A(Be,at),A(Be,Ne),A(Ne,Zt),A(Ne,Ii),A(Ne,Qt),A(Ne,Bi),A(Ne,er),A(Ne,Ni),A(Ne,tr),A(Be,Mi),A(Be,rr);for(let N=0;N<de.length;N+=1)de[N]&&de[N].m(rr,null);ge(k,an,K),ge(k,Rt,K),A(Rt,sr),A(Rt,Di),A(Rt,nr),A(nr,Fi),A(nr,ir),A(ir,$i),A(ir,cn),A(ir,Li),A(nr,Ui),ge(k,ln,K),ge(k,ct,K),A(ct,or),A(ct,ji),Ki[as].m(ct,null),A(ct,Hi),A(ct,ar),A(ar,Cr),A(ar,qi),A(ar,cs),A(cs,un),Bt=!0,zi||(rl=[Ot(Zt,"click",t[11]),Ot(Qt,"click",t[12]),Ot(er,"click",t[13]),Ot(tr,"click",t[14])],zi=!0)},p(k,K){if((!Bt||K[0]&16)&&Ke(a,k[4]),(!Bt||K[0]&32)&&Ke(h,k[5]),K[0]&129){kr=jt(k[0]);let N;for(N=0;N<kr.length;N+=1){const lt=uh(k,kr,N);Oe[N]?Oe[N].p(lt,K):(Oe[N]=dh(lt),Oe[N].c(),Oe[N].m(ce,null))}for(;N<Oe.length;N+=1)Oe[N].d(1);Oe.length=kr.length}if(K[0]&1){Rr=jt(k[0].filter(mh));let N;for(N=0;N<Rr.length;N+=1){const lt=lh(k,Rr,N);Pe[N]?Pe[N].p(lt,K):(Pe[N]=hh(lt),Pe[N].c(),Pe[N].m(Ye,null))}for(;N<Pe.length;N+=1)Pe[N].d(1);Pe.length=Rr.length}if(K[0]&2){cr=jt(k[1]);let N;for(N=0;N<cr.length;N+=1){const lt=ah(k,cr,N);de[N]?(de[N].p(lt,K),rt(de[N],1)):(de[N]=ph(lt),de[N].c(),rt(de[N],1),de[N].m(rr,null))}for(bh(),N=cr.length;N<de.length;N+=1)Up(N);wh()}(!Bt||K[0]&8)&&os!==(os=JSON.stringify(k[3],null,2)+"")&&Ke(cn,os),Ar.p(k,K),(!Bt||K[0]&4)&&Ke(un,k[2])},i(k){if(!Bt){for(let K=0;K<cr.length;K+=1)rt(de[K]);rt(Ar),Bt=!0}},o(k){de=de.filter(Boolean);for(let K=0;K<de.length;K+=1)Vt(de[K]);Vt(Ar),Bt=!1},d(k){k&&(I(e),I(m),I(g),I(q),I(X),I(kt),I(Be),I(an),I(Rt),I(ln),I(ct)),Tn(Oe,k),Tn(Pe,k),Tn(de,k),Ki[as].d(),zi=!1,yh(rl)}}}const jx="us-east-1";async function gh({id:t,shortcode:e}){const s=`https://pudding.cool/projects/flipbook-data/drawings/${t}/${e}.txt?version=${Date.now()}`;return await(await fetch(s)).text()}const mh=t=>!t.paused;function Hx(t,e,r){let{data:s}=e;sg();let n,i=[],o=[],a,c,l,u,d;async function h(){try{const q=await n.from("animation").select();if(q.error)throw console.log(q.error),new Error("getAllAnimations failed");if(q.data)return q.data;throw new Error("no animations")}catch(q){console.log(q)}}async function m(q,X){try{const ee=await n.from("animation").update({paused:X}).eq("id",q);if(ee.error)throw console.log(ee.error),new Error("onPause failed");return void 0}catch(ee){console.log(ee)}}async function g(q){try{const X=await n.from("frame").select().order("frame_index",{ascending:!1}).limit(q*i.length);if(X.error)throw console.log(X.error),new Error("getRecentFrames failed");if(X.data){const ee=lg(X.data,te=>te.animation_id);ee.sort((te,Y)=>te[0]-Y[0]),r(1,o=[...ee])}throw new Error("no frames")}catch(X){console.log(X)}}function p(){l?r(4,d=Math.floor((Date.now()-new Date(l.updated))/1e3)):r(4,d="?")}async function w(){const X=await fetch(`https://pudding.cool/projects/flipbook-data/meta.json?version=${Date.now()}`);r(3,l=await X.json()),r(5,u=new Date(l.updated).toLocaleString()),setTimeout(w,5e3)}Da(async()=>{n=Zm(s.supabaseUrl,s.supabaseKey);const{accessKeyId:q,secretAccessKey:X}=s;await Ox.init({accessKeyId:q,secretAccessKey:X,region:jx}),n.channel("custom-all-channel").on("postgres_changes",{event:"*",schema:"public",table:"animation"},async ee=>{if(i.length&&ee.new){const te=i.findIndex(Y=>Y.id===ee.new.id);if(te>-1){i[te]||r(0,i[te]={},i),r(0,i[te]={...i[te],...ee.new,updated:!0},i);const Y=await gh(i[te]);r(0,i[te].drawing=Y,i)}r(0,i),setTimeout(()=>{r(0,i[te].updated=!1,i),r(0,i)},2e3)}}).subscribe(),r(0,i=await h()),i.sort((ee,te)=>te.id-ee.id);for(const ee of i){const te=await gh(ee);ee.drawing=te}r(0,i),w(),setInterval(p,1e3)});const E=q=>m(q.id,!q.paused),C=()=>g(10),R=()=>g(20),L=()=>g(30),re=()=>g(30);function ce(q){a=q,r(2,a)}return t.$$set=q=>{"data"in q&&r(9,s=q.data)},[i,o,a,l,d,u,c,m,g,s,E,C,R,L,re,ce]}class Qx extends Fa{constructor(e){super(),$a(this,e,Hx,Ux,Ma,{data:9},null,[-1,-1])}}export{Qx as component};
