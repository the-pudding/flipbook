import{T as se,s as J,f as v,g as k,h as $,d,i as g,I as ae,p as K,H as M,a as N,e as U,r as B,c as S,w as T,l as O,m as j,v as y,D as R,n as W,j as X,L as le,u as ne,Q as V}from"../chunks/scheduler.da91aed2.js";import{S as Y,i as Z,g as x,t as C,c as ee,a as w,f as ie,b as D,d as H,m as I,e as L}from"../chunks/index.91142c57.js";import{C as oe,M as re,v as fe,c as q}from"../chunks/version.65cae229.js";import{s as F}from"../chunks/submit.0aa61197.js";import{p as ue}from"../chunks/stores.a3e14b3c.js";function ce(i){const a=se(ue).url.search.split("&").find(n=>n.includes(`${i}=`));if(a)return a.split("=")[1]}function pe(i){let e,t,a=i[6].draw.thanks+"",n,l,s,f,r,c,u=!i[2]&&!i[3]&&Q(i),p=i[2]&&z(i),h=i[3]&&A(i),_=i[2]&&G(i);return{c(){e=v("p"),t=new M(!1),n=N(),u&&u.c(),l=N(),p&&p.c(),s=N(),h&&h.c(),f=N(),_&&_.c(),r=U(),this.h()},l(o){e=k(o,"P",{});var m=$(e);t=B(m,!1),m.forEach(d),n=S(o),u&&u.l(o),l=S(o),p&&p.l(o),s=S(o),h&&h.l(o),f=S(o),_&&_.l(o),r=U(),this.h()},h(){t.a=null},m(o,m){g(o,e,m),t.m(a,e),g(o,n,m),u&&u.m(o,m),g(o,l,m),p&&p.m(o,m),g(o,s,m),h&&h.m(o,m),g(o,f,m),_&&_.m(o,m),g(o,r,m),c=!0},p(o,m){!o[2]&&!o[3]?u?u.p(o,m):(u=Q(o),u.c(),u.m(l.parentNode,l)):u&&(u.d(1),u=null),o[2]?p?p.p(o,m):(p=z(o),p.c(),p.m(s.parentNode,s)):p&&(p.d(1),p=null),o[3]?h?h.p(o,m):(h=A(o),h.c(),h.m(f.parentNode,f)):h&&(h.d(1),h=null),o[2]?_?(_.p(o,m),m&4&&w(_,1)):(_=G(o),_.c(),w(_,1),_.m(r.parentNode,r)):_&&(x(),C(_,1,1,()=>{_=null}),ee())},i(o){c||(w(_),c=!0)},o(o){C(_),c=!1},d(o){o&&(d(e),d(n),d(l),d(s),d(f),d(r)),u&&u.d(o),p&&p.d(o),h&&h.d(o),_&&_.d(o)}}}function _e(i){let e,t,a=i[6].draw.done+"";return{c(){e=v("p"),t=new M(!1),this.h()},l(n){e=k(n,"P",{});var l=$(e);t=B(l,!1),l.forEach(d),this.h()},h(){t.a=null},m(n,l){g(n,e,l),t.m(a,e)},p:T,i:T,o:T,d(n){n&&d(e)}}}function Q(i){let e,t=i[0]?"Loading...":"Start",a,n,l;return{c(){e=v("button"),a=O(t),this.h()},l(s){e=k(s,"BUTTON",{});var f=$(e);a=j(f,t),f.forEach(d),this.h()},h(){e.disabled=i[0]},m(s,f){g(s,e,f),y(e,a),n||(l=R(e,"click",i[7]),n=!0)},p(s,f){f&1&&t!==(t=s[0]?"Loading...":"Start")&&W(a,t),f&1&&(e.disabled=s[0])},d(s){s&&d(e),n=!1,l()}}}function z(i){let e,t,a=i[6].draw.task+"",n,l,s,f=i[6].draw.note+"",r;return{c(){e=v("p"),t=new M(!1),n=N(),l=v("em"),s=O("Note: "),r=O(f),this.h()},l(c){e=k(c,"P",{});var u=$(e);t=B(u,!1),n=S(u),l=k(u,"EM",{});var p=$(l);s=j(p,"Note: "),r=j(p,f),p.forEach(d),u.forEach(d),this.h()},h(){t.a=n},m(c,u){g(c,e,u),t.m(a,e),y(e,n),y(e,l),y(l,s),y(l,r)},p:T,d(c){c&&d(e)}}}function A(i){let e,t;return{c(){e=v("p"),t=O(i[3]),this.h()},l(a){e=k(a,"P",{class:!0});var n=$(e);t=j(n,i[3]),n.forEach(d),this.h()},h(){X(e,"class","error")},m(a,n){g(a,e,n),y(e,t)},p(a,n){n&8&&W(t,a[3])},d(a){a&&d(e)}}}function G(i){let e,t,a;function n(s){i[11](s)}let l={preset:i[2],$$slots:{ui:[me]},$$scope:{ctx:i}};return i[1]!==void 0&&(l.path=i[1]),e=new oe({props:l}),i[10](e),K.push(()=>ie(e,"path",n)),e.$on("validate",i[9]),{c(){D(e.$$.fragment)},l(s){H(e.$$.fragment,s)},m(s,f){I(e,s,f),a=!0},p(s,f){const r={};f&4&&(r.preset=s[2]),f&16384&&(r.$$scope={dirty:f,ctx:s}),!t&&f&2&&(t=!0,r.path=s[1],le(()=>t=!1)),e.$set(r)},i(s){a||(w(e.$$.fragment,s),a=!0)},o(s){C(e.$$.fragment,s),a=!1},d(s){i[10](null),L(e,s)}}}function me(i){let e,t,a="Submit",n,l;return{c(){e=v("div"),t=v("button"),t.textContent=a,this.h()},l(s){e=k(s,"DIV",{slot:!0});var f=$(e);t=k(f,"BUTTON",{"data-svelte-h":!0}),ne(t)!=="svelte-16lvxe5"&&(t.textContent=a),f.forEach(d),this.h()},h(){X(e,"slot","ui")},m(s,f){g(s,e,f),y(e,t),n||(l=R(t,"click",i[8]),n=!0)},p:T,d(s){s&&d(e),n=!1,l()}}}function de(i){let e,t,a,n;const l=[_e,pe],s=[];function f(r,c){return r[5]?0:1}return t=f(i),a=s[t]=l[t](i),{c(){e=v("section"),a.c()},l(r){e=k(r,"SECTION",{});var c=$(e);a.l(c),c.forEach(d)},m(r,c){g(r,e,c),s[t].m(e,null),n=!0},p(r,[c]){let u=t;t=f(r),t===u?s[t].p(r,c):(x(),C(s[u],1,1,()=>{s[u]=null}),ee(),a=s[t],a?a.p(r,c):(a=s[t]=l[t](r),a.c()),w(a,1),a.m(e,null))},i(r){n||(w(a),n=!0)},o(r){C(a),n=!1},d(r){r&&d(e),s[t].d()}}}const he="https://pudding.cool/projects/trace-data/drawings";function be(i,e,t){const a=ae("copy");let n,l,s,f,r,c,u;async function p(){n=ce("id"),t(0,l=!0);try{const b=await F("checkin",{shortcode:n});if(b.status===200){const{id:P,prev_shortcode:E}=b.data,te=await fetch(`${he}/${P}/${E}.txt`);t(2,f=await te.text())}else b.status===404?t(3,r="Oh no! This turn has expired."):t(3,r=b.message||"Oh no! Something went wrong.")}catch(b){t(3,r=`Error: ${b.message}`)}finally{t(0,l=!1)}}function h(){c.addFrame()}async function _({detail:b}){var P;try{if(b){const E=await F("submit",{shortcode:n,drawing:s});t(5,u=((P=E==null?void 0:E.data)==null?void 0:P.status)===200)}}catch(E){console.log(E)}}function o(b){K[b?"unshift":"push"](()=>{c=b,t(4,c)})}function m(b){s=b,t(1,s)}return[l,s,f,r,c,u,a,p,h,_,o,m]}class ge extends Y{constructor(e){super(),Z(this,e,be,de,J,{})}}function ve(i){let e,t,a,n;return e=new re({props:{title:i[0],description:i[1],url:i[2],keywords:i[3]}}),a=new ge({}),{c(){D(e.$$.fragment),t=N(),D(a.$$.fragment)},l(l){H(e.$$.fragment,l),t=S(l),H(a.$$.fragment,l)},m(l,s){I(e,l,s),g(l,t,s),I(a,l,s),n=!0},p:T,i(l){n||(w(e.$$.fragment,l),w(a.$$.fragment,l),n=!0)},o(l){C(e.$$.fragment,l),C(a.$$.fragment,l),n=!1},d(l){l&&d(t),L(e,l),L(a,l)}}}function ke(i,e,t){let{data:a}=e;fe();const{title:n,description:l,url:s,keywords:f}=q;return V("copy",q),V("data",a.data),i.$$set=r=>{"data"in r&&t(4,a=r.data)},[n,l,s,f,a]}class Ne extends Y{constructor(e){super(),Z(this,e,ke,ve,J,{data:4})}}export{Ne as component};
