import{T as ae,s as G,f as k,g as v,h as $,d,i as g,I as le,p as J,H as L,a as C,e as B,r as M,c as N,w as S,l as P,m as O,v as E,D as K,n as R,j as W,L as ne,u as oe,Q as U}from"../chunks/scheduler.da91aed2.js";import{S as X,i as Y,g as Z,t as y,c as x,a as w,f as ie,b as j,d as D,m as H,e as I}from"../chunks/index.91142c57.js";import{C as re,M as fe,v as ue,c as V}from"../chunks/version.b342242e.js";import{s as q}from"../chunks/submit.32117095.js";import{p as ce}from"../chunks/stores.4a31c84d.js";function pe(o){const a=ae(ce).url.search.split("&").find(n=>n.includes(`${o}=`));if(a)return a.split("=")[1]}function _e(o){let e,t,a=o[6].draw.thanks+"",n,l,s,f,r,c,u=!o[2]&&!o[3]&&F(o),p=o[2]&&Q(o),h=o[3]&&z(o),_=o[2]&&A(o);return{c(){e=k("p"),t=new L(!1),n=C(),u&&u.c(),l=C(),p&&p.c(),s=C(),h&&h.c(),f=C(),_&&_.c(),r=B(),this.h()},l(i){e=v(i,"P",{});var m=$(e);t=M(m,!1),m.forEach(d),n=N(i),u&&u.l(i),l=N(i),p&&p.l(i),s=N(i),h&&h.l(i),f=N(i),_&&_.l(i),r=B(),this.h()},h(){t.a=null},m(i,m){g(i,e,m),t.m(a,e),g(i,n,m),u&&u.m(i,m),g(i,l,m),p&&p.m(i,m),g(i,s,m),h&&h.m(i,m),g(i,f,m),_&&_.m(i,m),g(i,r,m),c=!0},p(i,m){!i[2]&&!i[3]?u?u.p(i,m):(u=F(i),u.c(),u.m(l.parentNode,l)):u&&(u.d(1),u=null),i[2]?p?p.p(i,m):(p=Q(i),p.c(),p.m(s.parentNode,s)):p&&(p.d(1),p=null),i[3]?h?h.p(i,m):(h=z(i),h.c(),h.m(f.parentNode,f)):h&&(h.d(1),h=null),i[2]?_?(_.p(i,m),m&4&&w(_,1)):(_=A(i),_.c(),w(_,1),_.m(r.parentNode,r)):_&&(Z(),y(_,1,1,()=>{_=null}),x())},i(i){c||(w(_),c=!0)},o(i){y(_),c=!1},d(i){i&&(d(e),d(n),d(l),d(s),d(f),d(r)),u&&u.d(i),p&&p.d(i),h&&h.d(i),_&&_.d(i)}}}function me(o){let e,t,a=o[6].draw.done+"";return{c(){e=k("p"),t=new L(!1),this.h()},l(n){e=v(n,"P",{});var l=$(e);t=M(l,!1),l.forEach(d),this.h()},h(){t.a=null},m(n,l){g(n,e,l),t.m(a,e)},p:S,i:S,o:S,d(n){n&&d(e)}}}function F(o){let e,t=o[0]?"Loading...":"Start",a,n,l;return{c(){e=k("button"),a=P(t),this.h()},l(s){e=v(s,"BUTTON",{});var f=$(e);a=O(f,t),f.forEach(d),this.h()},h(){e.disabled=o[0]},m(s,f){g(s,e,f),E(e,a),n||(l=K(e,"click",o[7]),n=!0)},p(s,f){f&1&&t!==(t=s[0]?"Loading...":"Start")&&R(a,t),f&1&&(e.disabled=s[0])},d(s){s&&d(e),n=!1,l()}}}function Q(o){let e,t,a=o[6].draw.task+"",n,l,s,f=o[6].draw.note+"",r;return{c(){e=k("p"),t=new L(!1),n=C(),l=k("em"),s=P("Note: "),r=P(f),this.h()},l(c){e=v(c,"P",{});var u=$(e);t=M(u,!1),n=N(u),l=v(u,"EM",{});var p=$(l);s=O(p,"Note: "),r=O(p,f),p.forEach(d),u.forEach(d),this.h()},h(){t.a=n},m(c,u){g(c,e,u),t.m(a,e),E(e,n),E(e,l),E(l,s),E(l,r)},p:S,d(c){c&&d(e)}}}function z(o){let e,t;return{c(){e=k("p"),t=P(o[3]),this.h()},l(a){e=v(a,"P",{class:!0});var n=$(e);t=O(n,o[3]),n.forEach(d),this.h()},h(){W(e,"class","error")},m(a,n){g(a,e,n),E(e,t)},p(a,n){n&8&&R(t,a[3])},d(a){a&&d(e)}}}function A(o){let e,t,a;function n(s){o[11](s)}let l={preset:o[2],$$slots:{ui:[de]},$$scope:{ctx:o}};return o[1]!==void 0&&(l.path=o[1]),e=new re({props:l}),o[10](e),J.push(()=>ie(e,"path",n)),e.$on("validate",o[9]),{c(){j(e.$$.fragment)},l(s){D(e.$$.fragment,s)},m(s,f){H(e,s,f),a=!0},p(s,f){const r={};f&4&&(r.preset=s[2]),f&16384&&(r.$$scope={dirty:f,ctx:s}),!t&&f&2&&(t=!0,r.path=s[1],ne(()=>t=!1)),e.$set(r)},i(s){a||(w(e.$$.fragment,s),a=!0)},o(s){y(e.$$.fragment,s),a=!1},d(s){o[10](null),I(e,s)}}}function de(o){let e,t,a="Submit",n,l;return{c(){e=k("div"),t=k("button"),t.textContent=a,this.h()},l(s){e=v(s,"DIV",{slot:!0});var f=$(e);t=v(f,"BUTTON",{"data-svelte-h":!0}),oe(t)!=="svelte-16lvxe5"&&(t.textContent=a),f.forEach(d),this.h()},h(){W(e,"slot","ui")},m(s,f){g(s,e,f),E(e,t),n||(l=K(t,"click",o[8]),n=!0)},p:S,d(s){s&&d(e),n=!1,l()}}}function he(o){let e,t,a,n;const l=[me,_e],s=[];function f(r,c){return r[5]?0:1}return t=f(o),a=s[t]=l[t](o),{c(){e=k("section"),a.c()},l(r){e=v(r,"SECTION",{});var c=$(e);a.l(c),c.forEach(d)},m(r,c){g(r,e,c),s[t].m(e,null),n=!0},p(r,[c]){let u=t;t=f(r),t===u?s[t].p(r,c):(Z(),y(s[u],1,1,()=>{s[u]=null}),x(),a=s[t],a?a.p(r,c):(a=s[t]=l[t](r),a.c()),w(a,1),a.m(e,null))},i(r){n||(w(a),n=!0)},o(r){y(a),n=!1},d(r){r&&d(e),s[t].d()}}}const be="https://pudding.cool/projects/trace-data/drawings";function ge(o,e,t){const a=le("copy");let n,l,s,f,r,c,u;async function p(){n=pe("id"),t(0,l=!0);try{const b=await q("checkin",{shortcode:n});if(b.status===200){const{id:T,prev_shortcode:ee,done:te}=b.data;if(te)t(5,u=!0);else{const se=await fetch(`${be}/${T}/${ee}.txt`);t(2,f=await se.text())}}else b.status===404?t(3,r="Oh no! This turn has expired."):t(3,r=b.message||"Oh no! Something went wrong.")}catch(b){t(3,r=`Error: ${b.message}`)}finally{t(0,l=!1)}}function h(){c.addFrame()}async function _({detail:b}){try{if(b){const T=await q("submit",{shortcode:n,drawing:s});console.log(T),t(5,u=!0)}}catch(T){console.log(T)}}function i(b){J[b?"unshift":"push"](()=>{c=b,t(4,c)})}function m(b){s=b,t(1,s)}return[l,s,f,r,c,u,a,p,h,_,i,m]}class ke extends X{constructor(e){super(),Y(this,e,ge,he,G,{})}}function ve(o){let e,t,a,n;return e=new fe({props:{title:o[0],description:o[1],url:o[2],keywords:o[3]}}),a=new ke({}),{c(){j(e.$$.fragment),t=C(),j(a.$$.fragment)},l(l){D(e.$$.fragment,l),t=N(l),D(a.$$.fragment,l)},m(l,s){H(e,l,s),g(l,t,s),H(a,l,s),n=!0},p:S,i(l){n||(w(e.$$.fragment,l),w(a.$$.fragment,l),n=!0)},o(l){y(e.$$.fragment,l),y(a.$$.fragment,l),n=!1},d(l){l&&d(t),I(e,l),I(a,l)}}}function we(o,e,t){let{data:a}=e;ue();const{title:n,description:l,url:s,keywords:f}=V;return U("copy",V),U("data",a.data),o.$$set=r=>{"data"in r&&t(4,a=r.data)},[n,l,s,f,a]}class Se extends X{constructor(e){super(),Y(this,e,we,ve,G,{data:4})}}export{Se as component};
