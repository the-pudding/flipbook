import{s as nf,f as re,a as Te,l as Qe,g as se,h as xe,x as jt,c as ke,m as et,d as Z,j as Ne,i as Rt,w as $,n as At,F as La,o as of,E as ja,y as Ll,R as Ha,S as za,p as af,I as cf,O as uf,J as lf,G as df,r as Un}from"../chunks/scheduler.1b8758cb.js";import{S as hf,i as ff,a as jl,t as Hl,f as pf,b as gf,d as mf,m as yf,e as wf}from"../chunks/index.1f7cc648.js";import{e as As}from"../chunks/each.e59479a4.js";import{c as bf}from"../chunks/copy.65aa4a8b.js";import{_ as pr}from"../chunks/preload-helper.a4192956.js";import{g as ko,v as _f,C as vf}from"../chunks/version.08d7136c.js";var qa={},Ln={},jn=34,Cr=10,Hn=13;function zl(t){return new Function("d","return {"+t.map(function(e,r){return JSON.stringify(e)+": d["+r+'] || ""'}).join(",")+"}")}function Ef(t,e){var r=zl(t);return function(s,n){return e(r(s),n,t)}}function Ka(t){var e=Object.create(null),r=[];return t.forEach(function(s){for(var n in s)n in e||r.push(e[n]=n)}),r}function Be(t,e){var r=t+"",s=r.length;return s<e?new Array(e-s+1).join(0)+r:r}function Sf(t){return t<0?"-"+Be(-t,6):t>9999?"+"+Be(t,6):Be(t,4)}function xf(t){var e=t.getUTCHours(),r=t.getUTCMinutes(),s=t.getUTCSeconds(),n=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":Sf(t.getUTCFullYear())+"-"+Be(t.getUTCMonth()+1,2)+"-"+Be(t.getUTCDate(),2)+(n?"T"+Be(e,2)+":"+Be(r,2)+":"+Be(s,2)+"."+Be(n,3)+"Z":s?"T"+Be(e,2)+":"+Be(r,2)+":"+Be(s,2)+"Z":r||e?"T"+Be(e,2)+":"+Be(r,2)+"Z":"")}function ql(t){var e=new RegExp('["'+t+`
\r]`),r=t.charCodeAt(0);function s(d,h){var p,g,y=n(d,function(w,x){if(p)return p(w,x-1);g=w,p=h?Ef(w,h):zl(w)});return y.columns=g||[],y}function n(d,h){var p=[],g=d.length,y=0,w=0,x,k=g<=0,O=!1;d.charCodeAt(g-1)===Cr&&--g,d.charCodeAt(g-1)===Hn&&--g;function B(){if(k)return Ln;if(O)return O=!1,qa;var ee,Ae=y,qe;if(d.charCodeAt(Ae)===jn){for(;y++<g&&d.charCodeAt(y)!==jn||d.charCodeAt(++y)===jn;);return(ee=y)>=g?k=!0:(qe=d.charCodeAt(y++))===Cr?O=!0:qe===Hn&&(O=!0,d.charCodeAt(y)===Cr&&++y),d.slice(Ae+1,ee-1).replace(/""/g,'"')}for(;y<g;){if((qe=d.charCodeAt(ee=y++))===Cr)O=!0;else if(qe===Hn)O=!0,d.charCodeAt(y)===Cr&&++y;else if(qe!==r)continue;return d.slice(Ae,ee)}return k=!0,d.slice(Ae,g)}for(;(x=B())!==Ln;){for(var J=[];x!==qa&&x!==Ln;)J.push(x),x=B();h&&(J=h(J,w++))==null||p.push(J)}return p}function i(d,h){return d.map(function(p){return h.map(function(g){return l(p[g])}).join(t)})}function o(d,h){return h==null&&(h=Ka(d)),[h.map(l).join(t)].concat(i(d,h)).join(`
`)}function a(d,h){return h==null&&(h=Ka(d)),i(d,h).join(`
`)}function c(d){return d.map(u).join(`
`)}function u(d){return d.map(l).join(t)}function l(d){return d==null?"":d instanceof Date?xf(d):e.test(d+="")?'"'+d.replace(/"/g,'""')+'"':d}return{parse:s,parseRows:n,format:o,formatBody:a,formatRows:c,formatRow:u,formatValue:l}}var Kl=ql(","),Af=Kl.parse,Cf=Kl.format,Gl=ql("	"),Rf=Gl.parse,Tf=Gl.format;const kf=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>pr(()=>Promise.resolve().then(()=>ps),void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)};class Oo extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class Of extends Oo{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Pf extends Oo{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class If extends Oo{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Bf=globalThis&&globalThis.__awaiter||function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(l){try{u(s.next(l))}catch(d){o(d)}}function c(l){try{u(s.throw(l))}catch(d){o(d)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((s=s.apply(t,e||[])).next())})};class Nf{constructor(e,{headers:r={},customFetch:s}={}){this.url=e,this.headers=r,this.fetch=kf(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var s;return Bf(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=r;let a={},c;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));const u=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:c}).catch(p=>{throw new Of(p)}),l=u.headers.get("x-relay-error");if(l&&l==="true")throw new Pf(u);if(!u.ok)throw new If(u);let d=((s=u.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),h;return d==="application/json"?h=yield u.json():d==="application/octet-stream"?h=yield u.blob():d==="multipart/form-data"?h=yield u.formData():h=yield u.text(),{data:h,error:null}}catch(n){return{data:null,error:n}}})}}var $f=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},gr=$f();const Mf=gr.fetch,Po=gr.fetch.bind(gr),Vl=gr.Headers,Df=gr.Request,Ff=gr.Response,ps=Object.freeze(Object.defineProperty({__proto__:null,Headers:Vl,Request:Df,Response:Ff,default:Po,fetch:Mf},Symbol.toStringTag,{value:"Module"}));class Uf extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class Lf{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Po:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,a,c;let u=null,l=null,d=null,h=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?l=x:l=JSON.parse(x))}const y=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),w=(a=i.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");y&&w&&w.length>1&&(d=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(l)&&(l.length>1?(u={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,d=null,h=406,p="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{const y=await i.text();try{u=JSON.parse(y),Array.isArray(u)&&i.status===404&&(l=[],u=null,h=200,p="OK")}catch{i.status===404&&y===""?(h=204,p="No Content"):u={message:y}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,h=200,p="OK"),u&&this.shouldThrowOnError)throw new Uf(u)}return{error:u,data:l,count:d,status:h,statusText:p}});return this.shouldThrowOnError||(n=n.catch(i=>{var o,a,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(a=i==null?void 0:i.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),n.then(e,r)}}class jf extends Lf{select(e){let r=!1;const s=(e??"*").split("").map(n=>/\s/.test(n)&&!r?"":(n==='"'&&(r=!r),n)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:r=!0,nullsFirst:s,foreignTable:n,referencedTable:i=n}={}){const o=i?`${i}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${r?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:r,referencedTable:s=r}={}){const n=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,r,{foreignTable:s,referencedTable:n=s}={}){const i=typeof n>"u"?"offset":`${n}.offset`,o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${r-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:r=!1,settings:s=!1,buffers:n=!1,wal:i=!1,format:o="text"}={}){var a;const c=[e?"analyze":null,r?"verbose":null,s?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${c};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class or extends jf{eq(e,r){return this.url.searchParams.append(e,`eq.${r}`),this}neq(e,r){return this.url.searchParams.append(e,`neq.${r}`),this}gt(e,r){return this.url.searchParams.append(e,`gt.${r}`),this}gte(e,r){return this.url.searchParams.append(e,`gte.${r}`),this}lt(e,r){return this.url.searchParams.append(e,`lt.${r}`),this}lte(e,r){return this.url.searchParams.append(e,`lte.${r}`),this}like(e,r){return this.url.searchParams.append(e,`like.${r}`),this}likeAllOf(e,r){return this.url.searchParams.append(e,`like(all).{${r.join(",")}}`),this}likeAnyOf(e,r){return this.url.searchParams.append(e,`like(any).{${r.join(",")}}`),this}ilike(e,r){return this.url.searchParams.append(e,`ilike.${r}`),this}ilikeAllOf(e,r){return this.url.searchParams.append(e,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(e,r){return this.url.searchParams.append(e,`ilike(any).{${r.join(",")}}`),this}is(e,r){return this.url.searchParams.append(e,`is.${r}`),this}in(e,r){const s=r.map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cs.{${r.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(r)}`),this}containedBy(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cd.{${r.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(r)}`),this}rangeGt(e,r){return this.url.searchParams.append(e,`sr.${r}`),this}rangeGte(e,r){return this.url.searchParams.append(e,`nxl.${r}`),this}rangeLt(e,r){return this.url.searchParams.append(e,`sl.${r}`),this}rangeLte(e,r){return this.url.searchParams.append(e,`nxr.${r}`),this}rangeAdjacent(e,r){return this.url.searchParams.append(e,`adj.${r}`),this}overlaps(e,r){return typeof r=="string"?this.url.searchParams.append(e,`ov.${r}`):this.url.searchParams.append(e,`ov.{${r.join(",")}}`),this}textSearch(e,r,{config:s,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${o}.${r}`),this}match(e){return Object.entries(e).forEach(([r,s])=>{this.url.searchParams.append(r,`eq.${s}`)}),this}not(e,r,s){return this.url.searchParams.append(e,`not.${r}.${s}`),this}or(e,{foreignTable:r,referencedTable:s=r}={}){const n=s?`${s}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,r,s){return this.url.searchParams.append(e,`${r}.${s}`),this}}class Hf{constructor(e,{headers:r={},schema:s,fetch:n}){this.url=e,this.headers=r,this.schema=s,this.fetch=n}select(e,{head:r=!1,count:s}={}){const n=r?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),s&&(this.headers.Prefer=`count=${s}`),new or({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:r,defaultToNull:s=!0}={}){const n="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((a,c)=>a.concat(Object.keys(c)),[]);if(o.length>0){const a=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",a.join(","))}}return new or({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:r,ignoreDuplicates:s=!1,count:n,defaultToNull:i=!0}={}){const o="POST",a=[`resolution=${s?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),i||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const c=e.reduce((u,l)=>u.concat(Object.keys(l)),[]);if(c.length>0){const u=[...new Set(c)].map(l=>`"${l}"`);this.url.searchParams.set("columns",u.join(","))}}return new or({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:r}={}){const s="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),r&&n.push(`count=${r}`),this.headers.Prefer=n.join(","),new or({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const r="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new or({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const zf="1.9.2",qf={"X-Client-Info":`postgrest-js/${zf}`};class Io{constructor(e,{headers:r={},schema:s,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},qf),r),this.schemaName=s,this.fetch=n}from(e){const r=new URL(`${this.url}/${e}`);return new Hf(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Io(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:s=!1,count:n}={}){let i;const o=new URL(`${this.url}/rpc/${e}`);let a;s?(i="HEAD",Object.entries(r).forEach(([u,l])=>{o.searchParams.append(u,`${l}`)})):(i="POST",a=r);const c=Object.assign({},this.headers);return n&&(c.Prefer=`count=${n}`),new or({method:i,url:o,headers:c,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}}const Kf="2.9.3",Gf={"X-Client-Info":`realtime-js/${Kf}`},Vf="1.0.0",Wl=1e4,Wf=1e3;var cr;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(cr||(cr={}));var je;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(je||(je={}));var Ze;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Ze||(Ze={}));var io;(function(t){t.websocket="websocket"})(io||(io={}));var Ht;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ht||(Ht={}));class Jl{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class Jf{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,r,s)}_decodeBroadcast(e,r,s){const n=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const a=s.decode(e.slice(o,o+n));o=o+n;const c=s.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:c,payload:u}}}class zn{constructor(e,r,s={},n=Wl){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ga;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Ga||(Ga={}));class Zr{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Zr.syncState(this.state,n,i,o),this.pendingDiffs.forEach(c=>{this.state=Zr.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Zr.syncDiff(this.state,n,i,o),a())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const i=this.cloneDeep(e),o=this.transformState(r),a={},c={};return this.map(i,(u,l)=>{o[u]||(c[u]=l)}),this.map(o,(u,l)=>{const d=i[u];if(d){const h=l.map(w=>w.presence_ref),p=d.map(w=>w.presence_ref),g=l.filter(w=>p.indexOf(w.presence_ref)<0),y=d.filter(w=>h.indexOf(w.presence_ref)<0);g.length>0&&(a[u]=g),y.length>0&&(c[u]=y)}else a[u]=l}),this.syncDiff(i,{joins:a,leaves:c},s,n)}static syncDiff(e,r,s,n){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(a,c)=>{var u;const l=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(c),l.length>0){const d=e[a].map(p=>p.presence_ref),h=l.filter(p=>d.indexOf(p.presence_ref)<0);e[a].unshift(...h)}s(a,l,c)}),this.map(o,(a,c)=>{let u=e[a];if(!u)return;const l=c.map(d=>d.presence_ref);u=u.filter(d=>l.indexOf(d.presence_ref)<0),e[a]=u,n(a,u,c),u.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var G;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(G||(G={}));const Va=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,o)=>(i[o]=Xf(o,t,e,n),i),{})},Xf=(t,e,r,s)=>{const n=e.find(a=>a.name===t),i=n==null?void 0:n.type,o=r[t];return i&&!s.includes(i)?Xl(i,o):oo(o)},Xl=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return ep(e,r)}switch(t){case G.bool:return Yf(e);case G.float4:case G.float8:case G.int2:case G.int4:case G.int8:case G.numeric:case G.oid:return Zf(e);case G.json:case G.jsonb:return Qf(e);case G.timestamp:return tp(e);case G.abstime:case G.date:case G.daterange:case G.int4range:case G.int8range:case G.money:case G.reltime:case G.text:case G.time:case G.timestamptz:case G.timetz:case G.tsrange:case G.tstzrange:return oo(e);default:return oo(e)}},oo=t=>t,Yf=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Zf=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Qf=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},ep=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>Xl(e,a))}return t},tp=t=>typeof t=="string"?t.replace(" ","T"):t;var Wa;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Wa||(Wa={}));var Ja;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes"})(Ja||(Ja={}));var Xa;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Xa||(Xa={}));class Bo{constructor(e,r={config:{}},s){this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=je.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},r.config),this.timeout=this.socket.timeout,this.joinPush=new zn(this,Ze.join,this.params,this.timeout),this.rejoinTimer=new Jl(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=je.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=je.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=je.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=je.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ze.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new Zr(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,r=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));const a={},c={broadcast:i,presence:o,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(u=>u.filter))!==null&&n!==void 0?n:[]};this.socket.accessToken&&(a.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:c},a)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",({postgres_changes:u})=>{var l;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{const d=this.bindings.postgres_changes,h=(l=d==null?void 0:d.length)!==null&&l!==void 0?l:0,p=[];for(let g=0;g<h;g++){const y=d[g],{filter:{event:w,schema:x,table:k,filter:O}}=y,B=u&&u[g];if(B&&B.event===w&&B.schema===x&&B.table===k&&B.filter===O)p.push(Object.assign(Object.assign({},y),{id:B.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this._on(e,r,s)}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,a={method:"POST",headers:{apikey:(s=this.socket.apiKey)!==null&&s!==void 0?s:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,a,(n=r.timeout)!==null&&n!==void 0?n:this.timeout)).ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,c;const u=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=je.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ze.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(s=>{const n=new zn(this,Ze.leave,{},e);n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,r,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),o}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new zn(this,e,r,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,i;const o=e.toLocaleLowerCase(),{close:a,error:c,leave:u,join:l}=Ze;if(s&&[a,c,u,l].indexOf(o)>=0&&s!==this._joinRef())return;let h=this._onMessage(o,r,s);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var g,y,w;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((w=(y=p.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===o}).map(p=>p.callback(h,s)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var g,y,w,x,k,O;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const B=p.id,J=(g=p.filter)===null||g===void 0?void 0:g.event;return B&&((y=r.ids)===null||y===void 0?void 0:y.includes(B))&&(J==="*"||(J==null?void 0:J.toLocaleLowerCase())===((w=r.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const B=(k=(x=p==null?void 0:p.filter)===null||x===void 0?void 0:x.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return B==="*"||B===((O=r==null?void 0:r.event)===null||O===void 0?void 0:O.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:y,table:w,commit_timestamp:x,type:k,errors:O}=g;h=Object.assign(Object.assign({},{schema:y,table:w,commit_timestamp:x,eventType:k,new:{},old:{},errors:O}),this._getPayloadRecords(g))}p.callback(h,s)})}_isClosed(){return this.state===je.closed}_isJoined(){return this.state===je.joined}_isJoining(){return this.state===je.joining}_isLeaving(){return this.state===je.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),i={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Bo.isEqual(n.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ze.close,{},e)}_onError(e){this._on(Ze.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=je.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Va(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Va(e.columns,e.old_record)),r}}const rp=()=>{},sp=typeof WebSocket<"u";class np{constructor(e,r){var s;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=Gf,this.params={},this.timeout=Wl,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=rp,this.conn=null,this.sendBuffer=[],this.serializer=new Jf,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>pr(()=>Promise.resolve().then(()=>ps),void 0,import.meta.url).then(({default:c})=>c(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${io.websocket}`,r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const n=(s=r==null?void 0:r.params)===null||s===void 0?void 0:s.apikey;n&&(this.accessToken=n,this.apiKey=n),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,o)=>o(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Jl(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(sp){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new ip(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),pr(()=>import("../chunks/browser.d17db799.js").then(e=>e.b),["../chunks/browser.d17db799.js","../chunks/version.08d7136c.js","../chunks/scheduler.1b8758cb.js","../chunks/index.1f7cc648.js","../assets/version.33d012d3.css"],import.meta.url).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case cr.connecting:return Ht.Connecting;case cr.open:return Ht.Open;case cr.closing:return Ht.Closing;default:return Ht.Closed}}isConnected(){return this.connectionState()===Ht.Open}channel(e,r={config:{}}){const s=new Bo(`realtime:${e}`,r,this);return this.channels.push(s),s}push(e){const{topic:r,event:s,payload:n,ref:i}=e,o=()=>{this.encode(e,a=>{var c;(c=this.conn)===null||c===void 0||c.send(a)})};this.log("push",`${r} ${s} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(r=>{e&&r.updateJoinPayload({access_token:e}),r.joinedOnce&&r._isJoined()&&r._push(Ze.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Vf}))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:s,event:n,payload:i,ref:o}=r;(o&&o===this.pendingHeartbeatRef||n===(i==null?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${n} ${o&&"("+o+")"||""}`,i),this.channels.filter(a=>a._isMember(s)).forEach(a=>a._trigger(n,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ze.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Wf,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class ip{constructor(e,r,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=cr.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class No extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Se(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class op extends No{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Ya extends No{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var ap=globalThis&&globalThis.__awaiter||function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(l){try{u(s.next(l))}catch(d){o(d)}}function c(l){try{u(s.throw(l))}catch(d){o(d)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((s=s.apply(t,e||[])).next())})};const Yl=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>pr(()=>Promise.resolve().then(()=>ps),void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},cp=()=>ap(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield pr(()=>Promise.resolve().then(()=>ps),void 0,import.meta.url)).Response:Response});var wr=globalThis&&globalThis.__awaiter||function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(l){try{u(s.next(l))}catch(d){o(d)}}function c(l){try{u(s.throw(l))}catch(d){o(d)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((s=s.apply(t,e||[])).next())})};const qn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),up=(t,e)=>wr(void 0,void 0,void 0,function*(){const r=yield cp();t instanceof r?t.json().then(s=>{e(new op(qn(s),t.status||500))}).catch(s=>{e(new Ya(qn(s),s))}):e(new Ya(qn(t),t))}),lp=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};function dn(t,e,r,s,n,i){return wr(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(r,lp(e,s,n,i)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>up(c,a))})})}function ao(t,e,r,s){return wr(this,void 0,void 0,function*(){return dn(t,"GET",e,r,s)})}function xt(t,e,r,s,n){return wr(this,void 0,void 0,function*(){return dn(t,"POST",e,s,n,r)})}function dp(t,e,r,s,n){return wr(this,void 0,void 0,function*(){return dn(t,"PUT",e,s,n,r)})}function Zl(t,e,r,s,n){return wr(this,void 0,void 0,function*(){return dn(t,"DELETE",e,s,n,r)})}var Ke=globalThis&&globalThis.__awaiter||function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(l){try{u(s.next(l))}catch(d){o(d)}}function c(l){try{u(s.throw(l))}catch(d){o(d)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((s=s.apply(t,e||[])).next())})};const hp={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Za={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class fp{constructor(e,r={},s,n){this.url=e,this.headers=r,this.bucketId=s,this.fetch=Yl(n)}uploadOrUpdate(e,r,s,n){return Ke(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Za),n),a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl)):(i=s,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType);const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),l=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),d=yield l.json();return l.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(Se(i))return{data:null,error:i};throw i}})}upload(e,r,s){return Ke(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,s)})}uploadToSignedUrl(e,r,s,n){return Ke(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:Za.upsert},n),l=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",u.cacheControl)):(c=s,l["cache-control"]=`max-age=${u.cacheControl}`,l["content-type"]=u.contentType);const d=yield this.fetch(a.toString(),{method:"PUT",body:c,headers:l}),h=yield d.json();return d.ok?{data:{path:i,fullPath:h.Key},error:null}:{data:null,error:h}}catch(c){if(Se(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e){return Ke(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=yield xt(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:this.headers}),n=new URL(this.url+s.url),i=n.searchParams.get("token");if(!i)throw new No("No token returned by API");return{data:{signedUrl:n.toString(),path:e,token:i},error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}update(e,r,s){return Ke(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,s)})}move(e,r){return Ke(this,void 0,void 0,function*(){try{return{data:yield xt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r},{headers:this.headers}),error:null}}catch(s){if(Se(s))return{data:null,error:s};throw s}})}copy(e,r){return Ke(this,void 0,void 0,function*(){try{return{data:{path:(yield xt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r},{headers:this.headers})).Key},error:null}}catch(s){if(Se(s))return{data:null,error:s};throw s}})}createSignedUrl(e,r,s){return Ke(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield xt(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,s){return Ke(this,void 0,void 0,function*(){try{const n=yield xt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}download(e,r){return Ke(this,void 0,void 0,function*(){const n=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield ao(this.fetch,`${this.url}/${n}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(Se(a))return{data:null,error:a};throw a}})}getPublicUrl(e,r){const s=this._getFinalPath(e),n=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&n.push(i);const a=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&n.push(c);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${s}${u}`)}}}remove(e){return Ke(this,void 0,void 0,function*(){try{return{data:yield Zl(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}list(e,r,s){return Ke(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},hp),r),{prefix:e||""});return{data:yield xt(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const pp="2.5.5",gp={"X-Client-Info":`storage-js/${pp}`};var Qt=globalThis&&globalThis.__awaiter||function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(l){try{u(s.next(l))}catch(d){o(d)}}function c(l){try{u(s.throw(l))}catch(d){o(d)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((s=s.apply(t,e||[])).next())})};class mp{constructor(e,r={},s){this.url=e,this.headers=Object.assign(Object.assign({},gp),r),this.fetch=Yl(s)}listBuckets(){return Qt(this,void 0,void 0,function*(){try{return{data:yield ao(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Se(e))return{data:null,error:e};throw e}})}getBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield ao(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Qt(this,void 0,void 0,function*(){try{return{data:yield xt(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Se(s))return{data:null,error:s};throw s}})}updateBucket(e,r){return Qt(this,void 0,void 0,function*(){try{return{data:yield dp(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Se(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield xt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield Zl(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}}class yp extends mp{constructor(e,r={},s){super(e,r,s)}from(e){return new fp(this.url,this.headers,e,this.fetch)}}const wp="2.39.7";let Xr="";typeof Deno<"u"?Xr="deno":typeof document<"u"?Xr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Xr="react-native":Xr="node";const bp={"X-Client-Info":`supabase-js-${Xr}/${wp}`},_p={headers:bp},vp={schema:"public"},Ep={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Sp={};var xp=globalThis&&globalThis.__awaiter||function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(l){try{u(s.next(l))}catch(d){o(d)}}function c(l){try{u(s.throw(l))}catch(d){o(d)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((s=s.apply(t,e||[])).next())})};const Ap=t=>{let e;return t?e=t:typeof fetch>"u"?e=Po:e=fetch,(...r)=>e(...r)},Cp=()=>typeof Headers>"u"?Vl:Headers,Rp=(t,e,r)=>{const s=Ap(r),n=Cp();return(i,o)=>xp(void 0,void 0,void 0,function*(){var a;const c=(a=yield e())!==null&&a!==void 0?a:t;let u=new n(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),s(i,Object.assign(Object.assign({},o),{headers:u}))})};function Tp(t){return t.replace(/\/$/,"")}function kp(t,e){const{db:r,auth:s,realtime:n,global:i}=t,{db:o,auth:a,realtime:c,global:u}=e;return{db:Object.assign(Object.assign({},o),r),auth:Object.assign(Object.assign({},a),s),realtime:Object.assign(Object.assign({},c),n),global:Object.assign(Object.assign({},u),i)}}function Op(t){return Math.round(Date.now()/1e3)+t}function Pp(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Xe=()=>typeof document<"u",$t={tested:!1,writable:!1},Qr=()=>{if(!Xe())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if($t.tested)return $t.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),$t.tested=!0,$t.writable=!0}catch{$t.tested=!0,$t.writable=!1}return $t.writable};function Kn(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const Ql=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>pr(()=>Promise.resolve().then(()=>ps),void 0,import.meta.url).then(({default:s})=>s(...r)):e=fetch,(...r)=>e(...r)},Ip=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Mt=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Cs=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Gn=async(t,e)=>{await t.removeItem(e)};function Bp(t){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let r="",s,n,i,o,a,c,u,l=0;for(t=t.replace("-","+").replace("_","/");l<t.length;)o=e.indexOf(t.charAt(l++)),a=e.indexOf(t.charAt(l++)),c=e.indexOf(t.charAt(l++)),u=e.indexOf(t.charAt(l++)),s=o<<2|a>>4,n=(a&15)<<4|c>>2,i=(c&3)<<6|u,r=r+String.fromCharCode(s),c!=64&&n!=0&&(r=r+String.fromCharCode(n)),u!=64&&i!=0&&(r=r+String.fromCharCode(i));return r}class hn{constructor(){this.promise=new hn.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}hn.promiseConstructor=Promise;function Qa(t){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,r=t.split(".");if(r.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(r[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=r[1];return JSON.parse(Bp(s))}async function Np(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function $p(t,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function Mp(t){return("0"+t.toString(16)).substr(-2)}function er(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,Mp).join("")}async function Dp(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}function Fp(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function tr(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await Dp(t);return Fp(r)}class $o extends Error{constructor(e,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r}}function j(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Up extends $o{constructor(e,r){super(e,r),this.name="AuthApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}function Lp(t){return j(t)&&t.name==="AuthApiError"}class ed extends $o{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Xt extends $o{constructor(e,r,s){super(e),this.name=r,this.status=s}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class rr extends Xt{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class Vn extends Xt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class Rs extends Xt{constructor(e){super(e,"AuthInvalidCredentialsError",400)}}class Ts extends Xt{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ec extends Xt{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class co extends Xt{constructor(e,r){super(e,"AuthRetryableFetchError",r)}}function Wn(t){return j(t)&&t.name==="AuthRetryableFetchError"}class jp extends Xt{constructor(e,r,s){super(e,"AuthWeakPasswordError",r),this.reasons=s}}var Hp=globalThis&&globalThis.__rest||function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};const ar=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),zp=[502,503,504];async function tc(t){if(!Ip(t))throw new co(ar(t),0);if(zp.includes(t.status))throw new co(ar(t),t.status);let e;try{e=await t.json()}catch(r){throw new ed(ar(r),r)}throw typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)?new jp(ar(e),t.status,e.weak_password.reasons):new Up(ar(e),t.status||500)}const qp=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function H(t,e,r,s){var n;const i=Object.assign({},s==null?void 0:s.headers);s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Kp(t,e,r+a,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function Kp(t,e,r,s,n,i){const o=qp(e,s,n,i);let a;try{a=await t(r,o)}catch(c){throw console.error(c),new co(ar(c),0)}if(a.ok||await tc(a),s!=null&&s.noResolveJson)return a;try{return await a.json()}catch(c){await tc(c)}}function Ut(t){var e;let r=null;Jp(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Op(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function rc(t){const e=Ut(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ct(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Gp(t){return{data:t,error:null}}function Vp(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=t,o=Hp(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},c=Object.assign({},o);return{data:{properties:a,user:c},error:null}}function Wp(t){return t}function Jp(t){return t.access_token&&t.refresh_token&&t.expires_in}var Xp=globalThis&&globalThis.__rest||function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};class Yp{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=Ql(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r="global"){try{return await H(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(j(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await H(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ct})}catch(s){if(j(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=Xp(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await H(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Vp,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(j(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await H(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ct})}catch(r){if(j(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,i,o,a,c;try{const u={nextPage:null,lastPage:0,total:0},l=await H(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Wp});if(l.error)throw l.error;const d=await l.json(),h=(o=l.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(a=l.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const y=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(g.split(";")[1].split("=")[1]);u[`${w}Page`]=y}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(j(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await H(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ct})}catch(r){if(j(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){try{return await H(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Ct})}catch(s){if(j(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){try{return await H(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ct})}catch(s){if(j(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:r,error:s}=await H(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(j(r))return{data:null,error:r};throw r}}async _deleteFactor(e){try{return{data:await H(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(j(r))return{data:null,error:r};throw r}}}const td="0.0.0",Zp="http://localhost:9999",Qp="supabase.auth.token",eg={"X-Client-Info":`gotrue-js/${td}`},sc=10,tg={getItem:t=>Qr()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{Qr()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{Qr()&&globalThis.localStorage.removeItem(t)}};function nc(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function rg(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const sr={debug:!!(globalThis&&Qr()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class rd extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class sg extends rd{}async function ng(t,e,r){sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),sr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new sg(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(sr.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}})}rg();const ig={url:Zp,storageKey:Qp,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:eg,flowType:"implicit",debug:!1},Rr=30*1e3,ic=3;async function oc(t,e,r){return await r()}class ss{constructor(e){var r,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ss.nextInstanceID,ss.nextInstanceID+=1,this.instanceID>0&&Xe()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},ig),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Yp({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Ql(n.fetch),this.lock=n.lock||oc,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,n.lock?this.lock=n.lock:Xe()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=ng:this.lock=oc,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:Qr()?this.storage=tg:(this.memoryStorage={},this.storage=nc(this.memoryStorage)):(this.memoryStorage={},this.storage=nc(this.memoryStorage)),Xe()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${td}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=Xe()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:r,error:s}=await this._getSessionFromURL(e);if(s)return this._debug("#_initialize()","error detecting session from URL",s),(s==null?void 0:s.message)==="Identity is already linked"||(s==null?void 0:s.message)==="Identity is already linked to another user"?{error:s}:(await this._removeSession(),{error:s});const{session:n,redirectType:i}=r;return this._debug("#_initialize()","detected session in URL",n,"redirect type",i),await this._saveSession(n),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return j(e)?{error:e}:{error:new ed("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signUp(e){var r,s,n;try{await this._removeSession();let i;if("email"in e){const{email:l,password:d,options:h}=e;let p=null,g=null;if(this.flowType==="pkce"){const y=er();await Mt(this.storage,`${this.storageKey}-code-verifier`,y),p=await tr(y),g=y===p?"plain":"s256"}i=await H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:l,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:g},xform:Ut})}else if("phone"in e){const{phone:l,password:d,options:h}=e;i=await H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:l,password:d,data:(s=h==null?void 0:h.data)!==null&&s!==void 0?s:{},channel:(n=h==null?void 0:h.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Ut})}else throw new Rs("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(j(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{await this._removeSession();let r;if("email"in e){const{email:i,password:o,options:a}=e;r=await H(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:rc})}else if("phone"in e){const{phone:i,password:o,options:a}=e;r=await H(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:rc})}else throw new Rs("You must provide either an email or phone number and a password");const{data:s,error:n}=r;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Vn}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(j(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,s,n,i;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const r=await Cs(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/"),{data:i,error:o}=await H(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Ut});return await Gn(this.storage,`${this.storageKey}-code-verifier`),o?{data:{user:null,session:null,redirectType:null},error:o}:!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Vn}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}async signInWithIdToken(e){await this._removeSession();try{const{options:r,provider:s,token:n,access_token:i,nonce:o}=e,a=await H(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ut}),{data:c,error:u}=a;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Vn}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(j(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,s,n,i,o;try{if(await this._removeSession(),"email"in e){const{email:a,options:c}=e;let u=null,l=null;if(this.flowType==="pkce"){const h=er();await Mt(this.storage,`${this.storageKey}-code-verifier`,h),u=await tr(h),l=h===u?"plain":"s256"}const{error:d}=await H(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:l},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:a,options:c}=e,{data:u,error:l}=await H(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:l}}throw new Rs("You must provide either an email or phone number.")}catch(a){if(j(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,s;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let n,i;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await H(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:Ut});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(n){if(j(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var r,s,n;try{await this._removeSession();let i=null,o=null;if(this.flowType==="pkce"){const a=er();await Mt(this.storage,`${this.storageKey}-code-verifier`,a),i=await tr(a),o=a===i?"plain":"s256"}return await H(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Gp})}catch(i){if(j(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new rr;const{error:n}=await H(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(j(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:o}=await H(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:o,error:a}=await H(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new Rs("You must provide either an email or phone number and a type")}catch(r){if(j(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Cs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s)return{data:{session:e},error:null};const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await H(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ct}):await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)throw o;return await H(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0,xform:Ct})})}catch(r){if(j(r))return{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new rr;const o=n.session;let a=null,c=null;if(this.flowType==="pkce"&&e.email!=null){const d=er();await Mt(this.storage,`${this.storageKey}-code-verifier`,d),a=await tr(d),c=d===a?"plain":"s256"}const{data:u,error:l}=await H(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:c}),jwt:o.access_token,xform:Ct});if(l)throw l;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(j(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return Qa(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new rr;const r=Date.now()/1e3;let s=r,n=!0,i=null;const o=Qa(e.access_token);if(o.exp&&(s=o.exp,n=s<=r),n){const{session:a,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(j(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:o,error:a}=r;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new rr;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(j(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e){try{if(!Xe())throw new Ts("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Ts("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new ec("Not a valid PKCE flow url.");const r=Kn(window.location.href);if(e){if(!r.code)throw new ec("No code detected.");const{data:k,error:O}=await this._exchangeCodeForSession(r.code);if(O)throw O;const B=new URL(window.location.href);return B.searchParams.delete("code"),window.history.replaceState(window.history.state,"",B.toString()),{data:{session:k.session,redirectType:null},error:null}}if(r.error||r.error_description||r.error_code)throw new Ts(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:a,expires_at:c,token_type:u}=r;if(!i||!a||!o||!u)throw new Ts("No session defined in URL");const l=Math.round(Date.now()/1e3),d=parseInt(a);let h=l+d;c&&(h=parseInt(c));const p=h-l;p*1e3<=Rr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const g=h-d;l-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,l):l-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",g,h,l);const{data:y,error:w}=await this._getUser(i);if(w)throw w;const x={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:d,expires_at:h,refresh_token:o,token_type:u,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:r.type},error:null}}catch(r){if(j(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantFlow(){const e=Kn(window.location.href);return!!(Xe()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=Kn(window.location.href),r=await Cs(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{error:i};const o=(s=n.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(Lp(a)&&(a.status===404||a.status===401)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Gn(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const r=Pp(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:i},error:o}=r;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;if(this.flowType==="pkce"){const i=er();await Mt(this.storage,`${this.storageKey}-code-verifier`,`${i}/PASSWORD_RECOVERY`),s=await tr(i),n=i===s?"plain":"s256"}try{return await H(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(j(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(j(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:s,error:n}=await this._useSession(async i=>{var o,a,c,u,l;const{data:d,error:h}=i;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await H(this.fetch,"GET",p,{headers:this.headers,jwt:(l=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&l!==void 0?l:void 0})});if(n)throw n;return Xe()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(j(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)throw o;return await H(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(j(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await $p(async n=>(await Np(n*200),this._debug(r,"refreshing attempt",n),await H(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ut})),(n,i,o)=>o&&o.error&&Wn(o.error)&&Date.now()+(n+1)*200-s<Rr)}catch(s){if(this._debug(r,"error",s),j(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),Xe()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Cs(this.storage,this.storageKey);if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const n=Math.round(Date.now()/1e3),i=((e=s.expires_at)!==null&&e!==void 0?e:1/0)<n+sc;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${sc}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Wn(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new rr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new hn;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new rr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(n,"error",i),j(i)){const o={session:null,error:i};return Wn(i)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),await Mt(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Gn(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Xe()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Rr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/Rr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Rr}ms, refresh threshold is ${ic} ticks`),n<=ic&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof rd)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Xe()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const i=er();await Mt(this.storage,`${this.storageKey}-code-verifier`,i);const o=await tr(i),a=i===o?"plain":"s256";this._debug("PKCE","code verifier",`${i.substring(0,5)}...`,"code challenge",o,"method",a);const c=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(c.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await H(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(j(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)return{data:null,error:o};const{data:a,error:c}=await H(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(!((n=a==null?void 0:a.totp)===null||n===void 0)&&n.qr_code&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(r){if(j(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:a}=await H(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(r){if(j(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?{data:null,error:i}:await H(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(j(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const s=(e==null?void 0:e.factors)||[],n=s.filter(i=>i.factor_type==="totp"&&i.status==="verified");return{data:{all:s,totp:n},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,s;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(n.access_token);let a=null;o.aal&&(a=o.aal);let c=a;((s=(r=n.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const l=o.amr||[];return{data:{currentLevel:a,nextLevel:c,currentAuthenticationMethods:l},error:null}}))}}ss.nextInstanceID=0;class og extends ss{constructor(e){super(e)}}var ag=globalThis&&globalThis.__awaiter||function(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(l){try{u(s.next(l))}catch(d){o(d)}}function c(l){try{u(s.throw(l))}catch(d){o(d)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((s=s.apply(t,e||[])).next())})};class cg{constructor(e,r,s){var n,i,o,a,c,u,l,d;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const h=Tp(e);this.realtimeUrl=`${h}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${h}/auth/v1`,this.storageUrl=`${h}/storage/v1`,this.functionsUrl=`${h}/functions/v1`;const p=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,g={db:vp,realtime:Sp,auth:Object.assign(Object.assign({},Ep),{storageKey:p}),global:_p},y=kp(s??{},g);this.storageKey=(i=(n=y.auth)===null||n===void 0?void 0:n.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=(o=y.global)===null||o===void 0?void 0:o.headers)!==null&&a!==void 0?a:{},this.auth=this._initSupabaseAuthClient((c=y.auth)!==null&&c!==void 0?c:{},this.headers,(u=y.global)===null||u===void 0?void 0:u.fetch),this.fetch=Rp(r,this._getAccessToken.bind(this),(l=y.global)===null||l===void 0?void 0:l.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},y.realtime)),this.rest=new Io(`${h}/rest/v1`,{headers:this.headers,schema:(d=y.db)===null||d===void 0?void 0:d.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new Nf(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new yp(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},s={}){return this.rest.rpc(e,r,s)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return ag(this,void 0,void 0,function*(){const{data:s}=yield this.auth.getSession();return(r=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,storageKey:i,flowType:o,debug:a},c,u){const l={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new og({url:this.authUrl,headers:Object.assign(Object.assign({},l),c),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,flowType:o,debug:a,fetch:u})}_initRealtimeClient(e){return new np(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,r,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.realtime.setAuth(s??null),this.changedAccessToken=s):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ug=(t,e,r)=>new cg(t,e,r),lg=t=>{let e=t.httpHandler;return{setHttpHandler(r){e=r},httpHandler(){return e},updateHttpClientConfig(r,s){e.updateHttpClientConfig(r,s)},httpHandlerConfigs(){return e.httpHandlerConfigs()}}},dg=t=>({httpHandler:t.httpHandler()});var ac;(function(t){t.HEADER="header",t.QUERY="query"})(ac||(ac={}));var cc;(function(t){t.HEADER="header",t.QUERY="query"})(cc||(cc={}));var ns;(function(t){t.HTTP="http",t.HTTPS="https"})(ns||(ns={}));var Gs;(function(t){t.MD5="md5",t.CRC32="crc32",t.CRC32C="crc32c",t.SHA1="sha1",t.SHA256="sha256"})(Gs||(Gs={}));var uc;(function(t){t[t.HEADER=0]="HEADER",t[t.TRAILER=1]="TRAILER"})(uc||(uc={}));const uo="__smithy_context";var lc;(function(t){t.PROFILE="profile",t.SSO_SESSION="sso-session",t.SERVICES="services"})(lc||(lc={}));var dc;(function(t){t.HTTP_0_9="http/0.9",t.HTTP_1_0="http/1.0",t.TDS_8_0="tds/8.0"})(dc||(dc={}));class De{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static isInstance(e){if(!e)return!1;const r=e;return"method"in r&&"protocol"in r&&"hostname"in r&&"path"in r&&typeof r.query=="object"&&typeof r.headers=="object"}clone(){const e=new De({...this,headers:{...this.headers}});return e.query&&(e.query=hg(e.query)),e}}function hg(t){return Object.keys(t).reduce((e,r)=>{const s=t[r];return{...e,[r]:Array.isArray(s)?[...s]:s}},{})}class is{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const r=e;return typeof r.statusCode=="number"&&typeof r.headers=="object"}}function fg(t){return e=>async r=>{const{request:s}=r;return De.isInstance(s)&&s.body&&t.runtime==="node"&&(s.headers={...s.headers,Expect:"100-continue"}),e({...r,request:s})}}const pg={step:"build",tags:["SET_EXPECT_HEADER","EXPECT_HEADER"],name:"addExpectContinueMiddleware",override:!0},gg=t=>({applyToStack:e=>{e.add(fg(t),pg)}});const mg=t=>e=>async r=>{if(!De.isInstance(r.request))return e(r);const{request:s}=r,{handlerProtocol:n=""}=t.requestHandler.metadata||{};if(n.indexOf("h2")>=0&&!s.headers[":authority"])delete s.headers.host,s.headers[":authority"]=s.hostname+(s.port?":"+s.port:"");else if(!s.headers.host){let i=s.hostname;s.port!=null&&(i+=`:${s.port}`),s.headers.host=i}return e(r)},yg={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},wg=t=>({applyToStack:e=>{e.add(mg(t),yg)}}),bg=()=>(t,e)=>async r=>{var s,n;try{const i=await t(r),{clientName:o,commandName:a,logger:c,dynamoDbDocumentClientOptions:u={}}=e,{overrideInputFilterSensitiveLog:l,overrideOutputFilterSensitiveLog:d}=u,h=l??e.inputFilterSensitiveLog,p=d??e.outputFilterSensitiveLog,{$metadata:g,...y}=i.output;return(s=c==null?void 0:c.info)==null||s.call(c,{clientName:o,commandName:a,input:h(r.input),output:p(y),metadata:g}),i}catch(i){const{clientName:o,commandName:a,logger:c,dynamoDbDocumentClientOptions:u={}}=e,{overrideInputFilterSensitiveLog:l}=u,d=l??e.inputFilterSensitiveLog;throw(n=c==null?void 0:c.error)==null||n.call(c,{clientName:o,commandName:a,input:d(r.input),error:i,metadata:i.$metadata}),i}},_g={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},vg=t=>({applyToStack:e=>{e.add(bg(),_g)}}),hc="X-Amzn-Trace-Id",Eg="AWS_LAMBDA_FUNCTION_NAME",Sg="_X_AMZN_TRACE_ID",xg=t=>e=>async r=>{const{request:s}=r;if(!De.isInstance(s)||t.runtime!=="node"||s.headers.hasOwnProperty(hc))return e(r);const n=process.env[Eg],i=process.env[Sg],o=a=>typeof a=="string"&&a.length>0;return o(n)&&o(i)&&(s.headers[hc]=i),e({...r,request:s})},Ag={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},Cg=t=>({applyToStack:e=>{e.add(xg(t),Ag)}});class Mo{trace(){}debug(){}info(){}warn(){}error(){}}const Dt=(t,e)=>{const r=[];if(t&&r.push(t),e)for(const s of e)r.push(s);return r},wt=(t,e)=>`${t||"anonymous"}${e&&e.length>0?` (a.k.a. ${e.join(",")})`:""}`,Vs=()=>{let t=[],e=[],r=!1;const s=new Set,n=d=>d.sort((h,p)=>fc[p.step]-fc[h.step]||pc[p.priority||"normal"]-pc[h.priority||"normal"]),i=d=>{let h=!1;const p=g=>{const y=Dt(g.name,g.aliases);if(y.includes(d)){h=!0;for(const w of y)s.delete(w);return!1}return!0};return t=t.filter(p),e=e.filter(p),h},o=d=>{let h=!1;const p=g=>{if(g.middleware===d){h=!0;for(const y of Dt(g.name,g.aliases))s.delete(y);return!1}return!0};return t=t.filter(p),e=e.filter(p),h},a=d=>{var h;return t.forEach(p=>{d.add(p.middleware,{...p})}),e.forEach(p=>{d.addRelativeTo(p.middleware,{...p})}),(h=d.identifyOnResolve)==null||h.call(d,l.identifyOnResolve()),d},c=d=>{const h=[];return d.before.forEach(p=>{p.before.length===0&&p.after.length===0?h.push(p):h.push(...c(p))}),h.push(d),d.after.reverse().forEach(p=>{p.before.length===0&&p.after.length===0?h.push(p):h.push(...c(p))}),h},u=(d=!1)=>{const h=[],p=[],g={};return t.forEach(w=>{const x={...w,before:[],after:[]};for(const k of Dt(x.name,x.aliases))g[k]=x;h.push(x)}),e.forEach(w=>{const x={...w,before:[],after:[]};for(const k of Dt(x.name,x.aliases))g[k]=x;p.push(x)}),p.forEach(w=>{if(w.toMiddleware){const x=g[w.toMiddleware];if(x===void 0){if(d)return;throw new Error(`${w.toMiddleware} is not found when adding ${wt(w.name,w.aliases)} middleware ${w.relation} ${w.toMiddleware}`)}w.relation==="after"&&x.after.push(w),w.relation==="before"&&x.before.push(w)}}),n(h).map(c).reduce((w,x)=>(w.push(...x),w),[])},l={add:(d,h={})=>{const{name:p,override:g,aliases:y}=h,w={step:"initialize",priority:"normal",middleware:d,...h},x=Dt(p,y);if(x.length>0){if(x.some(k=>s.has(k))){if(!g)throw new Error(`Duplicate middleware name '${wt(p,y)}'`);for(const k of x){const O=t.findIndex(J=>{var ee;return J.name===k||((ee=J.aliases)==null?void 0:ee.some(Ae=>Ae===k))});if(O===-1)continue;const B=t[O];if(B.step!==w.step||w.priority!==B.priority)throw new Error(`"${wt(B.name,B.aliases)}" middleware with ${B.priority} priority in ${B.step} step cannot be overridden by "${wt(p,y)}" middleware with ${w.priority} priority in ${w.step} step.`);t.splice(O,1)}}for(const k of x)s.add(k)}t.push(w)},addRelativeTo:(d,h)=>{const{name:p,override:g,aliases:y}=h,w={middleware:d,...h},x=Dt(p,y);if(x.length>0){if(x.some(k=>s.has(k))){if(!g)throw new Error(`Duplicate middleware name '${wt(p,y)}'`);for(const k of x){const O=e.findIndex(J=>{var ee;return J.name===k||((ee=J.aliases)==null?void 0:ee.some(Ae=>Ae===k))});if(O===-1)continue;const B=e[O];if(B.toMiddleware!==w.toMiddleware||B.relation!==w.relation)throw new Error(`"${wt(B.name,B.aliases)}" middleware ${B.relation} "${B.toMiddleware}" middleware cannot be overridden by "${wt(p,y)}" middleware ${w.relation} "${w.toMiddleware}" middleware.`);e.splice(O,1)}}for(const k of x)s.add(k)}e.push(w)},clone:()=>a(Vs()),use:d=>{d.applyToStack(l)},remove:d=>typeof d=="string"?i(d):o(d),removeByTag:d=>{let h=!1;const p=g=>{const{tags:y,name:w,aliases:x}=g;if(y&&y.includes(d)){const k=Dt(w,x);for(const O of k)s.delete(O);return h=!0,!1}return!0};return t=t.filter(p),e=e.filter(p),h},concat:d=>{var p;const h=a(Vs());return h.use(d),h.identifyOnResolve(r||h.identifyOnResolve()||(((p=d.identifyOnResolve)==null?void 0:p.call(d))??!1)),h},applyToStack:a,identify:()=>u(!0).map(d=>{const h=d.step??d.relation+" "+d.toMiddleware;return wt(d.name,d.aliases)+" - "+h}),identifyOnResolve(d){return typeof d=="boolean"&&(r=d),r},resolve:(d,h)=>{for(const p of u().map(g=>g.middleware).reverse())d=p(d,h);return r&&console.log(l.identify()),d}};return l},fc={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},pc={high:3,normal:2,low:1};class Rg{constructor(e){this.middlewareStack=Vs(),this.config=e}send(e,r,s){const n=typeof r!="function"?r:void 0,i=typeof r=="function"?r:s,o=e.resolveMiddleware(this.middlewareStack,this.config,n);if(i)o(e).then(a=>i(null,a.output),a=>i(a)).catch(()=>{});else return o(e).then(a=>a.output)}destroy(){this.config.requestHandler.destroy&&this.config.requestHandler.destroy()}}const kt={},br=new Array(64);for(let t=0,e="A".charCodeAt(0),r="Z".charCodeAt(0);t+e<=r;t++){const s=String.fromCharCode(t+e);kt[s]=t,br[t]=s}for(let t=0,e="a".charCodeAt(0),r="z".charCodeAt(0);t+e<=r;t++){const s=String.fromCharCode(t+e),n=t+26;kt[s]=n,br[n]=s}for(let t=0;t<10;t++){kt[t.toString(10)]=t+52;const e=t.toString(10),r=t+52;kt[e]=r,br[r]=e}kt["+"]=62;br[62]="+";kt["/"]=63;br[63]="/";const ur=6,es=8,Tg=63,Do=t=>{let e=t.length/4*3;t.slice(-2)==="=="?e-=2:t.slice(-1)==="="&&e--;const r=new ArrayBuffer(e),s=new DataView(r);for(let n=0;n<t.length;n+=4){let i=0,o=0;for(let u=n,l=n+3;u<=l;u++)if(t[u]!=="="){if(!(t[u]in kt))throw new TypeError(`Invalid character ${t[u]} in base64 string.`);i|=kt[t[u]]<<(l-u)*ur,o+=ur}else i>>=ur;const a=n/4*3;i>>=o%es;const c=Math.floor(o/es);for(let u=0;u<c;u++){const l=(c-u-1)*es;s.setUint8(a+u,(i&255<<l)>>l)}}return new Uint8Array(r)};function Fo(t){let e="";for(let r=0;r<t.length;r+=3){let s=0,n=0;for(let o=r,a=Math.min(r+3,t.length);o<a;o++)s|=t[o]<<(a-o-1)*es,n+=es;const i=Math.ceil(n/ur);s<<=i*ur-n;for(let o=1;o<=i;o++){const a=(i-o)*ur;e+=br[(s&Tg<<a)>>a]}e+="==".slice(0,4-i)}return e}const gs=t=>new TextEncoder().encode(t),lr=t=>typeof t=="string"?gs(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t),fn=t=>new TextDecoder("utf-8").decode(t);function kg(t,e="utf-8"){return e==="base64"?Fo(t):fn(t)}function Og(t,e){return e==="base64"?Kt.mutate(Do(t)):Kt.mutate(gs(t))}class Kt extends Uint8Array{static fromString(e,r="utf-8"){switch(typeof e){case"string":return Og(e,r);default:throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}}static mutate(e){return Object.setPrototypeOf(e,Kt.prototype),e}transformToString(e="utf-8"){return kg(this,e)}}const Pg=(t,e)=>{const{base64Encoder:r,bodyLengthChecker:s,checksumAlgorithmFn:n,checksumLocationName:i,streamHasher:o}=e,a=r!==void 0&&s!==void 0&&n!==void 0&&i!==void 0&&o!==void 0,c=a?o(n,t):void 0,u=t.getReader();return new ReadableStream({async pull(l){const{value:d,done:h}=await u.read();if(h){if(l.enqueue(`0\r
`),a){const p=r(await c);l.enqueue(`${i}:${p}\r
`),l.enqueue(`\r
`)}l.close()}else l.enqueue(`${(s(d)||0).toString(16)}\r
${d}\r
`)}})},zt=t=>encodeURIComponent(t).replace(/[!'()*]/g,Ig),Ig=t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`;function Bg(t){const e=[];for(let r of Object.keys(t).sort()){const s=t[r];if(r=zt(r),Array.isArray(s))for(let n=0,i=s.length;n<i;n++)e.push(`${r}=${zt(s[n])}`);else{let n=r;(s||typeof s=="string")&&(n+=`=${zt(s)}`),e.push(n)}}return e.join("&")}function Ng(t=0){return new Promise((e,r)=>{t&&setTimeout(()=>{const s=new Error(`Request did not complete within ${t} ms`);s.name="TimeoutError",r(s)},t)})}const $g={supported:typeof Request<"u"&&"keepalive"in new Request("https://[::1]")};class Uo{static create(e){return typeof(e==null?void 0:e.handle)=="function"?e:new Uo(e)}constructor(e){typeof e=="function"?this.configProvider=e().then(r=>r||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config))}destroy(){}async handle(e,{abortSignal:r}={}){this.config||(this.config=await this.configProvider);const s=this.config.requestTimeout,n=this.config.keepAlive===!0;if(r!=null&&r.aborted){const y=new Error("Request aborted");return y.name="AbortError",Promise.reject(y)}let i=e.path;const o=Bg(e.query||{});o&&(i+=`?${o}`),e.fragment&&(i+=`#${e.fragment}`);let a="";if(e.username!=null||e.password!=null){const y=e.username??"",w=e.password??"";a=`${y}:${w}@`}const{port:c,method:u}=e,l=`${e.protocol}//${a}${e.hostname}${c?`:${c}`:""}${i}`,h={body:u==="GET"||u==="HEAD"?void 0:e.body,headers:new Headers(e.headers),method:u};typeof AbortController<"u"&&(h.signal=r),$g.supported&&(h.keepalive=n);const p=new Request(l,h),g=[fetch(p).then(y=>{const w=y.headers,x={};for(const O of w.entries())x[O[0]]=O[1];return y.body!=null?{response:new is({headers:x,reason:y.statusText,statusCode:y.status,body:y.body})}:y.blob().then(O=>({response:new is({headers:x,reason:y.statusText,statusCode:y.status,body:O})}))}),Ng(s)];return r&&g.push(new Promise((y,w)=>{r.onabort=()=>{const x=new Error("Request aborted");x.name="AbortError",w(x)}})),Promise.race(g)}updateHttpClientConfig(e,r){this.config=void 0,this.configProvider=this.configProvider.then(s=>(s[e]=r,s))}httpHandlerConfigs(){return this.config??{}}}const sd=t=>typeof Blob=="function"&&t instanceof Blob?Mg(t):Dg(t);async function Mg(t){const e=await Fg(t),r=Do(e);return new Uint8Array(r)}async function Dg(t){let e=new Uint8Array(0);const r=t.getReader();let s=!1;for(;!s;){const{done:n,value:i}=await r.read();if(i){const o=e;e=new Uint8Array(o.length+i.length),e.set(o),e.set(i,o.length)}s=n}return e}function Fg(t){return new Promise((e,r)=>{const s=new FileReader;s.onloadend=()=>{if(s.readyState!==2)return r(new Error("Reader aborted too early"));const n=s.result??"",i=n.indexOf(","),o=i>-1?i+1:n.length;e(n.substring(o))},s.onabort=()=>r(new Error("Read aborted")),s.onerror=()=>r(s.error),s.readAsDataURL(t)})}const nd={},lo={};for(let t=0;t<256;t++){let e=t.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),nd[t]=e,lo[e]=t}function Ug(t){if(t.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2){const s=t.slice(r,r+2).toLowerCase();if(s in lo)e[r/2]=lo[s];else throw new Error(`Cannot decode unrecognized sequence ${s} as hexadecimal`)}return e}function He(t){let e="";for(let r=0;r<t.byteLength;r++)e+=nd[t[r]];return e}const gc="The stream has already been transformed.",Lg=t=>{var n,i;if(!mc(t)&&!yc(t)){const o=((i=(n=t==null?void 0:t.__proto__)==null?void 0:n.constructor)==null?void 0:i.name)||t;throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${o}`)}let e=!1;const r=async()=>{if(e)throw new Error(gc);return e=!0,await sd(t)},s=o=>{if(typeof o.stream!="function")throw new Error(`Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.
If you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body`);return o.stream()};return Object.assign(t,{transformToByteArray:r,transformToString:async o=>{const a=await r();if(o==="base64")return Fo(a);if(o==="hex")return He(a);if(o===void 0||o==="utf8"||o==="utf-8")return fn(a);if(typeof TextDecoder=="function")return new TextDecoder(o).decode(a);throw new Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(e)throw new Error(gc);if(e=!0,mc(t))return s(t);if(yc(t))return t;throw new Error(`Cannot transform payload to web stream, got ${t}`)}})},mc=t=>typeof Blob=="function"&&t instanceof Blob,yc=t=>typeof ReadableStream=="function"&&t instanceof ReadableStream,Lo=async(t=new Uint8Array,e)=>{if(t instanceof Uint8Array)return Kt.mutate(t);if(!t)return Kt.mutate(new Uint8Array);const r=e.streamCollector(t);return Kt.mutate(await r)};class _r{constructor(){this.middlewareStack=Vs()}static classBuilder(){return new jg}resolveMiddlewareWithContext(e,r,s,{middlewareFn:n,clientName:i,commandName:o,inputFilterSensitiveLog:a,outputFilterSensitiveLog:c,smithyContext:u,additionalContext:l,CommandCtor:d}){for(const w of n.bind(this)(d,e,r,s))this.middlewareStack.use(w);const h=e.concat(this.middlewareStack),{logger:p}=r,g={logger:p,clientName:i,commandName:o,inputFilterSensitiveLog:a,outputFilterSensitiveLog:c,[uo]:{...u},...l},{requestHandler:y}=r;return h.resolve(w=>y.handle(w.request,s||{}),g)}}class jg{constructor(){this._init=()=>{},this._ep={},this._middlewareFn=()=>[],this._commandName="",this._clientName="",this._additionalContext={},this._smithyContext={},this._inputFilterSensitiveLog=e=>e,this._outputFilterSensitiveLog=e=>e,this._serializer=null,this._deserializer=null}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,r,s={}){return this._smithyContext={service:e,operation:r,...s},this}c(e={}){return this._additionalContext=e,this}n(e,r){return this._clientName=e,this._commandName=r,this}f(e=s=>s,r=s=>s){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=r,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}build(){const e=this;let r;return r=class extends _r{static getEndpointParameterInstructions(){return e._ep}constructor(s){super(),this.input=s,this.serialize=e._serializer,this.deserialize=e._deserializer,e._init(this)}resolveMiddleware(s,n,i){return this.resolveMiddlewareWithContext(s,n,i,{CommandCtor:r,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog,outputFilterSensitiveLog:e._outputFilterSensitiveLog,smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}const tt="***SensitiveInformation***",Wt=t=>{switch(t){case"true":return!0;case"false":return!1;default:throw new Error(`Unable to parse boolean value "${t}"`)}},Hg=t=>{if(t!=null){if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return String(e)!==String(t)&&ad.warn(od(`Expected number but observed string: ${t}`)),e}if(typeof t=="number")return t;throw new TypeError(`Expected number, got ${typeof t}: ${t}`)}},zg=Math.ceil(2**127*(2-2**-23)),wc=t=>{const e=Hg(t);if(e!==void 0&&!Number.isNaN(e)&&e!==1/0&&e!==-1/0&&Math.abs(e)>zg)throw new TypeError(`Expected 32-bit float, got ${t}`);return e},ho=t=>{if(t!=null){if(Number.isInteger(t)&&!Number.isNaN(t))return t;throw new TypeError(`Expected integer, got ${typeof t}: ${t}`)}},bc=t=>jo(t,32),_c=t=>jo(t,16),vc=t=>jo(t,8),jo=(t,e)=>{const r=ho(t);if(r!==void 0&&qg(r,e)!==r)throw new TypeError(`Expected ${e}-bit integer, got ${t}`);return r},qg=(t,e)=>{switch(e){case 32:return Int32Array.of(t)[0];case 16:return Int16Array.of(t)[0];case 8:return Int8Array.of(t)[0]}},rt=(t,e)=>{if(t==null)throw e?new TypeError(`Expected a non-null value for ${e}`):new TypeError("Expected a non-null value");return t},id=t=>{if(t==null)return;if(typeof t=="object"&&!Array.isArray(t))return t;const e=Array.isArray(t)?"array":typeof t;throw new TypeError(`Expected object, got ${e}: ${t}`)},he=t=>{if(t!=null){if(typeof t=="string")return t;if(["boolean","number","bigint"].includes(typeof t))return ad.warn(od(`Expected string, got ${typeof t}: ${t}`)),String(t);throw new TypeError(`Expected string, got ${typeof t}: ${t}`)}},Kg=t=>wc(typeof t=="string"?ms(t):t),Gg=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,ms=t=>{const e=t.match(Gg);if(e===null||e[0].length!==t.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(t)},Ho=t=>ho(typeof t=="string"?ms(t):t),Gt=t=>bc(typeof t=="string"?ms(t):t),Ws=t=>_c(typeof t=="string"?ms(t):t),Vg=t=>vc(typeof t=="string"?ms(t):t),od=t=>String(new TypeError(t).stack||t).split(`
`).slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join(`
`),ad={warn:console.warn},Wg=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],zo=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function dr(t){const e=t.getUTCFullYear(),r=t.getUTCMonth(),s=t.getUTCDay(),n=t.getUTCDate(),i=t.getUTCHours(),o=t.getUTCMinutes(),a=t.getUTCSeconds(),c=n<10?`0${n}`:`${n}`,u=i<10?`0${i}`:`${i}`,l=o<10?`0${o}`:`${o}`,d=a<10?`0${a}`:`${a}`;return`${Wg[s]}, ${c} ${zo[r]} ${e} ${u}:${l}:${d} GMT`}const Jg=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),ys=t=>{if(t==null)return;if(typeof t!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const e=Jg.exec(t);if(!e)throw new TypeError("Invalid RFC-3339 date-time value");const[r,s,n,i,o,a,c,u,l]=e,d=Ws(as(s)),h=Tt(n,"month",1,12),p=Tt(i,"day",1,31),g=Ds(d,h,p,{hours:o,minutes:a,seconds:c,fractionalMilliseconds:u});return l.toUpperCase()!="Z"&&g.setTime(g.getTime()-om(l)),g},Xg=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d{2}) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),Yg=new RegExp(/^(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d{2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),Zg=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( [1-9]|\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? (\d{4})$/),os=t=>{if(t==null)return;if(typeof t!="string")throw new TypeError("RFC-7231 date-times must be expressed as strings");let e=Xg.exec(t);if(e){const[r,s,n,i,o,a,c,u]=e;return Ds(Ws(as(i)),Jn(n),Tt(s,"day",1,31),{hours:o,minutes:a,seconds:c,fractionalMilliseconds:u})}if(e=Yg.exec(t),e){const[r,s,n,i,o,a,c,u]=e;return tm(Ds(Qg(i),Jn(n),Tt(s,"day",1,31),{hours:o,minutes:a,seconds:c,fractionalMilliseconds:u}))}if(e=Zg.exec(t),e){const[r,s,n,i,o,a,c,u]=e;return Ds(Ws(as(u)),Jn(s),Tt(n.trimLeft(),"day",1,31),{hours:i,minutes:o,seconds:a,fractionalMilliseconds:c})}throw new TypeError("Invalid RFC-7231 date-time value")},Ds=(t,e,r,s)=>{const n=e-1;return sm(t,n,r),new Date(Date.UTC(t,n,r,Tt(s.hours,"hour",0,23),Tt(s.minutes,"minute",0,59),Tt(s.seconds,"seconds",0,60),im(s.fractionalMilliseconds)))},Qg=t=>{const e=new Date().getUTCFullYear(),r=Math.floor(e/100)*100+Ws(as(t));return r<e?r+100:r},em=50*365*24*60*60*1e3,tm=t=>t.getTime()-new Date().getTime()>em?new Date(Date.UTC(t.getUTCFullYear()-100,t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())):t,Jn=t=>{const e=zo.indexOf(t);if(e<0)throw new TypeError(`Invalid month: ${t}`);return e+1},rm=[31,28,31,30,31,30,31,31,30,31,30,31],sm=(t,e,r)=>{let s=rm[e];if(e===1&&nm(t)&&(s=29),r>s)throw new TypeError(`Invalid day for ${zo[e]} in ${t}: ${r}`)},nm=t=>t%4===0&&(t%100!==0||t%400===0),Tt=(t,e,r,s)=>{const n=Vg(as(t));if(n<r||n>s)throw new TypeError(`${e} must be between ${r} and ${s}, inclusive`);return n},im=t=>t==null?0:Kg("0."+t)*1e3,om=t=>{const e=t[0];let r=1;if(e=="+")r=1;else if(e=="-")r=-1;else throw new TypeError(`Offset direction, ${e}, must be "+" or "-"`);const s=Number(t.substring(1,3)),n=Number(t.substring(4,6));return r*(s*60+n)*60*1e3},as=t=>{let e=0;for(;e<t.length-1&&t.charAt(e)==="0";)e++;return e===0?t:t.slice(e)};class qo extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,qo.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}}const dt=(t,e={})=>{Object.entries(e).filter(([,s])=>s!==void 0).forEach(([s,n])=>{(t[s]==null||t[s]==="")&&(t[s]=n)});const r=t.message||t.Message||"UnknownError";return t.message=r,delete t.Message,t},am=({output:t,parsedBody:e,exceptionCtor:r,errorCode:s})=>{const n=um(t),i=n.httpStatusCode?n.httpStatusCode+"":void 0,o=new r({name:(e==null?void 0:e.code)||(e==null?void 0:e.Code)||s||i||"UnknownError",$fault:"client",$metadata:n});throw dt(o,e)},cm=t=>({output:e,parsedBody:r,errorCode:s})=>{am({output:e,parsedBody:r,exceptionCtor:t,errorCode:s})},um=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),lm=t=>{switch(t){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},dm=t=>{const e=[];for(const r in Gs){const s=Gs[r];t[s]!==void 0&&e.push({algorithmId:()=>s,checksumConstructor:()=>t[s]})}return{_checksumAlgorithms:e,addChecksumAlgorithm(r){this._checksumAlgorithms.push(r)},checksumAlgorithms(){return this._checksumAlgorithms}}},hm=t=>{const e={};return t.checksumAlgorithms().forEach(r=>{e[r.algorithmId()]=r.checksumConstructor()}),e},fm=t=>{let e=t.retryStrategy;return{setRetryStrategy(r){e=r},retryStrategy(){return e}}},pm=t=>{const e={};return e.retryStrategy=t.retryStrategy(),e},gm=t=>({...dm(t),...fm(t)}),mm=t=>({...hm(t),...pm(t)});function Ec(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}const fo=t=>Array.isArray(t)?t:[t],cd=t=>{const e="#text";for(const r in t)t.hasOwnProperty(r)&&t[r][e]!==void 0?t[r]=t[r][e]:typeof t[r]=="object"&&t[r]!==null&&(t[r]=cd(t[r]));return t},po=function(){const t=Object.getPrototypeOf(this).constructor,e=Function.bind.apply(String,[null,...arguments]),r=new e;return Object.setPrototypeOf(r,t.prototype),r};po.prototype=Object.create(String.prototype,{constructor:{value:po,enumerable:!1,writable:!0,configurable:!0}});Object.setPrototypeOf(po,String);function Y(t,e,r){let s,n,i;if(typeof e>"u"&&typeof r>"u")s={},i=t;else{if(s=t,typeof e=="function")return n=e,i=r,ym(s,n,i);i=e}for(const o of Object.keys(i)){if(!Array.isArray(i[o])){s[o]=i[o];continue}wm(s,null,i,o)}return s}const ym=(t,e,r)=>Y(t,Object.entries(r).reduce((s,[n,i])=>(Array.isArray(i)?s[n]=i:typeof i=="function"?s[n]=[e,i()]:s[n]=[e,i],s),{})),wm=(t,e,r,s)=>{if(e!==null){let o=r[s];typeof o=="function"&&(o=[,o]);const[a=bm,c=_m,u=s]=o;(typeof a=="function"&&a(e[u])||typeof a!="function"&&a)&&(t[s]=c(e[u]));return}let[n,i]=r[s];if(typeof i=="function"){let o;const a=n===void 0&&(o=i())!=null,c=typeof n=="function"&&!!n(void 0)||typeof n!="function"&&!!n;a?t[s]=o:c&&(t[s]=i())}else{const o=n===void 0&&i!=null,a=typeof n=="function"&&!!n(i)||typeof n!="function"&&!!n;(o||a)&&(t[s]=i)}},bm=t=>t!=null,_m=t=>t,vm=(t,e,r,s,n,i)=>{if(e!=null&&e[r]!==void 0){const o=s();if(o.length<=0)throw new Error("Empty value provided for input HTTP label: "+r+".");t=t.replace(n,i?o.split("/").map(a=>Ec(a)).join("/"):Ec(o))}else throw new Error("No value provided for input HTTP label: "+r+".");return t},Em="content-length";function Sm(){return(t,e)=>async r=>{var n;const{request:s}=r;if(De.isInstance(s)&&!(Em in s.headers)){const i="Are you using a Stream of unknown length as the Body of a PutObject request? Consider using Upload instead from @aws-sdk/lib-storage.";typeof((n=e==null?void 0:e.logger)==null?void 0:n.warn)=="function"&&!(e.logger instanceof Mo)?e.logger.warn(i):console.warn(i)}return t({...r})}}const xm={step:"finalizeRequest",tags:["CHECK_CONTENT_LENGTH_HEADER"],name:"getCheckContentLengthHeaderPlugin",override:!0},Am=t=>({applyToStack:e=>{e.add(Sm(),xm)}}),Cm=t=>(e,r)=>async s=>{const n=await t.region(),i=t.region;r.__s3RegionRedirect&&(t.region=async()=>(t.region=i,r.__s3RegionRedirect));const o=await e(s);if(r.__s3RegionRedirect){const a=await t.region();if(n!==a)throw new Error("Region was not restored following S3 region redirect.")}return o},Rm={tags:["REGION_REDIRECT","S3"],name:"regionRedirectEndpointMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"};function Tm(t){return(e,r)=>async s=>{var n,i;try{return await e(s)}catch(o){if(t.followRegionRedirects&&((n=o==null?void 0:o.$metadata)==null?void 0:n.httpStatusCode)===301){try{const a=o.$response.headers["x-amz-bucket-region"];(i=r.logger)==null||i.debug(`Redirecting from ${await t.region()} to ${a}`),r.__s3RegionRedirect=a}catch(a){throw new Error("Region redirect failed: "+a)}return e(s)}else throw o}}}const km={step:"initialize",tags:["REGION_REDIRECT","S3"],name:"regionRedirectMiddleware",override:!0},Om=t=>({applyToStack:e=>{e.add(Tm(t),km),e.addRelativeTo(Cm(t),Rm)}}),Pm=t=>(e,r)=>async s=>{var o;const n=await e(s),{response:i}=n;if(is.isInstance(i)&&i.headers.expires){i.headers.expiresstring=i.headers.expires;try{os(i.headers.expires)}catch(a){(o=r.logger)==null||o.warn(`AWS SDK Warning for ${r.clientName}::${r.commandName} response parsing (${i.headers.expires}): ${a}`),delete i.headers.expires}}return n},Im={tags:["S3"],name:"s3ExpiresMiddleware",override:!0,relation:"after",toMiddleware:"deserializerMiddleware"},ud=t=>({applyToStack:e=>{e.addRelativeTo(Pm(),Im)}});class pn{constructor(e={}){this.data=e,this.lastPurgeTime=Date.now()}get(e){const r=this.data[e];if(r)return r}set(e,r){return this.data[e]=r,r}delete(e){delete this.data[e]}async purgeExpired(){const e=Date.now();if(!(this.lastPurgeTime+pn.EXPIRED_CREDENTIAL_PURGE_INTERVAL_MS>e))for(const r in this.data){const s=this.data[r];if(!s.isRefreshing){const n=await s.identity;n.expiration&&n.expiration.getTime()<e&&delete this.data[r]}}}}pn.EXPIRED_CREDENTIAL_PURGE_INTERVAL_MS=3e4;class Xn{constructor(e,r=!1,s=Date.now()){this._identity=e,this.isRefreshing=r,this.accessed=s}get identity(){return this.accessed=Date.now(),this._identity}}class gn{constructor(e,r=new pn){this.createSessionFn=e,this.cache=r}async getS3ExpressIdentity(e,r){const s=r.Bucket,{cache:n}=this,i=n.get(s);return i?i.identity.then(o=>{var u,l;return(((u=o.expiration)==null?void 0:u.getTime())??0)<Date.now()?n.set(s,new Xn(this.getIdentity(s))).identity:((((l=o.expiration)==null?void 0:l.getTime())??0)<Date.now()+gn.REFRESH_WINDOW_MS&&!i.isRefreshing&&(i.isRefreshing=!0,this.getIdentity(s).then(d=>{n.set(s,new Xn(Promise.resolve(d)))})),o)}):n.set(s,new Xn(this.getIdentity(s))).identity}async getIdentity(e){var n,i;await this.cache.purgeExpired().catch(o=>{console.warn(`Error while clearing expired entries in S3ExpressIdentityCache: 
`+o)});const r=await this.createSessionFn(e);if(!((n=r.Credentials)!=null&&n.AccessKeyId)||!((i=r.Credentials)!=null&&i.SecretAccessKey))throw new Error("s3#createSession response credential missing AccessKeyId or SecretAccessKey.");return{accessKeyId:r.Credentials.AccessKeyId,secretAccessKey:r.Credentials.SecretAccessKey,sessionToken:r.Credentials.SessionToken,expiration:r.Credentials.Expiration?new Date(r.Credentials.Expiration):void 0}}}gn.REFRESH_WINDOW_MS=6e4;var Yn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var go=function(t,e){return go=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var n in s)s.hasOwnProperty(n)&&(r[n]=s[n])},go(t,e)};function Bm(t,e){go(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var mo=function(){return mo=Object.assign||function(e){for(var r,s=1,n=arguments.length;s<n;s++){r=arguments[s];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},mo.apply(this,arguments)};function Nm(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r}function $m(t,e,r,s){var n=arguments.length,i=n<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,r):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,s);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(n<3?o(i):n>3?o(e,r,i):o(e,r))||i);return n>3&&i&&Object.defineProperty(e,r,i),i}function Mm(t,e){return function(r,s){e(r,s,t)}}function Dm(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Fm(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(l){try{u(s.next(l))}catch(d){o(d)}}function c(l){try{u(s.throw(l))}catch(d){o(d)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((s=s.apply(t,e||[])).next())})}function Um(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,n,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(l){return c([u,l])}}function c(u){if(s)throw new TypeError("Generator is already executing.");for(;r;)try{if(s=1,n&&(i=u[0]&2?n.return:u[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,u[1])).done)return i;switch(n=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,n=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(l){u=[6,l],n=0}finally{s=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Lm(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]}function jm(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function yo(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],s=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ld(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var s=r.call(t),n,i=[],o;try{for(;(e===void 0||e-- >0)&&!(n=s.next()).done;)i.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(o)throw o.error}}return i}function Hm(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ld(arguments[e]));return t}function zm(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var s=Array(t),n=0,e=0;e<r;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,n++)s[n]=i[o];return s}function cs(t){return this instanceof cs?(this.v=t,this):new cs(t)}function qm(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(t,e||[]),n,i=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(h){s[h]&&(n[h]=function(p){return new Promise(function(g,y){i.push([h,p,g,y])>1||a(h,p)})})}function a(h,p){try{c(s[h](p))}catch(g){d(i[0][3],g)}}function c(h){h.value instanceof cs?Promise.resolve(h.value.v).then(u,l):d(i[0][2],h)}function u(h){a("next",h)}function l(h){a("throw",h)}function d(h,p){h(p),i.shift(),i.length&&a(i[0][0],i[0][1])}}function Km(t){var e,r;return e={},s("next"),s("throw",function(n){throw n}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(n,i){e[n]=t[n]?function(o){return(r=!r)?{value:cs(t[n](o)),done:n==="return"}:i?i(o):o}:i}}function Gm(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof yo=="function"?yo(t):t[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),n(a,c,o.done,o.value)})}}function n(i,o,a,c){Promise.resolve(c).then(function(u){i({value:u,done:a})},o)}}function Vm(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Wm(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Jm(t){return t&&t.__esModule?t:{default:t}}function Xm(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Ym(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const Zm=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return mo},__asyncDelegator:Km,__asyncGenerator:qm,__asyncValues:Gm,__await:cs,__awaiter:Fm,__classPrivateFieldGet:Xm,__classPrivateFieldSet:Ym,__createBinding:Lm,__decorate:$m,__exportStar:jm,__extends:Bm,__generator:Um,__importDefault:Jm,__importStar:Wm,__makeTemplateObject:Vm,__metadata:Dm,__param:Mm,__read:ld,__rest:Nm,__spread:Hm,__spreadArrays:zm,__values:yo},Symbol.toStringTag,{value:"Module"})),nt=ko(Zm);var Zn={},Tr={};const Qm=t=>{const e=[];for(let r=0,s=t.length;r<s;r++){const n=t.charCodeAt(r);if(n<128)e.push(n);else if(n<2048)e.push(n>>6|192,n&63|128);else if(r+1<t.length&&(n&64512)===55296&&(t.charCodeAt(r+1)&64512)===56320){const i=65536+((n&1023)<<10)+(t.charCodeAt(++r)&1023);e.push(i>>18|240,i>>12&63|128,i>>6&63|128,i&63|128)}else e.push(n>>12|224,n>>6&63|128,n&63|128)}return Uint8Array.from(e)},e0=t=>{let e="";for(let r=0,s=t.length;r<s;r++){const n=t[r];if(n<128)e+=String.fromCharCode(n);else if(192<=n&&n<224){const i=t[++r];e+=String.fromCharCode((n&31)<<6|i&63)}else if(240<=n&&n<365){const o="%"+[n,t[++r],t[++r],t[++r]].map(a=>a.toString(16)).join("%");e+=decodeURIComponent(o)}else e+=String.fromCharCode((n&15)<<12|(t[++r]&63)<<6|t[++r]&63)}return e};function t0(t){return new TextEncoder().encode(t)}function r0(t){return new TextDecoder("utf-8").decode(t)}const s0=t=>typeof TextEncoder=="function"?t0(t):Qm(t),n0=t=>typeof TextDecoder=="function"?r0(t):e0(t),i0=Object.freeze(Object.defineProperty({__proto__:null,fromUtf8:s0,toUtf8:n0},Symbol.toStringTag,{value:"Module"})),mn=ko(i0);var Sc;function o0(){if(Sc)return Tr;Sc=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.convertToBuffer=void 0;var t=mn,e=typeof Buffer<"u"&&Buffer.from?function(s){return Buffer.from(s,"utf8")}:t.fromUtf8;function r(s){return s instanceof Uint8Array?s:typeof s=="string"?e(s):ArrayBuffer.isView(s)?new Uint8Array(s.buffer,s.byteOffset,s.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(s)}return Tr.convertToBuffer=r,Tr}var kr={},xc;function a0(){if(xc)return kr;xc=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.isEmptyData=void 0;function t(e){return typeof e=="string"?e.length===0:e.byteLength===0}return kr.isEmptyData=t,kr}var Or={},Ac;function c0(){if(Ac)return Or;Ac=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.numToUint8=void 0;function t(e){return new Uint8Array([(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255])}return Or.numToUint8=t,Or}var Pr={},Cc;function u0(){if(Cc)return Pr;Cc=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.uint32ArrayFrom=void 0;function t(e){if(!Uint32Array.from){for(var r=new Uint32Array(e.length),s=0;s<e.length;)r[s]=e[s],s+=1;return r}return Uint32Array.from(e)}return Pr.uint32ArrayFrom=t,Pr}var Rc;function Pt(){return Rc||(Rc=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=t.numToUint8=t.isEmptyData=t.convertToBuffer=void 0;var e=o0();Object.defineProperty(t,"convertToBuffer",{enumerable:!0,get:function(){return e.convertToBuffer}});var r=a0();Object.defineProperty(t,"isEmptyData",{enumerable:!0,get:function(){return r.isEmptyData}});var s=c0();Object.defineProperty(t,"numToUint8",{enumerable:!0,get:function(){return s.numToUint8}});var n=u0();Object.defineProperty(t,"uint32ArrayFrom",{enumerable:!0,get:function(){return n.uint32ArrayFrom}})}(Zn)),Zn}var Ir={},Tc;function l0(){if(Tc)return Ir;Tc=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.AwsCrc32=void 0;var t=nt,e=Pt(),r=dd(),s=function(){function n(){this.crc32=new r.Crc32}return n.prototype.update=function(i){(0,e.isEmptyData)(i)||this.crc32.update((0,e.convertToBuffer)(i))},n.prototype.digest=function(){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(i){return[2,(0,e.numToUint8)(this.crc32.digest())]})})},n.prototype.reset=function(){this.crc32=new r.Crc32},n}();return Ir.AwsCrc32=s,Ir}var kc;function dd(){return kc||(kc=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.AwsCrc32=t.Crc32=t.crc32=void 0;var e=nt,r=Pt();function s(c){return new n().update(c).digest()}t.crc32=s;var n=function(){function c(){this.checksum=4294967295}return c.prototype.update=function(u){var l,d;try{for(var h=e.__values(u),p=h.next();!p.done;p=h.next()){var g=p.value;this.checksum=this.checksum>>>8^o[(this.checksum^g)&255]}}catch(y){l={error:y}}finally{try{p&&!p.done&&(d=h.return)&&d.call(h)}finally{if(l)throw l.error}}return this},c.prototype.digest=function(){return(this.checksum^4294967295)>>>0},c}();t.Crc32=n;var i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=(0,r.uint32ArrayFrom)(i),a=l0();Object.defineProperty(t,"AwsCrc32",{enumerable:!0,get:function(){return a.AwsCrc32}})}(Yn)),Yn}var Ko=dd();class ts{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const r=new Uint8Array(8);for(let s=7,n=Math.abs(Math.round(e));s>-1&&n>0;s--,n/=256)r[s]=n;return e<0&&Oc(r),new ts(r)}valueOf(){const e=this.bytes.slice(0),r=e[0]&128;return r&&Oc(e),parseInt(He(e),16)*(r?-1:1)}toString(){return String(this.valueOf())}}function Oc(t){for(let e=0;e<8;e++)t[e]^=255;for(let e=7;e>-1&&(t[e]++,t[e]===0);e--);}class hd{constructor(e,r){this.toUtf8=e,this.fromUtf8=r}format(e){const r=[];for(const i of Object.keys(e)){const o=this.fromUtf8(i);r.push(Uint8Array.from([o.byteLength]),o,this.formatHeaderValue(e[i]))}const s=new Uint8Array(r.reduce((i,o)=>i+o.byteLength,0));let n=0;for(const i of r)s.set(i,n),n+=i.byteLength;return s}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const r=new DataView(new ArrayBuffer(3));return r.setUint8(0,3),r.setInt16(1,e.value,!1),new Uint8Array(r.buffer);case"integer":const s=new DataView(new ArrayBuffer(5));return s.setUint8(0,4),s.setInt32(1,e.value,!1),new Uint8Array(s.buffer);case"long":const n=new Uint8Array(9);return n[0]=5,n.set(e.value.bytes,1),n;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const o=new Uint8Array(i.buffer);return o.set(e.value,3),o;case"string":const a=this.fromUtf8(e.value),c=new DataView(new ArrayBuffer(3+a.byteLength));c.setUint8(0,7),c.setUint16(1,a.byteLength,!1);const u=new Uint8Array(c.buffer);return u.set(a,3),u;case"timestamp":const l=new Uint8Array(9);return l[0]=8,l.set(ts.fromNumber(e.value.valueOf()).bytes,1),l;case"uuid":if(!b0.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const d=new Uint8Array(17);return d[0]=9,d.set(Ug(e.value.replace(/\-/g,"")),1),d}}parse(e){const r={};let s=0;for(;s<e.byteLength;){const n=e.getUint8(s++),i=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+s,n));switch(s+=n,e.getUint8(s++)){case 0:r[i]={type:Ic,value:!0};break;case 1:r[i]={type:Ic,value:!1};break;case 2:r[i]={type:d0,value:e.getInt8(s++)};break;case 3:r[i]={type:h0,value:e.getInt16(s,!1)},s+=2;break;case 4:r[i]={type:f0,value:e.getInt32(s,!1)},s+=4;break;case 5:r[i]={type:p0,value:new ts(new Uint8Array(e.buffer,e.byteOffset+s,8))},s+=8;break;case 6:const o=e.getUint16(s,!1);s+=2,r[i]={type:g0,value:new Uint8Array(e.buffer,e.byteOffset+s,o)},s+=o;break;case 7:const a=e.getUint16(s,!1);s+=2,r[i]={type:m0,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+s,a))},s+=a;break;case 8:r[i]={type:y0,value:new Date(new ts(new Uint8Array(e.buffer,e.byteOffset+s,8)).valueOf())},s+=8;break;case 9:const c=new Uint8Array(e.buffer,e.byteOffset+s,16);s+=16,r[i]={type:w0,value:`${He(c.subarray(0,4))}-${He(c.subarray(4,6))}-${He(c.subarray(6,8))}-${He(c.subarray(8,10))}-${He(c.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return r}}var Pc;(function(t){t[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid"})(Pc||(Pc={}));const Ic="boolean",d0="byte",h0="short",f0="integer",p0="long",g0="binary",m0="string",y0="timestamp",w0="uuid",b0=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,fd=4,Et=fd*2,Lt=4,_0=Et+Lt*2;function v0({byteLength:t,byteOffset:e,buffer:r}){if(t<_0)throw new Error("Provided message too short to accommodate event stream message overhead");const s=new DataView(r,e,t),n=s.getUint32(0,!1);if(t!==n)throw new Error("Reported message length does not match received message length");const i=s.getUint32(fd,!1),o=s.getUint32(Et,!1),a=s.getUint32(t-Lt,!1),c=new Ko.Crc32().update(new Uint8Array(r,e,Et));if(o!==c.digest())throw new Error(`The prelude checksum specified in the message (${o}) does not match the calculated CRC32 checksum (${c.digest()})`);if(c.update(new Uint8Array(r,e+Et,t-(Et+Lt))),a!==c.digest())throw new Error(`The message checksum (${c.digest()}) did not match the expected value of ${a}`);return{headers:new DataView(r,e+Et+Lt,i),body:new Uint8Array(r,e+Et+Lt+i,n-i-(Et+Lt+Lt))}}class E0{constructor(e,r){this.headerMarshaller=new hd(e,r),this.messageBuffer=[],this.isEndOfStream=!1}feed(e){this.messageBuffer.push(this.decode(e))}endOfStream(){this.isEndOfStream=!0}getMessage(){const e=this.messageBuffer.pop(),r=this.isEndOfStream;return{getMessage(){return e},isEndOfStream(){return r}}}getAvailableMessages(){const e=this.messageBuffer;this.messageBuffer=[];const r=this.isEndOfStream;return{getMessages(){return e},isEndOfStream(){return r}}}encode({headers:e,body:r}){const s=this.headerMarshaller.format(e),n=s.byteLength+r.byteLength+16,i=new Uint8Array(n),o=new DataView(i.buffer,i.byteOffset,i.byteLength),a=new Ko.Crc32;return o.setUint32(0,n,!1),o.setUint32(4,s.byteLength,!1),o.setUint32(8,a.update(i.subarray(0,8)).digest(),!1),i.set(s,12),i.set(r,s.byteLength+12),o.setUint32(n-4,a.update(i.subarray(8,n-4)).digest(),!1),i}decode(e){const{headers:r,body:s}=v0(e);return{headers:this.headerMarshaller.parse(r),body:s}}formatHeaders(e){return this.headerMarshaller.format(e)}}class S0{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.decoder.decode(e)}}class x0{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream)yield this.options.encoder.encode(e);this.options.includeEndFrame&&(yield new Uint8Array(0))}}class A0{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream){const r=await this.options.deserializer(e);r!==void 0&&(yield r)}}}class C0{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.serializer(e)}}const R0=t=>t[uo]||(t[uo]={}),st=t=>{if(typeof t=="function")return t;const e=Promise.resolve(t);return()=>e},T0="X-Amz-Algorithm",k0="X-Amz-Credential",pd="X-Amz-Date",O0="X-Amz-SignedHeaders",P0="X-Amz-Expires",gd="X-Amz-Signature",md="X-Amz-Security-Token",yd="authorization",wd=pd.toLowerCase(),I0="date",B0=[yd,wd,I0],N0=gd.toLowerCase(),wo="x-amz-content-sha256",$0=md.toLowerCase(),M0={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},D0=/^proxy-/,F0=/^sec-/,Qn="AWS4-HMAC-SHA256",U0="AWS4-HMAC-SHA256-PAYLOAD",L0="UNSIGNED-PAYLOAD",j0=50,bd="aws4_request",H0=60*60*24*7,ks={},ei=[],ti=(t,e,r)=>`${t}/${e}/${r}/${bd}`,z0=async(t,e,r,s,n)=>{const i=await Bc(t,e.secretAccessKey,e.accessKeyId),o=`${r}:${s}:${n}:${He(i)}:${e.sessionToken}`;if(o in ks)return ks[o];for(ei.push(o);ei.length>j0;)delete ks[ei.shift()];let a=`AWS4${e.secretAccessKey}`;for(const c of[r,s,n,bd])a=await Bc(t,a,c);return ks[o]=a},Bc=(t,e,r)=>{const s=new t(e);return s.update(lr(r)),s.digest()},Nc=({headers:t},e,r)=>{const s={};for(const n of Object.keys(t).sort()){if(t[n]==null)continue;const i=n.toLowerCase();(i in M0||e!=null&&e.has(i)||D0.test(i)||F0.test(i))&&(!r||r&&!r.has(i))||(s[i]=t[n].trim().replace(/\s+/g," "))}return s},q0=({query:t={}})=>{const e=[],r={};for(const s of Object.keys(t).sort()){if(s.toLowerCase()===N0)continue;e.push(s);const n=t[s];typeof n=="string"?r[s]=`${zt(s)}=${zt(n)}`:Array.isArray(n)&&(r[s]=n.slice(0).reduce((i,o)=>i.concat([`${zt(s)}=${zt(o)}`]),[]).sort().join("&"))}return e.map(s=>r[s]).filter(s=>s).join("&")},_d=t=>typeof ArrayBuffer=="function"&&t instanceof ArrayBuffer||Object.prototype.toString.call(t)==="[object ArrayBuffer]",ri=async({headers:t,body:e},r)=>{for(const s of Object.keys(t))if(s.toLowerCase()===wo)return t[s];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||_d(e)){const s=new r;return s.update(lr(e)),He(await s.digest())}return L0},K0=(t,e)=>{t=t.toLowerCase();for(const r of Object.keys(e))if(t===r.toLowerCase())return!0;return!1},vd=({headers:t,query:e,...r})=>({...r,headers:{...t},query:e?G0(e):void 0}),G0=t=>Object.keys(t).reduce((e,r)=>{const s=t[r];return{...e,[r]:Array.isArray(s)?[...s]:s}},{}),V0=(t,e={})=>{var n;const{headers:r,query:s={}}=typeof t.clone=="function"?t.clone():vd(t);for(const i of Object.keys(r)){const o=i.toLowerCase();o.slice(0,6)==="x-amz-"&&!((n=e.unhoistableHeaders)!=null&&n.has(o))&&(s[i]=r[i],delete r[i])}return{...t,headers:r,query:s}},$c=t=>{t=typeof t.clone=="function"?t.clone():vd(t);for(const e of Object.keys(t.headers))B0.indexOf(e.toLowerCase())>-1&&delete t.headers[e];return t},W0=t=>J0(t).toISOString().replace(/\.\d{3}Z$/,"Z"),J0=t=>typeof t=="number"?new Date(t*1e3):typeof t=="string"?Number(t)?new Date(Number(t)*1e3):new Date(t):t;class bo{constructor({applyChecksum:e,credentials:r,region:s,service:n,sha256:i,uriEscapePath:o=!0}){this.headerMarshaller=new hd(fn,gs),this.service=n,this.sha256=i,this.uriEscapePath=o,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=st(s),this.credentialProvider=st(r)}async presign(e,r={}){const{signingDate:s=new Date,expiresIn:n=3600,unsignableHeaders:i,unhoistableHeaders:o,signableHeaders:a,signingRegion:c,signingService:u}=r,l=await this.credentialProvider();this.validateResolvedCredentials(l);const d=c??await this.regionProvider(),{longDate:h,shortDate:p}=Os(s);if(n>H0)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const g=ti(p,d,u??this.service),y=V0($c(e),{unhoistableHeaders:o});l.sessionToken&&(y.query[md]=l.sessionToken),y.query[T0]=Qn,y.query[k0]=`${l.accessKeyId}/${g}`,y.query[pd]=h,y.query[P0]=n.toString(10);const w=Nc(y,i,a);return y.query[O0]=Mc(w),y.query[gd]=await this.getSignature(h,g,this.getSigningKey(l,d,p,u),this.createCanonicalRequest(y,w,await ri(e,this.sha256))),y}async sign(e,r){return typeof e=="string"?this.signString(e,r):e.headers&&e.payload?this.signEvent(e,r):e.message?this.signMessage(e,r):this.signRequest(e,r)}async signEvent({headers:e,payload:r},{signingDate:s=new Date,priorSignature:n,signingRegion:i,signingService:o}){const a=i??await this.regionProvider(),{shortDate:c,longDate:u}=Os(s),l=ti(c,a,o??this.service),d=await ri({headers:{},body:r},this.sha256),h=new this.sha256;h.update(e);const p=He(await h.digest()),g=[U0,u,l,n,p,d].join(`
`);return this.signString(g,{signingDate:s,signingRegion:a,signingService:o})}async signMessage(e,{signingDate:r=new Date,signingRegion:s,signingService:n}){return this.signEvent({headers:this.headerMarshaller.format(e.message.headers),payload:e.message.body},{signingDate:r,signingRegion:s,signingService:n,priorSignature:e.priorSignature}).then(o=>({message:e.message,signature:o}))}async signString(e,{signingDate:r=new Date,signingRegion:s,signingService:n}={}){const i=await this.credentialProvider();this.validateResolvedCredentials(i);const o=s??await this.regionProvider(),{shortDate:a}=Os(r),c=new this.sha256(await this.getSigningKey(i,o,a,n));return c.update(lr(e)),He(await c.digest())}async signRequest(e,{signingDate:r=new Date,signableHeaders:s,unsignableHeaders:n,signingRegion:i,signingService:o}={}){const a=await this.credentialProvider();this.validateResolvedCredentials(a);const c=i??await this.regionProvider(),u=$c(e),{longDate:l,shortDate:d}=Os(r),h=ti(d,c,o??this.service);u.headers[wd]=l,a.sessionToken&&(u.headers[$0]=a.sessionToken);const p=await ri(u,this.sha256);!K0(wo,u.headers)&&this.applyChecksum&&(u.headers[wo]=p);const g=Nc(u,n,s),y=await this.getSignature(l,h,this.getSigningKey(a,c,d,o),this.createCanonicalRequest(u,g,p));return u.headers[yd]=`${Qn} Credential=${a.accessKeyId}/${h}, SignedHeaders=${Mc(g)}, Signature=${y}`,u}createCanonicalRequest(e,r,s){const n=Object.keys(r).sort();return`${e.method}
${this.getCanonicalPath(e)}
${q0(e)}
${n.map(i=>`${i}:${r[i]}`).join(`
`)}

${n.join(";")}
${s}`}async createStringToSign(e,r,s){const n=new this.sha256;n.update(lr(s));const i=await n.digest();return`${Qn}
${e}
${r}
${He(i)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const r=[];for(const i of e.split("/"))(i==null?void 0:i.length)!==0&&i!=="."&&(i===".."?r.pop():r.push(i));const s=`${e!=null&&e.startsWith("/")?"/":""}${r.join("/")}${r.length>0&&(e!=null&&e.endsWith("/"))?"/":""}`;return encodeURIComponent(s).replace(/%2F/g,"/")}return e}async getSignature(e,r,s,n){const i=await this.createStringToSign(e,r,n),o=new this.sha256(await s);return o.update(lr(i)),He(await o.digest())}getSigningKey(e,r,s,n){return z0(this.sha256,e,s,r,n||this.service)}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}}const Os=t=>{const e=W0(t).replace(/[\-:]/g,"");return{longDate:e,shortDate:e.slice(0,8)}},Mc=t=>Object.keys(t).sort().join(";");var Dc;(function(t){t.ENV="env",t.CONFIG="shared config entry"})(Dc||(Dc={}));const X0="Directory",Y0="S3Express",Z0="sigv4-s3express",_o="X-Amz-S3session-Token",vo=_o.toLowerCase();class Q0 extends bo{async signWithCredentials(e,r,s){const n=Fc(r);e.headers[vo]=r.sessionToken;const i=this;return Uc(i,n),i.signRequest(e,s??{})}async presignWithCredentials(e,r,s){const n=Fc(r);return delete e.headers[vo],e.headers[_o]=r.sessionToken,e.query=e.query??{},e.query[_o]=r.sessionToken,Uc(this,n),this.presign(e,s)}}function Fc(t){return{accessKeyId:t.accessKeyId,secretAccessKey:t.secretAccessKey,expiration:t.expiration}}function Uc(t,e){const r=setTimeout(()=>{throw new Error("SignatureV4S3Express credential override was created but not called.")},10),s=t.credentialProvider,n=()=>(clearTimeout(r),t.credentialProvider=s,Promise.resolve(e));t.credentialProvider=n}const ey=t=>(e,r)=>async s=>{var n,i,o,a,c;if(r.endpointV2){const u=r.endpointV2,l=((o=(i=(n=u.properties)==null?void 0:n.authSchemes)==null?void 0:i[0])==null?void 0:o.name)===Z0;if((((a=u.properties)==null?void 0:a.backend)===Y0||((c=u.properties)==null?void 0:c.bucketType)===X0)&&(r.isS3ExpressBucket=!0),l){const h=s.input.Bucket;if(h){const p=await t.s3ExpressIdentityProvider.getS3ExpressIdentity(await t.credentials(),{Bucket:h});r.s3ExpressIdentity=p,De.isInstance(s.request)&&p.sessionToken&&(s.request.headers[vo]=p.sessionToken)}}}return e(s)},ty={name:"s3ExpressMiddleware",step:"build",tags:["S3","S3_EXPRESS"],override:!0},ry=t=>({applyToStack:e=>{e.add(ey(t),ty)}}),sy=(t,{session:e})=>{const[r,s]=e;return{...t,forcePathStyle:t.forcePathStyle??!1,useAccelerateEndpoint:t.useAccelerateEndpoint??!1,disableMultiregionAccessPoints:t.disableMultiregionAccessPoints??!1,followRegionRedirects:t.followRegionRedirects??!1,s3ExpressIdentityProvider:t.s3ExpressIdentityProvider??new gn(async n=>r().send(new s({Bucket:n,SessionMode:"ReadWrite"})))}},ny=t=>typeof t=="string"&&t.indexOf("arn:")===0&&t.split(":").length>=6;function iy(){return t=>async e=>{const{input:{Bucket:r}}=e;if(typeof r=="string"&&!ny(r)&&r.indexOf("/")>=0){const s=new Error(`Bucket name shouldn't contain '/', received '${r}'`);throw s.name="InvalidBucketName",s}return t({...e})}}const oy={step:"initialize",tags:["VALIDATE_BUCKET_NAME"],name:"validateBucketNameMiddleware",override:!0},ay=t=>({applyToStack:e=>{e.add(iy(),oy)}}),Ed=(t,e,r)=>{let s,n,i,o=!1;const a=async()=>{n||(n=t());try{s=await n,i=!0,o=!1}finally{n=void 0}return s};return e===void 0?async c=>((!i||c!=null&&c.forceRefresh)&&(s=await a()),s):async c=>((!i||c!=null&&c.forceRefresh)&&(s=await a()),o?s:r&&!r(s)?(o=!0,s):(e(s)&&await a(),s))},cy=3e5,uy=t=>{const e=t.credentials?ly(t.credentials):t.credentialDefaultProvider(Object.assign({},t,{parentClientConfig:t})),{signingEscapePath:r=!0,systemClockOffset:s=t.systemClockOffset||0,sha256:n}=t;let i;return t.signer?i=st(t.signer):t.regionInfoProvider?i=()=>st(t.region)().then(async o=>[await t.regionInfoProvider(o,{useFipsEndpoint:await t.useFipsEndpoint(),useDualstackEndpoint:await t.useDualstackEndpoint()})||{},o]).then(([o,a])=>{const{signingRegion:c,signingService:u}=o;t.signingRegion=t.signingRegion||c||a,t.signingName=t.signingName||u||t.serviceId;const l={...t,credentials:e,region:t.signingRegion,service:t.signingName,sha256:n,uriEscapePath:r},d=t.signerConstructor||bo;return new d(l)}):i=async o=>{o=Object.assign({},{name:"sigv4",signingName:t.signingName||t.defaultSigningName,signingRegion:await st(t.region)(),properties:{}},o);const a=o.signingRegion,c=o.signingName;t.signingRegion=t.signingRegion||a,t.signingName=t.signingName||c||t.serviceId;const u={...t,credentials:e,region:t.signingRegion,service:t.signingName,sha256:n,uriEscapePath:r},l=t.signerConstructor||bo;return new l(u)},{...t,systemClockOffset:s,signingEscapePath:r,credentials:e,signer:i}},ly=t=>typeof t=="function"?Ed(t,e=>e.expiration!==void 0&&e.expiration.getTime()-Date.now()<cy,e=>e.expiration!==void 0):st(t),Sd=t=>new Date(Date.now()+t),dy=(t,e)=>Math.abs(Sd(e).getTime()-t)>=3e5,Lc=(t,e)=>{const r=Date.parse(t);return dy(r,e)?r-Date.now():e},hy=t=>(e,r)=>async function(s){var d,h,p,g;if(!De.isInstance(s.request))return e(s);const n=(p=(h=(d=r.endpointV2)==null?void 0:d.properties)==null?void 0:h.authSchemes)==null?void 0:p[0],i=(n==null?void 0:n.name)==="sigv4a"?(g=n==null?void 0:n.signingRegionSet)==null?void 0:g.join(","):void 0,o=await t.signer(n);let a;const c={signingDate:Sd(t.systemClockOffset),signingRegion:i||r.signing_region,signingService:r.signing_service};if(r.s3ExpressIdentity){if(a=await o.signWithCredentials(s.request,r.s3ExpressIdentity,c),a.headers["X-Amz-Security-Token"]||a.headers["x-amz-security-token"])throw new Error("X-Amz-Security-Token must not be set for s3-express requests.")}else a=await o.sign(s.request,c);const u=await e({...s,request:a}).catch(y=>{const w=y.ServerTime??jc(y.$response);throw w&&(t.systemClockOffset=Lc(w,t.systemClockOffset)),y}),l=jc(u.response);return l&&(t.systemClockOffset=Lc(l,t.systemClockOffset)),u},jc=t=>{var e,r;return is.isInstance(t)?((e=t.headers)==null?void 0:e.date)??((r=t.headers)==null?void 0:r.Date):void 0},fy={name:"awsAuthMiddleware",tags:["SIGNATURE","AWSAUTH"],relation:"after",toMiddleware:"retryMiddleware",override:!0},py=t=>({applyToStack:e=>{e.addRelativeTo(hy(t),fy)}});function gy(t){return{...t,customUserAgent:typeof t.customUserAgent=="string"?[[t.customUserAgent]]:t.customUserAgent}}const my=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),xd=t=>my.test(t)||t.startsWith("[")&&t.endsWith("]"),yy=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),Go=(t,e=!1)=>{if(!e)return yy.test(t);const r=t.split(".");for(const s of r)if(!Go(s))return!1;return!0},Eo={},us="endpoints";function Ot(t){return typeof t!="object"||t==null?t:"ref"in t?`$${Ot(t.ref)}`:"fn"in t?`${t.fn}(${(t.argv||[]).map(Ot).join(", ")})`:JSON.stringify(t,null,2)}class ze extends Error{constructor(e){super(e),this.name="EndpointError"}}const wy=(t,e)=>t===e,by=t=>{const e=t.split("."),r=[];for(const s of e){const n=s.indexOf("[");if(n!==-1){if(s.indexOf("]")!==s.length-1)throw new ze(`Path: '${t}' does not end with ']'`);const i=s.slice(n+1,-1);if(Number.isNaN(parseInt(i)))throw new ze(`Invalid array index: '${i}' in path: '${t}'`);n!==0&&r.push(s.slice(0,n)),r.push(i)}else r.push(s)}return r},Ad=(t,e)=>by(e).reduce((r,s)=>{if(typeof r!="object")throw new ze(`Index '${s}' in '${e}' not found in '${JSON.stringify(t)}'`);return Array.isArray(r)?r[parseInt(s)]:r[s]},t),_y=t=>t!=null,vy=t=>!t,si={[ns.HTTP]:80,[ns.HTTPS]:443},Ey=t=>{const e=(()=>{try{if(t instanceof URL)return t;if(typeof t=="object"&&"hostname"in t){const{hostname:h,port:p,protocol:g="",path:y="",query:w={}}=t,x=new URL(`${g}//${h}${p?`:${p}`:""}${y}`);return x.search=Object.entries(w).map(([k,O])=>`${k}=${O}`).join("&"),x}return new URL(t)}catch{return null}})();if(!e)return console.error(`Unable to parse ${JSON.stringify(t)} as a whatwg URL.`),null;const r=e.href,{host:s,hostname:n,pathname:i,protocol:o,search:a}=e;if(a)return null;const c=o.slice(0,-1);if(!Object.values(ns).includes(c))return null;const u=xd(n),l=r.includes(`${s}:${si[c]}`)||typeof t=="string"&&t.includes(`${s}:${si[c]}`),d=`${s}${l?`:${si[c]}`:""}`;return{scheme:c,authority:d,path:i,normalizedPath:i.endsWith("/")?i:`${i}/`,isIp:u}},Sy=(t,e)=>t===e,xy=(t,e,r,s)=>e>=r||t.length<r?null:s?t.substring(t.length-r,t.length-e):t.substring(e,r),Ay=t=>encodeURIComponent(t).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Cy={booleanEquals:wy,getAttr:Ad,isSet:_y,isValidHostLabel:Go,not:vy,parseURL:Ey,stringEquals:Sy,substring:xy,uriEncode:Ay},Cd=(t,e)=>{const r=[],s={...e.endpointParams,...e.referenceRecord};let n=0;for(;n<t.length;){const i=t.indexOf("{",n);if(i===-1){r.push(t.slice(n));break}r.push(t.slice(n,i));const o=t.indexOf("}",i);if(o===-1){r.push(t.slice(i));break}t[i+1]==="{"&&t[o+1]==="}"&&(r.push(t.slice(i+1,o)),n=o+2);const a=t.substring(i+1,o);if(a.includes("#")){const[c,u]=a.split("#");r.push(Ad(s[c],u))}else r.push(s[a]);n=o+1}return r.join("")},Ry=({ref:t},e)=>({...e.endpointParams,...e.referenceRecord})[t],yn=(t,e,r)=>{if(typeof t=="string")return Cd(t,r);if(t.fn)return Rd(t,r);if(t.ref)return Ry(t,r);throw new ze(`'${e}': ${String(t)} is not a string, function or reference.`)},Rd=({fn:t,argv:e},r)=>{const s=e.map(i=>["boolean","number"].includes(typeof i)?i:yn(i,"arg",r)),n=t.split(".");return n[0]in Eo&&n[1]!=null?Eo[n[0]][n[1]](...s):Cy[t](...s)},Ty=({assign:t,...e},r)=>{var n,i;if(t&&t in r.referenceRecord)throw new ze(`'${t}' is already defined in Reference Record.`);const s=Rd(e,r);return(i=(n=r.logger)==null?void 0:n.debug)==null||i.call(n,us,`evaluateCondition: ${Ot(e)} = ${Ot(s)}`),{result:s===""?!0:!!s,...t!=null&&{toAssign:{name:t,value:s}}}},Vo=(t=[],e)=>{var s,n;const r={};for(const i of t){const{result:o,toAssign:a}=Ty(i,{...e,referenceRecord:{...e.referenceRecord,...r}});if(!o)return{result:o};a&&(r[a.name]=a.value,(n=(s=e.logger)==null?void 0:s.debug)==null||n.call(s,us,`assign: ${a.name} := ${Ot(a.value)}`))}return{result:!0,referenceRecord:r}},ky=(t,e)=>Object.entries(t).reduce((r,[s,n])=>({...r,[s]:n.map(i=>{const o=yn(i,"Header value entry",e);if(typeof o!="string")throw new ze(`Header '${s}' value '${o}' is not a string`);return o})}),{}),Td=(t,e)=>{if(Array.isArray(t))return t.map(r=>Td(r,e));switch(typeof t){case"string":return Cd(t,e);case"object":if(t===null)throw new ze(`Unexpected endpoint property: ${t}`);return kd(t,e);case"boolean":return t;default:throw new ze(`Unexpected endpoint property type: ${typeof t}`)}},kd=(t,e)=>Object.entries(t).reduce((r,[s,n])=>({...r,[s]:Td(n,e)}),{}),Oy=(t,e)=>{const r=yn(t,"Endpoint URL",e);if(typeof r=="string")try{return new URL(r)}catch(s){throw console.error(`Failed to construct URL with ${r}`,s),s}throw new ze(`Endpoint URL must be a string, got ${typeof r}`)},Py=(t,e)=>{var l,d;const{conditions:r,endpoint:s}=t,{result:n,referenceRecord:i}=Vo(r,e);if(!n)return;const o={...e,referenceRecord:{...e.referenceRecord,...i}},{url:a,properties:c,headers:u}=s;return(d=(l=e.logger)==null?void 0:l.debug)==null||d.call(l,us,`Resolving endpoint from template: ${Ot(s)}`),{...u!=null&&{headers:ky(u,o)},...c!=null&&{properties:kd(c,o)},url:Oy(a,o)}},Iy=(t,e)=>{const{conditions:r,error:s}=t,{result:n,referenceRecord:i}=Vo(r,e);if(n)throw new ze(yn(s,"Error",{...e,referenceRecord:{...e.referenceRecord,...i}}))},By=(t,e)=>{const{conditions:r,rules:s}=t,{result:n,referenceRecord:i}=Vo(r,e);if(n)return Od(s,{...e,referenceRecord:{...e.referenceRecord,...i}})},Od=(t,e)=>{for(const r of t)if(r.type==="endpoint"){const s=Py(r,e);if(s)return s}else if(r.type==="error")Iy(r,e);else if(r.type==="tree"){const s=By(r,e);if(s)return s}else throw new ze(`Unknown endpoint rule: ${r}`);throw new ze("Rules evaluation failed")},Ny=(t,e)=>{var u,l,d,h,p;const{endpointParams:r,logger:s}=e,{parameters:n,rules:i}=t;(l=(u=e.logger)==null?void 0:u.debug)==null||l.call(u,`${us} Initial EndpointParams: ${Ot(r)}`);const o=Object.entries(n).filter(([,g])=>g.default!=null).map(([g,y])=>[g,y.default]);if(o.length>0)for(const[g,y]of o)r[g]=r[g]??y;const a=Object.entries(n).filter(([,g])=>g.required).map(([g])=>g);for(const g of a)if(r[g]==null)throw new ze(`Missing required parameter: '${g}'`);const c=Od(i,{endpointParams:r,logger:s,referenceRecord:{}});if((d=e.endpointParams)!=null&&d.Endpoint)try{const g=new URL(e.endpointParams.Endpoint),{protocol:y,port:w}=g;c.url.protocol=y,c.url.port=w}catch{}return(p=(h=e.logger)==null?void 0:h.debug)==null||p.call(h,`${us} Resolved endpoint: ${Ot(c)}`),c},Pd=(t,e=!1)=>{if(e){for(const r of t.split("."))if(!Pd(r))return!1;return!0}return!(!Go(t)||t.length<3||t.length>63||t!==t.toLowerCase()||xd(t))},$y=t=>{const e=t.split(":");if(e.length<6)return null;const[r,s,n,i,o,...a]=e;return r!=="arn"||s===""||n===""||a[0]===""?null:{partition:s,service:n,region:i,accountId:o,resourceId:a[0].includes("/")?a[0].split("/"):a}},My=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"aws-global":{description:"AWS Standard global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"AWS China global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"AWS GovCloud (US) global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"c2s.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"AWS ISO (US) global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"sc2s.sgov.gov",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"AWS ISOB (US) global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"cloud.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"csp.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{}}],Dy="1.1",Fy={partitions:My,version:Dy};let Uy=Fy;const Ly=t=>{const{partitions:e}=Uy;for(const s of e){const{regions:n,outputs:i}=s;for(const[o,a]of Object.entries(n))if(o===t)return{...i,...a}}for(const s of e){const{regionRegex:n,outputs:i}=s;if(new RegExp(n).test(t))return{...i}}const r=e.find(s=>s.id==="aws");if(!r)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...r.outputs}},jy={isVirtualHostableS3Bucket:Pd,parseArn:$y,partition:Ly};Eo.aws=jy;const Hc="user-agent",ni="x-amz-user-agent",zc=" ",ii="/",Hy=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,zy=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g,qc="-",qy=t=>(e,r)=>async s=>{var d,h;const{request:n}=s;if(!De.isInstance(n))return e(s);const{headers:i}=n,o=((d=r==null?void 0:r.userAgent)==null?void 0:d.map(oi))||[],a=(await t.defaultUserAgentProvider()).map(oi),c=((h=t==null?void 0:t.customUserAgent)==null?void 0:h.map(oi))||[],u=[].concat([...a,...o,...c]).join(zc),l=[...a.filter(p=>p.startsWith("aws-sdk-")),...c].join(zc);return t.runtime!=="browser"?(l&&(i[ni]=i[ni]?`${i[Hc]} ${l}`:l),i[Hc]=u):i[ni]=u,e({...s,request:n})},oi=t=>{var o;const e=t[0].split(ii).map(a=>a.replace(Hy,qc)).join(ii),r=(o=t[1])==null?void 0:o.replace(zy,qc),s=e.indexOf(ii),n=e.substring(0,s);let i=e.substring(s+1);return n==="api"&&(i=i.toLowerCase()),[n,i,r].filter(a=>a&&a.length>0).reduce((a,c,u)=>{switch(u){case 0:return c;case 1:return`${a}/${c}`;default:return`${a}#${c}`}},"")},Ky={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},Gy=t=>({applyToStack:e=>{e.add(qy(t),Ky)}}),Vy=!1,Wy=!1,Id=t=>typeof t=="string"&&(t.startsWith("fips-")||t.endsWith("-fips")),Kc=t=>Id(t)?["fips-aws-global","aws-fips"].includes(t)?"us-east-1":t.replace(/fips-(dkr-|prod-)?|-fips/,""):t,Jy=t=>{const{region:e,useFipsEndpoint:r}=t;if(!e)throw new Error("Region is missing");return{...t,region:async()=>{if(typeof e=="string")return Kc(e);const s=await e();return Kc(s)},useFipsEndpoint:async()=>{const s=typeof e=="string"?e:await e();return Id(s)?!0:typeof r!="function"?Promise.resolve(!!r):r()}}},Xy=t=>({...t,eventStreamMarshaller:t.eventStreamSerdeProvider(t)}),Gc="content-length";function Yy(t){return e=>async r=>{const s=r.request;if(De.isInstance(s)){const{body:n,headers:i}=s;if(n&&Object.keys(i).map(o=>o.toLowerCase()).indexOf(Gc)===-1)try{const o=t(n);s.headers={...s.headers,[Gc]:String(o)}}catch{}}return e({...r,request:s})}}const Zy={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},Qy=t=>({applyToStack:e=>{e.add(Yy(t.bodyLengthChecker),Zy)}}),ew=async t=>{const e=(t==null?void 0:t.Bucket)||"";if(typeof t.Bucket=="string"&&(t.Bucket=e.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),iw(e)){if(t.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!nw(e)||e.indexOf(".")!==-1&&!String(t.Endpoint).startsWith("http:")||e.toLowerCase()!==e||e.length<3)&&(t.ForcePathStyle=!0);return t.DisableMultiRegionAccessPoints&&(t.disableMultiRegionAccessPoints=!0,t.DisableMRAP=!0),t},tw=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,rw=/(\d+\.){3}\d+/,sw=/\.\./,nw=t=>tw.test(t)&&!rw.test(t)&&!sw.test(t),iw=t=>{const[e,r,s,n,i,o]=t.split(":"),a=e==="arn"&&t.split(":").length>=6,c=[e,r,s,i,o].filter(Boolean).length===5;if(a&&!c)throw new Error(`Invalid ARN: ${t} was an invalid ARN.`);return e==="arn"&&!!r&&!!s&&!!i&&!!o},ow=(t,e,r)=>{const s=async()=>{const n=r[t]??r[e];return typeof n=="function"?n():n};return t==="credentialScope"||e==="CredentialScope"?async()=>{const n=typeof r.credentials=="function"?await r.credentials():r.credentials;return(n==null?void 0:n.credentialScope)??(n==null?void 0:n.CredentialScope)}:t==="endpoint"||e==="endpoint"?async()=>{const n=await s();if(n&&typeof n=="object"){if("url"in n)return n.url.href;if("hostname"in n){const{protocol:i,hostname:o,port:a,path:c}=n;return`${i}//${o}${a?":"+a:""}${c}`}}return n}:s},aw=async t=>{};function cw(t){const e={};if(t=t.replace(/^\?/,""),t)for(const r of t.split("&")){let[s,n=null]=r.split("=");s=decodeURIComponent(s),n&&(n=decodeURIComponent(n)),s in e?Array.isArray(e[s])?e[s].push(n):e[s]=[e[s],n]:e[s]=n}return e}const Js=t=>{if(typeof t=="string")return Js(new URL(t));const{hostname:e,pathname:r,port:s,protocol:n,search:i}=t;let o;return i&&(o=cw(i)),{hostname:e,port:s?parseInt(s):void 0,protocol:n,path:r,query:o}},Bd=t=>typeof t=="object"?"url"in t?Js(t.url):t:Js(t),uw=async(t,e,r,s)=>{if(!r.endpoint){const o=await aw(r.serviceId||"");o&&(r.endpoint=()=>Promise.resolve(Bd(o)))}const n=await lw(t,e,r);if(typeof r.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return r.endpointProvider(n,s)},lw=async(t,e,r)=>{var i;const s={},n=((i=e==null?void 0:e.getEndpointParameterInstructions)==null?void 0:i.call(e))||{};for(const[o,a]of Object.entries(n))switch(a.type){case"staticContextParams":s[o]=a.value;break;case"contextParams":s[o]=t[a.name];break;case"clientContextParams":case"builtInParams":s[o]=await ow(a.name,o,r)();break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(a))}return Object.keys(n).length===0&&Object.assign(s,r),String(r.serviceId).toLowerCase()==="s3"&&await ew(s),s},dw=({config:t,instructions:e})=>(r,s)=>async n=>{var a,c,u;const i=await uw(n.input,{getEndpointParameterInstructions(){return e}},{...t},s);s.endpointV2=i,s.authSchemes=(a=i.properties)==null?void 0:a.authSchemes;const o=(c=s.authSchemes)==null?void 0:c[0];if(o){s.signing_region=o.signingRegion,s.signing_service=o.signingName;const l=R0(s),d=(u=l==null?void 0:l.selectedHttpAuthScheme)==null?void 0:u.httpAuthOption;d&&(d.signingProperties=Object.assign(d.signingProperties||{},{signing_region:o.signingRegion,signingRegion:o.signingRegion,signing_service:o.signingName,signingName:o.signingName,signingRegionSet:o.signingRegionSet},o.properties))}return r({...n})},hw=(t,e)=>(r,s)=>async n=>{const{response:i}=await r(n);try{const o=await e(i,t);return{response:i,output:o}}catch(o){if(Object.defineProperty(o,"$response",{value:i}),!("$metadata"in o)){const a="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";o.message+=`
  `+a}throw o}},fw=(t,e)=>(r,s)=>async n=>{var a;const i=(a=s.endpointV2)!=null&&a.url&&t.urlParser?async()=>t.urlParser(s.endpointV2.url):t.endpoint;if(!i)throw new Error("No valid endpoint provider available.");const o=await e(n.input,{...t,endpoint:i});return r({...n,request:o})},pw={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},Wo={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function ws(t,e,r){return{applyToStack:s=>{s.add(hw(t,r),pw),s.add(fw(t,e),Wo)}}}const Nd={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:Wo.name},bs=(t,e)=>({applyToStack:r=>{r.addRelativeTo(dw({config:t,instructions:e}),Nd)}}),gw=t=>{const e=t.tls??!0,{endpoint:r}=t,s=r!=null?async()=>Bd(await st(r)()):void 0;return{...t,endpoint:s,tls:e,isCustomEndpoint:!!r,useDualstackEndpoint:st(t.useDualstackEndpoint??!1),useFipsEndpoint:st(t.useFipsEndpoint??!1)}};var mr;(function(t){t.STANDARD="standard",t.ADAPTIVE="adaptive"})(mr||(mr={}));const Xs=3,mw=mr.STANDARD,yw=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],ww=["TimeoutError","RequestTimeout","RequestTimeoutException"],bw=[500,502,503,504],_w=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],vw=t=>{var e;return(e=t.$metadata)==null?void 0:e.clockSkewCorrected},$d=t=>{var e,r;return((e=t.$metadata)==null?void 0:e.httpStatusCode)===429||yw.includes(t.name)||((r=t.$retryable)==null?void 0:r.throttling)==!0},Md=t=>{var e;return vw(t)||ww.includes(t.name)||_w.includes((t==null?void 0:t.code)||"")||bw.includes(((e=t.$metadata)==null?void 0:e.httpStatusCode)||0)},Ew=t=>{var e;if(((e=t.$metadata)==null?void 0:e.httpStatusCode)!==void 0){const r=t.$metadata.httpStatusCode;return 500<=r&&r<=599&&!Md(t)}return!1};class Sw{constructor(e){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=(e==null?void 0:e.beta)??.7,this.minCapacity=(e==null?void 0:e.minCapacity)??1,this.minFillRate=(e==null?void 0:e.minFillRate)??.5,this.scaleConstant=(e==null?void 0:e.scaleConstant)??.4,this.smooth=(e==null?void 0:e.smooth)??.8;const r=this.getCurrentTimeInSeconds();this.lastThrottleTime=r,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const r=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(s=>setTimeout(s,r))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}const r=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+r),this.lastTimestamp=e}updateClientSendingRate(e){let r;if(this.updateMeasuredRate(),$d(e)){const n=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=n,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),r=this.cubicThrottle(n),this.enableTokenBucket()}else this.calculateTimeWindow(),r=this.cubicSuccess(this.getCurrentTimeInSeconds());const s=Math.min(r,2*this.measuredTxRate);this.updateTokenBucketRate(s)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),r=Math.floor(e*2)/2;if(this.requestCount++,r>this.lastTxRateBucket){const s=this.requestCount/(r-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(s*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=r}}getPrecise(e){return parseFloat(e.toFixed(8))}}const So=100,Dd=20*1e3,xw=500,Vc=500,Aw=5,Cw=10,Rw=1,Tw="amz-sdk-invocation-id",kw="amz-sdk-request",Ow=()=>{let t=So;return{computeNextBackoffDelay:s=>Math.floor(Math.min(Dd,Math.random()*2**s*t)),setDelayBase:s=>{t=s}}},Wc=({retryDelay:t,retryCount:e,retryCost:r})=>({getRetryCount:()=>e,getRetryDelay:()=>Math.min(Dd,t),getRetryCost:()=>r});class Fd{constructor(e){this.maxAttempts=e,this.mode=mr.STANDARD,this.capacity=Vc,this.retryBackoffStrategy=Ow(),this.maxAttemptsProvider=typeof e=="function"?e:async()=>e}async acquireInitialRetryToken(e){return Wc({retryDelay:So,retryCount:0})}async refreshRetryTokenForRetry(e,r){const s=await this.getMaxAttempts();if(this.shouldRetry(e,r,s)){const n=r.errorType;this.retryBackoffStrategy.setDelayBase(n==="THROTTLING"?xw:So);const i=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),o=r.retryAfterHint?Math.max(r.retryAfterHint.getTime()-Date.now()||0,i):i,a=this.getCapacityCost(n);return this.capacity-=a,Wc({retryDelay:o,retryCount:e.getRetryCount()+1,retryCost:a})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(Vc,this.capacity+(e.getRetryCost()??Rw))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${Xs}`),Xs}}shouldRetry(e,r,s){return e.getRetryCount()+1<s&&this.capacity>=this.getCapacityCost(r.errorType)&&this.isRetryableError(r.errorType)}getCapacityCost(e){return e==="TRANSIENT"?Cw:Aw}isRetryableError(e){return e==="THROTTLING"||e==="TRANSIENT"}}class Pw{constructor(e,r){this.maxAttemptsProvider=e,this.mode=mr.ADAPTIVE;const{rateLimiter:s}=r??{};this.rateLimiter=s??new Sw,this.standardRetryStrategy=new Fd(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,r){return this.rateLimiter.updateClientSendingRate(r),this.standardRetryStrategy.refreshRetryTokenForRetry(e,r)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}var Ps,Iw=new Uint8Array(16);function Bw(){if(!Ps&&(Ps=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Ps))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ps(Iw)}const Nw=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function $w(t){return typeof t=="string"&&Nw.test(t)}var we=[];for(var ai=0;ai<256;++ai)we.push((ai+256).toString(16).substr(1));function Mw(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(we[t[e+0]]+we[t[e+1]]+we[t[e+2]]+we[t[e+3]]+"-"+we[t[e+4]]+we[t[e+5]]+"-"+we[t[e+6]]+we[t[e+7]]+"-"+we[t[e+8]]+we[t[e+9]]+"-"+we[t[e+10]]+we[t[e+11]]+we[t[e+12]]+we[t[e+13]]+we[t[e+14]]+we[t[e+15]]).toLowerCase();if(!$w(r))throw TypeError("Stringified UUID is invalid");return r}function Dw(t,e,r){t=t||{};var s=t.random||(t.rng||Bw)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,e){r=r||0;for(var n=0;n<16;++n)e[r+n]=s[n];return e}return Mw(s)}const Fw=t=>t instanceof Error?t:t instanceof Object?Object.assign(new Error,t):typeof t=="string"?new Error(t):new Error(`AWS SDK error wrapper for ${t}`),Uw=t=>{const{retryStrategy:e}=t,r=st(t.maxAttempts??Xs);return{...t,maxAttempts:r,retryStrategy:async()=>e||(await st(t.retryMode)()===mr.ADAPTIVE?new Pw(r):new Fd(r))}},Lw=t=>(t==null?void 0:t.body)instanceof ReadableStream,jw=t=>(e,r)=>async s=>{var o;let n=await t.retryStrategy();const i=await t.maxAttempts();if(Hw(n)){n=n;let a=await n.acquireInitialRetryToken(r.partition_id),c=new Error,u=0,l=0;const{request:d}=s,h=De.isInstance(d);for(h&&(d.headers[Tw]=Dw());;)try{h&&(d.headers[kw]=`attempt=${u+1}; max=${i}`);const{response:p,output:g}=await e(s);return n.recordSuccess(a),g.$metadata.attempts=u+1,g.$metadata.totalRetryDelay=l,{response:p,output:g}}catch(p){const g=zw(p);if(c=Fw(p),h&&Lw(d))throw(o=r.logger instanceof Mo?console:r.logger)==null||o.warn("An error was encountered in a non-retryable streaming request."),c;try{a=await n.refreshRetryTokenForRetry(a,g)}catch{throw c.$metadata||(c.$metadata={}),c.$metadata.attempts=u+1,c.$metadata.totalRetryDelay=l,c}u=a.getRetryCount();const y=a.getRetryDelay();l+=y,await new Promise(w=>setTimeout(w,y))}}else return n=n,n!=null&&n.mode&&(r.userAgent=[...r.userAgent||[],["cfg/retry-mode",n.mode]]),n.retry(e,s)},Hw=t=>typeof t.acquireInitialRetryToken<"u"&&typeof t.refreshRetryTokenForRetry<"u"&&typeof t.recordSuccess<"u",zw=t=>{const e={error:t,errorType:qw(t)},r=Gw(t.$response);return r&&(e.retryAfterHint=r),e},qw=t=>$d(t)?"THROTTLING":Md(t)?"TRANSIENT":Ew(t)?"SERVER_ERROR":"CLIENT_ERROR",Ud={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},Kw=t=>({applyToStack:e=>{e.add(jw(t),Ud)}}),Gw=t=>{if(!is.isInstance(t))return;const e=Object.keys(t.headers).find(i=>i.toLowerCase()==="retry-after");if(!e)return;const r=t.headers[e],s=Number(r);return Number.isNaN(s)?new Date(r):new Date(s*1e3)},Vw=t=>({...t,useFipsEndpoint:t.useFipsEndpoint??!1,useDualstackEndpoint:t.useDualstackEndpoint??!1,forcePathStyle:t.forcePathStyle??!1,useAccelerateEndpoint:t.useAccelerateEndpoint??!1,useGlobalEndpoint:t.useGlobalEndpoint??!1,disableMultiregionAccessPoints:t.disableMultiregionAccessPoints??!1,defaultSigningName:"s3"}),_s={ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},DisableS3ExpressSessionAuth:{type:"clientContextParams",name:"disableS3ExpressSessionAuth"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};class Ve extends qo{constructor(e){super(e),Object.setPrototypeOf(this,Ve.prototype)}}class Jo extends Ve{constructor(e){super({name:"NoSuchUpload",$fault:"client",...e}),this.name="NoSuchUpload",this.$fault="client",Object.setPrototypeOf(this,Jo.prototype)}}class Xo extends Ve{constructor(e){super({name:"ObjectNotInActiveTierError",$fault:"client",...e}),this.name="ObjectNotInActiveTierError",this.$fault="client",Object.setPrototypeOf(this,Xo.prototype)}}class Yo extends Ve{constructor(e){super({name:"BucketAlreadyExists",$fault:"client",...e}),this.name="BucketAlreadyExists",this.$fault="client",Object.setPrototypeOf(this,Yo.prototype)}}class Zo extends Ve{constructor(e){super({name:"BucketAlreadyOwnedByYou",$fault:"client",...e}),this.name="BucketAlreadyOwnedByYou",this.$fault="client",Object.setPrototypeOf(this,Zo.prototype)}}class Qo extends Ve{constructor(e){super({name:"NoSuchBucket",$fault:"client",...e}),this.name="NoSuchBucket",this.$fault="client",Object.setPrototypeOf(this,Qo.prototype)}}var Jc;(function(t){t.visit=(e,r)=>e.Prefix!==void 0?r.Prefix(e.Prefix):e.Tag!==void 0?r.Tag(e.Tag):e.And!==void 0?r.And(e.And):r._(e.$unknown[0],e.$unknown[1])})(Jc||(Jc={}));var Xc;(function(t){t.visit=(e,r)=>e.Prefix!==void 0?r.Prefix(e.Prefix):e.Tag!==void 0?r.Tag(e.Tag):e.ObjectSizeGreaterThan!==void 0?r.ObjectSizeGreaterThan(e.ObjectSizeGreaterThan):e.ObjectSizeLessThan!==void 0?r.ObjectSizeLessThan(e.ObjectSizeLessThan):e.And!==void 0?r.And(e.And):r._(e.$unknown[0],e.$unknown[1])})(Xc||(Xc={}));var Yc;(function(t){t.visit=(e,r)=>e.Prefix!==void 0?r.Prefix(e.Prefix):e.Tag!==void 0?r.Tag(e.Tag):e.AccessPointArn!==void 0?r.AccessPointArn(e.AccessPointArn):e.And!==void 0?r.And(e.And):r._(e.$unknown[0],e.$unknown[1])})(Yc||(Yc={}));var Zc;(function(t){t.visit=(e,r)=>e.Prefix!==void 0?r.Prefix(e.Prefix):e.Tag!==void 0?r.Tag(e.Tag):e.And!==void 0?r.And(e.And):r._(e.$unknown[0],e.$unknown[1])})(Zc||(Zc={}));class ea extends Ve{constructor(e){super({name:"InvalidObjectState",$fault:"client",...e}),this.name="InvalidObjectState",this.$fault="client",Object.setPrototypeOf(this,ea.prototype),this.StorageClass=e.StorageClass,this.AccessTier=e.AccessTier}}class ta extends Ve{constructor(e){super({name:"NoSuchKey",$fault:"client",...e}),this.name="NoSuchKey",this.$fault="client",Object.setPrototypeOf(this,ta.prototype)}}class ra extends Ve{constructor(e){super({name:"NotFound",$fault:"client",...e}),this.name="NotFound",this.$fault="client",Object.setPrototypeOf(this,ra.prototype)}}const Ww=t=>({...t,...t.SecretAccessKey&&{SecretAccessKey:tt},...t.SessionToken&&{SessionToken:tt}}),Jw=t=>({...t,...t.Credentials&&{Credentials:Ww(t.Credentials)}}),Xw=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:tt}}),Yw=t=>({...t,...t.SSECustomerKey&&{SSECustomerKey:tt}}),Zw=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:tt}}),Qw=t=>({...t,...t.SSECustomerKey&&{SSECustomerKey:tt}});Nd.name;Wo.name;Ud.name;function vs(t,e){return new eb(t,e)}class eb{constructor(e,r){this.input=e,this.context=r,this.query={},this.method="",this.headers={},this.path="",this.body=null,this.hostname="",this.resolvePathStack=[]}async build(){const{hostname:e,protocol:r="https",port:s,path:n}=await this.context.endpoint();this.path=n;for(const i of this.resolvePathStack)i(this.path);return new De({protocol:r,hostname:this.hostname||e,port:s,method:this.method,path:this.path,query:this.query,body:this.body,headers:this.headers})}hn(e){return this.hostname=e,this}bp(e){return this.resolvePathStack.push(r=>{this.path=`${r!=null&&r.endsWith("/")?r.slice(0,-1):r||""}`+e}),this}p(e,r,s,n){return this.resolvePathStack.push(i=>{this.path=vm(i,this.input,e,r,s,n)}),this}h(e){return this.headers=e,this}q(e){return this.query=e,this}b(e){return this.body=e,this}m(e){return this.method=e,this}}var sa={},wn={};(function(t){const e=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r=e+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",s="["+e+"]["+r+"]*",n=new RegExp("^"+s+"$"),i=function(a,c){const u=[];let l=c.exec(a);for(;l;){const d=[];d.startIndex=c.lastIndex-l[0].length;const h=l.length;for(let p=0;p<h;p++)d.push(l[p]);u.push(d),l=c.exec(a)}return u},o=function(a){const c=n.exec(a);return!(c===null||typeof c>"u")};t.isExist=function(a){return typeof a<"u"},t.isEmptyObject=function(a){return Object.keys(a).length===0},t.merge=function(a,c,u){if(c){const l=Object.keys(c),d=l.length;for(let h=0;h<d;h++)u==="strict"?a[l[h]]=[c[l[h]]]:a[l[h]]=c[l[h]]}},t.getValue=function(a){return t.isExist(a)?a:""},t.isName=o,t.getAllMatches=i,t.nameRegexp=s})(wn);const na=wn,tb={allowBooleanAttributes:!1,unpairedTags:[]};sa.validate=function(t,e){e=Object.assign({},tb,e);const r=[];let s=!1,n=!1;t[0]==="\uFEFF"&&(t=t.substr(1));for(let i=0;i<t.length;i++)if(t[i]==="<"&&t[i+1]==="?"){if(i+=2,i=eu(t,i),i.err)return i}else if(t[i]==="<"){let o=i;if(i++,t[i]==="!"){i=tu(t,i);continue}else{let a=!1;t[i]==="/"&&(a=!0,i++);let c="";for(;i<t.length&&t[i]!==">"&&t[i]!==" "&&t[i]!=="	"&&t[i]!==`
`&&t[i]!=="\r";i++)c+=t[i];if(c=c.trim(),c[c.length-1]==="/"&&(c=c.substring(0,c.length-1),i--),!ub(c)){let d;return c.trim().length===0?d="Invalid space after '<'.":d="Tag '"+c+"' is an invalid name.",ue("InvalidTag",d,Ie(t,i))}const u=nb(t,i);if(u===!1)return ue("InvalidAttr","Attributes for '"+c+"' have open quote.",Ie(t,i));let l=u.value;if(i=u.index,l[l.length-1]==="/"){const d=i-l.length;l=l.substring(0,l.length-1);const h=ru(l,e);if(h===!0)s=!0;else return ue(h.err.code,h.err.msg,Ie(t,d+h.err.line))}else if(a)if(u.tagClosed){if(l.trim().length>0)return ue("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",Ie(t,o));{const d=r.pop();if(c!==d.tagName){let h=Ie(t,d.tagStartPos);return ue("InvalidTag","Expected closing tag '"+d.tagName+"' (opened in line "+h.line+", col "+h.col+") instead of closing tag '"+c+"'.",Ie(t,o))}r.length==0&&(n=!0)}}else return ue("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",Ie(t,i));else{const d=ru(l,e);if(d!==!0)return ue(d.err.code,d.err.msg,Ie(t,i-l.length+d.err.line));if(n===!0)return ue("InvalidXml","Multiple possible root nodes found.",Ie(t,i));e.unpairedTags.indexOf(c)!==-1||r.push({tagName:c,tagStartPos:o}),s=!0}for(i++;i<t.length;i++)if(t[i]==="<")if(t[i+1]==="!"){i++,i=tu(t,i);continue}else if(t[i+1]==="?"){if(i=eu(t,++i),i.err)return i}else break;else if(t[i]==="&"){const d=ab(t,i);if(d==-1)return ue("InvalidChar","char '&' is not expected.",Ie(t,i));i=d}else if(n===!0&&!Qc(t[i]))return ue("InvalidXml","Extra text at the end",Ie(t,i));t[i]==="<"&&i--}}else{if(Qc(t[i]))continue;return ue("InvalidChar","char '"+t[i]+"' is not expected.",Ie(t,i))}if(s){if(r.length==1)return ue("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",Ie(t,r[0].tagStartPos));if(r.length>0)return ue("InvalidXml","Invalid '"+JSON.stringify(r.map(i=>i.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return ue("InvalidXml","Start tag expected.",1);return!0};function Qc(t){return t===" "||t==="	"||t===`
`||t==="\r"}function eu(t,e){const r=e;for(;e<t.length;e++)if(t[e]=="?"||t[e]==" "){const s=t.substr(r,e-r);if(e>5&&s==="xml")return ue("InvalidXml","XML declaration allowed only at the start of the document.",Ie(t,e));if(t[e]=="?"&&t[e+1]==">"){e++;break}else continue}return e}function tu(t,e){if(t.length>e+5&&t[e+1]==="-"&&t[e+2]==="-"){for(e+=3;e<t.length;e++)if(t[e]==="-"&&t[e+1]==="-"&&t[e+2]===">"){e+=2;break}}else if(t.length>e+8&&t[e+1]==="D"&&t[e+2]==="O"&&t[e+3]==="C"&&t[e+4]==="T"&&t[e+5]==="Y"&&t[e+6]==="P"&&t[e+7]==="E"){let r=1;for(e+=8;e<t.length;e++)if(t[e]==="<")r++;else if(t[e]===">"&&(r--,r===0))break}else if(t.length>e+9&&t[e+1]==="["&&t[e+2]==="C"&&t[e+3]==="D"&&t[e+4]==="A"&&t[e+5]==="T"&&t[e+6]==="A"&&t[e+7]==="["){for(e+=8;e<t.length;e++)if(t[e]==="]"&&t[e+1]==="]"&&t[e+2]===">"){e+=2;break}}return e}const rb='"',sb="'";function nb(t,e){let r="",s="",n=!1;for(;e<t.length;e++){if(t[e]===rb||t[e]===sb)s===""?s=t[e]:s!==t[e]||(s="");else if(t[e]===">"&&s===""){n=!0;break}r+=t[e]}return s!==""?!1:{value:r,index:e,tagClosed:n}}const ib=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function ru(t,e){const r=na.getAllMatches(t,ib),s={};for(let n=0;n<r.length;n++){if(r[n][1].length===0)return ue("InvalidAttr","Attribute '"+r[n][2]+"' has no space in starting.",Br(r[n]));if(r[n][3]!==void 0&&r[n][4]===void 0)return ue("InvalidAttr","Attribute '"+r[n][2]+"' is without value.",Br(r[n]));if(r[n][3]===void 0&&!e.allowBooleanAttributes)return ue("InvalidAttr","boolean attribute '"+r[n][2]+"' is not allowed.",Br(r[n]));const i=r[n][2];if(!cb(i))return ue("InvalidAttr","Attribute '"+i+"' is an invalid name.",Br(r[n]));if(!s.hasOwnProperty(i))s[i]=1;else return ue("InvalidAttr","Attribute '"+i+"' is repeated.",Br(r[n]))}return!0}function ob(t,e){let r=/\d/;for(t[e]==="x"&&(e++,r=/[\da-fA-F]/);e<t.length;e++){if(t[e]===";")return e;if(!t[e].match(r))break}return-1}function ab(t,e){if(e++,t[e]===";")return-1;if(t[e]==="#")return e++,ob(t,e);let r=0;for(;e<t.length;e++,r++)if(!(t[e].match(/\w/)&&r<20)){if(t[e]===";")break;return-1}return e}function ue(t,e,r){return{err:{code:t,msg:e,line:r.line||r,col:r.col}}}function cb(t){return na.isName(t)}function ub(t){return na.isName(t)}function Ie(t,e){const r=t.substring(0,e).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function Br(t){return t.startIndex+t[1].length}var ia={};const Ld={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(t,e,r){return t}},lb=function(t){return Object.assign({},Ld,t)};ia.buildOptions=lb;ia.defaultOptions=Ld;class db{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,r){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:r})}addChild(e){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}}var hb=db;const fb=wn;function pb(t,e){const r={};if(t[e+3]==="O"&&t[e+4]==="C"&&t[e+5]==="T"&&t[e+6]==="Y"&&t[e+7]==="P"&&t[e+8]==="E"){e=e+9;let s=1,n=!1,i=!1,o="";for(;e<t.length;e++)if(t[e]==="<"&&!i){if(n&&yb(t,e))e+=7,[entityName,val,e]=gb(t,e+1),val.indexOf("&")===-1&&(r[vb(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(n&&wb(t,e))e+=8;else if(n&&bb(t,e))e+=8;else if(n&&_b(t,e))e+=9;else if(mb)i=!0;else throw new Error("Invalid DOCTYPE");s++,o=""}else if(t[e]===">"){if(i?t[e-1]==="-"&&t[e-2]==="-"&&(i=!1,s--):s--,s===0)break}else t[e]==="["?n=!0:o+=t[e];if(s!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:r,i:e}}function gb(t,e){let r="";for(;e<t.length&&t[e]!=="'"&&t[e]!=='"';e++)r+=t[e];if(r=r.trim(),r.indexOf(" ")!==-1)throw new Error("External entites are not supported");const s=t[e++];let n="";for(;e<t.length&&t[e]!==s;e++)n+=t[e];return[r,n,e]}function mb(t,e){return t[e+1]==="!"&&t[e+2]==="-"&&t[e+3]==="-"}function yb(t,e){return t[e+1]==="!"&&t[e+2]==="E"&&t[e+3]==="N"&&t[e+4]==="T"&&t[e+5]==="I"&&t[e+6]==="T"&&t[e+7]==="Y"}function wb(t,e){return t[e+1]==="!"&&t[e+2]==="E"&&t[e+3]==="L"&&t[e+4]==="E"&&t[e+5]==="M"&&t[e+6]==="E"&&t[e+7]==="N"&&t[e+8]==="T"}function bb(t,e){return t[e+1]==="!"&&t[e+2]==="A"&&t[e+3]==="T"&&t[e+4]==="T"&&t[e+5]==="L"&&t[e+6]==="I"&&t[e+7]==="S"&&t[e+8]==="T"}function _b(t,e){return t[e+1]==="!"&&t[e+2]==="N"&&t[e+3]==="O"&&t[e+4]==="T"&&t[e+5]==="A"&&t[e+6]==="T"&&t[e+7]==="I"&&t[e+8]==="O"&&t[e+9]==="N"}function vb(t){if(fb.isName(t))return t;throw new Error(`Invalid entity name ${t}`)}var Eb=pb;const Sb=/^[-+]?0x[a-fA-F0-9]+$/,xb=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const Ab={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function Cb(t,e={}){if(e=Object.assign({},Ab,e),!t||typeof t!="string")return t;let r=t.trim();if(e.skipLike!==void 0&&e.skipLike.test(r))return t;if(e.hex&&Sb.test(r))return Number.parseInt(r,16);{const s=xb.exec(r);if(s){const n=s[1],i=s[2];let o=Rb(s[3]);const a=s[4]||s[6];if(!e.leadingZeros&&i.length>0&&n&&r[2]!==".")return t;if(!e.leadingZeros&&i.length>0&&!n&&r[1]!==".")return t;{const c=Number(r),u=""+c;return u.search(/[eE]/)!==-1||a?e.eNotation?c:t:r.indexOf(".")!==-1?u==="0"&&o===""||u===o||n&&u==="-"+o?c:t:i?o===u||n+o===u?c:t:r===u||r===n+u?c:t}}else return t}}function Rb(t){return t&&t.indexOf(".")!==-1&&(t=t.replace(/0+$/,""),t==="."?t="0":t[0]==="."?t="0"+t:t[t.length-1]==="."&&(t=t.substr(0,t.length-1))),t}var Tb=Cb;const oa=wn,Nr=hb,kb=Eb,Ob=Tb;"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,oa.nameRegexp);let Pb=class{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""}},this.addExternalEntities=Ib,this.parseXml=Db,this.parseTextData=Bb,this.resolveNameSpace=Nb,this.buildAttributesMap=Mb,this.isItStopNode=jb,this.replaceEntitiesValue=Ub,this.readStopNodeData=zb,this.saveTextToParentTag=Lb,this.addChild=Fb}};function Ib(t){const e=Object.keys(t);for(let r=0;r<e.length;r++){const s=e[r];this.lastEntities[s]={regex:new RegExp("&"+s+";","g"),val:t[s]}}}function Bb(t,e,r,s,n,i,o){if(t!==void 0&&(this.options.trimValues&&!s&&(t=t.trim()),t.length>0)){o||(t=this.replaceEntitiesValue(t));const a=this.options.tagValueProcessor(e,t,r,n,i);return a==null?t:typeof a!=typeof t||a!==t?a:this.options.trimValues?Ao(t,this.options.parseTagValue,this.options.numberParseOptions):t.trim()===t?Ao(t,this.options.parseTagValue,this.options.numberParseOptions):t}}function Nb(t){if(this.options.removeNSPrefix){const e=t.split(":"),r=t.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(t=r+e[1])}return t}const $b=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function Mb(t,e,r){if(!this.options.ignoreAttributes&&typeof t=="string"){const s=oa.getAllMatches(t,$b),n=s.length,i={};for(let o=0;o<n;o++){const a=this.resolveNameSpace(s[o][1]);let c=s[o][4],u=this.options.attributeNamePrefix+a;if(a.length)if(this.options.transformAttributeName&&(u=this.options.transformAttributeName(u)),u==="__proto__"&&(u="#__proto__"),c!==void 0){this.options.trimValues&&(c=c.trim()),c=this.replaceEntitiesValue(c);const l=this.options.attributeValueProcessor(a,c,e);l==null?i[u]=c:typeof l!=typeof c||l!==c?i[u]=l:i[u]=Ao(c,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(i[u]=!0)}if(!Object.keys(i).length)return;if(this.options.attributesGroupName){const o={};return o[this.options.attributesGroupName]=i,o}return i}}const Db=function(t){t=t.replace(/\r\n?/g,`
`);const e=new Nr("!xml");let r=e,s="",n="";for(let i=0;i<t.length;i++)if(t[i]==="<")if(t[i+1]==="/"){const a=qt(t,">",i,"Closing Tag is not closed.");let c=t.substring(i+2,a).trim();if(this.options.removeNSPrefix){const d=c.indexOf(":");d!==-1&&(c=c.substr(d+1))}this.options.transformTagName&&(c=this.options.transformTagName(c)),r&&(s=this.saveTextToParentTag(s,r,n));const u=n.substring(n.lastIndexOf(".")+1);if(c&&this.options.unpairedTags.indexOf(c)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${c}>`);let l=0;u&&this.options.unpairedTags.indexOf(u)!==-1?(l=n.lastIndexOf(".",n.lastIndexOf(".")-1),this.tagsNodeStack.pop()):l=n.lastIndexOf("."),n=n.substring(0,l),r=this.tagsNodeStack.pop(),s="",i=a}else if(t[i+1]==="?"){let a=xo(t,i,!1,"?>");if(!a)throw new Error("Pi Tag is not closed.");if(s=this.saveTextToParentTag(s,r,n),!(this.options.ignoreDeclaration&&a.tagName==="?xml"||this.options.ignorePiTags)){const c=new Nr(a.tagName);c.add(this.options.textNodeName,""),a.tagName!==a.tagExp&&a.attrExpPresent&&(c[":@"]=this.buildAttributesMap(a.tagExp,n,a.tagName)),this.addChild(r,c,n)}i=a.closeIndex+1}else if(t.substr(i+1,3)==="!--"){const a=qt(t,"-->",i+4,"Comment is not closed.");if(this.options.commentPropName){const c=t.substring(i+4,a-2);s=this.saveTextToParentTag(s,r,n),r.add(this.options.commentPropName,[{[this.options.textNodeName]:c}])}i=a}else if(t.substr(i+1,2)==="!D"){const a=kb(t,i);this.docTypeEntities=a.entities,i=a.i}else if(t.substr(i+1,2)==="!["){const a=qt(t,"]]>",i,"CDATA is not closed.")-2,c=t.substring(i+9,a);if(s=this.saveTextToParentTag(s,r,n),this.options.cdataPropName)r.add(this.options.cdataPropName,[{[this.options.textNodeName]:c}]);else{let u=this.parseTextData(c,r.tagname,n,!0,!1,!0);u==null&&(u=""),r.add(this.options.textNodeName,u)}i=a+2}else{let a=xo(t,i,this.options.removeNSPrefix),c=a.tagName,u=a.tagExp,l=a.attrExpPresent,d=a.closeIndex;this.options.transformTagName&&(c=this.options.transformTagName(c)),r&&s&&r.tagname!=="!xml"&&(s=this.saveTextToParentTag(s,r,n,!1));const h=r;if(h&&this.options.unpairedTags.indexOf(h.tagname)!==-1&&(r=this.tagsNodeStack.pop(),n=n.substring(0,n.lastIndexOf("."))),c!==e.tagname&&(n+=n?"."+c:c),this.isItStopNode(this.options.stopNodes,n,c)){let p="";if(u.length>0&&u.lastIndexOf("/")===u.length-1)i=a.closeIndex;else if(this.options.unpairedTags.indexOf(c)!==-1)i=a.closeIndex;else{const y=this.readStopNodeData(t,c,d+1);if(!y)throw new Error(`Unexpected end of ${c}`);i=y.i,p=y.tagContent}const g=new Nr(c);c!==u&&l&&(g[":@"]=this.buildAttributesMap(u,n,c)),p&&(p=this.parseTextData(p,c,n,!0,l,!0,!0)),n=n.substr(0,n.lastIndexOf(".")),g.add(this.options.textNodeName,p),this.addChild(r,g,n)}else{if(u.length>0&&u.lastIndexOf("/")===u.length-1){c[c.length-1]==="/"?(c=c.substr(0,c.length-1),u=c):u=u.substr(0,u.length-1),this.options.transformTagName&&(c=this.options.transformTagName(c));const p=new Nr(c);c!==u&&l&&(p[":@"]=this.buildAttributesMap(u,n,c)),this.addChild(r,p,n),n=n.substr(0,n.lastIndexOf("."))}else{const p=new Nr(c);this.tagsNodeStack.push(r),c!==u&&l&&(p[":@"]=this.buildAttributesMap(u,n,c)),this.addChild(r,p,n),r=p}s="",i=d}}else s+=t[i];return e.child};function Fb(t,e,r){const s=this.options.updateTag(e.tagname,r,e[":@"]);s===!1||(typeof s=="string"&&(e.tagname=s),t.addChild(e))}const Ub=function(t){if(this.options.processEntities){for(let e in this.docTypeEntities){const r=this.docTypeEntities[e];t=t.replace(r.regx,r.val)}for(let e in this.lastEntities){const r=this.lastEntities[e];t=t.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){const r=this.htmlEntities[e];t=t.replace(r.regex,r.val)}t=t.replace(this.ampEntity.regex,this.ampEntity.val)}return t};function Lb(t,e,r,s){return t&&(s===void 0&&(s=Object.keys(e.child).length===0),t=this.parseTextData(t,e.tagname,r,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,s),t!==void 0&&t!==""&&e.add(this.options.textNodeName,t),t=""),t}function jb(t,e,r){const s="*."+r;for(const n in t){const i=t[n];if(s===i||e===i)return!0}return!1}function Hb(t,e,r=">"){let s,n="";for(let i=e;i<t.length;i++){let o=t[i];if(s)o===s&&(s="");else if(o==='"'||o==="'")s=o;else if(o===r[0])if(r[1]){if(t[i+1]===r[1])return{data:n,index:i}}else return{data:n,index:i};else o==="	"&&(o=" ");n+=o}}function qt(t,e,r,s){const n=t.indexOf(e,r);if(n===-1)throw new Error(s);return n+e.length-1}function xo(t,e,r,s=">"){const n=Hb(t,e+1,s);if(!n)return;let i=n.data;const o=n.index,a=i.search(/\s/);let c=i,u=!0;if(a!==-1&&(c=i.substr(0,a).replace(/\s\s*$/,""),i=i.substr(a+1)),r){const l=c.indexOf(":");l!==-1&&(c=c.substr(l+1),u=c!==n.data.substr(l+1))}return{tagName:c,tagExp:i,closeIndex:o,attrExpPresent:u}}function zb(t,e,r){const s=r;let n=1;for(;r<t.length;r++)if(t[r]==="<")if(t[r+1]==="/"){const i=qt(t,">",r,`${e} is not closed`);if(t.substring(r+2,i).trim()===e&&(n--,n===0))return{tagContent:t.substring(s,r),i};r=i}else if(t[r+1]==="?")r=qt(t,"?>",r+1,"StopNode is not closed.");else if(t.substr(r+1,3)==="!--")r=qt(t,"-->",r+3,"StopNode is not closed.");else if(t.substr(r+1,2)==="![")r=qt(t,"]]>",r,"StopNode is not closed.")-2;else{const i=xo(t,r,">");i&&((i&&i.tagName)===e&&i.tagExp[i.tagExp.length-1]!=="/"&&n++,r=i.closeIndex)}}function Ao(t,e,r){if(e&&typeof t=="string"){const s=t.trim();return s==="true"?!0:s==="false"?!1:Ob(t,r)}else return oa.isExist(t)?t:""}var qb=Pb,jd={};function Kb(t,e){return Hd(t,e)}function Hd(t,e,r){let s;const n={};for(let i=0;i<t.length;i++){const o=t[i],a=Gb(o);let c="";if(r===void 0?c=a:c=r+"."+a,a===e.textNodeName)s===void 0?s=o[a]:s+=""+o[a];else{if(a===void 0)continue;if(o[a]){let u=Hd(o[a],e,c);const l=Wb(u,e);o[":@"]?Vb(u,o[":@"],c,e):Object.keys(u).length===1&&u[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?u=u[e.textNodeName]:Object.keys(u).length===0&&(e.alwaysCreateTextNode?u[e.textNodeName]="":u=""),n[a]!==void 0&&n.hasOwnProperty(a)?(Array.isArray(n[a])||(n[a]=[n[a]]),n[a].push(u)):e.isArray(a,c,l)?n[a]=[u]:n[a]=u}}}return typeof s=="string"?s.length>0&&(n[e.textNodeName]=s):s!==void 0&&(n[e.textNodeName]=s),n}function Gb(t){const e=Object.keys(t);for(let r=0;r<e.length;r++){const s=e[r];if(s!==":@")return s}}function Vb(t,e,r,s){if(e){const n=Object.keys(e),i=n.length;for(let o=0;o<i;o++){const a=n[o];s.isArray(a,r+"."+a,!0,!0)?t[a]=[e[a]]:t[a]=e[a]}}}function Wb(t,e){const{textNodeName:r}=e,s=Object.keys(t).length;return!!(s===0||s===1&&(t[r]||typeof t[r]=="boolean"||t[r]===0))}jd.prettify=Kb;const{buildOptions:Jb}=ia,Xb=qb,{prettify:Yb}=jd,Zb=sa;let Qb=class{constructor(e){this.externalEntities={},this.options=Jb(e)}parse(e,r){if(typeof e!="string")if(e.toString)e=e.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(r){r===!0&&(r={});const i=Zb.validate(e,r);if(i!==!0)throw Error(`${i.err.msg}:${i.err.line}:${i.err.col}`)}const s=new Xb(this.options);s.addExternalEntities(this.externalEntities);const n=s.parseXml(e);return this.options.preserveOrder||n===void 0?n:Yb(n,this.options)}addEntity(e,r){if(r.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(e.indexOf("&")!==-1||e.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(r==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=r}};var e_=Qb;const t_=`
`;function r_(t,e){let r="";return e.format&&e.indentBy.length>0&&(r=t_),zd(t,e,"",r)}function zd(t,e,r,s){let n="",i=!1;for(let o=0;o<t.length;o++){const a=t[o],c=s_(a);let u="";if(r.length===0?u=c:u=`${r}.${c}`,c===e.textNodeName){let g=a[c];n_(u,e)||(g=e.tagValueProcessor(c,g),g=qd(g,e)),i&&(n+=s),n+=g,i=!1;continue}else if(c===e.cdataPropName){i&&(n+=s),n+=`<![CDATA[${a[c][0][e.textNodeName]}]]>`,i=!1;continue}else if(c===e.commentPropName){n+=s+`<!--${a[c][0][e.textNodeName]}-->`,i=!0;continue}else if(c[0]==="?"){const g=su(a[":@"],e),y=c==="?xml"?"":s;let w=a[c][0][e.textNodeName];w=w.length!==0?" "+w:"",n+=y+`<${c}${w}${g}?>`,i=!0;continue}let l=s;l!==""&&(l+=e.indentBy);const d=su(a[":@"],e),h=s+`<${c}${d}`,p=zd(a[c],e,u,l);e.unpairedTags.indexOf(c)!==-1?e.suppressUnpairedNode?n+=h+">":n+=h+"/>":(!p||p.length===0)&&e.suppressEmptyNode?n+=h+"/>":p&&p.endsWith(">")?n+=h+`>${p}${s}</${c}>`:(n+=h+">",p&&s!==""&&(p.includes("/>")||p.includes("</"))?n+=s+e.indentBy+p+s:n+=p,n+=`</${c}>`),i=!0}return n}function s_(t){const e=Object.keys(t);for(let r=0;r<e.length;r++){const s=e[r];if(s!==":@")return s}}function su(t,e){let r="";if(t&&!e.ignoreAttributes)for(let s in t){let n=e.attributeValueProcessor(s,t[s]);n=qd(n,e),n===!0&&e.suppressBooleanAttributes?r+=` ${s.substr(e.attributeNamePrefix.length)}`:r+=` ${s.substr(e.attributeNamePrefix.length)}="${n}"`}return r}function n_(t,e){t=t.substr(0,t.length-e.textNodeName.length-1);let r=t.substr(t.lastIndexOf(".")+1);for(let s in e.stopNodes)if(e.stopNodes[s]===t||e.stopNodes[s]==="*."+r)return!0;return!1}function qd(t,e){if(t&&t.length>0&&e.processEntities)for(let r=0;r<e.entities.length;r++){const s=e.entities[r];t=t.replace(s.regex,s.val)}return t}var i_=r_;const o_=i_,a_={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function It(t){this.options=Object.assign({},a_,t),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=l_),this.processTextOrObjNode=c_,this.options.format?(this.indentate=u_,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}It.prototype.build=function(t){return this.options.preserveOrder?o_(t,this.options):(Array.isArray(t)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(t={[this.options.arrayNodeName]:t}),this.j2x(t,0).val)};It.prototype.j2x=function(t,e){let r="",s="";for(let n in t)if(!(typeof t[n]>"u"))if(t[n]===null)n[0]==="?"?s+=this.indentate(e)+"<"+n+"?"+this.tagEndChar:s+=this.indentate(e)+"<"+n+"/"+this.tagEndChar;else if(t[n]instanceof Date)s+=this.buildTextValNode(t[n],n,"",e);else if(typeof t[n]!="object"){const i=this.isAttribute(n);if(i)r+=this.buildAttrPairStr(i,""+t[n]);else if(n===this.options.textNodeName){let o=this.options.tagValueProcessor(n,""+t[n]);s+=this.replaceEntitiesValue(o)}else s+=this.buildTextValNode(t[n],n,"",e)}else if(Array.isArray(t[n])){const i=t[n].length;let o="";for(let a=0;a<i;a++){const c=t[n][a];typeof c>"u"||(c===null?n[0]==="?"?s+=this.indentate(e)+"<"+n+"?"+this.tagEndChar:s+=this.indentate(e)+"<"+n+"/"+this.tagEndChar:typeof c=="object"?this.options.oneListGroup?o+=this.j2x(c,e+1).val:o+=this.processTextOrObjNode(c,n,e):o+=this.buildTextValNode(c,n,"",e))}this.options.oneListGroup&&(o=this.buildObjectNode(o,n,"",e)),s+=o}else if(this.options.attributesGroupName&&n===this.options.attributesGroupName){const i=Object.keys(t[n]),o=i.length;for(let a=0;a<o;a++)r+=this.buildAttrPairStr(i[a],""+t[n][i[a]])}else s+=this.processTextOrObjNode(t[n],n,e);return{attrStr:r,val:s}};It.prototype.buildAttrPairStr=function(t,e){return e=this.options.attributeValueProcessor(t,""+e),e=this.replaceEntitiesValue(e),this.options.suppressBooleanAttributes&&e==="true"?" "+t:" "+t+'="'+e+'"'};function c_(t,e,r){const s=this.j2x(t,r+1);return t[this.options.textNodeName]!==void 0&&Object.keys(t).length===1?this.buildTextValNode(t[this.options.textNodeName],e,s.attrStr,r):this.buildObjectNode(s.val,e,s.attrStr,r)}It.prototype.buildObjectNode=function(t,e,r,s){if(t==="")return e[0]==="?"?this.indentate(s)+"<"+e+r+"?"+this.tagEndChar:this.indentate(s)+"<"+e+r+this.closeTag(e)+this.tagEndChar;{let n="</"+e+this.tagEndChar,i="";return e[0]==="?"&&(i="?",n=""),r&&t.indexOf("<")===-1?this.indentate(s)+"<"+e+r+i+">"+t+n:this.options.commentPropName!==!1&&e===this.options.commentPropName&&i.length===0?this.indentate(s)+`<!--${t}-->`+this.newLine:this.indentate(s)+"<"+e+r+i+this.tagEndChar+t+this.indentate(s)+n}};It.prototype.closeTag=function(t){let e="";return this.options.unpairedTags.indexOf(t)!==-1?this.options.suppressUnpairedNode||(e="/"):this.options.suppressEmptyNode?e="/":e=`></${t}`,e};It.prototype.buildTextValNode=function(t,e,r,s){if(this.options.cdataPropName!==!1&&e===this.options.cdataPropName)return this.indentate(s)+`<![CDATA[${t}]]>`+this.newLine;if(this.options.commentPropName!==!1&&e===this.options.commentPropName)return this.indentate(s)+`<!--${t}-->`+this.newLine;if(e[0]==="?")return this.indentate(s)+"<"+e+r+"?"+this.tagEndChar;{let n=this.options.tagValueProcessor(e,t);return n=this.replaceEntitiesValue(n),n===""?this.indentate(s)+"<"+e+r+this.closeTag(e)+this.tagEndChar:this.indentate(s)+"<"+e+r+">"+n+"</"+e+this.tagEndChar}};It.prototype.replaceEntitiesValue=function(t){if(t&&t.length>0&&this.options.processEntities)for(let e=0;e<this.options.entities.length;e++){const r=this.options.entities[e];t=t.replace(r.regex,r.val)}return t};function u_(t){return this.options.indentBy.repeat(t)}function l_(t){return t.startsWith(this.options.attributeNamePrefix)?t.substr(this.attrPrefixLen):!1}var d_=It;const h_=sa,f_=e_,p_=d_;var g_={XMLParser:f_,XMLValidator:h_,XMLBuilder:p_};class aa extends Ve{constructor(e){super({name:"ObjectAlreadyInActiveTierError",$fault:"client",...e}),this.name="ObjectAlreadyInActiveTierError",this.$fault="client",Object.setPrototypeOf(this,aa.prototype)}}var nu;(function(t){t.visit=(e,r)=>e.Records!==void 0?r.Records(e.Records):e.Stats!==void 0?r.Stats(e.Stats):e.Progress!==void 0?r.Progress(e.Progress):e.Cont!==void 0?r.Cont(e.Cont):e.End!==void 0?r.End(e.End):r._(e.$unknown[0],e.$unknown[1])})(nu||(nu={}));const m_=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:tt},...t.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:tt}}),y_=t=>({...t,...t.SSECustomerKey&&{SSECustomerKey:tt},...t.SSEKMSKeyId&&{SSEKMSKeyId:tt},...t.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:tt}}),w_=async(t,e)=>{const r=vs(t,e),s=Y({},$e,{[Ov]:t[cv]});r.bp("/"),r.p("Bucket",()=>t.Bucket,"{Bucket}",!1);const n=Y({[Cv]:[,""]});let i;return r.m("GET").h(s).q(n).b(i),r.build()},b_=async(t,e)=>{const r=vs(t,e),s=Y({},$e,{[oh]:t[Jd],[ah]:[()=>$e(t[Qs]),()=>dr(t[Qs]).toString()],[ch]:t[Xd],[uh]:[()=>$e(t[en]),()=>dr(t[en]).toString()],[dh]:t[eh],[Sr]:t[vr],[Ra]:t[ga],[xr]:t[Er],[Nn]:t[An],[In]:t[Sn],[fh]:t[Gd]});r.bp("/{Key+}"),r.p("Bucket",()=>t.Bucket,"{Bucket}",!1),r.p("Key",()=>t.Key,"{Key+}",!0);const n=Y({[yh]:[,"GetObject"],[_v]:[,t[rv]],[vv]:[,t[sv]],[Ev]:[,t[nv]],[Sv]:[,t[iv]],[xv]:[,t[ov]],[Av]:[()=>t.ResponseExpires!==void 0,()=>dr(t[av]).toString()],[hh]:[,t[Ss]],[lh]:[()=>t.PartNumber!==void 0,()=>t[Qd].toString()]});let i;return r.m("GET").h(s).q(n).b(i),r.build()},__=async(t,e)=>{const r=vs(t,e),s=Y({},$e,{[oh]:t[Jd],[ah]:[()=>$e(t[Qs]),()=>dr(t[Qs]).toString()],[ch]:t[Xd],[uh]:[()=>$e(t[en]),()=>dr(t[en]).toString()],[dh]:t[eh],[Sr]:t[vr],[Ra]:t[ga],[xr]:t[Er],[Nn]:t[An],[In]:t[Sn],[fh]:t[Gd]});r.bp("/{Key+}"),r.p("Bucket",()=>t.Bucket,"{Bucket}",!1),r.p("Key",()=>t.Key,"{Key+}",!0);const n=Y({[hh]:[,t[Ss]],[lh]:[()=>t.PartNumber!==void 0,()=>t[Qd].toString()]});let i;return r.m("HEAD").h(s).q(n).b(i),r.build()},v_=async(t,e)=>{const r=vs(t,e),s=Y({},$e,{[Nn]:t[An],[In]:t[Sn],[$v]:[()=>$e(t[iu]),()=>(t[iu]||[]).map(o=>o).join(", ")]});r.bp("/"),r.p("Bucket",()=>t.Bucket,"{Bucket}",!1);const n=Y({[yv]:[,"2"],[pv]:[,t[Us]],[gv]:[,t[Ls]],[wv]:[()=>t.MaxKeys!==void 0,()=>t[js].toString()],[bv]:[,t[Vt]],[fv]:[,t[Fs]],[mv]:[()=>t.FetchOwner!==void 0,()=>t[Y_].toString()],[Rv]:[,t[Hs]]});let i;return r.m("GET").h(s).q(n).b(i),r.build()},E_=async(t,e)=>{const r=vs(t,e),s=Y({},$e,{[va]:t[ha]||"application/octet-stream",[Tv]:t[V_],[ya]:t[ca],[wa]:t[ua],[ba]:t[la],[_a]:t[da],[ds]:[()=>$e(t[Ys]),()=>t[Ys].toString()],[dv]:t[J_],[Mv]:t[Yr],[Tn]:t[bn],[kn]:t[_n],[On]:t[vn],[Pn]:t[En],[hs]:[()=>$e(t[Zs]),()=>dr(t[Zs]).toString()],[Pv]:t[Z_],[Iv]:t[Q_],[Bv]:t[ev],[Nv]:t[tv],[$n]:t[Cn],[Ca]:t[mt],[ka]:t[ma],[Sr]:t[vr],[Ra]:t[ga],[xr]:t[Er],[Mn]:t[Rn],[mh]:t[sh],[Jt]:[()=>$e(t[ls]),()=>t[ls].toString()],[Nn]:t[An],[Dv]:t[uv],[Aa]:t[pa],[fs]:[()=>$e(t[tn]),()=>(t[tn].toISOString().split(".")[0]+"Z").toString()],[xa]:t[fa],[In]:t[Sn],...t.Metadata!==void 0&&Object.keys(t.Metadata).reduce((a,c)=>(a[`x-amz-meta-${c.toLowerCase()}`]=t.Metadata[c],a),{})});r.bp("/{Key+}"),r.p("Bucket",()=>t.Bucket,"{Bucket}",!1),r.p("Key",()=>t.Key,"{Key+}",!0);const n=Y({[yh]:[,"PutObject"]});let i,o;return t.Body!==void 0&&(o=t.Body,i=o),r.m("PUT").h(s).q(n).b(i),r.build()},S_=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return Es(t,e);const r=Y({$metadata:Fe(t)}),s=rt(id(await Oa(t.body,e)),"body");return s[li]!=null&&(r[li]=K_(s[li])),r},x_=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return Es(t,e);const r=Y({$metadata:Fe(t),[Vd]:[()=>t.headers[sn]!==void 0,()=>Wt(t.headers[sn])],[Kd]:[,t.headers[nh]],[fr]:[,t.headers[Sa]],[rh]:[,t.headers[ph]],[rs]:[()=>t.headers[rn]!==void 0,()=>rt(os(t.headers[rn]))],[Ys]:[()=>t.headers[ds]!==void 0,()=>Ho(t.headers[ds])],[hr]:[,t.headers[Ea]],[bn]:[,t.headers[Tn]],[_n]:[,t.headers[kn]],[vn]:[,t.headers[On]],[En]:[,t.headers[Pn]],[Yd]:[()=>t.headers[nn]!==void 0,()=>Gt(t.headers[nn])],[Ss]:[,t.headers[Ta]],[ca]:[,t.headers[ya]],[ua]:[,t.headers[wa]],[la]:[,t.headers[ba]],[da]:[,t.headers[_a]],[X_]:[,t.headers[hv]],[ha]:[,t.headers[va]],[Zs]:[()=>t.headers[hs]!==void 0,()=>rt(os(t.headers[hs]))],[Wd]:[,t.headers[ih]],[ma]:[,t.headers[ka]],[Cn]:[,t.headers[$n]],[vr]:[,t.headers[Sr]],[Er]:[,t.headers[xr]],[Rn]:[,t.headers[Mn]],[ls]:[()=>t.headers[Jt]!==void 0,()=>Wt(t.headers[Jt])],[mt]:[,t.headers[Ca]],[xn]:[,t.headers[Bn]],[th]:[,t.headers[gh]],[Zd]:[()=>t.headers[on]!==void 0,()=>Gt(t.headers[on])],[lv]:[()=>t.headers[ou]!==void 0,()=>Gt(t.headers[ou])],[pa]:[,t.headers[Aa]],[tn]:[()=>t.headers[fs]!==void 0,()=>rt(ys(t.headers[fs]))],[fa]:[,t.headers[xa]],Metadata:[,Object.keys(t.headers).filter(n=>n.startsWith("x-amz-meta-")).reduce((n,i)=>(n[i.substring(11)]=t.headers[i],n),{})]}),s=t.body;return e.sdkStreamMixin(s),r.Body=s,r},A_=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return Es(t,e);const r=Y({$metadata:Fe(t),[Vd]:[()=>t.headers[sn]!==void 0,()=>Wt(t.headers[sn])],[Kd]:[,t.headers[nh]],[fr]:[,t.headers[Sa]],[rh]:[,t.headers[ph]],[W_]:[,t.headers[kv]],[rs]:[()=>t.headers[rn]!==void 0,()=>rt(os(t.headers[rn]))],[Ys]:[()=>t.headers[ds]!==void 0,()=>Ho(t.headers[ds])],[bn]:[,t.headers[Tn]],[_n]:[,t.headers[kn]],[vn]:[,t.headers[On]],[En]:[,t.headers[Pn]],[hr]:[,t.headers[Ea]],[Yd]:[()=>t.headers[nn]!==void 0,()=>Gt(t.headers[nn])],[Ss]:[,t.headers[Ta]],[ca]:[,t.headers[ya]],[ua]:[,t.headers[wa]],[la]:[,t.headers[ba]],[da]:[,t.headers[_a]],[ha]:[,t.headers[va]],[Zs]:[()=>t.headers[hs]!==void 0,()=>rt(os(t.headers[hs]))],[Wd]:[,t.headers[ih]],[ma]:[,t.headers[ka]],[Cn]:[,t.headers[$n]],[vr]:[,t.headers[Sr]],[Er]:[,t.headers[xr]],[Rn]:[,t.headers[Mn]],[ls]:[()=>t.headers[Jt]!==void 0,()=>Wt(t.headers[Jt])],[mt]:[,t.headers[Ca]],[xn]:[,t.headers[Bn]],[th]:[,t.headers[gh]],[Zd]:[()=>t.headers[on]!==void 0,()=>Gt(t.headers[on])],[pa]:[,t.headers[Aa]],[tn]:[()=>t.headers[fs]!==void 0,()=>rt(ys(t.headers[fs]))],[fa]:[,t.headers[xa]],Metadata:[,Object.keys(t.headers).filter(s=>s.startsWith("x-amz-meta-")).reduce((s,n)=>(s[n.substring(11)]=t.headers[n],s),{})]});return await Lo(t.body,e),r},C_=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return Es(t,e);const r=Y({$metadata:Fe(t),[xn]:[,t.headers[Bn]]}),s=rt(id(await Oa(t.body,e)),"body");return s.CommonPrefixes===""?r[Is]=[]:s[Is]!=null&&(r[Is]=L_(fo(s[Is]))),s.Contents===""?r[Bs]=[]:s[Bs]!=null&&(r[Bs]=H_(fo(s[Bs]))),s[Fs]!=null&&(r[Fs]=he(s[Fs])),s[Us]!=null&&(r[Us]=he(s[Us])),s[Ls]!=null&&(r[Ls]=he(s[Ls])),s[pi]!=null&&(r[pi]=Wt(s[pi])),s[mi]!=null&&(r[mi]=Gt(s[mi])),s[js]!=null&&(r[js]=Gt(s[js])),s[yi]!=null&&(r[yi]=he(s[yi])),s[wi]!=null&&(r[wi]=he(s[wi])),s[Vt]!=null&&(r[Vt]=he(s[Vt])),s[Hs]!=null&&(r[Hs]=he(s[Hs])),r},R_=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return Es(t,e);const r=Y({$metadata:Fe(t),[fr]:[,t.headers[Sa]],[hr]:[,t.headers[Ea]],[bn]:[,t.headers[Tn]],[_n]:[,t.headers[kn]],[vn]:[,t.headers[On]],[En]:[,t.headers[Pn]],[Cn]:[,t.headers[$n]],[Ss]:[,t.headers[Ta]],[vr]:[,t.headers[Sr]],[Er]:[,t.headers[xr]],[Rn]:[,t.headers[Mn]],[sh]:[,t.headers[mh]],[ls]:[()=>t.headers[Jt]!==void 0,()=>Wt(t.headers[Jt])],[xn]:[,t.headers[Bn]]});return await Lo(t.body,e),r},Es=async(t,e)=>{const r={...t,body:await Fv(t.body,e)},s=Uv(t,r.body);switch(s){case"NoSuchUpload":case"com.amazonaws.s3#NoSuchUpload":throw await N_(r);case"ObjectNotInActiveTierError":case"com.amazonaws.s3#ObjectNotInActiveTierError":throw await D_(r);case"BucketAlreadyExists":case"com.amazonaws.s3#BucketAlreadyExists":throw await k_(r);case"BucketAlreadyOwnedByYou":case"com.amazonaws.s3#BucketAlreadyOwnedByYou":throw await O_(r);case"NoSuchBucket":case"com.amazonaws.s3#NoSuchBucket":throw await I_(r);case"InvalidObjectState":case"com.amazonaws.s3#InvalidObjectState":throw await P_(r);case"NoSuchKey":case"com.amazonaws.s3#NoSuchKey":throw await B_(r);case"NotFound":case"com.amazonaws.s3#NotFound":throw await $_(r);case"ObjectAlreadyInActiveTierError":case"com.amazonaws.s3#ObjectAlreadyInActiveTierError":throw await M_(r);default:const n=r.body;return T_({output:t,parsedBody:n,errorCode:s})}},T_=cm(Ve),k_=async(t,e)=>{const r=Y({});t.body;const s=new Yo({$metadata:Fe(t),...r});return dt(s,t.body)},O_=async(t,e)=>{const r=Y({});t.body;const s=new Zo({$metadata:Fe(t),...r});return dt(s,t.body)},P_=async(t,e)=>{const r=Y({}),s=t.body;s[ui]!=null&&(r[ui]=he(s[ui])),s[mt]!=null&&(r[mt]=he(s[mt]));const n=new ea({$metadata:Fe(t),...r});return dt(n,t.body)},I_=async(t,e)=>{const r=Y({});t.body;const s=new Qo({$metadata:Fe(t),...r});return dt(s,t.body)},B_=async(t,e)=>{const r=Y({});t.body;const s=new ta({$metadata:Fe(t),...r});return dt(s,t.body)},N_=async(t,e)=>{const r=Y({});t.body;const s=new Jo({$metadata:Fe(t),...r});return dt(s,t.body)},$_=async(t,e)=>{const r=Y({});t.body;const s=new ra({$metadata:Fe(t),...r});return dt(s,t.body)},M_=async(t,e)=>{const r=Y({});t.body;const s=new aa({$metadata:Fe(t),...r});return dt(s,t.body)},D_=async(t,e)=>{const r=Y({});t.body;const s=new Xo({$metadata:Fe(t),...r});return dt(s,t.body)},F_=(t,e)=>(t||[]).filter(r=>r!=null).map(r=>he(r)),U_=(t,e)=>{const r={};return t[Vt]!=null&&(r[Vt]=he(t[Vt])),r},L_=(t,e)=>(t||[]).filter(r=>r!=null).map(r=>U_(r)),j_=(t,e)=>{const r={};return t[gi]!=null&&(r[gi]=he(t[gi])),t[rs]!=null&&(r[rs]=rt(ys(t[rs]))),t[hr]!=null&&(r[hr]=he(t[hr])),t.ChecksumAlgorithm===""?r[Yr]=[]:t[Yr]!=null&&(r[Yr]=F_(fo(t[Yr]))),t[xi]!=null&&(r[xi]=Ho(t[xi])),t[mt]!=null&&(r[mt]=he(t[mt])),t[bi]!=null&&(r[bi]=z_(t[bi])),t[vi]!=null&&(r[vi]=q_(t[vi])),r},H_=(t,e)=>(t||[]).filter(r=>r!=null).map(r=>j_(r)),z_=(t,e)=>{const r={};return t[di]!=null&&(r[di]=he(t[di])),t[hi]!=null&&(r[hi]=he(t[hi])),r},q_=(t,e)=>{const r={};return t[fi]!=null&&(r[fi]=Wt(t[fi])),t[_i]!=null&&(r[_i]=rt(ys(t[_i]))),r},K_=(t,e)=>{const r={};return t[ci]!=null&&(r[ci]=he(t[ci])),t[Ei]!=null&&(r[Ei]=he(t[Ei])),t[Si]!=null&&(r[Si]=he(t[Si])),t[fr]!=null&&(r[fr]=rt(ys(t[fr]))),r},Fe=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),G_=(t,e)=>Lo(t,e).then(r=>e.utf8Encoder(r)),$e=t=>t!=null&&t!==""&&(!Object.getOwnPropertyNames(t).includes("length")||t.length!=0)&&(!Object.getOwnPropertyNames(t).includes("size")||t.size!=0),V_="ACL",ci="AccessKeyId",Kd="AcceptRanges",W_="ArchiveStatus",ui="AccessTier",ls="BucketKeyEnabled",li="Credentials",Yr="ChecksumAlgorithm",ca="CacheControl",bn="ChecksumCRC32",_n="ChecksumCRC32C",ua="ContentDisposition",la="ContentEncoding",da="ContentLanguage",Ys="ContentLength",Gd="ChecksumMode",J_="ContentMD5",Is="CommonPrefixes",X_="ContentRange",vn="ChecksumSHA1",En="ChecksumSHA256",ha="ContentType",Fs="ContinuationToken",Bs="Contents",Us="Delimiter",Vd="DeleteMarker",di="DisplayName",Zs="Expires",Sn="ExpectedBucketOwner",Wd="ExpiresString",Ls="EncodingType",hr="ETag",fr="Expiration",Y_="FetchOwner",Z_="GrantFullControl",Q_="GrantRead",ev="GrantReadACP",tv="GrantWriteACP",hi="ID",Jd="IfMatch",Qs="IfModifiedSince",Xd="IfNoneMatch",fi="IsRestoreInProgress",pi="IsTruncated",en="IfUnmodifiedSince",gi="Key",mi="KeyCount",rs="LastModified",js="MaxKeys",Yd="MissingMeta",yi="Name",wi="NextContinuationToken",bi="Owner",fa="ObjectLockLegalHoldStatus",pa="ObjectLockMode",tn="ObjectLockRetainUntilDate",iu="OptionalObjectAttributes",Vt="Prefix",Zd="PartsCount",Qd="PartNumber",eh="Range",xn="RequestCharged",rv="ResponseCacheControl",sv="ResponseContentDisposition",nv="ResponseContentEncoding",iv="ResponseContentLanguage",ov="ResponseContentType",av="ResponseExpires",_i="RestoreExpiryDate",An="RequestPayer",th="ReplicationStatus",vi="RestoreStatus",rh="Restore",Hs="StartAfter",Ei="SecretAccessKey",mt="StorageClass",cv="SessionMode",Cn="ServerSideEncryption",vr="SSECustomerAlgorithm",ga="SSECustomerKey",Er="SSECustomerKeyMD5",sh="SSEKMSEncryptionContext",Rn="SSEKMSKeyId",Si="SessionToken",xi="Size",uv="Tagging",lv="TagCount",Ss="VersionId",ma="WebsiteRedirectLocation",nh="accept-ranges",ya="cache-control",wa="content-disposition",ba="content-encoding",_a="content-language",ds="content-length",dv="content-md5",hv="content-range",va="content-type",fv="continuation-token",pv="delimiter",hs="expires",gv="encoding-type",Ea="etag",ih="expiresstring",mv="fetch-owner",oh="if-match",ah="if-modified-since",ch="if-none-match",uh="if-unmodified-since",rn="last-modified",yv="list-type",wv="max-keys",lh="partNumber",bv="prefix",dh="range",_v="response-cache-control",vv="response-content-disposition",Ev="response-content-encoding",Sv="response-content-language",xv="response-content-type",Av="response-expires",Cv="session",Rv="start-after",hh="versionId",Tv="x-amz-acl",kv="x-amz-archive-status",Tn="x-amz-checksum-crc32",kn="x-amz-checksum-crc32c",fh="x-amz-checksum-mode",On="x-amz-checksum-sha1",Pn="x-amz-checksum-sha256",Ov="x-amz-create-session-mode",sn="x-amz-delete-marker",Sa="x-amz-expiration",In="x-amz-expected-bucket-owner",Pv="x-amz-grant-full-control",Iv="x-amz-grant-read",Bv="x-amz-grant-read-acp",Nv="x-amz-grant-write-acp",nn="x-amz-missing-meta",on="x-amz-mp-parts-count",xa="x-amz-object-lock-legal-hold",Aa="x-amz-object-lock-mode",fs="x-amz-object-lock-retain-until-date",$v="x-amz-optional-object-attributes",ph="x-amz-restore",Bn="x-amz-request-charged",Nn="x-amz-request-payer",gh="x-amz-replication-status",Ca="x-amz-storage-class",Mv="x-amz-sdk-checksum-algorithm",$n="x-amz-server-side-encryption",Mn="x-amz-server-side-encryption-aws-kms-key-id",Jt="x-amz-server-side-encryption-bucket-key-enabled",mh="x-amz-server-side-encryption-context",Sr="x-amz-server-side-encryption-customer-algorithm",Ra="x-amz-server-side-encryption-customer-key",xr="x-amz-server-side-encryption-customer-key-md5",Dv="x-amz-tagging",ou="x-amz-tagging-count",Ta="x-amz-version-id",ka="x-amz-website-redirect-location",yh="x-id",Oa=(t,e)=>G_(t,e).then(r=>{if(r.length){const s=new g_.XMLParser({attributeNamePrefix:"",htmlEntities:!0,ignoreAttributes:!1,ignoreDeclaration:!0,parseTagValue:!1,trimValues:!1,tagValueProcessor:(c,u)=>u.trim()===""&&u.includes(`
`)?"":void 0});s.addEntity("#xD","\r"),s.addEntity("#10",`
`);const n=s.parse(r),i="#text",o=Object.keys(n)[0],a=n[o];return a[i]&&(a[o]=a[i],delete a[i]),cd(a)}return{}}),Fv=async(t,e)=>{const r=await Oa(t,e);return r.Error&&(r.Error.message=r.Error.message??r.Error.Message),r},Uv=(t,e)=>{if((e==null?void 0:e.Code)!==void 0)return e.Code;if(t.statusCode==404)return"NotFound"};class Lv extends _r.classBuilder().ep({..._s,DisableS3ExpressSessionAuth:{type:"staticContextParams",value:!0},Bucket:{type:"contextParams",name:"Bucket"}}).m(function(e,r,s,n){return[ws(s,this.serialize,this.deserialize),bs(s,e.getEndpointParameterInstructions())]}).s("AmazonS3","CreateSession",{}).n("S3Client","CreateSessionCommand").f(void 0,Jw).ser(w_).de(S_).build(){}const jv="@aws-sdk/client-s3",Hv="AWS SDK for JavaScript S3 Client for Node.js, Browser and React Native",zv="3.523.0",qv={build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"node ../../scripts/compilation/inline client-s3","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo s3",test:"yarn test:unit","test:e2e":"yarn test:e2e:node && yarn test:e2e:browser","test:e2e:browser":"ts-mocha test/**/*.browser.ispec.ts && karma start karma.conf.js","test:e2e:node":"jest --c jest.config.e2e.js","test:unit":"ts-mocha test/unit/**/*.spec.ts"},Kv="./dist-cjs/index.js",Gv="./dist-types/index.d.ts",Vv="./dist-es/index.js",Wv=!1,Jv={"@aws-crypto/sha1-browser":"3.0.0","@aws-crypto/sha256-browser":"3.0.0","@aws-crypto/sha256-js":"3.0.0","@aws-sdk/client-sts":"3.523.0","@aws-sdk/core":"3.523.0","@aws-sdk/credential-provider-node":"3.523.0","@aws-sdk/middleware-bucket-endpoint":"3.523.0","@aws-sdk/middleware-expect-continue":"3.523.0","@aws-sdk/middleware-flexible-checksums":"3.523.0","@aws-sdk/middleware-host-header":"3.523.0","@aws-sdk/middleware-location-constraint":"3.523.0","@aws-sdk/middleware-logger":"3.523.0","@aws-sdk/middleware-recursion-detection":"3.523.0","@aws-sdk/middleware-sdk-s3":"3.523.0","@aws-sdk/middleware-signing":"3.523.0","@aws-sdk/middleware-ssec":"3.523.0","@aws-sdk/middleware-user-agent":"3.523.0","@aws-sdk/region-config-resolver":"3.523.0","@aws-sdk/signature-v4-multi-region":"3.523.0","@aws-sdk/types":"3.523.0","@aws-sdk/util-endpoints":"3.523.0","@aws-sdk/util-user-agent-browser":"3.523.0","@aws-sdk/util-user-agent-node":"3.523.0","@aws-sdk/xml-builder":"3.523.0","@smithy/config-resolver":"^2.1.3","@smithy/core":"^1.3.4","@smithy/eventstream-serde-browser":"^2.1.3","@smithy/eventstream-serde-config-resolver":"^2.1.3","@smithy/eventstream-serde-node":"^2.1.3","@smithy/fetch-http-handler":"^2.4.3","@smithy/hash-blob-browser":"^2.1.3","@smithy/hash-node":"^2.1.3","@smithy/hash-stream-node":"^2.1.3","@smithy/invalid-dependency":"^2.1.3","@smithy/md5-js":"^2.1.3","@smithy/middleware-content-length":"^2.1.3","@smithy/middleware-endpoint":"^2.4.3","@smithy/middleware-retry":"^2.1.3","@smithy/middleware-serde":"^2.1.3","@smithy/middleware-stack":"^2.1.3","@smithy/node-config-provider":"^2.2.3","@smithy/node-http-handler":"^2.4.1","@smithy/protocol-http":"^3.2.1","@smithy/smithy-client":"^2.4.1","@smithy/types":"^2.10.1","@smithy/url-parser":"^2.1.3","@smithy/util-base64":"^2.1.1","@smithy/util-body-length-browser":"^2.1.1","@smithy/util-body-length-node":"^2.2.1","@smithy/util-defaults-mode-browser":"^2.1.3","@smithy/util-defaults-mode-node":"^2.2.2","@smithy/util-endpoints":"^1.1.3","@smithy/util-retry":"^2.1.3","@smithy/util-stream":"^2.1.3","@smithy/util-utf8":"^2.1.1","@smithy/util-waiter":"^2.1.3","fast-xml-parser":"4.2.5",tslib:"^2.5.0"},Xv={"@aws-sdk/signature-v4-crt":"3.523.0","@smithy/service-client-documentation-generator":"^2.1.1","@tsconfig/node14":"1.0.3","@types/chai":"^4.2.11","@types/mocha":"^8.0.4","@types/node":"^14.14.31",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~4.9.5"},Yv={node:">=14.0.0"},Zv={"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},Qv=["dist-*/**"],eE={name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},tE="Apache-2.0",rE={"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},sE="https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-s3",nE={type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-s3"},iE={name:jv,description:Hv,version:zv,scripts:qv,main:Kv,types:Gv,module:Vv,sideEffects:Wv,dependencies:Jv,devDependencies:Xv,engines:Yv,typesVersions:Zv,files:Qv,author:eE,license:tE,browser:rE,"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:sE,repository:nE};var wh={},$r={},Mr={},Dr={},au;function bh(){if(au)return Dr;au=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.isEmptyData=void 0;function t(e){return typeof e=="string"?e.length===0:e.byteLength===0}return Dr.isEmptyData=t,Dr}var Ai={},cu;function _h(){return cu||(cu=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_DATA_SHA_1=t.SHA_1_HMAC_ALGO=t.SHA_1_HASH=void 0,t.SHA_1_HASH={name:"SHA-1"},t.SHA_1_HMAC_ALGO={name:"HMAC",hash:t.SHA_1_HASH},t.EMPTY_DATA_SHA_1=new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9])}(Ai)),Ai}const oE={};function aE(){return typeof window<"u"?window:typeof self<"u"?self:oE}const cE=Object.freeze(Object.defineProperty({__proto__:null,locateWindow:aE},Symbol.toStringTag,{value:"Module"})),Ar=ko(cE);var uu;function vh(){if(uu)return Mr;uu=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.Sha1=void 0;var t=bh(),e=_h(),r=mn,s=Ar,n=function(){function a(c){this.secret=c,this.reset()}return a.prototype.update=function(c){var u=this;(0,t.isEmptyData)(c)||(this.operation=this.operation.then(function(l){return l.onerror=function(){u.operation=Promise.reject(new Error("Error encountered updating hash"))},l.process(o(c)),l}),this.operation.catch(function(){}))},a.prototype.digest=function(){return this.operation.then(function(c){return new Promise(function(u,l){c.onerror=function(){l(new Error("Error encountered finalizing hash"))},c.oncomplete=function(){c.result&&u(new Uint8Array(c.result)),l(new Error("Error encountered finalizing hash"))},c.finish()})})},a.prototype.reset=function(){this.secret?(this.operation=i(this.secret).then(function(c){return(0,s.locateWindow)().msCrypto.subtle.sign(e.SHA_1_HMAC_ALGO,c)}),this.operation.catch(function(){})):this.operation=Promise.resolve((0,s.locateWindow)().msCrypto.subtle.digest("SHA-1"))},a}();Mr.Sha1=n;function i(a){return new Promise(function(c,u){var l=(0,s.locateWindow)().msCrypto.subtle.importKey("raw",o(a),e.SHA_1_HMAC_ALGO,!1,["sign"]);l.oncomplete=function(){l.result&&c(l.result),u(new Error("ImportKey completed without importing key."))},l.onerror=function(){u(new Error("ImportKey failed to import key."))}})}function o(a){return typeof a=="string"?(0,r.fromUtf8)(a):ArrayBuffer.isView(a)?new Uint8Array(a.buffer,a.byteOffset,a.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(a)}return Mr}var Fr={},lu;function Eh(){if(lu)return Fr;lu=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.Sha1=void 0;var t=mn,e=bh(),r=_h(),s=Ar,n=function(){function o(a){this.toHash=new Uint8Array(0),a!==void 0&&(this.key=new Promise(function(c,u){(0,s.locateWindow)().crypto.subtle.importKey("raw",i(a),r.SHA_1_HMAC_ALGO,!1,["sign"]).then(c,u)}),this.key.catch(function(){}))}return o.prototype.update=function(a){if(!(0,e.isEmptyData)(a)){var c=i(a),u=new Uint8Array(this.toHash.byteLength+c.byteLength);u.set(this.toHash,0),u.set(c,this.toHash.byteLength),this.toHash=u}},o.prototype.digest=function(){var a=this;return this.key?this.key.then(function(c){return(0,s.locateWindow)().crypto.subtle.sign(r.SHA_1_HMAC_ALGO,c,a.toHash).then(function(u){return new Uint8Array(u)})}):(0,e.isEmptyData)(this.toHash)?Promise.resolve(r.EMPTY_DATA_SHA_1):Promise.resolve().then(function(){return(0,s.locateWindow)().crypto.subtle.digest(r.SHA_1_HASH,a.toHash)}).then(function(c){return Promise.resolve(new Uint8Array(c))})},o.prototype.reset=function(){this.toHash=new Uint8Array(0)},o}();Fr.Sha1=n;function i(o){return typeof o=="string"?(0,t.fromUtf8)(o):ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(o)}return Fr}var Ci={},We={},du;function uE(){if(du)return We;du=1,Object.defineProperty(We,"__esModule",{value:!0}),We.supportsZeroByteGCM=We.supportsSubtleCrypto=We.supportsSecureRandom=We.supportsWebCrypto=void 0;var t=nt,e=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function r(o){if(s(o)&&typeof o.crypto.subtle=="object"){var a=o.crypto.subtle;return n(a)}return!1}We.supportsWebCrypto=r;function s(o){if(typeof o=="object"&&typeof o.crypto=="object"){var a=o.crypto.getRandomValues;return typeof a=="function"}return!1}We.supportsSecureRandom=s;function n(o){return o&&e.every(function(a){return typeof o[a]=="function"})}We.supportsSubtleCrypto=n;function i(o){return t.__awaiter(this,void 0,void 0,function(){var a,c;return t.__generator(this,function(u){switch(u.label){case 0:if(!n(o))return[2,!1];u.label=1;case 1:return u.trys.push([1,4,,5]),[4,o.generateKey({name:"AES-GCM",length:128},!1,["encrypt"])];case 2:return a=u.sent(),[4,o.encrypt({name:"AES-GCM",iv:new Uint8Array(Array(12)),additionalData:new Uint8Array(Array(16)),tagLength:128},a,new Uint8Array(0))];case 3:return c=u.sent(),[2,c.byteLength===16];case 4:return u.sent(),[2,!1];case 5:return[2]}})})}return We.supportsZeroByteGCM=i,We}var hu;function Sh(){return hu||(hu=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=nt;e.__exportStar(uE(),t)}(Ci)),Ci}var Ri={},Ti={},fu;function lE(){return fu||(fu=1,Object.defineProperty(Ti,"__esModule",{value:!0})),Ti}var ki={},pu;function dE(){return pu||(pu=1,Object.defineProperty(ki,"__esModule",{value:!0})),ki}var Oi={},gu;function hE(){return gu||(gu=1,Object.defineProperty(Oi,"__esModule",{value:!0})),Oi}var Pi={},mu;function fE(){return mu||(mu=1,Object.defineProperty(Pi,"__esModule",{value:!0})),Pi}var Ur={},yu;function pE(){if(yu)return Ur;yu=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.isMsWindow=void 0;var t=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function e(s){return"MSInputMethodContext"in s&&"msCrypto"in s}function r(s){if(e(s)&&s.msCrypto.subtle!==void 0){var n=s.msCrypto,i=n.getRandomValues,o=n.subtle;return t.map(function(a){return o[a]}).concat(i).every(function(a){return typeof a=="function"})}return!1}return Ur.isMsWindow=r,Ur}var wu;function xh(){return wu||(wu=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=nt;e.__exportStar(lE(),t),e.__exportStar(dE(),t),e.__exportStar(hE(),t),e.__exportStar(fE(),t),e.__exportStar(pE(),t)}(Ri)),Ri}var bu;function gE(){if(bu)return $r;bu=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.Sha1=void 0;var t=vh(),e=Eh(),r=Sh(),s=xh(),n=Ar,i=Pt(),o=function(){function a(c){if((0,r.supportsWebCrypto)((0,n.locateWindow)()))this.hash=new e.Sha1(c);else if((0,s.isMsWindow)((0,n.locateWindow)()))this.hash=new t.Sha1(c);else throw new Error("SHA1 not supported")}return a.prototype.update=function(c,u){this.hash.update((0,i.convertToBuffer)(c))},a.prototype.digest=function(){return this.hash.digest()},a.prototype.reset=function(){this.hash.reset()},a}();return $r.Sha1=o,$r}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.WebCryptoSha1=t.Ie11Sha1=void 0;var e=nt;e.__exportStar(gE(),t);var r=vh();Object.defineProperty(t,"Ie11Sha1",{enumerable:!0,get:function(){return r.Sha1}});var s=Eh();Object.defineProperty(t,"WebCryptoSha1",{enumerable:!0,get:function(){return s.Sha1}})})(wh);var Ah={},Lr={},jr={},Hr={},_u;function mE(){if(_u)return Hr;_u=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.isEmptyData=void 0;function t(e){return typeof e=="string"?e.length===0:e.byteLength===0}return Hr.isEmptyData=t,Hr}var Ii={},vu;function Ch(){return vu||(vu=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_DATA_SHA_256=t.SHA_256_HMAC_ALGO=t.SHA_256_HASH=void 0,t.SHA_256_HASH={name:"SHA-256"},t.SHA_256_HMAC_ALGO={name:"HMAC",hash:t.SHA_256_HASH},t.EMPTY_DATA_SHA_256=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85])}(Ii)),Ii}var Eu;function Rh(){if(Eu)return jr;Eu=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.Sha256=void 0;var t=mE(),e=Ch(),r=mn,s=Ar,n=function(){function a(c){this.secret=c,this.reset()}return a.prototype.update=function(c){var u=this;(0,t.isEmptyData)(c)||(this.operation=this.operation.then(function(l){return l.onerror=function(){u.operation=Promise.reject(new Error("Error encountered updating hash"))},l.process(o(c)),l}),this.operation.catch(function(){}))},a.prototype.digest=function(){return this.operation.then(function(c){return new Promise(function(u,l){c.onerror=function(){l(new Error("Error encountered finalizing hash"))},c.oncomplete=function(){c.result&&u(new Uint8Array(c.result)),l(new Error("Error encountered finalizing hash"))},c.finish()})})},a.prototype.reset=function(){this.secret?(this.operation=i(this.secret).then(function(c){return(0,s.locateWindow)().msCrypto.subtle.sign(e.SHA_256_HMAC_ALGO,c)}),this.operation.catch(function(){})):this.operation=Promise.resolve((0,s.locateWindow)().msCrypto.subtle.digest("SHA-256"))},a}();jr.Sha256=n;function i(a){return new Promise(function(c,u){var l=(0,s.locateWindow)().msCrypto.subtle.importKey("raw",o(a),e.SHA_256_HMAC_ALGO,!1,["sign"]);l.oncomplete=function(){l.result&&c(l.result),u(new Error("ImportKey completed without importing key."))},l.onerror=function(){u(new Error("ImportKey failed to import key."))}})}function o(a){return typeof a=="string"?(0,r.fromUtf8)(a):ArrayBuffer.isView(a)?new Uint8Array(a.buffer,a.byteOffset,a.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(a)}return jr}var zr={},Su;function Th(){if(Su)return zr;Su=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.Sha256=void 0;var t=Pt(),e=Ch(),r=Ar,s=function(){function n(i){this.toHash=new Uint8Array(0),this.secret=i,this.reset()}return n.prototype.update=function(i){if(!(0,t.isEmptyData)(i)){var o=(0,t.convertToBuffer)(i),a=new Uint8Array(this.toHash.byteLength+o.byteLength);a.set(this.toHash,0),a.set(o,this.toHash.byteLength),this.toHash=a}},n.prototype.digest=function(){var i=this;return this.key?this.key.then(function(o){return(0,r.locateWindow)().crypto.subtle.sign(e.SHA_256_HMAC_ALGO,o,i.toHash).then(function(a){return new Uint8Array(a)})}):(0,t.isEmptyData)(this.toHash)?Promise.resolve(e.EMPTY_DATA_SHA_256):Promise.resolve().then(function(){return(0,r.locateWindow)().crypto.subtle.digest(e.SHA_256_HASH,i.toHash)}).then(function(o){return Promise.resolve(new Uint8Array(o))})},n.prototype.reset=function(){var i=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(o,a){(0,r.locateWindow)().crypto.subtle.importKey("raw",(0,t.convertToBuffer)(i.secret),e.SHA_256_HMAC_ALGO,!1,["sign"]).then(o,a)}),this.key.catch(function(){}))},n}();return zr.Sha256=s,zr}var Bi={},qr={},Le={},xu;function kh(){return xu||(xu=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.MAX_HASHABLE_LENGTH=Le.INIT=Le.KEY=Le.DIGEST_LENGTH=Le.BLOCK_SIZE=void 0,Le.BLOCK_SIZE=64,Le.DIGEST_LENGTH=32,Le.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Le.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Le.MAX_HASHABLE_LENGTH=Math.pow(2,53)-1),Le}var Kr={},Au;function yE(){if(Au)return Kr;Au=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.RawSha256=void 0;var t=kh(),e=function(){function r(){this.state=Int32Array.from(t.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return r.prototype.update=function(s){if(this.finished)throw new Error("Attempted to update an already finished hash.");var n=0,i=s.byteLength;if(this.bytesHashed+=i,this.bytesHashed*8>t.MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;i>0;)this.buffer[this.bufferLength++]=s[n++],i--,this.bufferLength===t.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},r.prototype.digest=function(){if(!this.finished){var s=this.bytesHashed*8,n=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),i=this.bufferLength;if(n.setUint8(this.bufferLength++,128),i%t.BLOCK_SIZE>=t.BLOCK_SIZE-8){for(var o=this.bufferLength;o<t.BLOCK_SIZE;o++)n.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(var o=this.bufferLength;o<t.BLOCK_SIZE-8;o++)n.setUint8(o,0);n.setUint32(t.BLOCK_SIZE-8,Math.floor(s/4294967296),!0),n.setUint32(t.BLOCK_SIZE-4,s),this.hashBuffer(),this.finished=!0}for(var a=new Uint8Array(t.DIGEST_LENGTH),o=0;o<8;o++)a[o*4]=this.state[o]>>>24&255,a[o*4+1]=this.state[o]>>>16&255,a[o*4+2]=this.state[o]>>>8&255,a[o*4+3]=this.state[o]>>>0&255;return a},r.prototype.hashBuffer=function(){for(var s=this,n=s.buffer,i=s.state,o=i[0],a=i[1],c=i[2],u=i[3],l=i[4],d=i[5],h=i[6],p=i[7],g=0;g<t.BLOCK_SIZE;g++){if(g<16)this.temp[g]=(n[g*4]&255)<<24|(n[g*4+1]&255)<<16|(n[g*4+2]&255)<<8|n[g*4+3]&255;else{var y=this.temp[g-2],w=(y>>>17|y<<15)^(y>>>19|y<<13)^y>>>10;y=this.temp[g-15];var x=(y>>>7|y<<25)^(y>>>18|y<<14)^y>>>3;this.temp[g]=(w+this.temp[g-7]|0)+(x+this.temp[g-16]|0)}var k=(((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&d^~l&h)|0)+(p+(t.KEY[g]+this.temp[g]|0)|0)|0,O=((o>>>2|o<<30)^(o>>>13|o<<19)^(o>>>22|o<<10))+(o&a^o&c^a&c)|0;p=h,h=d,d=l,l=u+k|0,u=c,c=a,a=o,o=k+O|0}i[0]+=o,i[1]+=a,i[2]+=c,i[3]+=u,i[4]+=l,i[5]+=d,i[6]+=h,i[7]+=p},r}();return Kr.RawSha256=e,Kr}var Cu;function wE(){if(Cu)return qr;Cu=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.Sha256=void 0;var t=nt,e=kh(),r=yE(),s=Pt(),n=function(){function o(a){this.secret=a,this.hash=new r.RawSha256,this.reset()}return o.prototype.update=function(a){if(!((0,s.isEmptyData)(a)||this.error))try{this.hash.update((0,s.convertToBuffer)(a))}catch(c){this.error=c}},o.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},o.prototype.digest=function(){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(a){return[2,this.digestSync()]})})},o.prototype.reset=function(){if(this.hash=new r.RawSha256,this.secret){this.outer=new r.RawSha256;var a=i(this.secret),c=new Uint8Array(e.BLOCK_SIZE);c.set(a);for(var u=0;u<e.BLOCK_SIZE;u++)a[u]^=54,c[u]^=92;this.hash.update(a),this.outer.update(c);for(var u=0;u<a.byteLength;u++)a[u]=0}},o}();qr.Sha256=n;function i(o){var a=(0,s.convertToBuffer)(o);if(a.byteLength>e.BLOCK_SIZE){var c=new r.RawSha256;c.update(a),a=c.digest()}var u=new Uint8Array(e.BLOCK_SIZE);return u.set(a),u}return qr}var Ru;function bE(){return Ru||(Ru=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=nt;e.__exportStar(wE(),t)}(Bi)),Bi}var Tu;function _E(){if(Tu)return Lr;Tu=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.Sha256=void 0;var t=Rh(),e=Th(),r=bE(),s=Sh(),n=xh(),i=Ar,o=Pt(),a=function(){function c(u){(0,s.supportsWebCrypto)((0,i.locateWindow)())?this.hash=new e.Sha256(u):(0,n.isMsWindow)((0,i.locateWindow)())?this.hash=new t.Sha256(u):this.hash=new r.Sha256(u)}return c.prototype.update=function(u,l){this.hash.update((0,o.convertToBuffer)(u))},c.prototype.digest=function(){return this.hash.digest()},c.prototype.reset=function(){this.hash.reset()},c}();return Lr.Sha256=a,Lr}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.WebCryptoSha256=t.Ie11Sha256=void 0;var e=nt;e.__exportStar(_E(),t);var r=Rh();Object.defineProperty(t,"Ie11Sha256",{enumerable:!0,get:function(){return r.Sha256}});var s=Th();Object.defineProperty(t,"WebCryptoSha256",{enumerable:!0,get:function(){return s.Sha256}})})(Ah);const vE={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},Oh={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},te={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},Ce={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},St={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class v{static getFirstMatch(e,r){const s=r.match(e);return s&&s.length>0&&s[1]||""}static getSecondMatch(e,r){const s=r.match(e);return s&&s.length>1&&s[2]||""}static matchAndReturnConst(e,r,s){if(e.test(r))return s}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const r=e.split(".").splice(0,2).map(s=>parseInt(s,10)||0);if(r.push(0),r[0]===10)switch(r[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const r=e.split(".").splice(0,2).map(s=>parseInt(s,10)||0);if(r.push(0),!(r[0]===1&&r[1]<5)){if(r[0]===1&&r[1]<6)return"Cupcake";if(r[0]===1&&r[1]>=6)return"Donut";if(r[0]===2&&r[1]<2)return"Eclair";if(r[0]===2&&r[1]===2)return"Froyo";if(r[0]===2&&r[1]>2)return"Gingerbread";if(r[0]===3)return"Honeycomb";if(r[0]===4&&r[1]<1)return"Ice Cream Sandwich";if(r[0]===4&&r[1]<4)return"Jelly Bean";if(r[0]===4&&r[1]>=4)return"KitKat";if(r[0]===5)return"Lollipop";if(r[0]===6)return"Marshmallow";if(r[0]===7)return"Nougat";if(r[0]===8)return"Oreo";if(r[0]===9)return"Pie"}}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,r,s=!1){const n=v.getVersionPrecision(e),i=v.getVersionPrecision(r);let o=Math.max(n,i),a=0;const c=v.map([e,r],u=>{const l=o-v.getVersionPrecision(u),d=u+new Array(l+1).join(".0");return v.map(d.split("."),h=>new Array(20-h.length).join("0")+h).reverse()});for(s&&(a=o-Math.min(n,i)),o-=1;o>=a;){if(c[0][o]>c[1][o])return 1;if(c[0][o]===c[1][o]){if(o===a)return 0;o-=1}else if(c[0][o]<c[1][o])return-1}}static map(e,r){const s=[];let n;if(Array.prototype.map)return Array.prototype.map.call(e,r);for(n=0;n<e.length;n+=1)s.push(r(e[n]));return s}static find(e,r){let s,n;if(Array.prototype.find)return Array.prototype.find.call(e,r);for(s=0,n=e.length;s<n;s+=1){const i=e[s];if(r(i,s))return i}}static assign(e,...r){const s=e;let n,i;if(Object.assign)return Object.assign(e,...r);for(n=0,i=r.length;n<i;n+=1){const o=r[n];typeof o=="object"&&o!==null&&Object.keys(o).forEach(c=>{s[c]=o[c]})}return e}static getBrowserAlias(e){return vE[e]}static getBrowserTypeByAlias(e){return Oh[e]||""}}const z=/version\/(\d+(\.?_?\d+)+)/i,EE=[{test:[/googlebot/i],describe(t){const e={name:"Googlebot"},r=v.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/opera/i],describe(t){const e={name:"Opera"},r=v.getFirstMatch(z,t)||v.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/opr\/|opios/i],describe(t){const e={name:"Opera"},r=v.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/SamsungBrowser/i],describe(t){const e={name:"Samsung Internet for Android"},r=v.getFirstMatch(z,t)||v.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/Whale/i],describe(t){const e={name:"NAVER Whale Browser"},r=v.getFirstMatch(z,t)||v.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/MZBrowser/i],describe(t){const e={name:"MZ Browser"},r=v.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/focus/i],describe(t){const e={name:"Focus"},r=v.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/swing/i],describe(t){const e={name:"Swing"},r=v.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/coast/i],describe(t){const e={name:"Opera Coast"},r=v.getFirstMatch(z,t)||v.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(t){const e={name:"Opera Touch"},r=v.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,t)||v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/yabrowser/i],describe(t){const e={name:"Yandex Browser"},r=v.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/ucbrowser/i],describe(t){const e={name:"UC Browser"},r=v.getFirstMatch(z,t)||v.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/Maxthon|mxios/i],describe(t){const e={name:"Maxthon"},r=v.getFirstMatch(z,t)||v.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/epiphany/i],describe(t){const e={name:"Epiphany"},r=v.getFirstMatch(z,t)||v.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/puffin/i],describe(t){const e={name:"Puffin"},r=v.getFirstMatch(z,t)||v.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/sleipnir/i],describe(t){const e={name:"Sleipnir"},r=v.getFirstMatch(z,t)||v.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/k-meleon/i],describe(t){const e={name:"K-Meleon"},r=v.getFirstMatch(z,t)||v.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/micromessenger/i],describe(t){const e={name:"WeChat"},r=v.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/qqbrowser/i],describe(t){const e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},r=v.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/msie|trident/i],describe(t){const e={name:"Internet Explorer"},r=v.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/\sedg\//i],describe(t){const e={name:"Microsoft Edge"},r=v.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/edg([ea]|ios)/i],describe(t){const e={name:"Microsoft Edge"},r=v.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/vivaldi/i],describe(t){const e={name:"Vivaldi"},r=v.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/seamonkey/i],describe(t){const e={name:"SeaMonkey"},r=v.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/sailfish/i],describe(t){const e={name:"Sailfish"},r=v.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return r&&(e.version=r),e}},{test:[/silk/i],describe(t){const e={name:"Amazon Silk"},r=v.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/phantom/i],describe(t){const e={name:"PhantomJS"},r=v.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/slimerjs/i],describe(t){const e={name:"SlimerJS"},r=v.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e={name:"BlackBerry"},r=v.getFirstMatch(z,t)||v.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/(web|hpw)[o0]s/i],describe(t){const e={name:"WebOS Browser"},r=v.getFirstMatch(z,t)||v.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/bada/i],describe(t){const e={name:"Bada"},r=v.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/tizen/i],describe(t){const e={name:"Tizen"},r=v.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/qupzilla/i],describe(t){const e={name:"QupZilla"},r=v.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/firefox|iceweasel|fxios/i],describe(t){const e={name:"Firefox"},r=v.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/electron/i],describe(t){const e={name:"Electron"},r=v.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/MiuiBrowser/i],describe(t){const e={name:"Miui"},r=v.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/chromium/i],describe(t){const e={name:"Chromium"},r=v.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/chrome|crios|crmo/i],describe(t){const e={name:"Chrome"},r=v.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/GSA/i],describe(t){const e={name:"Google Search"},r=v.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test(t){const e=!t.test(/like android/i),r=t.test(/android/i);return e&&r},describe(t){const e={name:"Android Browser"},r=v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/playstation 4/i],describe(t){const e={name:"PlayStation 4"},r=v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/safari|applewebkit/i],describe(t){const e={name:"Safari"},r=v.getFirstMatch(z,t);return r&&(e.version=r),e}},{test:[/.*/i],describe(t){const e=/^(.*)\/(.*) /,r=/^(.*)\/(.*)[ \t]\((.*)/,n=t.search("\\(")!==-1?r:e;return{name:v.getFirstMatch(n,t),version:v.getSecondMatch(n,t)}}}],SE=[{test:[/Roku\/DVP/],describe(t){const e=v.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:Ce.Roku,version:e}}},{test:[/windows phone/i],describe(t){const e=v.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:Ce.WindowsPhone,version:e}}},{test:[/windows /i],describe(t){const e=v.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),r=v.getWindowsVersionName(e);return{name:Ce.Windows,version:e,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(t){const e={name:Ce.iOS},r=v.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return r&&(e.version=r),e}},{test:[/macintosh/i],describe(t){const e=v.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),r=v.getMacOSVersionName(e),s={name:Ce.MacOS,version:e};return r&&(s.versionName=r),s}},{test:[/(ipod|iphone|ipad)/i],describe(t){const e=v.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:Ce.iOS,version:e}}},{test(t){const e=!t.test(/like android/i),r=t.test(/android/i);return e&&r},describe(t){const e=v.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),r=v.getAndroidVersionName(e),s={name:Ce.Android,version:e};return r&&(s.versionName=r),s}},{test:[/(web|hpw)[o0]s/i],describe(t){const e=v.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),r={name:Ce.WebOS};return e&&e.length&&(r.version=e),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e=v.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||v.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||v.getFirstMatch(/\bbb(\d+)/i,t);return{name:Ce.BlackBerry,version:e}}},{test:[/bada/i],describe(t){const e=v.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:Ce.Bada,version:e}}},{test:[/tizen/i],describe(t){const e=v.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:Ce.Tizen,version:e}}},{test:[/linux/i],describe(){return{name:Ce.Linux}}},{test:[/CrOS/],describe(){return{name:Ce.ChromeOS}}},{test:[/PlayStation 4/],describe(t){const e=v.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:Ce.PlayStation4,version:e}}}],xE=[{test:[/googlebot/i],describe(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe(t){const e=v.getFirstMatch(/(can-l01)/i,t)&&"Nova",r={type:te.mobile,vendor:"Huawei"};return e&&(r.model=e),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe(){return{type:te.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe(){return{type:te.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(){return{type:te.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe(){return{type:te.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe(){return{type:te.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe(){return{type:te.tablet}}},{test(t){const e=t.test(/ipod|iphone/i),r=t.test(/like (ipod|iphone)/i);return e&&!r},describe(t){const e=v.getFirstMatch(/(ipod|iphone)/i,t);return{type:te.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe(){return{type:te.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe(){return{type:te.mobile}}},{test(t){return t.getBrowserName(!0)==="blackberry"},describe(){return{type:te.mobile,vendor:"BlackBerry"}}},{test(t){return t.getBrowserName(!0)==="bada"},describe(){return{type:te.mobile}}},{test(t){return t.getBrowserName()==="windows phone"},describe(){return{type:te.mobile,vendor:"Microsoft"}}},{test(t){const e=Number(String(t.getOSVersion()).split(".")[0]);return t.getOSName(!0)==="android"&&e>=3},describe(){return{type:te.tablet}}},{test(t){return t.getOSName(!0)==="android"},describe(){return{type:te.mobile}}},{test(t){return t.getOSName(!0)==="macos"},describe(){return{type:te.desktop,vendor:"Apple"}}},{test(t){return t.getOSName(!0)==="windows"},describe(){return{type:te.desktop}}},{test(t){return t.getOSName(!0)==="linux"},describe(){return{type:te.desktop}}},{test(t){return t.getOSName(!0)==="playstation 4"},describe(){return{type:te.tv}}},{test(t){return t.getOSName(!0)==="roku"},describe(){return{type:te.tv}}}],AE=[{test(t){return t.getBrowserName(!0)==="microsoft edge"},describe(t){if(/\sedg\//i.test(t))return{name:St.Blink};const r=v.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:St.EdgeHTML,version:r}}},{test:[/trident/i],describe(t){const e={name:St.Trident},r=v.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test(t){return t.test(/presto/i)},describe(t){const e={name:St.Presto},r=v.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test(t){const e=t.test(/gecko/i),r=t.test(/like gecko/i);return e&&!r},describe(t){const e={name:St.Gecko},r=v.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/(apple)?webkit\/537\.36/i],describe(){return{name:St.Blink}}},{test:[/(apple)?webkit/i],describe(t){const e={name:St.WebKit},r=v.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}}];class ku{constructor(e,r=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},r!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=v.find(EE,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(s=>this.test(s));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=v.find(SE,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(s=>this.test(s));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:r}=this.getOS();return e?String(r).toLowerCase()||"":r||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:r}=this.getPlatform();return e?String(r).toLowerCase()||"":r||""}parsePlatform(){this.parsedResult.platform={};const e=v.find(xE,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(s=>this.test(s));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=v.find(AE,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(s=>this.test(s));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return v.assign({},this.parsedResult)}satisfies(e){const r={};let s=0;const n={};let i=0;if(Object.keys(e).forEach(a=>{const c=e[a];typeof c=="string"?(n[a]=c,i+=1):typeof c=="object"&&(r[a]=c,s+=1)}),s>0){const a=Object.keys(r),c=v.find(a,l=>this.isOS(l));if(c){const l=this.satisfies(r[c]);if(l!==void 0)return l}const u=v.find(a,l=>this.isPlatform(l));if(u){const l=this.satisfies(r[u]);if(l!==void 0)return l}}if(i>0){const a=Object.keys(n),c=v.find(a,u=>this.isBrowser(u,!0));if(c!==void 0)return this.compareVersion(n[c])}}isBrowser(e,r=!1){const s=this.getBrowserName().toLowerCase();let n=e.toLowerCase();const i=v.getBrowserTypeByAlias(n);return r&&i&&(n=i.toLowerCase()),n===s}compareVersion(e){let r=[0],s=e,n=!1;const i=this.getBrowserVersion();if(typeof i=="string")return e[0]===">"||e[0]==="<"?(s=e.substr(1),e[1]==="="?(n=!0,s=e.substr(2)):r=[],e[0]===">"?r.push(1):r.push(-1)):e[0]==="="?s=e.substr(1):e[0]==="~"&&(n=!0,s=e.substr(1)),r.indexOf(v.compareVersions(i,s,n))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,r=!1){return this.isBrowser(e,r)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(r=>this.is(r))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class Ph{static getParser(e,r=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new ku(e,r)}static parse(e){return new ku(e).getResult()}static get BROWSER_MAP(){return Oh}static get ENGINE_MAP(){return St}static get OS_MAP(){return Ce}static get PLATFORMS_MAP(){return te}}const CE=({serviceId:t,clientVersion:e})=>async()=>{var n,i,o,a,c;const r=typeof window<"u"&&((n=window==null?void 0:window.navigator)!=null&&n.userAgent)?Ph.parse(window.navigator.userAgent):void 0,s=[["aws-sdk-js",e],["ua","2.0"],[`os/${((i=r==null?void 0:r.os)==null?void 0:i.name)||"other"}`,(o=r==null?void 0:r.os)==null?void 0:o.version],["lang/js"],["md/browser",`${((a=r==null?void 0:r.browser)==null?void 0:a.name)??"unknown"}_${((c=r==null?void 0:r.browser)==null?void 0:c.version)??"unknown"}`]];return t&&s.push([`api/${t}`,e]),s};function RE(t){let e=0,r=0,s=null,n=null;const i=a=>{if(typeof a!="number")throw new Error("Attempted to allocate an event message where size was not a number: "+a);e=a,r=4,s=new Uint8Array(a),new DataView(s.buffer).setUint32(0,a,!1)},o=async function*(){const a=t[Symbol.asyncIterator]();for(;;){const{value:c,done:u}=await a.next();if(u){if(e)if(e===r)yield s;else throw new Error("Truncated event message received.");else return;return}const l=c.length;let d=0;for(;d<l;){if(!s){const p=l-d;n||(n=new Uint8Array(4));const g=Math.min(4-r,p);if(n.set(c.slice(d,d+g),r),r+=g,d+=g,r<4)break;i(new DataView(n.buffer).getUint32(0,!1)),n=null}const h=Math.min(e-r,l-d);s.set(c.slice(d,d+h),r),r+=h,d+=h,e&&e===r&&(yield s,s=null,e=0,r=0)}}};return{[Symbol.asyncIterator]:o}}function TE(t,e){return async function(r){const{value:s}=r.headers[":message-type"];if(s==="error"){const n=new Error(r.headers[":error-message"].value||"UnknownError");throw n.name=r.headers[":error-code"].value,n}else if(s==="exception"){const n=r.headers[":exception-type"].value,i={[n]:r},o=await t(i);if(o.$unknown){const a=new Error(e(r.body));throw a.name=n,a}throw o[n]}else if(s==="event"){const n={[r.headers[":event-type"].value]:r},i=await t(n);return i.$unknown?void 0:i}else throw Error(`Unrecognizable event type: ${r.headers[":event-type"].value}`)}}let kE=class{constructor({utf8Encoder:e,utf8Decoder:r}){this.eventStreamCodec=new E0(e,r),this.utfEncoder=e}deserialize(e,r){const s=RE(e);return new A0({messageStream:new S0({inputStream:s,decoder:this.eventStreamCodec}),deserializer:TE(r,this.utfEncoder)})}serialize(e,r){return new x0({messageStream:new C0({inputStream:e,serializer:r}),encoder:this.eventStreamCodec,includeEndFrame:!0})}};const OE=t=>({[Symbol.asyncIterator]:async function*(){const e=t.getReader();try{for(;;){const{done:r,value:s}=await e.read();if(r)return;yield s}}finally{e.releaseLock()}}}),PE=t=>{const e=t[Symbol.asyncIterator]();return new ReadableStream({async pull(r){const{done:s,value:n}=await e.next();if(s)return r.close();r.enqueue(n)}})};class IE{constructor({utf8Encoder:e,utf8Decoder:r}){this.universalMarshaller=new kE({utf8Decoder:r,utf8Encoder:e})}deserialize(e,r){const s=BE(e)?OE(e):e;return this.universalMarshaller.deserialize(s,r)}serialize(e,r){const s=this.universalMarshaller.serialize(e,r);return typeof ReadableStream=="function"?PE(s):s}}const BE=t=>typeof ReadableStream=="function"&&t instanceof ReadableStream,NE=t=>new IE(t);function $E(t,e,r=1024*1024){return new Promise((s,n)=>{const i=new FileReader;i.addEventListener("error",n),i.addEventListener("abort",n);const o=t.size;let a=0;function c(){if(a>=o){s();return}i.readAsArrayBuffer(t.slice(a,Math.min(o,a+r)))}i.addEventListener("load",u=>{const l=u.target.result;e(new Uint8Array(l)),a+=l.byteLength,c()}),c()})}const ME=async function(e,r){const s=new e;return await $E(r,n=>{s.update(n)}),s.digest()},DE=t=>()=>Promise.reject(t),bt=64,FE=16,UE=[1732584193,4023233417,2562383102,271733878];class LE{constructor(){this.reset()}update(e){if(jE(e))return;if(this.finished)throw new Error("Attempted to update an already finished hash.");const r=HE(e);let s=0,{byteLength:n}=r;for(this.bytesHashed+=n;n>0;)this.buffer.setUint8(this.bufferLength++,r[s++]),n--,this.bufferLength===bt&&(this.hashBuffer(),this.bufferLength=0)}async digest(){if(!this.finished){const{buffer:r,bufferLength:s,bytesHashed:n}=this,i=n*8;if(r.setUint8(this.bufferLength++,128),s%bt>=bt-8){for(let o=this.bufferLength;o<bt;o++)r.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(let o=this.bufferLength;o<bt-8;o++)r.setUint8(o,0);r.setUint32(bt-8,i>>>0,!0),r.setUint32(bt-4,Math.floor(i/4294967296),!0),this.hashBuffer(),this.finished=!0}const e=new DataView(new ArrayBuffer(FE));for(let r=0;r<4;r++)e.setUint32(r*4,this.state[r],!0);return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}hashBuffer(){const{buffer:e,state:r}=this;let s=r[0],n=r[1],i=r[2],o=r[3];s=be(s,n,i,o,e.getUint32(0,!0),7,3614090360),o=be(o,s,n,i,e.getUint32(4,!0),12,3905402710),i=be(i,o,s,n,e.getUint32(8,!0),17,606105819),n=be(n,i,o,s,e.getUint32(12,!0),22,3250441966),s=be(s,n,i,o,e.getUint32(16,!0),7,4118548399),o=be(o,s,n,i,e.getUint32(20,!0),12,1200080426),i=be(i,o,s,n,e.getUint32(24,!0),17,2821735955),n=be(n,i,o,s,e.getUint32(28,!0),22,4249261313),s=be(s,n,i,o,e.getUint32(32,!0),7,1770035416),o=be(o,s,n,i,e.getUint32(36,!0),12,2336552879),i=be(i,o,s,n,e.getUint32(40,!0),17,4294925233),n=be(n,i,o,s,e.getUint32(44,!0),22,2304563134),s=be(s,n,i,o,e.getUint32(48,!0),7,1804603682),o=be(o,s,n,i,e.getUint32(52,!0),12,4254626195),i=be(i,o,s,n,e.getUint32(56,!0),17,2792965006),n=be(n,i,o,s,e.getUint32(60,!0),22,1236535329),s=_e(s,n,i,o,e.getUint32(4,!0),5,4129170786),o=_e(o,s,n,i,e.getUint32(24,!0),9,3225465664),i=_e(i,o,s,n,e.getUint32(44,!0),14,643717713),n=_e(n,i,o,s,e.getUint32(0,!0),20,3921069994),s=_e(s,n,i,o,e.getUint32(20,!0),5,3593408605),o=_e(o,s,n,i,e.getUint32(40,!0),9,38016083),i=_e(i,o,s,n,e.getUint32(60,!0),14,3634488961),n=_e(n,i,o,s,e.getUint32(16,!0),20,3889429448),s=_e(s,n,i,o,e.getUint32(36,!0),5,568446438),o=_e(o,s,n,i,e.getUint32(56,!0),9,3275163606),i=_e(i,o,s,n,e.getUint32(12,!0),14,4107603335),n=_e(n,i,o,s,e.getUint32(32,!0),20,1163531501),s=_e(s,n,i,o,e.getUint32(52,!0),5,2850285829),o=_e(o,s,n,i,e.getUint32(8,!0),9,4243563512),i=_e(i,o,s,n,e.getUint32(28,!0),14,1735328473),n=_e(n,i,o,s,e.getUint32(48,!0),20,2368359562),s=ve(s,n,i,o,e.getUint32(20,!0),4,4294588738),o=ve(o,s,n,i,e.getUint32(32,!0),11,2272392833),i=ve(i,o,s,n,e.getUint32(44,!0),16,1839030562),n=ve(n,i,o,s,e.getUint32(56,!0),23,4259657740),s=ve(s,n,i,o,e.getUint32(4,!0),4,2763975236),o=ve(o,s,n,i,e.getUint32(16,!0),11,1272893353),i=ve(i,o,s,n,e.getUint32(28,!0),16,4139469664),n=ve(n,i,o,s,e.getUint32(40,!0),23,3200236656),s=ve(s,n,i,o,e.getUint32(52,!0),4,681279174),o=ve(o,s,n,i,e.getUint32(0,!0),11,3936430074),i=ve(i,o,s,n,e.getUint32(12,!0),16,3572445317),n=ve(n,i,o,s,e.getUint32(24,!0),23,76029189),s=ve(s,n,i,o,e.getUint32(36,!0),4,3654602809),o=ve(o,s,n,i,e.getUint32(48,!0),11,3873151461),i=ve(i,o,s,n,e.getUint32(60,!0),16,530742520),n=ve(n,i,o,s,e.getUint32(8,!0),23,3299628645),s=Ee(s,n,i,o,e.getUint32(0,!0),6,4096336452),o=Ee(o,s,n,i,e.getUint32(28,!0),10,1126891415),i=Ee(i,o,s,n,e.getUint32(56,!0),15,2878612391),n=Ee(n,i,o,s,e.getUint32(20,!0),21,4237533241),s=Ee(s,n,i,o,e.getUint32(48,!0),6,1700485571),o=Ee(o,s,n,i,e.getUint32(12,!0),10,2399980690),i=Ee(i,o,s,n,e.getUint32(40,!0),15,4293915773),n=Ee(n,i,o,s,e.getUint32(4,!0),21,2240044497),s=Ee(s,n,i,o,e.getUint32(32,!0),6,1873313359),o=Ee(o,s,n,i,e.getUint32(60,!0),10,4264355552),i=Ee(i,o,s,n,e.getUint32(24,!0),15,2734768916),n=Ee(n,i,o,s,e.getUint32(52,!0),21,1309151649),s=Ee(s,n,i,o,e.getUint32(16,!0),6,4149444226),o=Ee(o,s,n,i,e.getUint32(44,!0),10,3174756917),i=Ee(i,o,s,n,e.getUint32(8,!0),15,718787259),n=Ee(n,i,o,s,e.getUint32(36,!0),21,3951481745),r[0]=s+r[0]&4294967295,r[1]=n+r[1]&4294967295,r[2]=i+r[2]&4294967295,r[3]=o+r[3]&4294967295}reset(){this.state=Uint32Array.from(UE),this.buffer=new DataView(new ArrayBuffer(bt)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}}function Dn(t,e,r,s,n,i){return e=(e+t&4294967295)+(s+i&4294967295)&4294967295,(e<<n|e>>>32-n)+r&4294967295}function be(t,e,r,s,n,i,o){return Dn(e&r|~e&s,t,e,n,i,o)}function _e(t,e,r,s,n,i,o){return Dn(e&s|r&~s,t,e,n,i,o)}function ve(t,e,r,s,n,i,o){return Dn(e^r^s,t,e,n,i,o)}function Ee(t,e,r,s,n,i,o){return Dn(r^(e|~s),t,e,n,i,o)}function jE(t){return typeof t=="string"?t.length===0:t.byteLength===0}function HE(t){return typeof t=="string"?gs(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}const Ou=typeof TextEncoder=="function"?new TextEncoder:null,zE=t=>{if(typeof t=="string"){if(Ou)return Ou.encode(t).byteLength;let e=t.length;for(let r=e-1;r>=0;r--){const s=t.charCodeAt(r);s>127&&s<=2047?e++:s>2047&&s<=65535&&(e+=2),s>=56320&&s<=57343&&r--}return e}else{if(typeof t.byteLength=="number")return t.byteLength;if(typeof t.size=="number")return t.size}throw new Error(`Body Length computation failed for ${t}`)},qE={CrtSignerV4:null};class KE{constructor(e){this.sigv4Signer=new Q0(e),this.signerOptions=e}async sign(e,r={}){if(r.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().sign(e,r)}return this.sigv4Signer.sign(e,r)}async signWithCredentials(e,r,s={}){if(s.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().signWithCredentials(e,r,s)}return this.sigv4Signer.signWithCredentials(e,r,s)}async presign(e,r={}){if(r.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().presign(e,r)}return this.sigv4Signer.presign(e,r)}async presignWithCredentials(e,r,s={}){if(s.signingRegion==="*")throw new Error("Method presignWithCredentials is not supported for [signingRegion=*].");return this.sigv4Signer.presignWithCredentials(e,r,s)}getSigv4aSigner(){if(!this.sigv4aSigner){let e=null;try{if(e=qE.CrtSignerV4,typeof e!="function")throw new Error}catch(r){throw r.message=`${r.message}
Please check whether you have installed the "@aws-sdk/signature-v4-crt" package explicitly. 
You must also register the package by calling [require("@aws-sdk/signature-v4-crt");] or an ESM equivalent such as [import "@aws-sdk/signature-v4-crt";]. 
For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt`,r}this.sigv4aSigner=new e({...this.signerOptions,signingAlgorithm:1})}return this.sigv4aSigner}}const Pa="required",f="type",m="conditions",b="fn",_="argv",P="ref",Q="assign",A="url",C="properties",Ih="backend",it="authSchemes",ot="disableDoubleEncoding",at="signingName",ht="signingRegion",R="headers",GE=!1,Je=!0,Ge="isSet",ye="booleanEquals",T="error",an="aws.partition",X="stringEquals",ne="getAttr",Ue="name",ut="substring",Pu="bucketSuffix",Bh="parseURL",Iu="{url#scheme}://{url#authority}/{uri_encoded_bucket}{url#path}",S="endpoint",E="tree",Nh="aws.isVirtualHostableS3Bucket",zs="{url#scheme}://{Bucket}.{url#authority}{url#path}",lt="not",qs="{url#scheme}://{url#authority}{url#path}",$h="hardwareType",Mh="regionPrefix",Bu="bucketAliasSuffix",Co="outpostId",Yt="isValidHostLabel",Ia="s3-outposts",yr="s3",Dh="{url#scheme}://{url#authority}{url#normalizedPath}{Bucket}",Fh="https://{Bucket}.s3-accelerate.{partitionResult#dnsSuffix}",Nu="https://{Bucket}.s3.{partitionResult#dnsSuffix}",Uh="aws.parseArn",Lh="bucketArn",jh="arnType",cn="",Ba="s3-object-lambda",Hh="accesspoint",Na="accessPointName",$u="{url#scheme}://{accessPointName}-{bucketArn#accountId}.{url#authority}{url#path}",Mu="mrapPartition",Du="outpostType",Fu="arnPrefix",zh="{url#scheme}://{url#authority}{url#normalizedPath}{uri_encoded_bucket}",Uu="https://s3.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",Lu="https://s3.{partitionResult#dnsSuffix}",Gr={[Pa]:!1,[f]:"String"},nr={[Pa]:!0,default:!1,[f]:"Boolean"},Vr={[Pa]:!1,[f]:"Boolean"},Ye={[b]:ye,[_]:[{[P]:"Accelerate"},!0]},W={[b]:ye,[_]:[{[P]:"UseFIPS"},!0]},V={[b]:ye,[_]:[{[P]:"UseDualStack"},!0]},ce={[b]:Ge,[_]:[{[P]:"Endpoint"}]},qh={[b]:an,[_]:[{[P]:"Region"}],[Q]:"partitionResult"},ju={[b]:X,[_]:[{[b]:ne,[_]:[{[P]:"partitionResult"},Ue]},"aws-cn"]},un={[b]:Ge,[_]:[{[P]:"Bucket"}]},Oe={[P]:"Bucket"},Re={[b]:Bh,[_]:[{[P]:"Endpoint"}],[Q]:"url"},Ks={[b]:ye,[_]:[{[b]:ne,[_]:[{[P]:"url"},"isIp"]},!0]},Kh={[P]:"url"},Gh={[b]:"uriEncode",[_]:[Oe],[Q]:"uri_encoded_bucket"},gt={[Ih]:"S3Express",[it]:[{[ot]:!0,[Ue]:"sigv4",[at]:"s3express",[ht]:"{Region}"}]},I={},Vh={[b]:Nh,[_]:[Oe,!1]},Ni={[T]:"S3Express bucket name is not a valid virtual hostable name.",[f]:T},ln={[Ih]:"S3Express",[it]:[{[ot]:!0,[Ue]:"sigv4-s3express",[at]:"s3express",[ht]:"{Region}"}]},Hu={[b]:Ge,[_]:[{[P]:"UseS3ExpressControlEndpoint"}]},zu={[b]:ye,[_]:[{[P]:"UseS3ExpressControlEndpoint"},!0]},N={[b]:lt,[_]:[ce]},qu={[T]:"Unrecognized S3Express bucket name format.",[f]:T},Ku={[b]:lt,[_]:[un]},Gu={[P]:$h},Vu={[m]:[N],[T]:"Expected a endpoint to be specified but no endpoint was found",[f]:T},Ns={[it]:[{[ot]:!0,[Ue]:"sigv4",[at]:Ia,[ht]:"{Region}"}]},$i={[b]:ye,[_]:[{[P]:"ForcePathStyle"},!1]},VE={[P]:"ForcePathStyle"},ae={[b]:ye,[_]:[{[P]:"Accelerate"},!1]},de={[b]:X,[_]:[{[P]:"Region"},"aws-global"]},fe={[it]:[{[ot]:!0,[Ue]:"sigv4",[at]:yr,[ht]:"us-east-1"}]},L={[b]:lt,[_]:[de]},pe={[b]:ye,[_]:[{[P]:"UseGlobalEndpoint"},!0]},Wu={[A]:"https://{Bucket}.s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[C]:{[it]:[{[ot]:!0,[Ue]:"sigv4",[at]:yr,[ht]:"{Region}"}]},[R]:{}},le={[it]:[{[ot]:!0,[Ue]:"sigv4",[at]:yr,[ht]:"{Region}"}]},ge={[b]:ye,[_]:[{[P]:"UseGlobalEndpoint"},!1]},F={[b]:ye,[_]:[{[P]:"UseDualStack"},!1]},Ju={[A]:"https://{Bucket}.s3-fips.{Region}.{partitionResult#dnsSuffix}",[C]:le,[R]:{}},M={[b]:ye,[_]:[{[P]:"UseFIPS"},!1]},Xu={[A]:"https://{Bucket}.s3-accelerate.dualstack.{partitionResult#dnsSuffix}",[C]:le,[R]:{}},Yu={[A]:"https://{Bucket}.s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[C]:le,[R]:{}},Mi={[b]:ye,[_]:[{[b]:ne,[_]:[Kh,"isIp"]},!1]},Di={[A]:Dh,[C]:le,[R]:{}},Ro={[A]:zs,[C]:le,[R]:{}},Zu={[S]:Ro,[f]:S},Fi={[A]:Fh,[C]:le,[R]:{}},Qu={[A]:"https://{Bucket}.s3.{Region}.{partitionResult#dnsSuffix}",[C]:le,[R]:{}},$s={[T]:"Invalid region: region was not a valid DNS name.",[f]:T},Me={[P]:Lh},Wh={[P]:jh},Ui={[b]:ne,[_]:[Me,"service"]},$a={[P]:Na},el={[m]:[V],[T]:"S3 Object Lambda does not support Dual-stack",[f]:T},tl={[m]:[Ye],[T]:"S3 Object Lambda does not support S3 Accelerate",[f]:T},rl={[m]:[{[b]:Ge,[_]:[{[P]:"DisableAccessPoints"}]},{[b]:ye,[_]:[{[P]:"DisableAccessPoints"},!0]}],[T]:"Access points are not supported for this operation",[f]:T},Li={[m]:[{[b]:Ge,[_]:[{[P]:"UseArnRegion"}]},{[b]:ye,[_]:[{[P]:"UseArnRegion"},!1]},{[b]:lt,[_]:[{[b]:X,[_]:[{[b]:ne,[_]:[Me,"region"]},"{Region}"]}]}],[T]:"Invalid configuration: region from ARN `{bucketArn#region}` does not match client region `{Region}` and UseArnRegion is `false`",[f]:T},Jh={[b]:ne,[_]:[{[P]:"bucketPartition"},Ue]},Xh={[b]:ne,[_]:[Me,"accountId"]},ji={[it]:[{[ot]:!0,[Ue]:"sigv4",[at]:Ba,[ht]:"{bucketArn#region}"}]},sl={[T]:"Invalid ARN: The access point name may only contain a-z, A-Z, 0-9 and `-`. Found: `{accessPointName}`",[f]:T},Hi={[T]:"Invalid ARN: The account id may only contain a-z, A-Z, 0-9 and `-`. Found: `{bucketArn#accountId}`",[f]:T},zi={[T]:"Invalid region in ARN: `{bucketArn#region}` (invalid DNS name)",[f]:T},qi={[T]:"Client was configured for partition `{partitionResult#name}` but ARN (`{Bucket}`) has `{bucketPartition#name}`",[f]:T},nl={[T]:"Invalid ARN: The ARN may only contain a single resource component after `accesspoint`.",[f]:T},il={[T]:"Invalid ARN: Expected a resource of the format `accesspoint:<accesspoint name>` but no name was provided",[f]:T},Wr={[it]:[{[ot]:!0,[Ue]:"sigv4",[at]:yr,[ht]:"{bucketArn#region}"}]},ol={[it]:[{[ot]:!0,[Ue]:"sigv4",[at]:Ia,[ht]:"{bucketArn#region}"}]},al={[b]:Uh,[_]:[Oe]},cl={[A]:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[C]:le,[R]:{}},ul={[A]:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[C]:le,[R]:{}},ll={[A]:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[C]:le,[R]:{}},Ki={[A]:zh,[C]:le,[R]:{}},dl={[A]:"https://s3.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[C]:le,[R]:{}},hl={[P]:"UseObjectLambdaEndpoint"},Gi={[it]:[{[ot]:!0,[Ue]:"sigv4",[at]:Ba,[ht]:"{Region}"}]},fl={[A]:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[C]:le,[R]:{}},pl={[A]:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}",[C]:le,[R]:{}},gl={[A]:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[C]:le,[R]:{}},Vi={[A]:qs,[C]:le,[R]:{}},ml={[A]:"https://s3.{Region}.{partitionResult#dnsSuffix}",[C]:le,[R]:{}},Wi=[{[P]:"Region"}],WE=[{[P]:"Endpoint"}],JE=[Oe],Ji=[V],Ms=[Ye],Ft=[ce,Re],yl=[{[b]:Ge,[_]:[{[P]:"DisableS3ExpressSessionAuth"}]},{[b]:ye,[_]:[{[P]:"DisableS3ExpressSessionAuth"},!0]}],wl=[Ks],Xi=[Gh],Yi=[Vh],ir=[W],bl=[{[b]:ut,[_]:[Oe,6,14,!0],[Q]:"s3expressAvailabilityZoneId"},{[b]:ut,[_]:[Oe,14,16,!0],[Q]:"s3expressAvailabilityZoneDelim"},{[b]:X,[_]:[{[P]:"s3expressAvailabilityZoneDelim"},"--"]}],_l=[{[m]:[W],[S]:{[A]:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.{Region}.amazonaws.com",[C]:gt,[R]:{}},[f]:S},{[S]:{[A]:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.{Region}.amazonaws.com",[C]:gt,[R]:{}},[f]:S}],vl=[{[b]:ut,[_]:[Oe,6,15,!0],[Q]:"s3expressAvailabilityZoneId"},{[b]:ut,[_]:[Oe,15,17,!0],[Q]:"s3expressAvailabilityZoneDelim"},{[b]:X,[_]:[{[P]:"s3expressAvailabilityZoneDelim"},"--"]}],El=[{[m]:[W],[S]:{[A]:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.{Region}.amazonaws.com",[C]:ln,[R]:{}},[f]:S},{[S]:{[A]:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.{Region}.amazonaws.com",[C]:ln,[R]:{}},[f]:S}],XE=[un],Sl=[{[b]:Yt,[_]:[{[P]:Co},!1]}],xl=[{[b]:X,[_]:[{[P]:Mh},"beta"]}],_t=[qh],Al=[{[b]:Yt,[_]:[{[P]:"Region"},!1]}],vt=[{[b]:X,[_]:[{[P]:"Region"},"us-east-1"]}],Zi=[{[b]:X,[_]:[Wh,Hh]}],Cl=[{[b]:ne,[_]:[Me,"resourceId[1]"],[Q]:Na},{[b]:lt,[_]:[{[b]:X,[_]:[$a,cn]}]}],YE=[Me,"resourceId[1]"],Qi=[{[b]:lt,[_]:[{[b]:X,[_]:[{[b]:ne,[_]:[Me,"region"]},cn]}]}],Rl=[{[b]:lt,[_]:[{[b]:Ge,[_]:[{[b]:ne,[_]:[Me,"resourceId[2]"]}]}]}],ZE=[Me,"resourceId[2]"],eo=[{[b]:an,[_]:[{[b]:ne,[_]:[Me,"region"]}],[Q]:"bucketPartition"}],Tl=[{[b]:X,[_]:[Jh,{[b]:ne,[_]:[{[P]:"partitionResult"},Ue]}]}],to=[{[b]:Yt,[_]:[{[b]:ne,[_]:[Me,"region"]},!0]}],ro=[{[b]:Yt,[_]:[Xh,!1]}],kl=[{[b]:Yt,[_]:[$a,!1]}],Ol=[{[b]:Yt,[_]:[{[P]:"Region"},!0]}],QE={version:"1.0",parameters:{Bucket:Gr,Region:Gr,UseFIPS:nr,UseDualStack:nr,Endpoint:Gr,ForcePathStyle:nr,Accelerate:nr,UseGlobalEndpoint:nr,UseObjectLambdaEndpoint:Vr,Key:Gr,Prefix:Gr,DisableAccessPoints:Vr,DisableMultiRegionAccessPoints:nr,UseArnRegion:Vr,UseS3ExpressControlEndpoint:Vr,DisableS3ExpressSessionAuth:Vr},rules:[{[m]:[{[b]:Ge,[_]:Wi}],rules:[{[m]:[Ye,W],error:"Accelerate cannot be used with FIPS",[f]:T},{[m]:[V,ce],error:"Cannot set dual-stack in combination with a custom endpoint.",[f]:T},{[m]:[ce,W],error:"A custom endpoint cannot be combined with FIPS",[f]:T},{[m]:[ce,Ye],error:"A custom endpoint cannot be combined with S3 Accelerate",[f]:T},{[m]:[W,qh,ju],error:"Partition does not support FIPS",[f]:T},{[m]:[un,{[b]:ut,[_]:[Oe,0,6,Je],[Q]:Pu},{[b]:X,[_]:[{[P]:Pu},"--x-s3"]}],rules:[{[m]:Ji,error:"S3Express does not support Dual-stack.",[f]:T},{[m]:Ms,error:"S3Express does not support S3 Accelerate.",[f]:T},{[m]:Ft,rules:[{[m]:yl,rules:[{[m]:wl,rules:[{[m]:Xi,rules:[{endpoint:{[A]:Iu,[C]:gt,[R]:I},[f]:S}],[f]:E}],[f]:E},{[m]:Yi,rules:[{endpoint:{[A]:zs,[C]:gt,[R]:I},[f]:S}],[f]:E},Ni],[f]:E},{[m]:wl,rules:[{[m]:Xi,rules:[{endpoint:{[A]:Iu,[C]:ln,[R]:I},[f]:S}],[f]:E}],[f]:E},{[m]:Yi,rules:[{endpoint:{[A]:zs,[C]:ln,[R]:I},[f]:S}],[f]:E},Ni],[f]:E},{[m]:[Hu,zu],rules:[{[m]:[Gh,N],rules:[{[m]:ir,endpoint:{[A]:"https://s3express-control-fips.{Region}.amazonaws.com/{uri_encoded_bucket}",[C]:gt,[R]:I},[f]:S},{endpoint:{[A]:"https://s3express-control.{Region}.amazonaws.com/{uri_encoded_bucket}",[C]:gt,[R]:I},[f]:S}],[f]:E}],[f]:E},{[m]:Yi,rules:[{[m]:yl,rules:[{[m]:bl,rules:_l,[f]:E},{[m]:vl,rules:_l,[f]:E},qu],[f]:E},{[m]:bl,rules:El,[f]:E},{[m]:vl,rules:El,[f]:E},qu],[f]:E},Ni],[f]:E},{[m]:[Ku,Hu,zu],rules:[{[m]:Ft,endpoint:{[A]:qs,[C]:gt,[R]:I},[f]:S},{[m]:ir,endpoint:{[A]:"https://s3express-control-fips.{Region}.amazonaws.com",[C]:gt,[R]:I},[f]:S},{endpoint:{[A]:"https://s3express-control.{Region}.amazonaws.com",[C]:gt,[R]:I},[f]:S}],[f]:E},{[m]:[un,{[b]:ut,[_]:[Oe,49,50,Je],[Q]:$h},{[b]:ut,[_]:[Oe,8,12,Je],[Q]:Mh},{[b]:ut,[_]:[Oe,0,7,Je],[Q]:Bu},{[b]:ut,[_]:[Oe,32,49,Je],[Q]:Co},{[b]:an,[_]:Wi,[Q]:"regionPartition"},{[b]:X,[_]:[{[P]:Bu},"--op-s3"]}],rules:[{[m]:Sl,rules:[{[m]:[{[b]:X,[_]:[Gu,"e"]}],rules:[{[m]:xl,rules:[Vu,{[m]:Ft,endpoint:{[A]:"https://{Bucket}.ec2.{url#authority}",[C]:Ns,[R]:I},[f]:S}],[f]:E},{endpoint:{[A]:"https://{Bucket}.ec2.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[C]:Ns,[R]:I},[f]:S}],[f]:E},{[m]:[{[b]:X,[_]:[Gu,"o"]}],rules:[{[m]:xl,rules:[Vu,{[m]:Ft,endpoint:{[A]:"https://{Bucket}.op-{outpostId}.{url#authority}",[C]:Ns,[R]:I},[f]:S}],[f]:E},{endpoint:{[A]:"https://{Bucket}.op-{outpostId}.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[C]:Ns,[R]:I},[f]:S}],[f]:E},{error:'Unrecognized hardware type: "Expected hardware type o or e but got {hardwareType}"',[f]:T}],[f]:E},{error:"Invalid ARN: The outpost Id must only contain a-z, A-Z, 0-9 and `-`.",[f]:T}],[f]:E},{[m]:XE,rules:[{[m]:[ce,{[b]:lt,[_]:[{[b]:Ge,[_]:[{[b]:Bh,[_]:WE}]}]}],error:"Custom endpoint `{Endpoint}` was not a valid URI",[f]:T},{[m]:[$i,Vh],rules:[{[m]:_t,rules:[{[m]:Al,rules:[{[m]:[Ye,ju],error:"S3 Accelerate cannot be used in this region",[f]:T},{[m]:[V,W,ae,N,de],endpoint:{[A]:"https://{Bucket}.s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[C]:fe,[R]:I},[f]:S},{[m]:[V,W,ae,N,L,pe],rules:[{endpoint:Wu,[f]:S}],[f]:E},{[m]:[V,W,ae,N,L,ge],endpoint:Wu,[f]:S},{[m]:[F,W,ae,N,de],endpoint:{[A]:"https://{Bucket}.s3-fips.us-east-1.{partitionResult#dnsSuffix}",[C]:fe,[R]:I},[f]:S},{[m]:[F,W,ae,N,L,pe],rules:[{endpoint:Ju,[f]:S}],[f]:E},{[m]:[F,W,ae,N,L,ge],endpoint:Ju,[f]:S},{[m]:[V,M,Ye,N,de],endpoint:{[A]:"https://{Bucket}.s3-accelerate.dualstack.us-east-1.{partitionResult#dnsSuffix}",[C]:fe,[R]:I},[f]:S},{[m]:[V,M,Ye,N,L,pe],rules:[{endpoint:Xu,[f]:S}],[f]:E},{[m]:[V,M,Ye,N,L,ge],endpoint:Xu,[f]:S},{[m]:[V,M,ae,N,de],endpoint:{[A]:"https://{Bucket}.s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[C]:fe,[R]:I},[f]:S},{[m]:[V,M,ae,N,L,pe],rules:[{endpoint:Yu,[f]:S}],[f]:E},{[m]:[V,M,ae,N,L,ge],endpoint:Yu,[f]:S},{[m]:[F,M,ae,ce,Re,Ks,de],endpoint:{[A]:Dh,[C]:fe,[R]:I},[f]:S},{[m]:[F,M,ae,ce,Re,Mi,de],endpoint:{[A]:zs,[C]:fe,[R]:I},[f]:S},{[m]:[F,M,ae,ce,Re,Ks,L,pe],rules:[{[m]:vt,endpoint:Di,[f]:S},{endpoint:Di,[f]:S}],[f]:E},{[m]:[F,M,ae,ce,Re,Mi,L,pe],rules:[{[m]:vt,endpoint:Ro,[f]:S},Zu],[f]:E},{[m]:[F,M,ae,ce,Re,Ks,L,ge],endpoint:Di,[f]:S},{[m]:[F,M,ae,ce,Re,Mi,L,ge],endpoint:Ro,[f]:S},{[m]:[F,M,Ye,N,de],endpoint:{[A]:Fh,[C]:fe,[R]:I},[f]:S},{[m]:[F,M,Ye,N,L,pe],rules:[{[m]:vt,endpoint:Fi,[f]:S},{endpoint:Fi,[f]:S}],[f]:E},{[m]:[F,M,Ye,N,L,ge],endpoint:Fi,[f]:S},{[m]:[F,M,ae,N,de],endpoint:{[A]:Nu,[C]:fe,[R]:I},[f]:S},{[m]:[F,M,ae,N,L,pe],rules:[{[m]:vt,endpoint:{[A]:Nu,[C]:le,[R]:I},[f]:S},{endpoint:Qu,[f]:S}],[f]:E},{[m]:[F,M,ae,N,L,ge],endpoint:Qu,[f]:S}],[f]:E},$s],[f]:E}],[f]:E},{[m]:[ce,Re,{[b]:X,[_]:[{[b]:ne,[_]:[Kh,"scheme"]},"http"]},{[b]:Nh,[_]:[Oe,Je]},$i,M,F,ae],rules:[{[m]:_t,rules:[{[m]:Al,rules:[Zu],[f]:E},$s],[f]:E}],[f]:E},{[m]:[$i,{[b]:Uh,[_]:JE,[Q]:Lh}],rules:[{[m]:[{[b]:ne,[_]:[Me,"resourceId[0]"],[Q]:jh},{[b]:lt,[_]:[{[b]:X,[_]:[Wh,cn]}]}],rules:[{[m]:[{[b]:X,[_]:[Ui,Ba]}],rules:[{[m]:Zi,rules:[{[m]:Cl,rules:[el,tl,{[m]:Qi,rules:[rl,{[m]:Rl,rules:[Li,{[m]:eo,rules:[{[m]:_t,rules:[{[m]:Tl,rules:[{[m]:to,rules:[{[m]:[{[b]:X,[_]:[Xh,cn]}],error:"Invalid ARN: Missing account id",[f]:T},{[m]:ro,rules:[{[m]:kl,rules:[{[m]:Ft,endpoint:{[A]:$u,[C]:ji,[R]:I},[f]:S},{[m]:ir,endpoint:{[A]:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[C]:ji,[R]:I},[f]:S},{endpoint:{[A]:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda.{bucketArn#region}.{bucketPartition#dnsSuffix}",[C]:ji,[R]:I},[f]:S}],[f]:E},sl],[f]:E},Hi],[f]:E},zi],[f]:E},qi],[f]:E}],[f]:E}],[f]:E},nl],[f]:E},{error:"Invalid ARN: bucket ARN is missing a region",[f]:T}],[f]:E},il],[f]:E},{error:"Invalid ARN: Object Lambda ARNs only support `accesspoint` arn types, but found: `{arnType}`",[f]:T}],[f]:E},{[m]:Zi,rules:[{[m]:Cl,rules:[{[m]:Qi,rules:[{[m]:Zi,rules:[{[m]:Qi,rules:[rl,{[m]:Rl,rules:[Li,{[m]:eo,rules:[{[m]:_t,rules:[{[m]:[{[b]:X,[_]:[Jh,"{partitionResult#name}"]}],rules:[{[m]:to,rules:[{[m]:[{[b]:X,[_]:[Ui,yr]}],rules:[{[m]:ro,rules:[{[m]:kl,rules:[{[m]:Ms,error:"Access Points do not support S3 Accelerate",[f]:T},{[m]:[W,V],endpoint:{[A]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[C]:Wr,[R]:I},[f]:S},{[m]:[W,F],endpoint:{[A]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[C]:Wr,[R]:I},[f]:S},{[m]:[M,V],endpoint:{[A]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[C]:Wr,[R]:I},[f]:S},{[m]:[M,F,ce,Re],endpoint:{[A]:$u,[C]:Wr,[R]:I},[f]:S},{[m]:[M,F],endpoint:{[A]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.{bucketArn#region}.{bucketPartition#dnsSuffix}",[C]:Wr,[R]:I},[f]:S}],[f]:E},sl],[f]:E},Hi],[f]:E},{error:"Invalid ARN: The ARN was not for the S3 service, found: {bucketArn#service}",[f]:T}],[f]:E},zi],[f]:E},qi],[f]:E}],[f]:E}],[f]:E},nl],[f]:E}],[f]:E}],[f]:E},{[m]:[{[b]:Yt,[_]:[$a,Je]}],rules:[{[m]:Ji,error:"S3 MRAP does not support dual-stack",[f]:T},{[m]:ir,error:"S3 MRAP does not support FIPS",[f]:T},{[m]:Ms,error:"S3 MRAP does not support S3 Accelerate",[f]:T},{[m]:[{[b]:ye,[_]:[{[P]:"DisableMultiRegionAccessPoints"},Je]}],error:"Invalid configuration: Multi-Region Access Point ARNs are disabled.",[f]:T},{[m]:[{[b]:an,[_]:Wi,[Q]:Mu}],rules:[{[m]:[{[b]:X,[_]:[{[b]:ne,[_]:[{[P]:Mu},Ue]},{[b]:ne,[_]:[Me,"partition"]}]}],rules:[{endpoint:{[A]:"https://{accessPointName}.accesspoint.s3-global.{mrapPartition#dnsSuffix}",[C]:{[it]:[{[ot]:Je,name:"sigv4a",[at]:yr,signingRegionSet:["*"]}]},[R]:I},[f]:S}],[f]:E},{error:"Client was configured for partition `{mrapPartition#name}` but bucket referred to partition `{bucketArn#partition}`",[f]:T}],[f]:E}],[f]:E},{error:"Invalid Access Point Name",[f]:T}],[f]:E},il],[f]:E},{[m]:[{[b]:X,[_]:[Ui,Ia]}],rules:[{[m]:Ji,error:"S3 Outposts does not support Dual-stack",[f]:T},{[m]:ir,error:"S3 Outposts does not support FIPS",[f]:T},{[m]:Ms,error:"S3 Outposts does not support S3 Accelerate",[f]:T},{[m]:[{[b]:Ge,[_]:[{[b]:ne,[_]:[Me,"resourceId[4]"]}]}],error:"Invalid Arn: Outpost Access Point ARN contains sub resources",[f]:T},{[m]:[{[b]:ne,[_]:YE,[Q]:Co}],rules:[{[m]:Sl,rules:[Li,{[m]:eo,rules:[{[m]:_t,rules:[{[m]:Tl,rules:[{[m]:to,rules:[{[m]:ro,rules:[{[m]:[{[b]:ne,[_]:ZE,[Q]:Du}],rules:[{[m]:[{[b]:ne,[_]:[Me,"resourceId[3]"],[Q]:Na}],rules:[{[m]:[{[b]:X,[_]:[{[P]:Du},Hh]}],rules:[{[m]:Ft,endpoint:{[A]:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.{url#authority}",[C]:ol,[R]:I},[f]:S},{endpoint:{[A]:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.s3-outposts.{bucketArn#region}.{bucketPartition#dnsSuffix}",[C]:ol,[R]:I},[f]:S}],[f]:E},{error:"Expected an outpost type `accesspoint`, found {outpostType}",[f]:T}],[f]:E},{error:"Invalid ARN: expected an access point name",[f]:T}],[f]:E},{error:"Invalid ARN: Expected a 4-component resource",[f]:T}],[f]:E},Hi],[f]:E},zi],[f]:E},qi],[f]:E}],[f]:E}],[f]:E},{error:"Invalid ARN: The outpost Id may only contain a-z, A-Z, 0-9 and `-`. Found: `{outpostId}`",[f]:T}],[f]:E},{error:"Invalid ARN: The Outpost Id was not set",[f]:T}],[f]:E},{error:"Invalid ARN: Unrecognized format: {Bucket} (type: {arnType})",[f]:T}],[f]:E},{error:"Invalid ARN: No ARN type specified",[f]:T}],[f]:E},{[m]:[{[b]:ut,[_]:[Oe,0,4,GE],[Q]:Fu},{[b]:X,[_]:[{[P]:Fu},"arn:"]},{[b]:lt,[_]:[{[b]:Ge,[_]:[al]}]}],error:"Invalid ARN: `{Bucket}` was not a valid ARN",[f]:T},{[m]:[{[b]:ye,[_]:[VE,Je]},al],error:"Path-style addressing cannot be used with ARN buckets",[f]:T},{[m]:Xi,rules:[{[m]:_t,rules:[{[m]:[ae],rules:[{[m]:[V,N,W,de],endpoint:{[A]:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[C]:fe,[R]:I},[f]:S},{[m]:[V,N,W,L,pe],rules:[{endpoint:cl,[f]:S}],[f]:E},{[m]:[V,N,W,L,ge],endpoint:cl,[f]:S},{[m]:[F,N,W,de],endpoint:{[A]:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[C]:fe,[R]:I},[f]:S},{[m]:[F,N,W,L,pe],rules:[{endpoint:ul,[f]:S}],[f]:E},{[m]:[F,N,W,L,ge],endpoint:ul,[f]:S},{[m]:[V,N,M,de],endpoint:{[A]:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[C]:fe,[R]:I},[f]:S},{[m]:[V,N,M,L,pe],rules:[{endpoint:ll,[f]:S}],[f]:E},{[m]:[V,N,M,L,ge],endpoint:ll,[f]:S},{[m]:[F,ce,Re,M,de],endpoint:{[A]:zh,[C]:fe,[R]:I},[f]:S},{[m]:[F,ce,Re,M,L,pe],rules:[{[m]:vt,endpoint:Ki,[f]:S},{endpoint:Ki,[f]:S}],[f]:E},{[m]:[F,ce,Re,M,L,ge],endpoint:Ki,[f]:S},{[m]:[F,N,M,de],endpoint:{[A]:Uu,[C]:fe,[R]:I},[f]:S},{[m]:[F,N,M,L,pe],rules:[{[m]:vt,endpoint:{[A]:Uu,[C]:le,[R]:I},[f]:S},{endpoint:dl,[f]:S}],[f]:E},{[m]:[F,N,M,L,ge],endpoint:dl,[f]:S}],[f]:E},{error:"Path-style addressing cannot be used with S3 Accelerate",[f]:T}],[f]:E}],[f]:E}],[f]:E},{[m]:[{[b]:Ge,[_]:[hl]},{[b]:ye,[_]:[hl,Je]}],rules:[{[m]:_t,rules:[{[m]:Ol,rules:[el,tl,{[m]:Ft,endpoint:{[A]:qs,[C]:Gi,[R]:I},[f]:S},{[m]:ir,endpoint:{[A]:"https://s3-object-lambda-fips.{Region}.{partitionResult#dnsSuffix}",[C]:Gi,[R]:I},[f]:S},{endpoint:{[A]:"https://s3-object-lambda.{Region}.{partitionResult#dnsSuffix}",[C]:Gi,[R]:I},[f]:S}],[f]:E},$s],[f]:E}],[f]:E},{[m]:[Ku],rules:[{[m]:_t,rules:[{[m]:Ol,rules:[{[m]:[W,V,N,de],endpoint:{[A]:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[C]:fe,[R]:I},[f]:S},{[m]:[W,V,N,L,pe],rules:[{endpoint:fl,[f]:S}],[f]:E},{[m]:[W,V,N,L,ge],endpoint:fl,[f]:S},{[m]:[W,F,N,de],endpoint:{[A]:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}",[C]:fe,[R]:I},[f]:S},{[m]:[W,F,N,L,pe],rules:[{endpoint:pl,[f]:S}],[f]:E},{[m]:[W,F,N,L,ge],endpoint:pl,[f]:S},{[m]:[M,V,N,de],endpoint:{[A]:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[C]:fe,[R]:I},[f]:S},{[m]:[M,V,N,L,pe],rules:[{endpoint:gl,[f]:S}],[f]:E},{[m]:[M,V,N,L,ge],endpoint:gl,[f]:S},{[m]:[M,F,ce,Re,de],endpoint:{[A]:qs,[C]:fe,[R]:I},[f]:S},{[m]:[M,F,ce,Re,L,pe],rules:[{[m]:vt,endpoint:Vi,[f]:S},{endpoint:Vi,[f]:S}],[f]:E},{[m]:[M,F,ce,Re,L,ge],endpoint:Vi,[f]:S},{[m]:[M,F,N,de],endpoint:{[A]:Lu,[C]:fe,[R]:I},[f]:S},{[m]:[M,F,N,L,pe],rules:[{[m]:vt,endpoint:{[A]:Lu,[C]:le,[R]:I},[f]:S},{endpoint:ml,[f]:S}],[f]:E},{[m]:[M,F,N,L,ge],endpoint:ml,[f]:S}],[f]:E},$s],[f]:E}],[f]:E}],[f]:E},{error:"A region must be set when sending requests to S3.",[f]:T}]},eS=QE,tS=(t,e={})=>Ny(eS,{endpointParams:t,logger:e.logger}),rS=t=>({apiVersion:"2006-03-01",base64Decoder:(t==null?void 0:t.base64Decoder)??Do,base64Encoder:(t==null?void 0:t.base64Encoder)??Fo,disableHostPrefix:(t==null?void 0:t.disableHostPrefix)??!1,endpointProvider:(t==null?void 0:t.endpointProvider)??tS,extensions:(t==null?void 0:t.extensions)??[],getAwsChunkedEncodingStream:(t==null?void 0:t.getAwsChunkedEncodingStream)??Pg,logger:(t==null?void 0:t.logger)??new Mo,sdkStreamMixin:(t==null?void 0:t.sdkStreamMixin)??Lg,serviceId:(t==null?void 0:t.serviceId)??"S3",signerConstructor:(t==null?void 0:t.signerConstructor)??KE,signingEscapePath:(t==null?void 0:t.signingEscapePath)??!1,urlParser:(t==null?void 0:t.urlParser)??Js,useArnRegion:(t==null?void 0:t.useArnRegion)??!1,utf8Decoder:(t==null?void 0:t.utf8Decoder)??gs,utf8Encoder:(t==null?void 0:t.utf8Encoder)??fn}),sS=["in-region","cross-region","mobile","standard","legacy"],nS=({defaultsMode:t}={})=>Ed(async()=>{const e=typeof t=="function"?await t():t;switch(e==null?void 0:e.toLowerCase()){case"auto":return Promise.resolve(iS()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(e==null?void 0:e.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${sS.join(", ")}, got ${e}`)}}),iS=()=>{var r,s;const t=typeof window<"u"&&((r=window==null?void 0:window.navigator)!=null&&r.userAgent)?Ph.parse(window.navigator.userAgent):void 0,e=(s=t==null?void 0:t.platform)==null?void 0:s.type;return e==="tablet"||e==="mobile"},oS=t=>{const e=nS(t),r=()=>e().then(lm),s=rS(t);return{...s,...t,runtime:"browser",defaultsMode:e,bodyLengthChecker:(t==null?void 0:t.bodyLengthChecker)??zE,credentialDefaultProvider:(t==null?void 0:t.credentialDefaultProvider)??(n=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(t==null?void 0:t.defaultUserAgentProvider)??CE({serviceId:s.serviceId,clientVersion:iE.version}),eventStreamSerdeProvider:(t==null?void 0:t.eventStreamSerdeProvider)??NE,maxAttempts:(t==null?void 0:t.maxAttempts)??Xs,md5:(t==null?void 0:t.md5)??LE,region:(t==null?void 0:t.region)??DE("Region is missing"),requestHandler:Uo.create((t==null?void 0:t.requestHandler)??r),retryMode:(t==null?void 0:t.retryMode)??(async()=>(await r()).retryMode||mw),sha1:(t==null?void 0:t.sha1)??wh.Sha1,sha256:(t==null?void 0:t.sha256)??Ah.Sha256,streamCollector:(t==null?void 0:t.streamCollector)??sd,streamHasher:(t==null?void 0:t.streamHasher)??ME,useDualstackEndpoint:(t==null?void 0:t.useDualstackEndpoint)??(()=>Promise.resolve(Vy)),useFipsEndpoint:(t==null?void 0:t.useFipsEndpoint)??(()=>Promise.resolve(Wy))}},aS=t=>{let e=async()=>{if(t.region===void 0)throw new Error("Region is missing from runtimeConfig");const r=t.region;return typeof r=="string"?r:r()};return{setRegion(r){e=r},region(){return e}}},cS=t=>({region:t.region()}),so=t=>t,uS=(t,e)=>{const r={...so(aS(t)),...so(gm(t)),...so(lg(t))};return e.forEach(s=>s.configure(r)),{...t,...cS(r),...mm(r),...dg(r)}};class lS extends Rg{constructor(...[e]){const r=oS(e||{}),s=Vw(r),n=Jy(s),i=gw(n),o=Uw(i),a=o,c=uy(a),u=sy(c,{session:[()=>this,Lv]}),l=gy(u),d=Xy(l),h=uS(d,(e==null?void 0:e.extensions)||[]);super(h),this.config=h,this.middlewareStack.use(Kw(this.config)),this.middlewareStack.use(Qy(this.config)),this.middlewareStack.use(wg(this.config)),this.middlewareStack.use(vg(this.config)),this.middlewareStack.use(Cg(this.config)),this.middlewareStack.use(py(this.config)),this.middlewareStack.use(ay(this.config)),this.middlewareStack.use(gg(this.config)),this.middlewareStack.use(Om(this.config)),this.middlewareStack.use(ry(this.config)),this.middlewareStack.use(Gy(this.config))}destroy(){super.destroy()}}function dS(t){return e=>async r=>{const s={...r.input},n=[{target:"SSECustomerKey",hash:"SSECustomerKeyMD5"},{target:"CopySourceSSECustomerKey",hash:"CopySourceSSECustomerKeyMD5"}];for(const i of n){const o=s[i.target];if(o){let a;typeof o=="string"?/^(?:[A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(o)?a=t.base64Decoder(o):(a=t.utf8Decoder(o),s[i.target]=t.base64Encoder(a)):(a=ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o),s[i.target]=t.base64Encoder(a));const c=new t.md5;c.update(a),s[i.hash]=t.base64Encoder(await c.digest())}}return e({...r,input:s})}}const hS={name:"ssecMiddleware",step:"initialize",tags:["SSE"],override:!0},Ma=t=>({applyToStack:e=>{e.add(dS(t),hS)}});var me;(function(t){t.MD5="MD5",t.CRC32="CRC32",t.CRC32C="CRC32C",t.SHA1="SHA1",t.SHA256="SHA256"})(me||(me={}));var Pl;(function(t){t.HEADER="header",t.TRAILER="trailer"})(Pl||(Pl={}));const fS=me.MD5,pS=me.CRC32,To=[me.CRC32,me.CRC32C,me.SHA1,me.SHA256],gS=[me.CRC32,me.CRC32C,me.SHA1,me.SHA256],mS=(t,{requestChecksumRequired:e,requestAlgorithmMember:r},s)=>{const n=s?pS:fS;if(!r||!t[r])return e?n:void 0;const i=t[r];if(!To.includes(i))throw new Error(`The checksum algorithm "${i}" is not supported by the client. Select one of ${To}.`);return i},Da=t=>t===me.MD5?"content-md5":`x-amz-checksum-${t.toLowerCase()}`,yS=(t,e)=>{const r=t.toLowerCase();for(const s of Object.keys(e))if(r===s.toLowerCase())return!0;return!1},Fa=t=>t!==void 0&&typeof t!="string"&&!ArrayBuffer.isView(t)&&!_d(t);var no={},Jr={},Il;function wS(){if(Il)return Jr;Il=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.AwsCrc32c=void 0;var t=nt,e=Pt(),r=Yh(),s=function(){function n(){this.crc32c=new r.Crc32c}return n.prototype.update=function(i){(0,e.isEmptyData)(i)||this.crc32c.update((0,e.convertToBuffer)(i))},n.prototype.digest=function(){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(i){return[2,(0,e.numToUint8)(this.crc32c.digest())]})})},n.prototype.reset=function(){this.crc32c=new r.Crc32c},n}();return Jr.AwsCrc32c=s,Jr}var Bl;function Yh(){return Bl||(Bl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.AwsCrc32c=t.Crc32c=t.crc32c=void 0;var e=nt,r=Pt();function s(c){return new n().update(c).digest()}t.crc32c=s;var n=function(){function c(){this.checksum=4294967295}return c.prototype.update=function(u){var l,d;try{for(var h=e.__values(u),p=h.next();!p.done;p=h.next()){var g=p.value;this.checksum=this.checksum>>>8^o[(this.checksum^g)&255]}}catch(y){l={error:y}}finally{try{p&&!p.done&&(d=h.return)&&d.call(h)}finally{if(l)throw l.error}}return this},c.prototype.digest=function(){return(this.checksum^4294967295)>>>0},c}();t.Crc32c=n;var i=[0,4067132163,3778769143,324072436,3348797215,904991772,648144872,3570033899,2329499855,2024987596,1809983544,2575936315,1296289744,3207089363,2893594407,1578318884,274646895,3795141740,4049975192,51262619,3619967088,632279923,922689671,3298075524,2592579488,1760304291,2075979607,2312596564,1562183871,2943781820,3156637768,1313733451,549293790,3537243613,3246849577,871202090,3878099393,357341890,102525238,4101499445,2858735121,1477399826,1264559846,3107202533,1845379342,2677391885,2361733625,2125378298,820201905,3263744690,3520608582,598981189,4151959214,85089709,373468761,3827903834,3124367742,1213305469,1526817161,2842354314,2107672161,2412447074,2627466902,1861252501,1098587580,3004210879,2688576843,1378610760,2262928035,1955203488,1742404180,2511436119,3416409459,969524848,714683780,3639785095,205050476,4266873199,3976438427,526918040,1361435347,2739821008,2954799652,1114974503,2529119692,1691668175,2005155131,2247081528,3690758684,697762079,986182379,3366744552,476452099,3993867776,4250756596,255256311,1640403810,2477592673,2164122517,1922457750,2791048317,1412925310,1197962378,3037525897,3944729517,427051182,170179418,4165941337,746937522,3740196785,3451792453,1070968646,1905808397,2213795598,2426610938,1657317369,3053634322,1147748369,1463399397,2773627110,4215344322,153784257,444234805,3893493558,1021025245,3467647198,3722505002,797665321,2197175160,1889384571,1674398607,2443626636,1164749927,3070701412,2757221520,1446797203,137323447,4198817972,3910406976,461344835,3484808360,1037989803,781091935,3705997148,2460548119,1623424788,1939049696,2180517859,1429367560,2807687179,3020495871,1180866812,410100952,3927582683,4182430767,186734380,3756733383,763408580,1053836080,3434856499,2722870694,1344288421,1131464017,2971354706,1708204729,2545590714,2229949006,1988219213,680717673,3673779818,3383336350,1002577565,4010310262,493091189,238226049,4233660802,2987750089,1082061258,1395524158,2705686845,1972364758,2279892693,2494862625,1725896226,952904198,3399985413,3656866545,731699698,4283874585,222117402,510512622,3959836397,3280807620,837199303,582374963,3504198960,68661723,4135334616,3844915500,390545967,1230274059,3141532936,2825850620,1510247935,2395924756,2091215383,1878366691,2644384480,3553878443,565732008,854102364,3229815391,340358836,3861050807,4117890627,119113024,1493875044,2875275879,3090270611,1247431312,2660249211,1828433272,2141937292,2378227087,3811616794,291187481,34330861,4032846830,615137029,3603020806,3314634738,939183345,1776939221,2609017814,2295496738,2058945313,2926798794,1545135305,1330124605,3173225534,4084100981,17165430,307568514,3762199681,888469610,3332340585,3587147933,665062302,2042050490,2346497209,2559330125,1793573966,3190661285,1279665062,1595330642,2910671697],o=(0,r.uint32ArrayFrom)(i),a=wS();Object.defineProperty(t,"AwsCrc32c",{enumerable:!0,get:function(){return a.AwsCrc32c}})}(no)),no}var bS=Yh();const Zh=(t,e)=>({[me.MD5]:e.md5,[me.CRC32]:Ko.AwsCrc32,[me.CRC32C]:bS.AwsCrc32c,[me.SHA1]:e.sha1,[me.SHA256]:e.sha256})[t],Qh=(t,e)=>{const r=new t;return r.update(lr(e||"")),r.digest()},_S={name:"flexibleChecksumsMiddleware",step:"build",tags:["BODY_CHECKSUM"],override:!0},vS=(t,e)=>(r,s)=>async n=>{if(!De.isInstance(n.request))return r(n);const{request:i}=n,{body:o,headers:a}=i,{base64Encoder:c,streamHasher:u}=t,{input:l,requestChecksumRequired:d,requestAlgorithmMember:h}=e,p=mS(l,{requestChecksumRequired:d,requestAlgorithmMember:h},!!s.isS3ExpressBucket);let g=o,y=a;if(p){const x=Da(p),k=Zh(p,t);if(Fa(o)){const{getAwsChunkedEncodingStream:O,bodyLengthChecker:B}=t;g=O(o,{base64Encoder:c,bodyLengthChecker:B,checksumLocationName:x,checksumAlgorithmFn:k,streamHasher:u}),y={...a,"content-encoding":a["content-encoding"]?`${a["content-encoding"]},aws-chunked`:"aws-chunked","transfer-encoding":"chunked","x-amz-decoded-content-length":a["content-length"],"x-amz-content-sha256":"STREAMING-UNSIGNED-PAYLOAD-TRAILER","x-amz-trailer":x},delete y["content-length"]}else if(!yS(x,a)){const O=await Qh(k,o);y={...a,[x]:c(O)}}}return await r({...n,request:{...i,headers:y,body:g}})},ef=(t=[])=>{const e=[];for(const r of gS)!t.includes(r)||!To.includes(r)||e.push(r);return e},ES=t=>{const e=t.lastIndexOf("-");if(e!==-1){const r=t.slice(e+1);if(!r.startsWith("0")){const s=parseInt(r,10);if(!isNaN(s)&&s>=1&&s<=1e4)return!0}}return!1};function Nl(t){return new Blob([t]).stream()}const SS=async(t,{streamHasher:e,checksumAlgorithmFn:r,base64Encoder:s})=>{const n=Fa(t)?e(r,t):Qh(r,t);return s(await n)},xS=async(t,{config:e,responseAlgorithms:r})=>{const s=ef(r),{body:n,headers:i}=t;for(const o of s){const a=Da(o),c=i[a];if(c){const u=Zh(o,e),{streamHasher:l,base64Encoder:d}=e,h=await SS(n,{streamHasher:l,checksumAlgorithmFn:u,base64Encoder:d});if(h===c)break;throw new Error(`Checksum mismatch: expected "${h}" but received "${c}" in response header "${a}".`)}}},AS={name:"flexibleChecksumsResponseMiddleware",toMiddleware:"deserializerMiddleware",relation:"after",tags:["BODY_CHECKSUM"],override:!0},CS=(t,e)=>(r,s)=>async n=>{if(!De.isInstance(n.request))return r(n);const i=n.input,o=await r(n),a=o.response;let c;const{requestValidationModeMember:u,responseAlgorithms:l}=e;if(u&&i[u]==="ENABLED"){const{clientName:d,commandName:h}=s;if(d==="S3Client"&&h==="GetObjectCommand"&&ef(l).every(y=>{const w=Da(y),x=a.headers[w];return!x||ES(x)}))return o;const g=Fa(a.body);g&&(c=await t.streamCollector(a.body),a.body=Nl(c)),await xS(o.response,{config:t,responseAlgorithms:l}),g&&c&&(a.body=Nl(c))}return o},tf=(t,e)=>({applyToStack:r=>{r.add(vS(t,e),_S),r.addRelativeTo(CS(t,e),AS)}});class RS extends _r.classBuilder().ep({..._s,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,r,s,n){return[ws(s,this.serialize,this.deserialize),bs(s,e.getEndpointParameterInstructions()),Ma(s),ud(),tf(s,{input:this.input,requestChecksumRequired:!1,requestValidationModeMember:"ChecksumMode",responseAlgorithms:["CRC32","CRC32C","SHA256","SHA1"]})]}).s("AmazonS3","GetObject",{}).n("S3Client","GetObjectCommand").f(Yw,Xw).ser(b_).de(x_).build(){}class TS extends _r.classBuilder().ep({..._s,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,r,s,n){return[ws(s,this.serialize,this.deserialize),bs(s,e.getEndpointParameterInstructions()),Ma(s),ud()]}).s("AmazonS3","HeadObject",{}).n("S3Client","HeadObjectCommand").f(Qw,Zw).ser(__).de(A_).build(){}class kS extends _r.classBuilder().ep({..._s,Bucket:{type:"contextParams",name:"Bucket"},Prefix:{type:"contextParams",name:"Prefix"}}).m(function(e,r,s,n){return[ws(s,this.serialize,this.deserialize),bs(s,e.getEndpointParameterInstructions())]}).s("AmazonS3","ListObjectsV2",{}).n("S3Client","ListObjectsV2Command").f(void 0,void 0).ser(v_).de(C_).build(){}class OS extends _r.classBuilder().ep({..._s,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,r,s,n){return[ws(s,this.serialize,this.deserialize),bs(s,e.getEndpointParameterInstructions()),Am(),Ma(s),tf(s,{input:this.input,requestAlgorithmMember:"ChecksumAlgorithm",requestChecksumRequired:!1})]}).s("AmazonS3","PutObject",{}).n("S3Client","PutObjectCommand").f(y_,m_).ser(E_).de(R_).build(){}let yt=null;function rf(t){const e=["csv","tsv","json","txt"];try{const r=t.split(".");if(r.length){const s=r.pop();if(e.includes(s))return s;throw new Error(`unsupported format: ${s}`)}throw new Error("no extension in filename")}catch(r){throw r}}async function PS({data:t,format:e}){try{let r=null;return e==="csv"&&(r=Cf(t)),e==="tsv"&&(r=Tf(t)),e==="json"&&(r=JSON.stringify(t)),e==="txt"&&(r=t),r}catch{throw new Error(`issue stringifying data as a ${e}`)}}async function IS(t){return new Promise((e,r)=>{const s=[];t.on("data",n=>s.push(n)),t.on("end",()=>e(Buffer.concat(s))),t.on("error",r)})}async function BS({stream:t,format:e}){try{const s=(await IS(t)).toString("utf8");let n=null;return e==="csv"&&(n=Af(s)),e==="tsv"&&(n=Rf(s)),e==="json"&&(n=JSON.parse(s)),e==="txt"&&(n=s),n}catch{throw new Error(`issue parsing data as a ${e}`)}}function Fn(t){const e=t.startsWith("/"),r=t.endsWith("/");return t.substring(e?1:0).slice(0,r?-1:t.length)}async function NS({bucket:t,path:e="",file:r,data:s}){if(!yt)throw new Error("data-s3 not intialized");if(!t||!r||!s)throw new Error("missing parameters");try{const n=await rf(r),i=await PS({data:s,format:n}),o={Bucket:`${t}`,Body:i,Key:`${Fn(e)}/${r}`};return await yt.send(new OS(o)),!0}catch(n){throw n}}async function $S({bucket:t,path:e="",file:r}){if(!yt)throw new Error("data-s3 not intialized");if(!t||!r)throw new Error("missing parameters");try{const s={Bucket:t,Key:`${Fn(e)}/${r}`},{Body:n}=await yt.send(new RS(s)),i=n,o=await rf(s.Key);return await BS({stream:i,format:o})}catch(s){throw s}}async function MS({bucket:t,path:e="",file:r}){try{if(!yt)throw new Error("data-s3 not intialized");if(!t||!r)throw new Error("missing parameters");const s={Bucket:`${t}`,Key:`${Fn(e)}/${r}`};return await yt.send(new TS(s)),!0}catch(s){if(s.name==="NotFound")return!1;throw s}}async function DS({bucket:t,path:e=""}){try{if(!yt)throw new Error("data-s3 not intialized");if(!t)throw new Error("missing parameters");const r={Bucket:t,Prefix:Fn(e)};return(await yt.send(new kS(r))).Contents.map(i=>i.Key.replace(`${r.Prefix}/`,"")).filter(i=>i)}catch(r){throw r}}async function FS({accessKeyId:t,secretAccessKey:e,region:r}){if(!r)throw new Error("data-s3 init: missing region");if(!t||!e)throw new Error("data-s3 init: missing credentials");{const s={accessKeyId:t,secretAccessKey:e};yt=new lS({region:r,credentials:s})}}const US={init:FS,upload:NS,download:$S,exists:MS,list:DS};function $l(t,e,r){const s=t.slice();return s[11]=e[r],s}function Ml(t,e,r){const s=t.slice();s[14]=e[r];const n=s[14].updated;return s[2]=n,s}function Dl(t){let e,r,s=t[14].id+"",n,i,o,a=t[14].frame_index+"",c,u,l,d=t[14].shortcode+"",h,p,g,y=t[14].user_id+"",w,x,k,O,B=t[14].paused?"Resume":"Pause",J,ee,Ae,qe;function Bt(){return t[6](t[14])}return{c(){e=re("tr"),r=re("td"),n=Qe(s),i=Te(),o=re("td"),c=Qe(a),u=Te(),l=re("td"),h=Qe(d),p=Te(),g=re("td"),w=Qe(y),x=Te(),k=re("td"),O=re("button"),J=Qe(B),ee=Te(),this.h()},l(Pe){e=se(Pe,"TR",{class:!0});var q=xe(e);r=se(q,"TD",{class:!0});var ft=xe(r);n=et(ft,s),ft.forEach(Z),i=ke(q),o=se(q,"TD",{class:!0});var ie=xe(o);c=et(ie,a),ie.forEach(Z),u=ke(q),l=se(q,"TD",{class:!0});var pt=xe(l);h=et(pt,d),pt.forEach(Z),p=ke(q),g=se(q,"TD",{class:!0});var oe=xe(g);w=et(oe,y),oe.forEach(Z),x=ke(q),k=se(q,"TD",{class:!0});var xs=xe(k);O=se(xs,"BUTTON",{class:!0});var Zt=xe(O);J=et(Zt,B),Zt.forEach(Z),xs.forEach(Z),ee=ke(q),q.forEach(Z),this.h()},h(){Ne(r,"class","svelte-ha5zzp"),Ne(o,"class","svelte-ha5zzp"),Ne(l,"class","svelte-ha5zzp"),Ne(g,"class","svelte-ha5zzp"),Ne(O,"class","small"),Ne(k,"class","svelte-ha5zzp"),Ne(e,"class","svelte-ha5zzp"),ja(e,"updated",t[2])},m(Pe,q){Rt(Pe,e,q),$(e,r),$(r,n),$(e,i),$(e,o),$(o,c),$(e,u),$(e,l),$(l,h),$(e,p),$(e,g),$(g,w),$(e,x),$(e,k),$(k,O),$(O,J),$(e,ee),Ae||(qe=Ll(O,"click",Bt),Ae=!0)},p(Pe,q){t=Pe,q&1&&s!==(s=t[14].id+"")&&At(n,s),q&1&&a!==(a=t[14].frame_index+"")&&At(c,a),q&1&&d!==(d=t[14].shortcode+"")&&At(h,d),q&1&&y!==(y=t[14].user_id+"")&&At(w,y),q&1&&B!==(B=t[14].paused?"Resume":"Pause")&&At(J,B),q&1&&ja(e,"updated",t[2])},d(Pe){Pe&&Z(e),Ae=!1,qe()}}}function Fl(t){let e,r,s,n=t[11].id+"",i,o,a=t[11].frame_index+"",c,u,l,d,h;return{c(){e=re("p"),r=re("mark"),s=Qe("animation: "),i=Qe(n),o=Qe(" frame: "),c=Qe(a),u=Te(),l=Ha("svg"),d=Ha("path"),this.h()},l(p){e=se(p,"P",{});var g=xe(e);r=se(g,"MARK",{});var y=xe(r);s=et(y,"animation: "),i=et(y,n),o=et(y," frame: "),c=et(y,a),y.forEach(Z),g.forEach(Z),u=ke(p),l=za(p,"svg",{class:!0});var w=xe(l);d=za(w,"path",{d:!0,class:!0}),xe(d).forEach(Z),w.forEach(Z),this.h()},h(){Ne(d,"d",h=t[11].drawing),Ne(d,"class","svelte-ha5zzp"),Ne(l,"class","svelte-ha5zzp")},m(p,g){Rt(p,e,g),$(e,r),$(r,s),$(r,i),$(r,o),$(r,c),Rt(p,u,g),Rt(p,l,g),$(l,d)},p(p,g){g&1&&n!==(n=p[11].id+"")&&At(i,n),g&1&&a!==(a=p[11].frame_index+"")&&At(c,a),g&1&&h!==(h=p[11].drawing)&&Ne(d,"d",h)},d(p){p&&(Z(e),Z(u),Z(l))}}}function LS(t){let e,r,s,n,i,o="Copy SVG",a,c,u,l;function d(p){t[7](p)}let h={};return t[1]!==void 0&&(h.path=t[1]),e=new vf({props:h}),af.push(()=>pf(e,"path",d)),{c(){gf(e.$$.fragment),s=Te(),n=re("p"),i=re("button"),i.textContent=o},l(p){mf(e.$$.fragment,p),s=ke(p),n=se(p,"P",{});var g=xe(n);i=se(g,"BUTTON",{"data-svelte-h":!0}),jt(i)!=="svelte-jhecks"&&(i.textContent=o),g.forEach(Z)},m(p,g){yf(e,p,g),Rt(p,s,g),Rt(p,n,g),$(n,i),c=!0,u||(l=[cf(a=bf.call(null,i,t[1]||"")),Ll(i,"svelte-copy",qS)],u=!0)},p(p,g){const y={};!r&&g&2&&(r=!0,y.path=p[1],uf(()=>r=!1)),e.$set(y),a&&lf(a.update)&&g&2&&a.update.call(null,p[1]||"")},i(p){c||(jl(e.$$.fragment,p),c=!0)},o(p){Hl(e.$$.fragment,p),c=!1},d(p){p&&(Z(s),Z(n)),wf(e,p),u=!1,df(l)}}}function jS(t){let e,r="Animation Created!";return{c(){e=re("p"),e.textContent=r},l(s){e=se(s,"P",{"data-svelte-h":!0}),jt(e)!=="svelte-vkhmzv"&&(e.textContent=r)},m(s,n){Rt(s,e,n)},p:Un,i:Un,o:Un,d(s){s&&Z(e)}}}function HS(t){let e,r,s="Admin Dashboard",n,i,o,a,c,u,l="Current",d,h,p,g='<tr class="svelte-ha5zzp"><th class="svelte-ha5zzp">ID</th> <th class="svelte-ha5zzp">Frame Index</th> <th class="svelte-ha5zzp">Shortcode</th> <th class="svelte-ha5zzp">User ID</th> <th class="svelte-ha5zzp">Pause</th></tr>',y,w,x,k,O="Previous",B,J,ee,Ae="New Animation",qe,Bt,Pe,q,ft=As(t[0]),ie=[];for(let U=0;U<ft.length;U+=1)ie[U]=Dl(Ml(t,ft,U));let pt=As(t[0]),oe=[];for(let U=0;U<pt.length;U+=1)oe[U]=Fl($l(t,pt,U));const xs=[jS,LS],Zt=[];function sf(U,K){return U[3]?0:1}return Bt=sf(t),Pe=Zt[Bt]=xs[Bt](t),{c(){e=re("section"),r=re("h1"),r.textContent=s,n=Te(),i=re("p"),o=Qe("last public update: "),a=Qe(t[2]),c=Te(),u=re("h2"),u.textContent=l,d=Te(),h=re("table"),p=re("thead"),p.innerHTML=g,y=Te(),w=re("tbody");for(let U=0;U<ie.length;U+=1)ie[U].c();x=Te(),k=re("h2"),k.textContent=O,B=Te();for(let U=0;U<oe.length;U+=1)oe[U].c();J=Te(),ee=re("h2"),ee.textContent=Ae,qe=Te(),Pe.c(),this.h()},l(U){e=se(U,"SECTION",{class:!0});var K=xe(e);r=se(K,"H1",{"data-svelte-h":!0}),jt(r)!=="svelte-ijv2ub"&&(r.textContent=s),n=ke(K),i=se(K,"P",{});var D=xe(i);o=et(D,"last public update: "),a=et(D,t[2]),D.forEach(Z),c=ke(K),u=se(K,"H2",{"data-svelte-h":!0}),jt(u)!=="svelte-1xgllxh"&&(u.textContent=l),d=ke(K),h=se(K,"TABLE",{id:!0,class:!0});var ct=xe(h);p=se(ct,"THEAD",{"data-svelte-h":!0}),jt(p)!=="svelte-13kjonr"&&(p.innerHTML=g),y=ke(ct),w=se(ct,"TBODY",{});var Ua=xe(w);for(let Nt=0;Nt<ie.length;Nt+=1)ie[Nt].l(Ua);Ua.forEach(Z),ct.forEach(Z),x=ke(K),k=se(K,"H2",{"data-svelte-h":!0}),jt(k)!=="svelte-10fc9cz"&&(k.textContent=O),B=ke(K);for(let Nt=0;Nt<oe.length;Nt+=1)oe[Nt].l(K);J=ke(K),ee=se(K,"H2",{"data-svelte-h":!0}),jt(ee)!=="svelte-14c2nra"&&(ee.textContent=Ae),qe=ke(K),Pe.l(K),K.forEach(Z),this.h()},h(){Ne(h,"id","animations"),Ne(h,"class","svelte-ha5zzp"),Ne(e,"class","svelte-ha5zzp")},m(U,K){Rt(U,e,K),$(e,r),$(e,n),$(e,i),$(i,o),$(i,a),$(e,c),$(e,u),$(e,d),$(e,h),$(h,p),$(h,y),$(h,w);for(let D=0;D<ie.length;D+=1)ie[D]&&ie[D].m(w,null);$(e,x),$(e,k),$(e,B);for(let D=0;D<oe.length;D+=1)oe[D]&&oe[D].m(e,null);$(e,J),$(e,ee),$(e,qe),Zt[Bt].m(e,null),q=!0},p(U,[K]){if((!q||K&4)&&At(a,U[2]),K&17){ft=As(U[0]);let D;for(D=0;D<ft.length;D+=1){const ct=Ml(U,ft,D);ie[D]?ie[D].p(ct,K):(ie[D]=Dl(ct),ie[D].c(),ie[D].m(w,null))}for(;D<ie.length;D+=1)ie[D].d(1);ie.length=ft.length}if(K&1){pt=As(U[0]);let D;for(D=0;D<pt.length;D+=1){const ct=$l(U,pt,D);oe[D]?oe[D].p(ct,K):(oe[D]=Fl(ct),oe[D].c(),oe[D].m(e,J))}for(;D<oe.length;D+=1)oe[D].d(1);oe.length=pt.length}Pe.p(U,K)},i(U){q||(jl(Pe),q=!0)},o(U){Hl(Pe),q=!1},d(U){U&&Z(e),La(ie,U),La(oe,U),Zt[Bt].d()}}}const zS="us-east-1";async function Ul({id:t,shortcode:e}){const s=`https://pudding.cool/projects/flipbook-data/drawings/${t}/${e}.txt?version=${Date.now()}`;return await(await fetch(s)).text()}function qS(){alert("copied")}function KS(t,e,r){let{data:s}=e;_f();let n,i=[],o,a,c;async function u(){try{const g=await n.from("animation").select();if(g.error)throw console.log(g.error),new Error("getAllAnimations failed");if(g.data)return g.data;throw new Error("no animations")}catch(g){console.log(g)}}async function l(g,y){try{const w=await n.from("animation").update({paused:y}).eq("id",g);if(w.error)throw console.log(w.error),new Error("onPause failed");return void 0}catch(w){console.log(w)}}async function d(){const w=await(await fetch(`https://pudding.cool/projects/flipbook-data/meta.json?version=${Date.now()}`)).json();r(2,c=new Date(w.updated).toLocaleString()),setTimeout(d,15e3)}of(async()=>{n=ug(s.supabaseUrl,s.supabaseKey);const{accessKeyId:g,secretAccessKey:y}=s;await US.init({accessKeyId:g,secretAccessKey:y,region:zS}),n.channel("custom-all-channel").on("postgres_changes",{event:"*",schema:"public",table:"animation"},async w=>{if(i.length&&w.new){const x=i.findIndex(k=>k.id===w.new.id);if(x>-1){i[x]||r(0,i[x]={},i),r(0,i[x]={...i[x],...w.new,updated:!0},i);const k=await Ul(i[x]);r(0,i[x].drawing=k,i)}r(0,i),setTimeout(()=>{r(0,i[x].updated=!1,i),r(0,i)},2e3)}}).subscribe(),r(0,i=await u());for(const w of i){const x=await Ul(w);w.drawing=x}r(0,i),d()});const h=g=>l(g.id,!g.paused);function p(g){o=g,r(1,o)}return t.$$set=g=>{"data"in g&&r(5,s=g.data)},[i,o,c,a,l,s,h,p]}class tx extends hf{constructor(e){super(),ff(this,e,KS,HS,nf,{data:5})}}export{tx as component};
