import{T as Z,s as F,f as $,H as Q,a as k,g as v,h as w,r as z,d as h,c as E,i as S,v as g,I as x,l as y,m as N,D as A,n as G,w as H,j as J,p as K,L as ee,u as te,Q as I}from"../chunks/scheduler.82866026.js";import{S as R,i as W,a as C,g as ae,t as T,c as se,f as ne,b as O,d as P,m as j,e as D}from"../chunks/index.f4b91e18.js";import{C as le,M as oe,v as ie,c as L}from"../chunks/version.282a95b1.js";import{s as M}from"../chunks/submit.5754b767.js";import{p as re}from"../chunks/stores.017c79e2.js";function fe(n){const s=Z(re).url.search.split("&").find(o=>o.includes(`${n}=`));if(s)return s.split("=")[1]}function B(n){let e,t=n[0]?"Loading...":"Start",s,o,l;return{c(){e=$("button"),s=y(t),this.h()},l(a){e=v(a,"BUTTON",{});var i=w(e);s=N(i,t),i.forEach(h),this.h()},h(){e.disabled=n[0]},m(a,i){S(a,e,i),g(e,s),o||(l=A(e,"click",n[6]),o=!0)},p(a,i){i&1&&t!==(t=a[0]?"Loading...":"Start")&&G(s,t),i&1&&(e.disabled=a[0])},d(a){a&&h(e),o=!1,l()}}}function U(n){let e,t,s=n[5].draw.task+"",o,l,a,i=n[5].draw.note+"",m;return{c(){e=$("p"),t=new Q(!1),o=k(),l=$("em"),a=y("Note: "),m=y(i),this.h()},l(d){e=v(d,"P",{});var f=w(e);t=z(f,!1),o=E(f),l=v(f,"EM",{});var u=w(l);a=N(u,"Note: "),m=N(u,i),u.forEach(h),f.forEach(h),this.h()},h(){t.a=o},m(d,f){S(d,e,f),t.m(s,e),g(e,o),g(e,l),g(l,a),g(l,m)},p:H,d(d){d&&h(e)}}}function V(n){let e,t;return{c(){e=$("p"),t=y(n[3]),this.h()},l(s){e=v(s,"P",{class:!0});var o=w(e);t=N(o,n[3]),o.forEach(h),this.h()},h(){J(e,"class","error")},m(s,o){S(s,e,o),g(e,t)},p(s,o){o&8&&G(t,s[3])},d(s){s&&h(e)}}}function q(n){let e,t,s;function o(a){n[10](a)}let l={preset:n[2],$$slots:{ui:[ce]},$$scope:{ctx:n}};return n[1]!==void 0&&(l.path=n[1]),e=new le({props:l}),n[9](e),K.push(()=>ne(e,"path",o)),e.$on("validate",n[8]),{c(){O(e.$$.fragment)},l(a){P(e.$$.fragment,a)},m(a,i){j(e,a,i),s=!0},p(a,i){const m={};i&4&&(m.preset=a[2]),i&8192&&(m.$$scope={dirty:i,ctx:a}),!t&&i&2&&(t=!0,m.path=a[1],ee(()=>t=!1)),e.$set(m)},i(a){s||(C(e.$$.fragment,a),s=!0)},o(a){T(e.$$.fragment,a),s=!1},d(a){n[9](null),D(e,a)}}}function ce(n){let e,t,s="Submit",o,l;return{c(){e=$("div"),t=$("button"),t.textContent=s,this.h()},l(a){e=v(a,"DIV",{slot:!0});var i=w(e);t=v(i,"BUTTON",{"data-svelte-h":!0}),te(t)!=="svelte-16lvxe5"&&(t.textContent=s),i.forEach(h),this.h()},h(){J(e,"slot","ui")},m(a,i){S(a,e,i),g(e,t),o||(l=A(t,"click",n[7]),o=!0)},p:H,d(a){a&&h(e),o=!1,l()}}}function ue(n){let e,t,s,o=n[5].draw.thanks+"",l,a,i,m,d,f=!n[2]&&!n[3]&&B(n),u=n[2]&&U(n),_=n[3]&&V(n),p=n[2]&&q(n);return{c(){e=$("section"),t=$("p"),s=new Q(!1),l=k(),f&&f.c(),a=k(),u&&u.c(),i=k(),_&&_.c(),m=k(),p&&p.c(),this.h()},l(c){e=v(c,"SECTION",{});var r=w(e);t=v(r,"P",{});var b=w(t);s=z(b,!1),b.forEach(h),l=E(r),f&&f.l(r),a=E(r),u&&u.l(r),i=E(r),_&&_.l(r),m=E(r),p&&p.l(r),r.forEach(h),this.h()},h(){s.a=null},m(c,r){S(c,e,r),g(e,t),s.m(o,t),g(e,l),f&&f.m(e,null),g(e,a),u&&u.m(e,null),g(e,i),_&&_.m(e,null),g(e,m),p&&p.m(e,null),d=!0},p(c,[r]){!c[2]&&!c[3]?f?f.p(c,r):(f=B(c),f.c(),f.m(e,a)):f&&(f.d(1),f=null),c[2]?u?u.p(c,r):(u=U(c),u.c(),u.m(e,i)):u&&(u.d(1),u=null),c[3]?_?_.p(c,r):(_=V(c),_.c(),_.m(e,m)):_&&(_.d(1),_=null),c[2]?p?(p.p(c,r),r&4&&C(p,1)):(p=q(c),p.c(),C(p,1),p.m(e,null)):p&&(ae(),T(p,1,1,()=>{p=null}),se())},i(c){d||(C(p),d=!0)},o(c){T(p),d=!1},d(c){c&&h(e),f&&f.d(),u&&u.d(),_&&_.d(),p&&p.d()}}}const pe="https://pudding.cool/projects/trace-data/drawings";function me(n,e,t){const s=x("copy");let o,l,a,i,m,d;async function f(){o=fe("id"),t(0,l=!0);try{const r=await M("checkin",{shortcode:o});if(r.status===200){const{id:b,prev_shortcode:X}=r.data,Y=await fetch(`${pe}/${b}/${X}.txt`);t(2,i=await Y.text())}else r.status===404?t(3,m="Oh no! This turn has expired."):t(3,m=r.message||"Oh no! Something went wrong.")}catch(r){t(3,m=`Error: ${r.message}`)}finally{t(0,l=!1)}}function u(){d.addFrame()}async function _({detail:r}){try{if(r){const b=await M("submit",{shortcode:o,drawing:a});console.log(b)}}catch(b){console.log(b)}}function p(r){K[r?"unshift":"push"](()=>{d=r,t(4,d)})}function c(r){a=r,t(1,a)}return[l,a,i,m,d,s,f,u,_,p,c]}class _e extends R{constructor(e){super(),W(this,e,me,ue,F,{})}}function de(n){let e,t,s,o;return e=new oe({props:{title:n[0],description:n[1],url:n[2],keywords:n[3]}}),s=new _e({}),{c(){O(e.$$.fragment),t=k(),O(s.$$.fragment)},l(l){P(e.$$.fragment,l),t=E(l),P(s.$$.fragment,l)},m(l,a){j(e,l,a),S(l,t,a),j(s,l,a),o=!0},p:H,i(l){o||(C(e.$$.fragment,l),C(s.$$.fragment,l),o=!0)},o(l){T(e.$$.fragment,l),T(s.$$.fragment,l),o=!1},d(l){l&&h(t),D(e,l),D(s,l)}}}function he(n,e,t){let{data:s}=e;ie();const{title:o,description:l,url:a,keywords:i}=L;return I("copy",L),I("data",s.data),n.$$set=m=>{"data"in m&&t(4,s=m.data)},[o,l,a,i,s]}class ke extends R{constructor(e){super(),W(this,e,he,de,F,{data:4})}}export{ke as component};
