import{W as It,s as kt,A as Ct,f as D,R as O,a as z,g as N,h as k,S as q,d as P,c as G,j as F,k as it,E as lt,i as H,w as x,y as K,B as At,C as Rt,D as St,G as Ot,N as qt,o as Dt,l as _t,m as yt,n as bt,X as Nt,r as jt}from"./scheduler.1b8758cb.js";import{S as Vt,i as Xt,a as Q,t as zt,h as Gt}from"./index.1f7cc648.js";function Ht(n,{delay:e=0,duration:t=400,easing:r=It}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:a=>`opacity: ${a*s}`}}function tt(n,e=!1){let t=0;for(let r=1;r<n.length;r++){const s=n[r-1],a=n[r];e?t+=Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2)):t+=Math.sqrt(Math.pow(a[0]-s[0],2)+Math.pow(a[1]-s[1],2))}return t}var ct=function(n){return n[n.length-1]},ft=function(n){return n.reduce(function(e,t){return e+t},0)},T=function(n){var e=n.reduce(function(t,r){return r+t},0);return e/n.length},st=function(n,e){return{x:n.x-e.x,y:n.y-e.y}},Mt=function(n){var e=n.x,t=n.y;return Math.sqrt(e*e+t*t)},j=function(n,e){return Mt(st(n,e))},et=function(n){var e=n[0],t=n.slice(1);return t.reduce(function(r,s){var a=j(s,e);return e=s,r+a},0)},Wt=function(n,e,t){var r=st(e,n),s=t/Mt(r);return{x:e.x+s*r.x,y:e.y+s*r.y}},nt=function(n,e){for(var t=e.numPoints,r=t===void 0?50:t,s=et(n),a=s/(r-1),l=[n[0]],f=ct(n),d=n.slice(1),v=0;v<r-2;v++)for(var _=ct(l),g=a,h=!1;!h;){var p=j(_,d[0]);if(p<g)g-=p,_=d.shift();else{var M=Wt(_,d[0],g-p);l.push(M),h=!0}}return l.push(f),l},Yt=function(n,e){return n.map(function(t){return{x:Math.cos(-1*e)*t.x-Math.sin(-1*e)*t.y,y:Math.sin(-1*e)*t.x+Math.cos(-1*e)*t.y}})},rt=function(n,e){for(var t=n.length>=e.length?n:e,r=n.length>=e.length?e:n,s=function(v,_,g,h){if(v===0&&_===0)return j(t[0],r[0]);if(v>0&&_===0)return Math.max(g[0],j(t[v],r[0]));var p=h[h.length-1];return v===0&&_>0?Math.max(p,j(t[0],r[_])):Math.max(Math.min(g[_],g[_-1],p),j(t[v],r[_]))},a=[],l=0;l<t.length;l++){for(var f=[],d=0;d<r.length;d++)f.push(s(l,d,a,f));a=f}return a[r.length-1]},ut=function(n,e){e===void 0&&(e={});var t=e.rebalance,r=t===void 0?!0:t,s=e.estimationPoints,a=s===void 0?50:s,l=r?nt(n,{numPoints:a}):n,f=T(l.map(function(h){return h.x})),d=T(l.map(function(h){return h.y})),v={x:f,y:d},_=l.map(function(h){return st(h,v)}),g=Math.sqrt(T(_.map(function(h){var p=h.x,M=h.y;return p*p+M*M})));return _.map(function(h){return{x:h.x/g,y:h.y/g}})},Bt=function(n,e){if(n.length!==e.length)throw new Error("curve and relativeCurve must have the same length");var t=ft(n.map(function(s,a){var l=s.x,f=s.y;return f*e[a].x-l*e[a].y})),r=ft(n.map(function(s,a){var l=s.x,f=s.y;return l*e[a].x+f*e[a].y}));return Math.atan2(t,r)},ht=function(n,e,t){t===void 0&&(t={});var r=t.estimationPoints,s=r===void 0?50:r,a=t.rotations,l=a===void 0?10:a,f=t.restrictRotationAngle,d=f===void 0?Math.PI:f,v=t.checkRotations,_=v===void 0?!0:v;if(Math.abs(d)>Math.PI)throw new Error("restrictRotationAngle cannot be larger than PI");var g=ut(n,{estimationPoints:s}),h=ut(e,{estimationPoints:s}),p=Math.sqrt(et(g)*et(h)),M=[0];if(_){var E=Bt(g,h);E>Math.PI&&(E=E-2*Math.PI),E!==0&&Math.abs(E)<d&&M.push(E);for(var y=0;y<l;y++){var L=-1*d+2*y*d/(l-1);L!==0&&L!==Math.PI&&M.push(L)}}var C=1/0;return M.forEach(function(c){var o=Yt(g,c),u=rt(o,h);u<C&&(C=u)}),Math.max(1-C/(p/Math.sqrt(2)),0)};function Jt({cur:n,prev:e,diagonal:t}){const r=Math.max(e.length,n.length),s=nt(n,{numPoints:r}),a=nt(e,{numPoints:r}),l=[...a].reverse(),f={estimationPoints:200,rotations:30},d=ht(a,s,f),v=ht(l,s,f),_=tt(s,!0),g=tt(a,!0),h=Math.max(_,g),p=Math.abs(_/g-1),M=rt(a,s),E=rt(l,s),y=M/t,L=E/t,C=M/h,c=E/h;let o=.075;g<100&&(o=.2),g<200&&(o=.15),g<300&&(o=.1);const u=p<o&&d>.9&&(y<.2||C<.2),R=p<o&&v>.9&&(L<.2||c<.2);return{valid:u||R,debug1:{ll_target:o,ll:+p.toFixed(2),sim:+d.toFixed(2),diag:+y.toFixed(2),len:+C.toFixed(2),pass:u},debug2:{ll_target:o,ll:+p.toFixed(2),sim:+v.toFixed(2),diag:+L.toFixed(2),len:+c.toFixed(2),pass:R}}}const Kt=n=>({}),mt=n=>({});function dt(n){let e;return{c(){e=O("path"),this.h()},l(t){e=q(t,"path",{class:!0,d:!0}),k(e).forEach(P),this.h()},h(){F(e,"class","prev svelte-9w8b69"),F(e,"d",n[5])},m(t,r){H(t,e,r)},p(t,r){r[0]&32&&F(e,"d",t[5])},d(t){t&&P(e)}}}function vt(n){let e,t=n[2]+1+"",r;return{c(){e=D("p"),r=_t(t),this.h()},l(s){e=N(s,"P",{class:!0});var a=k(e);r=yt(a,t),a.forEach(P),this.h()},h(){F(e,"class","frame svelte-9w8b69")},m(s,a){H(s,e,a),x(e,r)},p(s,a){a[0]&4&&t!==(t=s[2]+1+"")&&bt(r,t)},d(s){s&&P(e)}}}function gt(n){let e,t,r,s;return{c(){e=D("p"),t=D("small"),r=_t(n[8]),this.h()},l(a){e=N(a,"P",{class:!0});var l=k(e);t=N(l,"SMALL",{});var f=k(t);r=yt(f,n[8]),f.forEach(P),l.forEach(P),this.h()},h(){F(e,"class","message svelte-9w8b69")},m(a,l){H(a,e,l),x(e,t),x(t,r)},p(a,l){l[0]&256&&bt(r,a[8])},i(a){a&&(s||Nt(()=>{s=Gt(e,Ht,{}),s.start()}))},o:jt,d(a){a&&P(e)}}}function Qt(n){let e,t,r,s,a,l,f,d,v,_,g,h,p,M,E,y,L,C,c=n[5]&&!n[7]&&dt(n),o=n[1]&&vt(n),u=n[8]&&gt(n);const R=n[25].ui,b=Ct(R,n,n[24],mt);return{c(){e=D("div"),t=D("div"),r=O("svg"),s=O("g"),a=O("path"),l=z(),f=O("svg"),d=O("g"),c&&c.c(),v=O("path"),_=z(),o&&o.c(),g=z(),u&&u.c(),h=z(),p=D("div"),M=D("span"),E=z(),b&&b.c(),this.h()},l(i){e=N(i,"DIV",{class:!0});var w=k(e);t=N(w,"DIV",{class:!0});var S=k(t);r=q(S,"svg",{class:!0});var W=k(r);s=q(W,"g",{});var Y=k(s);a=q(Y,"path",{d:!0,class:!0}),k(a).forEach(P),Y.forEach(P),W.forEach(P),l=G(S),f=q(S,"svg",{class:!0});var B=k(f);d=q(B,"g",{});var V=k(d);c&&c.l(V),v=q(V,"path",{d:!0,class:!0}),k(v).forEach(P),V.forEach(P),B.forEach(P),_=G(S),o&&o.l(S),g=G(S),u&&u.l(S),S.forEach(P),h=G(w),p=N(w,"DIV",{class:!0});var J=k(p);M=N(J,"SPAN",{class:!0,style:!0}),k(M).forEach(P),J.forEach(P),w.forEach(P),E=G(i),b&&b.l(i),this.h()},h(){F(a,"d",n[6]),F(a,"class","svelte-9w8b69"),F(r,"class","preview svelte-9w8b69"),F(v,"d",n[3]),F(v,"class","svelte-9w8b69"),F(f,"class","draw shadow svelte-9w8b69"),F(t,"class","canvas svelte-9w8b69"),F(M,"class","bar svelte-9w8b69"),it(M,"--ink",n[4]*100+"%"),F(p,"class","ink svelte-9w8b69"),F(e,"class","c svelte-9w8b69"),lt(e,"disabled",n[0])},m(i,w){H(i,e,w),x(e,t),x(t,r),x(r,s),x(s,a),x(t,l),x(t,f),x(f,d),c&&c.m(d,null),x(d,v),x(t,_),o&&o.m(t,null),x(t,g),u&&u.m(t,null),x(e,h),x(e,p),x(p,M),H(i,E,w),b&&b.m(i,w),y=!0,L||(C=[K(e,"pointerdown",n[9]),K(e,"pointermove",n[10]),K(e,"pointerup",n[11]),K(e,"pointerleave",n[11])],L=!0)},p(i,w){(!y||w[0]&64)&&F(a,"d",i[6]),i[5]&&!i[7]?c?c.p(i,w):(c=dt(i),c.c(),c.m(d,v)):c&&(c.d(1),c=null),(!y||w[0]&8)&&F(v,"d",i[3]),i[1]?o?o.p(i,w):(o=vt(i),o.c(),o.m(t,g)):o&&(o.d(1),o=null),i[8]?u?(u.p(i,w),w[0]&256&&Q(u,1)):(u=gt(i),u.c(),Q(u,1),u.m(t,null)):u&&(u.d(1),u=null),(!y||w[0]&16)&&it(M,"--ink",i[4]*100+"%"),(!y||w[0]&1)&&lt(e,"disabled",i[0]),b&&b.p&&(!y||w[0]&16777216)&&At(b,R,i,i[24],y?St(R,i[24],w,Kt):Rt(i[24]),mt)},i(i){y||(Q(u),Q(b,i),y=!0)},o(i){zt(b,i),y=!1},d(i){i&&(P(e),P(E)),c&&c.d(),o&&o.d(),u&&u.d(),b&&b.d(i),L=!1,Ot(C)}}}const $=300,Ut=12;function Zt(n){let e=[];for(let t of n)e.push(...t);return e}function pt(n){const e=+n.offsetX.toFixed(1),t=+n.offsetY.toFixed(1);return[e,t]}function Tt(n,e,t){let r,s,{$$slots:a={},$$scope:l}=e,{preset:f}=e,{path:d}=e,{paths:v}=e,{disabled:_}=e,{showFrameIndex:g}=e;const h=$,p=$*5,M=qt(),E=!!f;let y=1,L=!1,C=!1,c=0,o=[],u="",R="",b=!0,i;const w=Lt,S=Ft,W=Et,Y=at,B=X;function V(m){t(8,X=null),t(20,L=!1),t(4,y=1),C=!0;const A=pt(m);t(21,o[c]=[],o),o[c].push(A)}function J(m){if(!C||L)return;const A=pt(m);o[c].push(A);const I=tt(o[c]);I>p&&t(20,L=!0),t(4,y=Math.max(0,(p-I)/p)),t(21,o=[...o])}function wt(){C=!1}function Pt(){if(E&&c>0){const m=[...o[c]].map(([U,Z])=>({x:U,y:Z})),A=[...o[c-1]].map(([U,Z])=>({x:U,y:Z})),I=Math.sqrt($**2+h**2),xt=Jt({cur:m,prev:A,diagonal:I});t(22,b=xt.valid),M("validate",b)}else t(22,b=!0);b?(t(5,u=s),t(2,c+=1)):setTimeout(()=>{t(22,b=void 0)},2e3),t(23,r=[]),t(4,y=1)}function at(){t(21,o[c]=[],o),t(6,R=""),t(4,y=1),t(22,b=!0)}function ot(m=0){const A=o[m].map(I=>I.join(" ")).join("L");t(6,R=i?`M${A}`:""),setTimeout(()=>{let I=m+1;I>c-1&&(I=0),i&&ot(I)},1e3/Ut)}function Ft(){Pt()}function Et(){at()}function X(m){t(8,X=m)}function Lt(){t(7,i=!i),i?ot():t(6,R="")}return Dt(()=>{t(5,u=f||""),u&&(t(2,c=1),t(21,o[0]=Zt(u.split("M").filter(m=>m).map(m=>m.split("L").map(A=>A.split(" ").map(I=>+I)))),o))}),n.$$set=m=>{"preset"in m&&t(14,f=m.preset),"path"in m&&t(12,d=m.path),"paths"in m&&t(13,v=m.paths),"disabled"in m&&t(0,_=m.disabled),"showFrameIndex"in m&&t(1,g=m.showFrameIndex),"$$scope"in m&&t(24,l=m.$$scope)},n.$$.update=()=>{var m;n.$$.dirty[0]&2097156&&t(23,r=(m=o[c])==null?void 0:m.map(A=>A.join(" ")).join("L")),n.$$.dirty[0]&8388608&&t(3,s=r!=null&&r.length?`M${r}`:""),n.$$.dirty[0]&2097152&&t(13,v=o.map(A=>`M${A.map(I=>I.join(" ")).join("L")}`)),n.$$.dirty[0]&8&&t(12,d=s),n.$$.dirty[0]&5242880&&t(8,X=b===!1?"I think you can do better!":L?"Out of ink":null)},[_,g,c,s,y,u,R,i,X,V,J,wt,d,v,f,w,S,W,Y,B,L,o,b,r,l,a]}class ee extends Vt{constructor(e){super(),Xt(this,e,Tt,Qt,kt,{preset:14,path:12,paths:13,disabled:0,showFrameIndex:1,preview:15,addFrame:16,clearFrame:17,resetFrame:18,addMessage:19},null,[-1,-1])}get preview(){return this.$$.ctx[15]}get addFrame(){return this.$$.ctx[16]}get clearFrame(){return this.$$.ctx[17]}get resetFrame(){return this.$$.ctx[18]}get addMessage(){return this.$$.ctx[19]}}function ne(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function re(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}function se(){console.log("--- --- --- --- --- ---"),console.log("svelte-starter: 5.13.0"),console.log("build: 2024-03-01-14:29"),console.log("--- --- --- --- --- ---")}export{ee as C,ne as a,re as g,se as v};
